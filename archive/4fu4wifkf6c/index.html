<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="一个小时快速搭建微信小程序"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>一个小时快速搭建微信小程序 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/4fu4wifkf6c/",
				"appid": "1613049289050283", 
				"title": "一个小时快速搭建微信小程序 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-02T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/iaiex7af4ue/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/ab3x8xjr87i/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f4fu4wifkf6c%2f&text=%e4%b8%80%e4%b8%aa%e5%b0%8f%e6%97%b6%e5%bf%ab%e9%80%9f%e6%90%ad%e5%bb%ba%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f4fu4wifkf6c%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f4fu4wifkf6c%2f&text=%e4%b8%80%e4%b8%aa%e5%b0%8f%e6%97%b6%e5%bf%ab%e9%80%9f%e6%90%ad%e5%bb%ba%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f4fu4wifkf6c%2f&title=%e4%b8%80%e4%b8%aa%e5%b0%8f%e6%97%b6%e5%bf%ab%e9%80%9f%e6%90%ad%e5%bb%ba%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f4fu4wifkf6c%2f&is_video=false&description=%e4%b8%80%e4%b8%aa%e5%b0%8f%e6%97%b6%e5%bf%ab%e9%80%9f%e6%90%ad%e5%bb%ba%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%b8%80%e4%b8%aa%e5%b0%8f%e6%97%b6%e5%bf%ab%e9%80%9f%e6%90%ad%e5%bb%ba%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f4fu4wifkf6c%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f4fu4wifkf6c%2f&title=%e4%b8%80%e4%b8%aa%e5%b0%8f%e6%97%b6%e5%bf%ab%e9%80%9f%e6%90%ad%e5%bb%ba%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4fu4wifkf6c%2f&title=%e4%b8%80%e4%b8%aa%e5%b0%8f%e6%97%b6%e5%bf%ab%e9%80%9f%e6%90%ad%e5%bb%ba%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4fu4wifkf6c%2f&title=%e4%b8%80%e4%b8%aa%e5%b0%8f%e6%97%b6%e5%bf%ab%e9%80%9f%e6%90%ad%e5%bb%ba%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4fu4wifkf6c%2f&title=%e4%b8%80%e4%b8%aa%e5%b0%8f%e6%97%b6%e5%bf%ab%e9%80%9f%e6%90%ad%e5%bb%ba%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">一个小时快速搭建微信小程序</h1><div class="meta"><div class="postdate"><time datetime="2019-02-02" itemprop="datePublished">2019-02-02</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e「小程序」这个划时代的产品发布快一周了，互联网技术人都在摩拳擦掌，跃跃欲试。可是小程序目前还在内测，首批只发放了 200 个内测资格（泪流满面）。本以为没有 AppID 这个月就与小程序无缘了，庆幸的是微信这两天发布了正式版开发者工具，\x3cstrong\x3e无需内测邀请也可以尝鲜了\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e因此也就有了我与「小程序」的初体验，而我的感受只有一个字——爽！\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e选择哪个「小程序」Demo？\x3c\/h2\x3e\n\x3cp\x3e在知名同性交友网站 Github 上，「小程序」的 Demo 不少，但是大多只是简单的 API 演示，有的甚至直接把页面数据写在了 json 文件里（分明有网络请求 API）。我想体验的是能够将服务端和小程序端无缝连接起来（体验够爽）的项目。最终，我选择了腾讯云官方推出的\x3ca href=\x22https:\/\/www.qcloud.com\/act\/event\/yingyonghao.html?utm_source=Community\x26amp;utm_medium=Community\x26amp;utm_campaign=ZhiHu\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e「小相册」项目\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e「小相册」主要实现了以下功能：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e列出对象存储 COS 中的图片列表。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e点击左上角上传图片图标，可以调用相机拍照或从手机相册选择图片，并将选中的图片上传到 对象存储 COS 中。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e轻按任意图片，可进入全屏图片预览模式，并可左右滑动切换预览图片。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e长按任意图片，可将其保存到本地，或从 对象存储 COS 中删除。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033830?w=921\x26amp;h=635\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033830?w=921\x26amp;h=635\x22 alt=\x22小相册小程序演示图\x22 title=\x22小相册小程序演示图\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e效果演示图（受开发工具的限制，部分功能尚未实现）\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.qcloud.com\/act\/event\/yingyonghao.html?utm_source=Community\x26amp;utm_medium=Community\x26amp;utm_campaign=ZhiHu\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e对象存储服务\x3c\/a\x3e（Cloud Object Service）是腾讯云推出的面向企业和个人开发者提供的高可用，高稳定，强安全的云端存储服务。可以将任意数量和形式的非结构化数据放入COS，并在其中实现数据的管理和处理。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e之所以选择腾讯云的 Demo，一是因为它是\x3cstrong\x3e腾讯自家推出的，项目的质量有保障\x3c\/strong\x3e；二是因为它是\x3cstrong\x3e少有的既讲小程序开发，又介绍云端部署的项目\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e稍微有点经验的程序员都知道，架构要动静分离，静态文件最好不要放在自己的服务器上，要放在专门用来存储的对象存储服务器COS上，并且用CDN 加速。「小相册」后端采用的是 Node.js，Nginx作为反向代理。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e第一步：搭开发环境\x3c\/h2\x3e\n\x3cp\x3e首先，我们需要在本地搭建好微信「小程序」的开发环境。即下载开发者工具。微信官方已经推出了正式版 IDE，\x3cstrong\x3e大家没有必要再去下载破解版了\x3c\/strong\x3e。打开\x3ca href=\x22https:\/\/mp.weixin.qq.com\/debug\/wxadoc\/dev\/devtools\/download.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e官网下载页面\x3c\/a\x3e，根据自己的操作系统选择。我使用的是 Mac 版。\x3c\/p\x3e\n\x3cp\x3e安装好之后打开运行，会要求微信扫码登陆。之后，就可以看到创建项目的页面了。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033831?w=614\x26amp;h=420\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033831?w=614\x26amp;h=420\x22 alt=\x22创建项目的页面\x22 title=\x22创建项目的页面\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e选择添加项目，没有 AppID 就选无（如果乱写会报错，到时可能无法进入项目）。如果你选择的项目目录为空，请如图所示勾选在“当前目录中创建quick start项目”。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033832?w=805\x26amp;h=440\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033832?w=805\x26amp;h=440\x22 alt=\x22quick start\x22 title=\x22quick start\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e点击“添加项目”之后，我们会进入开发工具的调试页面。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e第二步：下载「小相册」源码\x3c\/h2\x3e\n\x3cp\x3e接下来，我们下载「小相册」的源码。可以选择直接从\x3ca href=\x22http:\/\/imgcache.qq.com\/qcloud\/la\/demo-source\/qcloud-applet-album.zip\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e腾讯云官网提供的链接\x3c\/a\x3e下载，也可以从腾讯云团队的 Github 仓库拉取。我推荐从 Github 仓库拉取，这样可以及时获取最新的代码。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3egit clone https:\/\/github.com\/CFETeam\/weapp-demo-album.git\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e最终，我们会得到类似这样的文件目录。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033833?w=502\x26amp;h=106\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033833?w=502\x26amp;h=106\x22 alt=\x22小相册文件目录\x22 title=\x22小相册文件目录\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e简单解释下目录结构：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eapplet（或app）: 「小相册」应用包代码，可直接在微信开发者工具中作为项目打开。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eserver: 搭建的Node服务端代码，作为服务器和app通信，提供 CGI 接口示例，用于拉取图片资源、上传图片、删除图片。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eassets：「小相册」的演示截图。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e源码下载完成之后，我们打开微信 web 开发者工具，新建项目「小相册」，选择目录applet（或app）。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033834?w=543\x26amp;h=285\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033834?w=543\x26amp;h=285\x22 alt=\x22添加项目\x22 title=\x22添加项目\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e「小相册」源码分析\x3c\/h3\x3e\n\x3cp\x3e在进行部署之前，我们来简单分析一下「小相册」的具体代码。毕竟只看效果不是我们的目的，我们的目的是\x3cstrong\x3e以「小相册」为例，了解如何开发小程序并与服务端进行交互\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033835?w=1074\x26amp;h=1256\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033835?w=1074\x26amp;h=1256\x22 alt=\x22文件tree结构图\x22 title=\x22文件tree结构图\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e「小相册」包含一个描述整体程序的 app 和多个描述各自页面的 page。主程序 app 主要由三个文件组成，分别是 \x3ccode\x3eapp.js\x3c\/code\x3e（小程序逻辑）、\x3ccode\x3eapp.json\x3c\/code\x3e（小程序公共设置）和 \x3ccode\x3eapp.wxss\x3c\/code\x3e（小程序公共样式表），其中前两个为必备文件。\x3ccode\x3econfig.js\x3c\/code\x3e 文件中包含了一些部署域名的设置，现在不用管。\x3c\/p\x3e\n\x3cp\x3e在 pages 目录下，有两个 page 页面，分别是 index 和 album。页面结构算是比较简单的，其中 index 是小程序启动时默认进入的页面。每个页面下，至少要有 .js（页面逻辑）和 .wxml（页面结构）两个文件，.wxss（页面样式表）和 .json（页面配置）文件为选填。你可能注意到了，\x3cstrong\x3e这些文件的文件名与父目录的名称相同\x3c\/strong\x3e。这是微信官方的规定，目的是减少配置项，方便开发者。\x3c\/p\x3e\n\x3cp\x3e接下来我们以 index 页面为例做简单的解释。\x3ccode\x3eindex.wxml\x3c\/code\x3e 是这个页面的表现层文件，其中的代码非常简单，可以分为上下两大部分。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cview\x3e\n    \x3cview class=\x26quot;page-top\x26quot;\x3e\n        \x3ctext class=\x26quot;username\x26quot;\x3e恭喜你\x3c\/text\x3e\n        \x3ctext class=\x26quot;text-info\x26quot;\x3e成功地搭建了一个微信小程序\x3c\/text\x3e\n        \x3cview class=\x26quot;page-btn-wrap\x26quot;\x3e\n            \x3cbutton class=\x26quot;page-btn\x26quot; bindtap=\x26quot;gotoAlbum\x26quot;\x3e进入相册\x3c\/button\x3e\n        \x3c\/view\x3e\n    \x3c\/view\x3e\n    \x3cview class=\x26quot;page-bottom\x26quot;\x3e\n        \x3ctext class=\x26quot;qr-txt\x26quot;\x3e分享二维码邀请好友结伴一起写小程序！\x3c\/text\x3e\n        \x3cimage src=\x26quot;..\/..\/images\/qr.png\x26quot; class=\x26quot;qr-img\x26quot;\x3e\x3c\/image\x3e\n        \x3cimage src=\x26quot;..\/..\/images\/logo.png\x26quot; class=\x26quot;page-logo\x26quot;\x3e\x3c\/image\x3e\n    \x3c\/view\x3e\n\x3c\/view\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eview\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eview\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22page-top\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etext\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22username\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e恭喜你\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etext\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etext\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text-info\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e成功地搭建了一个微信小程序\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etext\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eview\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22page-btn-wrap\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22page-btn\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ebindtap\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22gotoAlbum\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e进入相册\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eview\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eview\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eview\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22page-bottom\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etext\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22qr-txt\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e分享二维码邀请好友结伴一起写小程序！\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etext\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimage\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22..\/..\/images\/qr.png\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22qr-img\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eimage\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimage\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22..\/..\/images\/logo.png\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22page-logo\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eimage\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eview\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eview\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e页面的演示效果如下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033836?w=921\x26amp;h=635\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033836?w=921\x26amp;h=635\x22 alt=\x22index 页面渲染\x22 title=\x22index 页面渲染\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e我们看到，页面上有一个“进入相册”的按钮。正常理解，点击后该按钮后我们就可以进入相册了（这不废话嘛）。那小程序背后是怎样实现该操作的呢？\x3c\/p\x3e\n\x3cp\x3e在 \x3ccode\x3eindex.wxml\x3c\/code\x3e 中，我们发现对应的 button 标签上定义了一个 \x3ccode\x3ebindtap\x3c\/code\x3e 属性，绑定了一个叫做 \x3ccode\x3egotoAlbum\x3c\/code\x3e 的方法。而这个方法可以在 \x3ccode\x3eindex.js\x3c\/code\x3e 文件中找到。事实上，文件中也只定义了这一个方法，执行的具体动作就是跳转到 album 页面。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Page({\n    \/\/ 前往相册页\n    gotoAlbum() {\n        wx.navigateTo({ url: \x27..\/album\/album\x27 });\n    },\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3ePage({\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 前往相册页\x3c\/span\x3e\n    gotoAlbum() {\n        wx.navigateTo({ \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27..\/album\/album\x27\x3c\/span\x3e });\n    },\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3ealbum.js\x3c\/code\x3e 页面中编写了程序的主要逻辑，包括选择或拍摄图片、图片预览、图片下载和图片删除；album.wxml 中三种视图容器 view、scroll-view、swiper均有使用，还提供了消息提示框 toast。具体方法和视图的实现请查看\x3ca href=\x22https:\/\/github.com\/CFETeam\/weapp-demo-album\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e项目源码\x3c\/a\x3e。所有的这些功能都写在 Page 类中。\x3c\/p\x3e\n\x3cp\x3elib 目录下提供了小程序会用的一些辅助函数，包括异步访问和对象存储 COS 的 API。\x3c\/p\x3e\n\x3cp\x3e总的来说，和微信官方宣传的一样，在开发者工具下进行小程序的开发，效率确实提高了很多，而且有很多微信提高的组件和 API。所以，在开发速度这点上的体验还是非常爽的。\x3c\/p\x3e\n\x3cp\x3e另外，由于「小相册」需要使用诸多云端能力，如图片的上传和下载，我们还需要进行服务器端的部署和设置。具体请看接下来的步骤。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e第三步：云端部署 server 代码\x3c\/h2\x3e\n\x3cp\x3e虽然服务端的开发不是本文的重点，但是为了全面地体验「小相册」的整个开发部署流程，我们还是有必要了解服务端的部署，这里我们使用的是腾讯云。\x3c\/p\x3e\n\x3cp\x3e如果你想更爽一点，那么可以选择腾讯云官方提供的小程序云端镜像。「小相册」的服务器运行代码和配置已经打包成腾讯云 CVM 镜像，可以\x3ca href=\x22https:\/\/buy.qcloud.com\/cvm?marketImgId=370\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e直接使用\x3c\/a\x3e。可谓是一键部署好云端。\x3c\/p\x3e\n\x3cp\x3e如果你以前没有使用过腾讯云，可以选择免费试用（我已经领取了 8 天的个人版服务器），或者\x3ca href=\x22https:\/\/www.qcloud.com\/act\/event\/yingyonghao.html#section-voucher\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e领取礼包\x3c\/a\x3e以优惠的价格购买所需的服务。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033837?w=1206\x26amp;h=430\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033837?w=1206\x26amp;h=430\x22 alt=\x22直接使用小程序镜像\x22 title=\x22直接使用小程序镜像\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e你也可以选择将「小相册」源码中的server文件夹上传到自己的服务器。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e第四步：准备域名和配置证书\x3c\/h2\x3e\n\x3cp\x3e如果你已经有腾讯云的服务器和域名，并配置好了 https，那么可以跳过第 4-6 步。\x3c\/p\x3e\n\x3cp\x3e在微信小程序中，所有的网络请求受到严格限制，不满足条件的域名和协议无法请求。简单来说，就是你的域名必须走 https 协议。所以你还需要为你的域名\x3ca href=\x22https:\/\/console.qcloud.com\/ssl\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e申请一个证书\x3c\/a\x3e。如果没有域名，\x3ca href=\x22https:\/\/www.qcloud.com\/product\/dm.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e请先注册一个\x3c\/a\x3e。由于我们没有收到内测，也就暂时不用登录微信公众平台配置通信域名了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e第五步：Nginx 配置 https\x3c\/h2\x3e\n\x3cp\x3e微信小程序云端示例镜像中，已经部署好了 Nginx，但是还需要在\x26nbsp;\x3ccode\x3e\/etc\/nginx\/conf.d\x3c\/code\x3e\x26nbsp;下修改配置中的域名、证书、私钥。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033838?w=507\x26amp;h=266\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033838?w=507\x26amp;h=266\x22 alt=\x22nginx 配置\x22 title=\x22nginx 配置\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e请将红框部分换成自己的域名和证书，并且将 \x3ccode\x3eproxy_pass\x3c\/code\x3e 设置为 Node.js 监听的端口，我的是 9993。\x3c\/p\x3e\n\x3cp\x3e配置完成后，重新加载配置文件并且重启 Nginx。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22sudo service nginx reload\nsudo service nginx restart\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ebnf\x22\x3e\x3ccode class=\x22sh\x22\x3e\x3cspan class=\x22hljs-attribute\x22\x3esudo service nginx reload\nsudo service nginx restart\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e第六步：域名解析\x3c\/h2\x3e\n\x3cp\x3e我们还需要添加域名记录，将域名解析到我们的云服务器上，这样才可以使用域名进行 https 服务。在腾讯云注册的域名，可以直接使用\x3ca href=\x22https:\/\/console.qcloud.com\/cns\/domains\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e云解析控制台\x3c\/a\x3e来添加主机记录，直接选择上面购买的 CVM。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033839?w=802\x26amp;h=703\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033839?w=802\x26amp;h=703\x22 alt=\x22域名解析\x22 title=\x22域名解析\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e解析生效后，我们的域名就支持 https 访问了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e第七步：开通和配置 COS\x3c\/h2\x3e\n\x3cp\x3e由于我们希望实现动静分离的架构，所以选择把「小相册」的图片资源是存储在 COS 上的。要使用 COS 服务，需要登录 \x3ca href=\x22https:\/\/console.qcloud.com\/cos\/overview?utm_source=jiaocheng\x26amp;utm_medium=cos\x26amp;utm_campaign=qcloud\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCOS 管理控制台\x3c\/a\x3e，然后在其中完成以下操作。\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e\x3cp\x3e点击创建 Bucket。会要求选择所属项目，填写相应名称。这里，我们只需要填上自己喜欢的 Bucket 名称即可。\x3c\/p\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033840?w=1270\x26amp;h=752\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033840?w=1270\x26amp;h=752\x22 alt=\x22创建Bucket\x22 title=\x22创建Bucket\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e\x3cp\x3e然后在 Bucket 列表中，点击刚刚创建的 Bucket。然后在新页面点击“获取API密钥”。\x3c\/p\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033841?w=1270\x26amp;h=694\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033841?w=1270\x26amp;h=694\x22 alt=\x22获取API密钥\x22 title=\x22获取API密钥\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e弹出的页面中包括了我们所需要的三个信息：唯一的 APP ID，一对SecretID和SecretKey（用于调用 COS API）。保管好这些信息，我们在稍后会用到。\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e\x3cp\x3e最后，在新的 Bucket 容器中创建文件夹，命名为photos。这点后面我们也会提到。\x3c\/p\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e第八步：启动「小相册」的服务端\x3c\/h2\x3e\n\x3cp\x3e在官方提供的镜像中，小相册示例的 Node 服务代码已部署在目录 \x3ccode\x3e\/data\/release\/qcloud-applet-album\x3c\/code\x3e 下。进入该目录，如果是你自己的服务器，请进入相应的文件夹。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22cd \/data\/release\/qcloud-applet-album\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haskell\x22\x3e\x3ccode class=\x22sh\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-title\x22\x3ecd\x3c\/span\x3e \/\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e\/release\/qcloud-applet-album\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在该目录下，有一个名为 \x3ccode\x3econfig.js\x3c\/code\x3e 的配置文件（如下所示），按注释修改对应的 COS 配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module.exports = {\n    \/\/ Node 监听的端口号\n    port: \x279993\x27,\n    ROUTE_BASE_PATH: \x27\/applet\x27,\n\n    cosAppId: \x27填写开通 COS 时分配的 APP ID\x27,\n    cosSecretId: \x27填写密钥 SecretID\x27,\n    cosSecretKey: \x27填写密钥 SecretKey\x27,\n    cosFileBucket: \x27填写创建的公有读私有写的bucket名称\x27,\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Node 监听的端口号\x3c\/span\x3e\n    port: \x3cspan class=\x22hljs-string\x22\x3e\x279993\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eROUTE_BASE_PATH\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/applet\x27\x3c\/span\x3e,\n\n    \x3cspan class=\x22hljs-attr\x22\x3ecosAppId\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27填写开通 COS 时分配的 APP ID\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ecosSecretId\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27填写密钥 SecretID\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ecosSecretKey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27填写密钥 SecretKey\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ecosFileBucket\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27填写创建的公有读私有写的bucket名称\x27\x3c\/span\x3e,\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e另外，\x3ccode\x3ecd .\/routes\/album\/handlers\x3c\/code\x3e，修改 \x3ccode\x3elist.js\x3c\/code\x3e，将 \x3ccode\x3econst listPath\x3c\/code\x3e 的值修改为你的Bucket 下的图片存储路径。如果是根目录，则修改为 \x3ccode\x3e\x27\/\x27\x3c\/code\x3e。当前服务端的代码中将该值设置为了 \x3ccode\x3e\x27\/photos\x27\x3c\/code\x3e ，如果你在第七步中没有创建该目录，则无法调试成功。\x3c\/p\x3e\n\x3cp\x3e小相册示例使用 pm2 管理 Node 进程，执行以下命令启动 node 服务：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22pm2 start process.json\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livecodeserver\x22\x3e\x3ccode class=\x22sh\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3epm2 \x3cspan class=\x22hljs-built_in\x22\x3estart\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eprocess\x3c\/span\x3e.json\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e第九步：配置「小相册」通信域名\x3c\/h2\x3e\n\x3cp\x3e接下来，在微信 web 开发者工具打开「小相册」项目，并把源文件config.js中的通讯域名 host 修改成你自己申请的域名。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033842?w=659\x26amp;h=339\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033842?w=659\x26amp;h=339\x22 alt=\x22小相册-修改域名\x22 title=\x22小相册-修改域名\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e将蓝色框内的内容修改为自己的域名\x3c\/p\x3e\n\x3cp\x3e然后点击调试，即可打开小相册Demo开始体验。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033843?w=554\x26amp;h=509\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033843?w=554\x26amp;h=509\x22 alt=\x22小相册调试体验\x22 title=\x22小相册调试体验\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007033836?w=921\x26amp;h=635\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007033836?w=921\x26amp;h=635\x22 alt=\x22小相册调试体验2\x22 title=\x22小相册调试体验2\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e最后提示一点，截止目前为止，微信小程序提供的上传和下载 API 无法在调试工具中正常工作，需要用手机微信扫码预览体验。但是由于没有内测资格，我们暂时是没办法体验了。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e嗯，就这点不够爽，没有内测邀请。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e更新：\x3cstrong\x3e腾讯云还写了另外3个demo的\x3ca href=\x22https:\/\/www.qcloud.com\/act\/event\/yingyonghao.html?utm_source=Community\x26amp;utm_medium=Community\x26amp;utm_campaign=ZhiHu\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e小程序教程\x3c\/a\x3e，大家也可以看看。\x3c\/strong\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>一个小时快速搭建微信小程序</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007033827">https://segmentfault.com/a/1190000007033827</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/4fu4wifkf6c/" target="_blank">https://alili.tech/archive/4fu4wifkf6c/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>