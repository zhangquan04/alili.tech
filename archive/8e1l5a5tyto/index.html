<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="react进阶系列：高阶组件详解（二）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>react进阶系列：高阶组件详解（二） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/8e1l5a5tyto/",
				"appid": "1613049289050283", 
				"title": "react进阶系列：高阶组件详解（二） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-11T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/11jwxjgd200b/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/bdc11l693cl/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f8e1l5a5tyto%2f&text=react%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%ef%bc%9a%e9%ab%98%e9%98%b6%e7%bb%84%e4%bb%b6%e8%af%a6%e8%a7%a3%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f8e1l5a5tyto%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f8e1l5a5tyto%2f&text=react%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%ef%bc%9a%e9%ab%98%e9%98%b6%e7%bb%84%e4%bb%b6%e8%af%a6%e8%a7%a3%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f8e1l5a5tyto%2f&title=react%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%ef%bc%9a%e9%ab%98%e9%98%b6%e7%bb%84%e4%bb%b6%e8%af%a6%e8%a7%a3%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f8e1l5a5tyto%2f&is_video=false&description=react%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%ef%bc%9a%e9%ab%98%e9%98%b6%e7%bb%84%e4%bb%b6%e8%af%a6%e8%a7%a3%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=react%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%ef%bc%9a%e9%ab%98%e9%98%b6%e7%bb%84%e4%bb%b6%e8%af%a6%e8%a7%a3%ef%bc%88%e4%ba%8c%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f8e1l5a5tyto%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f8e1l5a5tyto%2f&title=react%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%ef%bc%9a%e9%ab%98%e9%98%b6%e7%bb%84%e4%bb%b6%e8%af%a6%e8%a7%a3%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f8e1l5a5tyto%2f&title=react%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%ef%bc%9a%e9%ab%98%e9%98%b6%e7%bb%84%e4%bb%b6%e8%af%a6%e8%a7%a3%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f8e1l5a5tyto%2f&title=react%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%ef%bc%9a%e9%ab%98%e9%98%b6%e7%bb%84%e4%bb%b6%e8%af%a6%e8%a7%a3%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f8e1l5a5tyto%2f&title=react%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%ef%bc%9a%e9%ab%98%e9%98%b6%e7%bb%84%e4%bb%b6%e8%af%a6%e8%a7%a3%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">react进阶系列：高阶组件详解（二）</h1><div class="meta"><div class="postdate"><time datetime="2019-01-11" itemprop="datePublished">2019-01-11</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e高阶组件可以封装公共逻辑，给当前组件传递方法属性，添加生命周期钩子等。\x3c\/p\x3e\n\x3cp\x3e案例：\x3c\/p\x3e\n\x3cp\x3e一个项目中有的页面需要判断所处环境，如果在移动端则正常显示页面，并向用户提示当前页面所处的移动端环境，如果不在移动端则显示提示让其在移动端打开。但是有的页面又不需要这个判断。\x3c\/p\x3e\n\x3cp\x3e如果在每个页面都写一段判断逻辑未免麻烦，因此可以借助高阶组件来处理这部分逻辑。\x3c\/p\x3e\n\x3cp\x3e先创建一个高阶组件\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ src\/container\/withEnvironment\/index.jsx\nimport React from \x27react\x27;\n\nconst envs = {\n    weixin: \x27微信\x27,\n    qq: \x27QQ\x27,\n    baiduboxapp: \x27手机百度\x27,\n    weibo: \x27微博\x27,\n    other: \x27移动端\x27\n}\n\nfunction withEnvironment(BasicComponent) {\n    const ua = navigator.userAgent;\n    const isMobile = \x27ontouchstart\x27 in document;\n    let env = \x27other\x27;\n\n    if (ua.match(\/MicroMessenger\/i)) {\n        env = \x27weixin\x27;\n    }\n    if (ua.match(\/weibo\/i)) {\n        env = \x27weibo\x27;\n    }\n    if (ua.match(\/qq\/i)) {\n        env = \x27qq\x27;\n    }\n    if (ua.match(\/baiduboxapp\/i)) {\n        env = \x27baiduboxapp\x27\n    }\n\n    \/\/ 不同逻辑下返回不同的中间组件\n    if (!isMobile) {\n        return function () {\n            return (\n                \x3cdiv\x3e\n                    \x3cdiv\x3e该页面只能在移动端查看，请扫描下方二维码打开。\x3c\/div\x3e\n                    \x3cdiv\x3e假设这里有张二维码\x3c\/div\x3e\n                \x3c\/div\x3e\n            )    \n        }\n    }\n\n    \/\/ 通过定义的中间组件将页面所处环境通过props传递给基础组件\n    const C = props =\x3e (\n        \x3cBasicComponent {...props} env={env} envdesc={envs[env]} \/\x3e\n    )\n\n    return C;\n}\n\n\nexport default withEnvironment;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ src\/container\/withEnvironment\/index.jsx\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e envs = {\n    \x3cspan class=\x22hljs-attr\x22\x3eweixin\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27微信\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eqq\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27QQ\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ebaiduboxapp\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27手机百度\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eweibo\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27微博\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eother\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27移动端\x27\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ewithEnvironment\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eBasicComponent\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ua = navigator.userAgent;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e isMobile = \x3cspan class=\x22hljs-string\x22\x3e\x27ontouchstart\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e env = \x3cspan class=\x22hljs-string\x22\x3e\x27other\x27\x3c\/span\x3e;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ua.match(\x3cspan class=\x22hljs-regexp\x22\x3e\/MicroMessenger\/i\x3c\/span\x3e)) {\n        env = \x3cspan class=\x22hljs-string\x22\x3e\x27weixin\x27\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ua.match(\x3cspan class=\x22hljs-regexp\x22\x3e\/weibo\/i\x3c\/span\x3e)) {\n        env = \x3cspan class=\x22hljs-string\x22\x3e\x27weibo\x27\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ua.match(\x3cspan class=\x22hljs-regexp\x22\x3e\/qq\/i\x3c\/span\x3e)) {\n        env = \x3cspan class=\x22hljs-string\x22\x3e\x27qq\x27\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ua.match(\x3cspan class=\x22hljs-regexp\x22\x3e\/baiduboxapp\/i\x3c\/span\x3e)) {\n        env = \x3cspan class=\x22hljs-string\x22\x3e\x27baiduboxapp\x27\x3c\/span\x3e\n    }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 不同逻辑下返回不同的中间组件\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isMobile) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n                \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e该页面只能在移动端查看，请扫描下方二维码打开。\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e假设这里有张二维码\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n            )    \n        }\n    }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 通过定义的中间组件将页面所处环境通过props传递给基础组件\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e C = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eprops\x3c\/span\x3e =\x26gt;\x3c\/span\x3e (\n        \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eBasicComponent\x3c\/span\x3e {\x3cspan class=\x22hljs-attr\x22\x3e...props\x3c\/span\x3e} \x3cspan class=\x22hljs-attr\x22\x3eenv\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{env}\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eenvdesc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{envs[env]}\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n    )\n\n    return C;\n}\n\n\nexport default withEnvironment;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后在基础组件中使用\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ src\/pages\/Demo01\/index.jsx\nimport React from \x27react\x27;\nimport withEnvironment from \x27..\/..\/container\/withEnvironment\x27;\n\nfunction Demo01(props) {\n    return (\n        \x3cdiv\x3e你现在正在{props.envdesc}中访问该页面\x3c\/div\x3e\n    )\n}\n\nexport default withEnvironment(Demo01);\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ src\/pages\/Demo01\/index.jsx\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e withEnvironment \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/..\/container\/withEnvironment\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eDemo01\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eprops\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n        \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e你现在正在{props.envdesc}中访问该页面\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n    )\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e withEnvironment(Demo01);\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后将基础组件渲染出来即可查看到效果。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ src\/index.js\nimport React from \x27react\x27;\nimport { render } from \x27react-dom\x27;\nimport Demo01 from \x27.\/pages\/Demo01\x27;\n\nconst root = document.querySelector(\x27#root\x27);\nrender(\x3cDemo01 \/\x3e, root);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ src\/index.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { render } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react-dom\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Demo01 \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/pages\/Demo01\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e root = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27#root\x27\x3c\/span\x3e);\nrender(\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eDemo01\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e, root);\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在上面这个例子中，我们将环境判断的逻辑放在了高阶组件中处理，以后只要需要判断环境的页面只需要在基础组件中这样执行即可。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export default withEnvironment(Demo01);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haskell\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e withEnvironment(\x3cspan class=\x22hljs-type\x22\x3eDemo01\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e除此之外，我们在实际开发中还会遇到一个非常常见的需求，那就是在进入一个页面时需要判断登录状态，登录状态与非登录状态的不同显示，登录状态之后角色的不同显示都可以通过高阶组件统一来处理这个逻辑，然后将登录状态，角色信息等传递给基础组件。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 大概的处理逻辑\nimport React from \x27react\x27;\nimport $ from \x27jquery\x27;\n\n\/\/ 假设已经封装了一个叫做getCookie的方法获取cookie\nimport { getCookie } from \x27cookie\x27;\n\nfunction withRule(BasicComponent) {\n\n    return class C extends React.Component {\n        state = {\n            islogin: false,\n            rule: -1,\n            loading: true,\n            error: null\n        }\n\n        componentDidMount() {\n            \/\/ 如果能直接在cookie中找到uid，说明已经登录过并保存了相关信息\n            if (getCookie(\x27uid\x27)) {\n                this.setState({\n                    islogin: true,\n                    rule: getCookie(\x27rule\x27) || 0,\n                    loading: false\n                })\n            } else {\n                \/\/ 如果找不到uid，则尝试自动登录，先从kookie中查找是否保存了登录账号与密码\n                const userinfo = getCookie(\x27userinfo\x27);\n                if (userinfo) {\n                    \/\/ 调用登录接口\n                    $.post(\x27\/api\/login\x27, {\n                        username: userinfo.username,\n                        password: userinfo.password\n                    }).then(resp =\x3e {\n                        this.setState({\n                            islogin: true,\n                            rule: resp.rule,\n                            islogin: false\n                        })\n                    }).catch(err =\x3e this.setState({ error: err.message }))\n                } else {\n                    \/\/ 当无法自动登录时，你可以选择在这里弹出登录框，或者直接显示未登录页面的样式等都可以\n                }\n            }\n        }\n\n        render() {\n            const { islogin, rule, loading, error } = this.state;\n\n            if (error) {\n                return (\n                    \x3cdiv\x3e登录接口请求失败！错误信息为：{error}\x3c\/div\x3e\n                )\n            }\n\n            if (loading) {\n                return (\n                    \x3cdiv\x3e页面加载中, 请稍后...\x3c\/div\x3e\n                )\n            }\n\n            return (\n                \x3cBasicComponent {...props} islogin={islogin} rule={rule} \/\x3e\n            )\n        }\n    }\n}\n\nexport default withRule;\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 大概的处理逻辑\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e $ \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27jquery\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 假设已经封装了一个叫做getCookie的方法获取cookie\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { getCookie } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27cookie\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ewithRule\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eBasicComponent\x3c\/span\x3e) \x3c\/span\x3e{\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eC\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n        state = {\n            \x3cspan class=\x22hljs-attr\x22\x3eislogin\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3erule\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eloading\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eerror\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n        }\n\n        componentDidMount() {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果能直接在cookie中找到uid，说明已经登录过并保存了相关信息\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (getCookie(\x3cspan class=\x22hljs-string\x22\x3e\x27uid\x27\x3c\/span\x3e)) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n                    \x3cspan class=\x22hljs-attr\x22\x3eislogin\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n                    \x3cspan class=\x22hljs-attr\x22\x3erule\x3c\/span\x3e: getCookie(\x3cspan class=\x22hljs-string\x22\x3e\x27rule\x27\x3c\/span\x3e) || \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n                    \x3cspan class=\x22hljs-attr\x22\x3eloading\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n                })\n            } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果找不到uid，则尝试自动登录，先从kookie中查找是否保存了登录账号与密码\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e userinfo = getCookie(\x3cspan class=\x22hljs-string\x22\x3e\x27userinfo\x27\x3c\/span\x3e);\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (userinfo) {\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调用登录接口\x3c\/span\x3e\n                    $.post(\x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/login\x27\x3c\/span\x3e, {\n                        \x3cspan class=\x22hljs-attr\x22\x3eusername\x3c\/span\x3e: userinfo.username,\n                        \x3cspan class=\x22hljs-attr\x22\x3epassword\x3c\/span\x3e: userinfo.password\n                    }).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eresp\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n                        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n                            \x3cspan class=\x22hljs-attr\x22\x3eislogin\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n                            \x3cspan class=\x22hljs-attr\x22\x3erule\x3c\/span\x3e: resp.rule,\n                            \x3cspan class=\x22hljs-attr\x22\x3eislogin\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n                        })\n                    }).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({ \x3cspan class=\x22hljs-attr\x22\x3eerror\x3c\/span\x3e: err.message }))\n                } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 当无法自动登录时，你可以选择在这里弹出登录框，或者直接显示未登录页面的样式等都可以\x3c\/span\x3e\n                }\n            }\n        }\n\n        render() {\n            \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e { islogin, rule, loading, error } = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state;\n\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (error) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n                    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e登录接口请求失败！错误信息为：{error}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n                )\n            }\n\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (loading) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n                    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e页面加载中, 请稍后...\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n                )\n            }\n\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n                \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eBasicComponent\x3c\/span\x3e {\x3cspan class=\x22hljs-attr\x22\x3e...props\x3c\/span\x3e} \x3cspan class=\x22hljs-attr\x22\x3eislogin\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{islogin}\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erule\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{rule}\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n            )\n        }\n    }\n}\n\nexport default withRule;\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e与第一个例子相比，这个例子更加接近实际应用并且逻辑也更更加复杂。因此涉及到了异步数据，因此最好的方式是在中间组件的\x3ccode\x3ecomponentDidMount\x3c\/code\x3e中来处理逻辑。并在\x3ccode\x3erender\x3c\/code\x3e中根据不同的状态决定不同的渲染结果。\x3c\/p\x3e\n\x3cp\x3e我们需要根据实际情况合理的使用react创建组件的两种方式。这一点至关重要。上面两个例子个人认为还是比较典型的能代表大多数情况。\x3c\/p\x3e\n\x3ch4\x3ereact-router中的高阶组件\x3c\/h4\x3e\n\x3cp\x3e我们在学习react的过程中，会逐渐的与高阶组件打交道，\x3ccode\x3ereact-router 中的 withRouter\x3c\/code\x3e应该算是会最早接触到的高阶组件。我们在使用的时候就知道，通过\x3ccode\x3ewithRouter\x3c\/code\x3e包装的组件，我们可以在props中访问到\x3ccode\x3elocation, router\x3c\/code\x3e等对象，这正是\x3ccode\x3ewithRouter\x3c\/code\x3e通过高阶组件的方式传递过来的。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import React, { Component } from \x27react\x27;\nimport { withRouter } from \x27react-router\x27;\n\nclass Home extends Component {\n    componentDidMount() {\n        const { router } = this.props;\n\n        router.push(\x27\/\x27);\n    }\n    render() {\n        return (\n            \x3cdiv className=\x26quot;my-home\x26quot;\x3e...\x3c\/div\x3e\n        )\n    }\n}\nexport default withRouter(Home);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React, { Component } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { withRouter } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react-router\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eHome\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n    componentDidMount() {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e { router } = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n\n        router.push(\x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e);\n    }\n    render() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n            \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22my-home\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e...\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n        )\n    }\n}\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e withRouter(Home);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们可以来看看在\x3ccode\x3ereact-router v4\x3c\/code\x3e中\x3ccode\x3ewithRouter\x3c\/code\x3e的源码。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import React from \x27react\x27;\nimport PropTypes from \x27prop-types\x27;\nimport hoistStatics from \x27hoist-non-react-statics\x27;\nimport Route from \x27.\/Route\x27;\n\n\/\/ 传入基础组件作为参数\nconst withRouter = (Component) =\x3e {\n\n    \/\/ 创建中间组件\n    const C = (props) =\x3e {\n        const { wrappedComponentRef, ...remainingProps } = props;\n        return (\n            \x3cRoute render={routeComponentProps =\x3e (\n                \/\/ wrappedComponentRef 用来解决高阶组件无法正确获取到ref的问题\n                \x3cComponent {...remainingProps} {...routeComponentProps} ref={wrappedComponentRef}\/\x3e\n            )}\/\x3e\n        )\n    }\n\n    C.displayName = `withRouter(${Component.displayName || Component.name})`;\n    C.WrappedComponent = Component;\n    C.propTypes = {\n        wrappedComponentRef: PropTypes.func\n    }\n\n    \/\/ hoistStatics类似于Object.assign，用于解决基础组件因为高阶组件的包裹而丢失静态方法的问题\n    return hoistStatics(C, Component);\n}\n\nexport default withRouter;\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e PropTypes \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27prop-types\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e hoistStatics \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27hoist-non-react-statics\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Route \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/Route\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 传入基础组件作为参数\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e withRouter = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eComponent\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建中间组件\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e C = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eprops\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e { wrappedComponentRef, ...remainingProps } = props;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n            \x26lt;Route render={routeComponentProps =\x26gt; (\n                \/\/ wrappedComponentRef 用来解决高阶组件无法正确获取到ref的问题\n                \x26lt;Component {...remainingProps} {...routeComponentProps} ref={wrappedComponentRef}\/\x26gt;\n            )}\/\x26gt;\n        )\n    }\n\n    C.displayName = `withRouter(${Component.displayName || Component.name})`;\n    C.WrappedComponent = Component;\n    C.propTypes = {\n        wrappedComponentRef: PropTypes.func\n    }\n\n    \/\/ hoistStatics类似于Object.assign，用于解决基础组件因为高阶组件的包裹而丢失静态方法的问题\n    return hoistStatics(C, Component);\n}\n\nexport default withRouter;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果对于高阶组件的例子你已经熟知，那么\x3ccode\x3ewithRouter\x3c\/code\x3e的源码其实很容易理解。它做所的工作就仅仅只是把\x3ccode\x3erouteComponentProps\x3c\/code\x3e传入基础组件而已。\x3c\/p\x3e\n\x3cp\x3e另外还需要注意点是在该源码中，解决了两个因为高阶组件带来的问题，一个是经过高阶组件包裹的组件在使用时无法通过ref正确获取到对应的值。二是基础组件的静态方法也会因为高阶组件的包裹会丢失。不过好在这段源码已经给我们提供了对应的解决方案。因此如果我们在使用中需要处理这2点的话，按照这里的方式来做就可以了。\x3c\/p\x3e\n\x3cp\x3e但是通常情况下，我们也很少会在自定义的组件中添加静态方法和使用ref。如果在开发中确实遇到了必须使用它们，就一定要注意高阶组件的这2个问题并认真解决。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV0emY?w=800\x26amp;h=300\x22 src=\x22https:\/\/static.alili.tech\/img\/bV0emY?w=800\x26amp;h=300\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>react进阶系列：高阶组件详解（二）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009948787">https://segmentfault.com/a/1190000009948787</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/8e1l5a5tyto/" target="_blank">https://alili.tech/archive/8e1l5a5tyto/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>