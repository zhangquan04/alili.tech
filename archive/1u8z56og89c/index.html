<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="如何瘦身 Git 仓库"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>如何瘦身 Git 仓库 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/1u8z56og89c/",
				"appid": "1613049289050283", 
				"title": "如何瘦身 Git 仓库 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-23T02:30:08"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/f6srmoktrzj/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/ad4vdiawsus/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f1u8z56og89c%2f&text=%e5%a6%82%e4%bd%95%e7%98%a6%e8%ba%ab%20Git%20%e4%bb%93%e5%ba%93"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f1u8z56og89c%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f1u8z56og89c%2f&text=%e5%a6%82%e4%bd%95%e7%98%a6%e8%ba%ab%20Git%20%e4%bb%93%e5%ba%93"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f1u8z56og89c%2f&title=%e5%a6%82%e4%bd%95%e7%98%a6%e8%ba%ab%20Git%20%e4%bb%93%e5%ba%93"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f1u8z56og89c%2f&is_video=false&description=%e5%a6%82%e4%bd%95%e7%98%a6%e8%ba%ab%20Git%20%e4%bb%93%e5%ba%93"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%a6%82%e4%bd%95%e7%98%a6%e8%ba%ab%20Git%20%e4%bb%93%e5%ba%93&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f1u8z56og89c%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f1u8z56og89c%2f&title=%e5%a6%82%e4%bd%95%e7%98%a6%e8%ba%ab%20Git%20%e4%bb%93%e5%ba%93"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1u8z56og89c%2f&title=%e5%a6%82%e4%bd%95%e7%98%a6%e8%ba%ab%20Git%20%e4%bb%93%e5%ba%93"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1u8z56og89c%2f&title=%e5%a6%82%e4%bd%95%e7%98%a6%e8%ba%ab%20Git%20%e4%bb%93%e5%ba%93"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1u8z56og89c%2f&title=%e5%a6%82%e4%bd%95%e7%98%a6%e8%ba%ab%20Git%20%e4%bb%93%e5%ba%93"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">如何瘦身 Git 仓库</h1><div class="meta"><div class="postdate"><time datetime="2019-01-23" itemprop="datePublished">2019-01-23</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3ch1\x3e\x3ca href=\x22#如何瘦身-git-仓库\x22\x3e\x3c\/a\x3e如何瘦身 Git 仓库\x3c\/h1\x3e\n\x3cp\x3e对 Git 仓库的维护通常是为了减少仓库的大小。如果你从另外一个版本控制系统导入了一个仓库，你可能需要在导入后清除掉不必要的文件。本文着重于从一个 Git 仓库中删除大文件，并且包含下列主题：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e理解从 Git 的历史记录中删除文件\x3c\/li\x3e\n\x3cli\x3e使用 BFG 重写历史记录\x3c\/li\x3e\n\x3cli\x3e可选，使用 \x3ccode\x3egit filter-branch\x3c\/code\x3e 重写历史记录\x3c\/li\x3e\n\x3cli\x3e垃圾回收\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e\n\x3cp\x3e\x3cstrong\x3e请格外小心.....\x3c\/strong\x3e\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cblockquote\x3e\n\x3cp\x3e本文中的步骤和工具使用的高级技术涉及破坏性操作。确保您在开始之前仔细读过并\x3cstrong\x3e备份了你的仓库\x3c\/strong\x3e，创建一个备份最容易的方式是使用 \x3ca href=\x22http:\/\/stackoverflow.com\/questions\/3959924\/whats-the-difference-between-git-clone-mirror-and-git-clone-bare\x22\x3e--mirror\x3c\/a\x3e 标志对你的仓库克隆，然后对整个克隆的文件进行打包压缩。有了这个备份，如果在维护期间意外损坏了您的仓库的关键元素，那么你可以通过备份的仓库来恢复。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cblockquote\x3e\n\x3cp\x3e请记住，仓库维护对仓库的用户可能会是毁灭性的。与你的团队或者仓库的关注者进行沟通会是一个不错的主意。确保每个人都已经检查了他们的代码，并且同意在仓库维护期间停止开发。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch3\x3e\x3ca href=\x22#理解从-git-的历史记录中删除文件\x22\x3e\x3c\/a\x3e理解从 Git 的历史记录中删除文件\x3c\/h3\x3e\n\x3cp\x3e回想一下，克隆仓库会克隆整个历史记录——包括每个源代码文件的所有版本。如果一个用户提交了一个较大的文件，比如一个 JAR，则随后的每次克隆都会包含这个文件。即使用户最终在后面的某次提交中删除了这个文件，但是这个文件仍然存在于这个仓库的历史记录中。要想完全的从你的仓库中删除这个文件，你必须：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e从你的项目的\x3cem\x3e当前的\x3c\/em\x3e文件树中删除该文件;\x3c\/li\x3e\n\x3cli\x3e从仓库的历史记录中删除文件——_重写_ Git 历史记录，从包含该文件的\x3cem\x3e所有的\x3c\/em\x3e提交中删除这个文件;\x3c\/li\x3e\n\x3cli\x3e删除指向_旧的_提交历史记录的所有 \x3ca href=\x22http:\/\/git-scm.com\/docs\/git-reflog\x22\x3ereflog\x3c\/a\x3e 历史记录;\x3c\/li\x3e\n\x3cli\x3e重新整理仓库，使用 \x3ca href=\x22http:\/\/git-scm.com\/docs\/git-gc\x22\x3egit gc\x3c\/a\x3e 对现在没有使用的数据进行垃圾回收。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3eGit 的 “gc”（垃圾回收）将通过你的任何一个分支或者标签来删除仓库中所有的实际没用的或者以某种方式引用的数据。为了使其发挥作用，我们需要重写包含不需要的文件的所有 Git 仓库历史记录，仓库将不再引用它—— git gc 将会丢弃所有没用的数据。\x3c\/p\x3e\n\x3cp\x3e重写存储库历史是一个棘手的事情，因为每个提交都依赖它的父提交，所以任何一个很小的改变都会改变它的每一个随后的提交的提交 ID。有两个自动化的工具可以做到这：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/rtyley.github.io\/bfg-repo-cleaner\/\x22\x3eBFG Repo Cleaner\x3c\/a\x3e 快速、简单且易于使用，需要 Java 6 或者更高版本的运行环境。\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/git-scm.com\/docs\/git-filter-branch\x22\x3egit filter-branch\x3c\/a\x3e 功能强大、配置麻烦，用于大于仓库时速度较慢，是核心 Git 套件的一部分。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e切记，当你重写历史记录后，无论你是使用 BFG 还是使用 filter-branch，你都需要删除指向旧的历史记录的 \x3ccode\x3ereflog\x3c\/code\x3e 条目，最后运行垃圾回收器来删除旧的数据。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#使用-bfg-重写历史记录\x22\x3e\x3c\/a\x3e使用 BFG 重写历史记录\x3c\/h3\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/rtyley.github.io\/bfg-repo-cleaner\/\x22\x3eBFG\x3c\/a\x3e 是为将像大文件或者密码这些不想要的数据从 Git 仓库中删除而专门设计的，所以它有一一个简单的标志用来删除那些大的历史文件（不在当前的提交里面）：\x3ccode\x3e--strip-blobs-bigger-than\x3c\/code\x3e\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs mipsasm\x22\x3e$ \x3cspan class=\x22hljs-keyword\x22\x3ejava \x3c\/span\x3e-\x3cspan class=\x22hljs-keyword\x22\x3ejar \x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ebfg.jar \x3c\/span\x3e--strip-\x3cspan class=\x22hljs-keyword\x22\x3eblobs-than \x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3eM\n\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e大小超过 100MB 的任何文件（不包含在你\x3cem\x3e最近的\x3c\/em\x3e提交中的文件——因为 BFG \x3ca href=\x22http:\/\/rtyley.github.io\/bfg-repo-cleaner\/#protected-commits\x22\x3e默认会保护你的最新提交的内容\x3c\/a\x3e）将会从你的 Git 仓库的历史记录中删除。如果你想用名字来指明具体的文件，你也可以这样做：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3e$ java -jar bfg\x3cspan class=\x22hljs-selector-class\x22\x3e.jar\x3c\/span\x3e --delete-files *\x3cspan class=\x22hljs-selector-class\x22\x3e.mp4\x3c\/span\x3e\n\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3eBFG 的速度要比 \x3ccode\x3egit filter-branch\x3c\/code\x3e 快 \x3ca href=\x22https:\/\/www.youtube.com\/watch?v=Ir4IHzPhJuI\x22\x3e10-1000 倍\x3c\/a\x3e，而且通常更容易使用——查看完整的\x3ca href=\x22http:\/\/rtyley.github.io\/bfg-repo-cleaner\/#usage\x22\x3e使用说明\x3c\/a\x3e和\x3ca href=\x22http:\/\/rtyley.github.io\/bfg-repo-cleaner\/#examples\x22\x3e示例\x3c\/a\x3e获取更多细节。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#或者使用-git-filter-branch-来重写历史记录\x22\x3e\x3c\/a\x3e或者，使用 git filter-branch 来重写历史记录\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3efilter-branch\x3c\/code\x3e 命令可以对 Git 仓库的历史记录重写，就像 BFG 一样，但是过程更慢和更手动化。如果你不知道这些大文件在_哪里_，那么你第一步就需要找到它们：\x3c\/p\x3e\n\x3ch4\x3e\x3ca href=\x22#手动查看你-git-仓库中的大文件\x22\x3e\x3c\/a\x3e手动查看你 Git 仓库中的大文件\x3c\/h4\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/stubbisms.wordpress.com\/2009\/07\/10\/git-script-to-show-largest-pack-objects-and-trim-your-waist-line\/\x22\x3eAntony Stubbs\x3c\/a\x3e 写了一个可以很好地完成这个功能的 BASH 脚本。该脚本可以检查你的包文件的内容并列出大文件。在你开始删除文件之前，请执行以下操作获取并安装此脚本：\x3c\/p\x3e\n\x3cp\x3e1、 \x3ca href=\x22https:\/\/confluence.atlassian.com\/bitbucket\/files\/321848291\/321979854\/1\/1360604134990\/git_find_big.sh\x22\x3e下载脚本\x3c\/a\x3e到你的本地的系统。\x3c\/p\x3e\n\x3cp\x3e2、 将它放在一个可以访问你的 Git 仓库的易于找到的位置。\x3c\/p\x3e\n\x3cp\x3e3、 让脚本成为可执行文件：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs shell\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e$\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e chmod 777 git_find_big.sh\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e4、 克隆仓库到你本地系统。\x3c\/p\x3e\n\x3cp\x3e5、 改变当前目录到你的仓库根目录。\x3c\/p\x3e\n\x3cp\x3e6、 手动运行 Git 垃圾回收器：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs ada\x22\x3egit gc \x3cspan class=\x22hljs-comment\x22\x3e--auto\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e7、 找出 .git 文件夹的大小\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs jboss-cli\x22\x3e$ du -hs \x3cspan class=\x22hljs-string\x22\x3e.git\/objects\x3c\/span\x3e\n45M \x3cspan class=\x22hljs-string\x22\x3e.git\/objects\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e注意文件大小，以便随后参考。\x3c\/p\x3e\n\x3cp\x3e8、 运行 \x3ccode\x3egit_find_big.sh\x3c\/code\x3e 脚本来列出你的仓库中的大文件。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs 1c\x22\x3e$ git_find_big.sh \nAll sizes are in kB\x27s. The pack column is the size of the object, compressed, inside the pack file.\nsize  pack  SHA                                       location\n592   580   e\x3cspan class=\x22hljs-number\x22\x3e3117\x3c\/span\x3ef48bc305dd1f5ae0df\x3cspan class=\x22hljs-number\x22\x3e3419\x3c\/span\x3ea0ce2d\x3cspan class=\x22hljs-number\x22\x3e961733\x3c\/span\x3e6  media\/img\/emojis.jar\n550   169   b594a7f59ba7ba9daebb\x3cspan class=\x22hljs-number\x22\x3e2044\x3c\/span\x3e7a87ea\x3cspan class=\x22hljs-number\x22\x3e435787\x3c\/span\x3e4f43  media\/js\/aui\/aui-dependencies.jar\n518   514   22f7f9a\x3cspan class=\x22hljs-number\x22\x3e8490\x3c\/span\x3e5aaec019dae9ea\x3cspan class=\x22hljs-number\x22\x3e1279\x3c\/span\x3ea\x3cspan class=\x22hljs-number\x22\x3e9450277130\x3c\/span\x3e  media\/images\/screenshots\/issue-tracker-wiki.jar\n337   92    1fd8ac97c9fecf74ba\x3cspan class=\x22hljs-number\x22\x3e6246\x3c\/span\x3eeacef\x3cspan class=\x22hljs-number\x22\x3e8288\x3c\/span\x3ee89b4bff5  media\/js\/lib\/bundle.js\n240   239   e0c26d\x3cspan class=\x22hljs-number\x22\x3e9959\x3c\/span\x3ebd583e5ef32b\x3cspan class=\x22hljs-number\x22\x3e6206\x3c\/span\x3efc8abe5fea\x3cspan class=\x22hljs-number\x22\x3e8624\x3c\/span\x3e  media\/img\/featuretour\/heroshot.png\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e大文件都是 JAR 文件，包的大小列是最相关的。\x3ccode\x3eaui-dependencies.jar\x3c\/code\x3e 被压缩到 169kb，但是 \x3ccode\x3eemojis.jar\x3c\/code\x3e 只压缩到 500kb。\x3ccode\x3eemojis.jar\x3c\/code\x3e 就是一个待删除的对象。\x3c\/p\x3e\n\x3ch4\x3e\x3ca href=\x22#运行-filter-branch\x22\x3e\x3c\/a\x3e运行 filter-branch\x3c\/h4\x3e\n\x3cp\x3e你可以给这个命令传递一个用于重写 Git 索引的过滤器。例如，一个过滤器可以可以将每个检索的提交删除。这个用法如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs vim\x22\x3egit \x3cspan class=\x22hljs-built_in\x22\x3efilter\x3c\/span\x3e-branch --\x3cspan class=\x22hljs-built_in\x22\x3eindex\x3c\/span\x3e-\x3cspan class=\x22hljs-built_in\x22\x3efilter\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27git rm --cached --ignore-unmatch  _pathname_ \x27\x3c\/span\x3e commitHASH\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3ccode\x3e--index-filter\x3c\/code\x3e 选项可以修改仓库的索引，\x3ccode\x3e--cached\x3c\/code\x3e 选项从索引中而不是磁盘来删除文件。这样会更快，因为你不需要在运行这个过滤器前检查每个修订版本。\x3ccode\x3egit rm\x3c\/code\x3e 中的 \x3ccode\x3eignore-unmatch\x3c\/code\x3e 选项可以防止在尝试移走不存在的文件 \x3ccode\x3epathname\x3c\/code\x3e 的时候命令失败。通过指定一个提交 HASH 值，你可以从每个以这个 HASH 值开始的提交中删除\x3ccode\x3epathname\x3c\/code\x3e。要从开始处删除，你可以省略这个参数或者指定为 \x3ccode\x3eHEAD\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e如果你的大文件在不同的分支，你将需要通过名字来删除每个文件。如果大文件都在一个单独的分支，你可以直接删除这个分支本身。\x3c\/p\x3e\n\x3ch4\x3e\x3ca href=\x22#选项-1通过文件名删除文件\x22\x3e\x3c\/a\x3e选项 1：通过文件名删除文件\x3c\/h4\x3e\n\x3cp\x3e使用下面的步骤来删除大文件：\x3c\/p\x3e\n\x3cp\x3e1、 使用下面的命令来删除你找到的第一个大文件：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs vim\x22\x3egit \x3cspan class=\x22hljs-built_in\x22\x3efilter\x3c\/span\x3e-branch --\x3cspan class=\x22hljs-built_in\x22\x3eindex\x3c\/span\x3e-\x3cspan class=\x22hljs-built_in\x22\x3efilter\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27git rm --cached --ignore-unmatch filename\x27\x3c\/span\x3e HEAD\n\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e2、 重复步骤 1 找到剩下的每个大文件。\x3c\/p\x3e\n\x3cp\x3e3、 在你的仓库里更新引用。 \x3ccode\x3efilter-branch\x3c\/code\x3e 会为你原先的引用创建一个 \x3ccode\x3erefs\/original\/\x3c\/code\x3e 下的备份。一旦你确信已经删除了正确的文件，你可以运行下面的命令来删除备份文件，同时可以让垃圾回收器回收大的对象：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs vim\x22\x3egit \x3cspan class=\x22hljs-built_in\x22\x3efilter\x3c\/span\x3e-branch --\x3cspan class=\x22hljs-built_in\x22\x3eindex\x3c\/span\x3e-\x3cspan class=\x22hljs-built_in\x22\x3efilter\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27git rm --cached --ignore-unmatch filename\x27\x3c\/span\x3e HEAD\n\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch4\x3e\x3ca href=\x22#选项-2直接删除分支\x22\x3e\x3c\/a\x3e选项 2：直接删除分支\x3c\/h4\x3e\n\x3cp\x3e如果你所有的大文件都在一个单独的分支上，你可以直接删除这个分支。删除这个分支会自动删除所有的引用。\x3c\/p\x3e\n\x3cp\x3e1、 删除分支。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs shell\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e$\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e git branch -D PROJ567bugfix\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e2、 从后面的分支中删除所有的 reflog 引用。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#对不用的数据垃圾回收\x22\x3e\x3c\/a\x3e对不用的数据垃圾回收\x3c\/h3\x3e\n\x3cp\x3e1、 删除从现在到后面的所有 reflog 引用（除非你明确地只在一个分支上操作）。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e$\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3egit\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3ereflog\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3eexpire\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eexpire=now\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eall\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e2、 通过运行垃圾回收器和删除旧的对象重新打包仓库。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3e$ git gc \x3cspan class=\x22hljs-attribute\x22\x3e--prune\x3c\/span\x3e=now\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e3、 把你所有的修改推送回仓库。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e$\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3egit\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3epush\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eall\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eforce\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e4、 确保你所有的标签也是当前最新的:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e$\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3egit\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3epush\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3etags\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eforce\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3chr\x3e\n\x3cp\x3evia: \x3ca href=\x22https:\/\/confluence.atlassian.com\/bitbucket\/maintaining-a-git-repository-321848291.html\x22\x3ehttps:\/\/confluence.atlassian.com\/bitbucket\/maintaining-a-git-repository-321848291.html\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e作者：\x3ca href=\x22https:\/\/confluence.atlassian.com\/bitbucket\/maintaining-a-git-repository-321848291.html\x22\x3eatlassian.com\x3c\/a\x3e 译者：\x3ca href=\x22https:\/\/github.com\/zhousiyu325\x22\x3ezhousiyu325\x3c\/a\x3e 校对：\x3ca href=\x22https:\/\/github.com\/wxy\x22\x3ewxy\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e本文由 \x3ca href=\x22https:\/\/github.com\/LCTT\/TranslateProject\x22\x3eLCTT\x3c\/a\x3e 原创编译，\x3ca href=\x22https:\/\/linux.cn\/\x22\x3eLinux中国\x3c\/a\x3e 荣誉推出\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>如何瘦身 Git 仓库</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/maintaining-a-git-repository">https://www.zcfy.cc/article/maintaining-a-git-repository</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/1u8z56og89c/" target="_blank">https://alili.tech/archive/1u8z56og89c/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>