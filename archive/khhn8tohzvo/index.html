<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Web前端模板引擎の字符串模板"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Web前端模板引擎の字符串模板 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/khhn8tohzvo/",
				"appid": "1613049289050283", 
				"title": "Web前端模板引擎の字符串模板 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-07T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/flpr76t41b6/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/9czy0g8zgnn/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fkhhn8tohzvo%2f&text=Web%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e5%bc%95%e6%93%8e%e3%81%ae%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%a8%a1%e6%9d%bf"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fkhhn8tohzvo%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fkhhn8tohzvo%2f&text=Web%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e5%bc%95%e6%93%8e%e3%81%ae%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%a8%a1%e6%9d%bf"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fkhhn8tohzvo%2f&title=Web%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e5%bc%95%e6%93%8e%e3%81%ae%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%a8%a1%e6%9d%bf"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fkhhn8tohzvo%2f&is_video=false&description=Web%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e5%bc%95%e6%93%8e%e3%81%ae%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%a8%a1%e6%9d%bf"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Web%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e5%bc%95%e6%93%8e%e3%81%ae%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%a8%a1%e6%9d%bf&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fkhhn8tohzvo%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fkhhn8tohzvo%2f&title=Web%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e5%bc%95%e6%93%8e%e3%81%ae%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%a8%a1%e6%9d%bf"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkhhn8tohzvo%2f&title=Web%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e5%bc%95%e6%93%8e%e3%81%ae%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%a8%a1%e6%9d%bf"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkhhn8tohzvo%2f&title=Web%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e5%bc%95%e6%93%8e%e3%81%ae%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%a8%a1%e6%9d%bf"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkhhn8tohzvo%2f&title=Web%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e5%bc%95%e6%93%8e%e3%81%ae%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%a8%a1%e6%9d%bf"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Web前端模板引擎の字符串模板</h1><div class="meta"><div class="postdate"><time datetime="2019-01-07" itemprop="datePublished">2019-01-07</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e这是一个系列文章，将会介绍目前Web前端领域里用到的三种模板引擎技术，它们分别是：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e基于字符串的模板\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e基于Dom操作的模板\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e基于虚拟Dom的模板\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e本文是这个系列的第一篇，着重介绍基于字符串的模板引擎的实现原理，分析它的优点缺点以及使用的场景。\x3c\/p\x3e\n\x3cp\x3e进入正文之前，我们先回顾一下在模板引擎出现之前，暂且称之为“石器时代”，我们是如何利用JS改变页面结构的。对于下面的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv id=\x26quot;container\x26quot;\x3e\n    我们正处于刀耕火种的石器时代\n\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22HTML\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22container\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    我们正处于刀耕火种的石器时代\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果我们需要修改container里面的内容，一般有2种方法：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e通过JS的\x3ccode\x3eDOM API\x3c\/code\x3e直接操作DOM\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    var newTxt = \x27石器时代需要自己撸工具，摩擦摩擦，似魔鬼的步伐...\x27;\n    var container = document.getElementById(\x27container\x27);\n    var desc = document.createElement(\x27H1\x27);\n    var txt = document.createTextNode(newTxt);\n    desc.appendChild(txt);\n    container.replaceChild(desc, container.childNodes[0]);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e newTxt = \x3cspan class=\x22hljs-string\x22\x3e\x27石器时代需要自己撸工具，摩擦摩擦，似魔鬼的步伐...\x27\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e container = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27container\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e desc = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27H1\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e txt = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createTextNode(newTxt);\n    desc.appendChild(txt);\n    container.replaceChild(desc, container.childNodes[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e通过\x3ccode\x3einnerHTML\x3c\/code\x3e批量修改DOM结构\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    var newTxt = \x27石器时代需要自己撸工具，摩擦摩擦，似魔鬼的步伐...\x27;\n    var template = \x27\x3cH1\x3e\x27 \x2b newTxt \x2b \x27\x3c\/H1\x3e\x27;\n    var container = document.getElementById(\x27container\x27);\n    container.innerHTML=template;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e newTxt = \x3cspan class=\x22hljs-string\x22\x3e\x27石器时代需要自己撸工具，摩擦摩擦，似魔鬼的步伐...\x27\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e template = \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;H1\x26gt;\x27\x3c\/span\x3e \x2b newTxt \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/H1\x26gt;\x27\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e container = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27container\x27\x3c\/span\x3e);\n    container.innerHTML=template;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e相比之下，第二种方式通过innerHTML更新DOM要简单许多，它无需考虑DOM的层级结构，只要做简单的字符串拼接就能实现需求。但这种方式的问题是代码可读性很差，同时开发者还必须保证最终拼接的字符串的正确性。当需要作出修改时，面对一坨的字符也很痛苦。\x3c\/p\x3e\n\x3cp\x3e在上面的例子中，我们的需求是将一个变量注入到模板当中，类似ES6的模板字符串：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var newTxt = \x27石器时代需要自己撸工具，摩擦摩擦，似魔鬼的步伐...\x27;\nvar template = `\x3cH1\x3e${newTxt}\x3c\/H1\x3e`;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e newTxt = \x3cspan class=\x22hljs-string\x22\x3e\x27石器时代需要自己撸工具，摩擦摩擦，似魔鬼的步伐...\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e template = \x3cspan class=\x22hljs-string\x22\x3e`\x26lt;H1\x26gt;\x3cspan class=\x22hljs-subst\x22\x3e${newTxt}\x3c\/span\x3e\x26lt;\/H1\x26gt;`\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e但ES6这种现代化的常规武器，对石器时代而言是天方夜谭。部落里的老司机凭借深厚的JS功底，撸出了各种基于字符串的模板。这些模板又可以细分为2类：一种是不包含逻辑处理，只作数据绑定用的，如\x3ca href=\x22https:\/\/github.com\/janl\/mustache.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emustache.js\x3c\/a\x3e；另一种是既有逻辑处理，也有数据绑定的，如\x3ca href=\x22http:\/\/www.embeddedjs.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eEJS\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e下面，我以EJS的语法为例，实现一个简单的字符串模板引擎。模版引擎的编译流程如下：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010313800\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010313800\x22 alt=\x22字符串模板编译过程\x22 title=\x22字符串模板编译过程\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e1.首先，需要编译模板字符串，将其转换为JS能够理解的语法。第一步是利用正则表达式，区分出字符串中哪些是模板语法，哪些是正常的HTML标签。以下是一个EJS语法的例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cul\x3e\n    \x3c% for(var i=0; i\x3csupplies.length; i\x2b\x2b) {%\x3e\n        \x3cli\x3e\x3c%= supplies[i] %\x3e\x3c\/li\x3e\n    \x3c% } %\x3e\n\x3c\/ul\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x26lt;ul\x26gt;\n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3e%\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-attr\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ei\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e0;\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ei\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-attr\x22\x3esupplies.length\x3c\/span\x3e; \x3cspan class=\x22hljs-attr\x22\x3ei\x3c\/span\x3e\x2b\x2b) {%\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3e%=\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esupplies\x3c\/span\x3e[\x3cspan class=\x22hljs-attr\x22\x3ei\x3c\/span\x3e] %\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3e%\x3c\/span\x3e } %\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在‘\x26lt;%=’和‘%\x26gt;’之间是JS的表达式，而在‘\x26lt;%’和’%\x26gt;‘之间是普通的JS语句，可以进行逻辑判断和条件循环等操作。可以使用以下正则表达式抽取：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 匹配表达式，只能有一行\nlet evalExpr = \/\\\x3c\\%\\=(.\x2b?)\\%\\\x3e\/g;\n\n\/\/ 匹配语句，可以有多行\nlet expr = \/\\\x3c\\%([\\s\\S]\x2b?)\\%\\\x3e\/g;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 匹配表达式，只能有一行\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e evalExpr = \x3cspan class=\x22hljs-regexp\x22\x3e\/\\\x26lt;\\%\\=(.\x2b?)\\%\\\x26gt;\/g\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 匹配语句，可以有多行\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e expr = \x3cspan class=\x22hljs-regexp\x22\x3e\/\\\x26lt;\\%([\\s\\S]\x2b?)\\%\\\x26gt;\/g\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e对于普通的HTML标签，需要用自定义的echo函数包裹一下，在使用eval函数编译的时候直接输出字符串。echo函数的定义如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 临时变量，保存编译后的模板字符串\nlet output = \x26quot;\x26quot;;\n  \n\/\/ 直接将html字符串拼接到output后面\nfunction echo(html){\n    output \x2b= html;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 临时变量，保存编译后的模板字符串\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e output = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e;\n  \n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 直接将html字符串拼接到output后面\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eecho\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ehtml\x3c\/span\x3e)\x3c\/span\x3e{\n    output \x2b= html;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e完整的compile函数代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function compile(template){\n  \n    \/\/ 匹配表达式，只能有一行\n    let evalExpr = \/\\\x3c\\%\\=(.\x2b?)\\%\\\x3e\/g;\n  \n    \/\/ 匹配语句，可以有多行\n    let expr = \/\\\x3c\\%([\\s\\S]\x2b?)\\%\\\x3e\/g;\n  \n    \/\/ 内容为空的部分\n    let empty = \/echo\\(\\\x26quot;\\\x26quot;\\);\/g;\n  \n    template = template\n        \/\/ 转换JS表达式\n        .replace(evalExpr, \x27`); \\n echo( $1 ); \\n echo(`\x27)\n    \n        \/\/ 转换JS语句\n        .replace(expr, \x27`); \\n $1 \\n echo(`\x27);\n  \n    \/\/ 在模板的最外层包裹一个echo\n    template = \x27echo(`\x27 \x2b template \x2b \x27`);\x27;\n  \n    \/\/ 清除空的echo\n    template = template\n        .replace(empty, \x26quot;\x26quot;);\n  \n    \/\/ 保存编译后的字符串，此处用了ES6的模板字符串特性，相当于eval了一下\n    let script = \n        `(function parse(data){\n  \n            \/\/ 临时变量，保存编译后的模板字符串\n            var output = \x26quot;\x26quot;;\n  \n            \/\/ 直接将html字符串拼接到output后面\n            function echo(html){\n                output \x2b= html;\n            }\n  \n            \/\/ 包含echo的模板字符串\n            ${ template }\n  \n            return output;\n        })`;\n    \n    return script;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecompile\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etemplate\x3c\/span\x3e)\x3c\/span\x3e{\n  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 匹配表达式，只能有一行\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e evalExpr = \x3cspan class=\x22hljs-regexp\x22\x3e\/\\\x26lt;\\%\\=(.\x2b?)\\%\\\x26gt;\/g\x3c\/span\x3e;\n  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 匹配语句，可以有多行\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e expr = \x3cspan class=\x22hljs-regexp\x22\x3e\/\\\x26lt;\\%([\\s\\S]\x2b?)\\%\\\x26gt;\/g\x3c\/span\x3e;\n  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 内容为空的部分\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e empty = \x3cspan class=\x22hljs-regexp\x22\x3e\/echo\\(\\\x22\\\x22\\);\/g\x3c\/span\x3e;\n  \n    template = template\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 转换JS表达式\x3c\/span\x3e\n        .replace(evalExpr, \x3cspan class=\x22hljs-string\x22\x3e\x27`); \\n echo( $1 ); \\n echo(`\x27\x3c\/span\x3e)\n    \n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 转换JS语句\x3c\/span\x3e\n        .replace(expr, \x3cspan class=\x22hljs-string\x22\x3e\x27`); \\n $1 \\n echo(`\x27\x3c\/span\x3e);\n  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在模板的最外层包裹一个echo\x3c\/span\x3e\n    template = \x3cspan class=\x22hljs-string\x22\x3e\x27echo(`\x27\x3c\/span\x3e \x2b template \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27`);\x27\x3c\/span\x3e;\n  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 清除空的echo\x3c\/span\x3e\n    template = template\n        .replace(empty, \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e);\n  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 保存编译后的字符串，此处用了ES6的模板字符串特性，相当于eval了一下\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e script = \n        \x3cspan class=\x22hljs-string\x22\x3e`(function parse(data){\n  \n            \/\/ 临时变量，保存编译后的模板字符串\n            var output = \x22\x22;\n  \n            \/\/ 直接将html字符串拼接到output后面\n            function echo(html){\n                output \x2b= html;\n            }\n  \n            \/\/ 包含echo的模板字符串\n            \x3cspan class=\x22hljs-subst\x22\x3e${ template }\x3c\/span\x3e\n  \n            return output;\n        })`\x3c\/span\x3e;\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e script;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e经过正则表达式处理后，这段代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cul\x3e\n    \x3c% for(var i=0; i\x3csupplies.length; i\x2b\x2b) {%\x3e\n        \x3cli\x3e\x3c%= supplies[i] %\x3e\x3c\/li\x3e\n    \x3c% } %\x3e\n\x3c\/ul\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x26lt;ul\x26gt;\n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3e%\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-attr\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ei\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e0;\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ei\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-attr\x22\x3esupplies.length\x3c\/span\x3e; \x3cspan class=\x22hljs-attr\x22\x3ei\x3c\/span\x3e\x2b\x2b) {%\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3e%=\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esupplies\x3c\/span\x3e[\x3cspan class=\x22hljs-attr\x22\x3ei\x3c\/span\x3e] %\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3e%\x3c\/span\x3e } %\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e会转化为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    echo(`\x3cul\x3e`); \n        for(var i=0; i\x3cdata.supplies.length; i\x2b\x2b) { \n            echo(`\x3cli\x3e`); \n                echo( data.supplies[i] ); \n            echo(`\x3c\/li\x3e`); \n        }  \n    echo(`\x3c\/ul\x3e`);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    echo(\x3cspan class=\x22hljs-string\x22\x3e`\x26lt;ul\x26gt;`\x3c\/span\x3e); \n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i\x26lt;data.supplies.length; i\x2b\x2b) { \n            echo(\x3cspan class=\x22hljs-string\x22\x3e`\x26lt;li\x26gt;`\x3c\/span\x3e); \n                echo( data.supplies[i] ); \n            echo(\x3cspan class=\x22hljs-string\x22\x3e`\x26lt;\/li\x26gt;`\x3c\/span\x3e); \n        }  \n    echo(\x3cspan class=\x22hljs-string\x22\x3e`\x26lt;\/ul\x26gt;`\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e完整代码亦可见\x3ca href=\x22https:\/\/jsfiddle.net\/38c0tmr5\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJSFiddle\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x2238c0tmr5\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3cp\x3e2.第二步，我们将模板中用到的数据\x3ccode\x3edata\x3c\/code\x3e注入到compile函数的parse子函数中，生成最终的字符串。\x3c\/p\x3e\n\x3cp\x3e3.最后，我们再通过innerHTML，把字符串插入到DOM合适的位置。\x3c\/p\x3e\n\x3cp\x3e字符串模板之所以能够更新页面，最核心的原理是使用innerHTML这个api将字符串直接插入到DOM节点中。因此，我们分析字符串模板的优缺点就离不开使用innerHTML更新DOM的优缺点。先谈谈优点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e直观，容易理解。更新后的DOM结构可以一目了然的反映在字符串当中。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e容易维护。当需要更改模板时，直接改相应字符串就可以，新人也容易上手。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e可用于服务端渲染。简单的字符串拼接，不依赖DOM，对应的字符串可由服务器端直接生成。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e再来谈谈缺点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e安全隐患。模板字符串中完全可以出现此类代码：\x26lt;img src=\x2269\x22 onerror=\x22alert(\x27xss\x27)\x22\x26gt;\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e慢！特别对于需要频繁更新的场景。由于innerHTML是直接替换掉原有元素，因此就涉及到相应节点和对应事件的卸载，然后再装载新的节点和事件。在这个过程中，界面也会被重排和重绘，对性能是严重的损耗。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e不智能。当只需要修改模板里面的某一部分数据时，整个模板页都需要被刷新。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e维护困难。这不是打脸嘛，上面才说了容易维护，这里又讲维护困难！？这当然是有原因的嘛。当不需要考虑性能的时候，一个页面可能只需要维护一个模板，这难道不简单？但考虑到性能的时候，就需要对模板进行拆分和拼装，维护这些相互依赖的模板会让人很崩溃。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e综上所述，我们可以很简单的总结出字符串模板引擎的使用场景：如果你的应用比较简单，交互也不多，也希望有一个快速的首屏时间，请使用字符串模板引擎。反之，你硬要上字符串模板引擎的话，我建议你先看看我下一期或者下下一期的文章再做决定，哈哈哈哈～\x3c\/p\x3e\n\x3cp\x3e未完待续...\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Web前端模板引擎の字符串模板</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010313795">https://segmentfault.com/a/1190000010313795</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/khhn8tohzvo/" target="_blank">https://alili.tech/archive/khhn8tohzvo/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>