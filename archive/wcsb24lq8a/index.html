<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="激动人心的 Angular HttpClient"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>激动人心的 Angular HttpClient | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/wcsb24lq8a/",
				"appid": "1613049289050283", 
				"title": "激动人心的 Angular HttpClient | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-09T02:30:12"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/vhqjad5otd8/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/ziuwua7i3lr/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fwcsb24lq8a%2f&text=%e6%bf%80%e5%8a%a8%e4%ba%ba%e5%bf%83%e7%9a%84%20Angular%20HttpClient"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fwcsb24lq8a%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fwcsb24lq8a%2f&text=%e6%bf%80%e5%8a%a8%e4%ba%ba%e5%bf%83%e7%9a%84%20Angular%20HttpClient"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fwcsb24lq8a%2f&title=%e6%bf%80%e5%8a%a8%e4%ba%ba%e5%bf%83%e7%9a%84%20Angular%20HttpClient"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fwcsb24lq8a%2f&is_video=false&description=%e6%bf%80%e5%8a%a8%e4%ba%ba%e5%bf%83%e7%9a%84%20Angular%20HttpClient"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e6%bf%80%e5%8a%a8%e4%ba%ba%e5%bf%83%e7%9a%84%20Angular%20HttpClient&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fwcsb24lq8a%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fwcsb24lq8a%2f&title=%e6%bf%80%e5%8a%a8%e4%ba%ba%e5%bf%83%e7%9a%84%20Angular%20HttpClient"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fwcsb24lq8a%2f&title=%e6%bf%80%e5%8a%a8%e4%ba%ba%e5%bf%83%e7%9a%84%20Angular%20HttpClient"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fwcsb24lq8a%2f&title=%e6%bf%80%e5%8a%a8%e4%ba%ba%e5%bf%83%e7%9a%84%20Angular%20HttpClient"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fwcsb24lq8a%2f&title=%e6%bf%80%e5%8a%a8%e4%ba%ba%e5%bf%83%e7%9a%84%20Angular%20HttpClient"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">激动人心的 Angular HttpClient</h1><div class="meta"><div class="postdate"><time datetime="2019-01-09" itemprop="datePublished">2019-01-09</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e阅读 Angular 6\/RxJS 最新教程，请访问\x3ca href=\x22http:\/\/www.semlinker.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e前端修仙之路\x3c\/a\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3eAngular \x3ca href=\x22https:\/\/github.com\/angular\/angular\/compare\/4.3.0-beta.1...4.3.0-rc.0\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e4.3.0-rc.0\x3c\/a\x3e 版本已经发布?。在这个版本中，我们等到了一个令人兴奋的新功能 -  HTTPClient API 的改进版本，以后妈妈再也不用担心我处理 HTTP 请求了?。\x3c\/p\x3e\n\x3cblockquote\x3eHttpClient 是已有 Angular HTTP API 的演进，它在一个单独的 \x3ccode\x3e@angular\/common\/http\x3c\/code\x3e 包中。这是为了确保现有的代码库可以缓慢迁移到新的 API。\x3c\/blockquote\x3e\n\x3cp\x3e接下来让我们开启 Angular 新版 \x3ca href=\x22https:\/\/github.com\/angular\/angular\/blob\/master\/packages\/common\/http\/src\/client.ts\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eHttp Client\x3c\/a\x3e 之旅。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e安装\x3c\/h2\x3e\n\x3cp\x3e首先，我们需要更新所有的包到 \x3ccode\x3e4.3.0-rc.0\x3c\/code\x3e 版本。然后，我们需要在 \x3ccode\x3eAppModule\x3c\/code\x3e 中导入 \x3ccode\x3eHttpClientModule\x3c\/code\x3e 模块。具体如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { HttpClientModule } from \x27@angular\/common\/http\x27;\n@NgModule({\n declarations: [\n   AppComponent\n ],\n imports: [\n   BrowserModule,\n   HttpClientModule\n ],\n bootstrap: [AppComponent]\n})\nexport class AppModule { }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { HttpClientModule } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@angular\/common\/http\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-meta\x22\x3e@NgModule\x3c\/span\x3e({\n declarations: [\n   AppComponent\n ],\n imports: [\n   BrowserModule,\n   HttpClientModule\n ],\n bootstrap: [AppComponent]\n})\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e AppModule { }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e现在一切准备就绪。让我们来体验一下我们一直期待的三个新特性。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e特性一 默认 JSON 解析\x3c\/h2\x3e\n\x3cp\x3e现在 JSON 是默认的数据格式，我们不需要再进行显式的解析。即我们不需要再使用以下代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22http.get(url).map(res =\x3e res.json()).subscribe(...)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3ehttp.get(url).map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e res.json()).subscribe(...)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e现在我们可以这样写：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22http.get(url).subscribe(...)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3ehttp.get(url).subscribe(...)\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e特性二 支持拦截器 (Interceptors)\x3c\/h2\x3e\n\x3cp\x3e拦截器允许我们将中间件逻辑插入管线中。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e请求拦截器 (Request Interceptor)\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import {\n  HttpRequest,\n  HttpHandler,\n  HttpEvent\n} from \x27@angular\/common\/http\x27;\n\n@Injectable()\nclass JWTInterceptor implements HttpInterceptor {\n  \n  constructor(private userService: UserService) {}\n  \n  intercept(req: HttpRequest\x3cany\x3e, next: HttpHandler): Observable\x3cHttpEvent\x3cany\x3e\x3e {\n\n    const JWT = `Bearer ${this.userService.getToken()}`;\n    req = req.clone({\n      setHeaders: {\n        Authorization: JWT\n      }\n    });\n    return next.handle(req);\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {\n  HttpRequest,\n  HttpHandler,\n  HttpEvent\n} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@angular\/common\/http\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-meta\x22\x3e@Injectable\x3c\/span\x3e()\n\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e JWTInterceptor \x3cspan class=\x22hljs-keyword\x22\x3eimplements\x3c\/span\x3e HttpInterceptor {\n  \n  \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eprivate\x3c\/span\x3e userService: UserService\x3c\/span\x3e) {}\n  \n  intercept(req: HttpRequest\x26lt;\x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x26gt;, next: HttpHandler): Observable\x26lt;HttpEvent\x26lt;\x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x26gt;\x26gt; {\n\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e JWT = \x3cspan class=\x22hljs-string\x22\x3e`Bearer \x3cspan class=\x22hljs-subst\x22\x3e${this.userService.getToken()}\x3c\/span\x3e`\x3c\/span\x3e;\n    req = req.clone({\n      setHeaders: {\n        Authorization: JWT\n      }\n    });\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e next.handle(req);\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果我们想要注册新的拦截器 (interceptor)，我们需要实现 \x3ccode\x3eHttpInterceptor\x3c\/code\x3e 接口，然后实现该接口中的 \x3ccode\x3eintercept\x3c\/code\x3e 方法。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export interface HttpInterceptor {\n  intercept(req: HttpRequest\x3cany\x3e, next: HttpHandler): Observable\x3cHttpEvent\x3cany\x3e\x3e;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3einterface\x3c\/span\x3e HttpInterceptor {\n  intercept(req: HttpRequest\x26lt;\x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x26gt;, next: HttpHandler): Observable\x26lt;HttpEvent\x26lt;\x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x26gt;\x26gt;;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e需要注意的是，请求对象和响应对象必须是不可修改的 (immutable)。因此，我们在返回请求对象前，我们需要克隆原始的请求对象。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3enext.handle(req)\x3c\/code\x3e 方法使用新的请求对象，调用底层的 XHR 对象，并返回响应事件流。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e响应拦截器 (Response Interceptor)\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@Injectable()\nclass JWTInterceptor implements HttpInterceptor {\n\n  constructor(private router: Router) {}\n  \n  intercept(req: HttpRequest \x3c any \x3e ,\n    next: HttpHandler): Observable \x3c HttpEvent \x3c any \x3e\x3e {\n\n    return next.handle(req).map(event =\x3e {\n        if (event instanceof HttpResponse) {\n          if (event.status === 401) {\n            \/\/ JWT expired, go to login\n          }\n        }\n        return event;\n      }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e@Injectable\x3c\/span\x3e()\n\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e JWTInterceptor \x3cspan class=\x22hljs-keyword\x22\x3eimplements\x3c\/span\x3e HttpInterceptor {\n\n  \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eprivate\x3c\/span\x3e router: Router\x3c\/span\x3e) {}\n  \n  intercept(req: HttpRequest \x26lt; \x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e \x26gt; ,\n    next: HttpHandler): Observable \x26lt; HttpEvent \x26lt; \x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e \x26gt;\x26gt; {\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e next.handle(req).map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event \x3cspan class=\x22hljs-keyword\x22\x3einstanceof\x3c\/span\x3e HttpResponse) {\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.status === \x3cspan class=\x22hljs-number\x22\x3e401\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ JWT expired, go to login\x3c\/span\x3e\n          }\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e event;\n      }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e响应拦截器可以通过在 \x3ccode\x3enext.handle(req)\x3c\/code\x3e 返回的流对象 (即 Observable 对象) 上应用附加的 Rx 操作符来转换响应事件流对象。\x3c\/p\x3e\n\x3cp\x3e接下来要应用 \x3ccode\x3eJWTInterceptor\x3c\/code\x3e 响应拦截器的最后一件事是注册该拦截器，即使用 \x3ccode\x3eHTTP_INTERCEPTORS\x3c\/code\x3e 作为 token，注册 multi Provider：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22[{ provide: HTTP_INTERCEPTORS, useClass: JWTInterceptor, multi: true }]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e[{ provide: HTTP_INTERCEPTORS, useClass: JWTInterceptor, multi: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e }]\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e特性三 进度事件 (Progress Events)\x3c\/h2\x3e\n\x3cp\x3e进度事件可以用于跟踪文件上传和下载。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import {\n  HttpEventType,\n  HttpClient,\n  HttpRequest\n} from \x27@angular\/common\/http\x27;\n\nhttp.request(new HttpRequest(\n  \x27POST\x27,\n   URL,\n   body, \n  {\n    reportProgress: true\n  })).subscribe(event =\x3e {\n\n  if (event.type === HttpEventType.DownloadProgress) {\n    \/\/ {\n    \/\/ loaded:11, \/\/ Number of bytes uploaded or downloaded.\n    \/\/ total :11 \/\/ Total number of bytes to upload or download\n    \/\/ }\n  }\n\n  if (event.type === HttpEventType.UploadProgress) {\n    \/\/ {\n    \/\/ loaded:11, \/\/ Number of bytes uploaded or downloaded.\n    \/\/ total :11 \/\/ Total number of bytes to upload or download\n    \/\/ }\n  }\n\n  if (event.type === HttpEventType.Response) {\n    console.log(event.body);\n  }\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {\n  HttpEventType,\n  HttpClient,\n  HttpRequest\n} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@angular\/common\/http\x27\x3c\/span\x3e;\n\nhttp.request(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e HttpRequest(\n  \x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e,\n   URL,\n   body, \n  {\n    reportProgress: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  })).subscribe(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.type === HttpEventType.DownloadProgress) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ {\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ loaded:11, \/\/ Number of bytes uploaded or downloaded.\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ total :11 \/\/ Total number of bytes to upload or download\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ }\x3c\/span\x3e\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.type === HttpEventType.UploadProgress) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ {\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ loaded:11, \/\/ Number of bytes uploaded or downloaded.\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ total :11 \/\/ Total number of bytes to upload or download\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ }\x3c\/span\x3e\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.type === HttpEventType.Response) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(event.body);\n  }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果我们想要跟踪文件上传或下载的进度，在创建请求对象时，我们需要配置 \x3ccode\x3e{reportProgress: true}\x3c\/code\x3e 参数。\x3c\/p\x3e\n\x3cp\x3e此外在回调函数中，我们通过 \x3ccode\x3eevent.type\x3c\/code\x3e 来判断不同的事件类型，从进行相应的事件处理。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eHttpEventType\x3c\/code\x3e 枚举定义如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export enum HttpEventType {\n  \/**\n   * 表示请求已经被发送\n   *\/\n  Sent,\n\n  \/**\n   * 已接收到上传进度事件\n   *\/\n  UploadProgress,\n\n  \/**\n   * 已接收到响应状态码和响应头\n   *\/\n  ResponseHeader,\n\n  \/**\n   * 已接收到下载进度事件\n   *\/\n  DownloadProgress,\n\n  \/**\n   * 已接收全部响应，包含响应体 \n   *\/\n  Response,\n\n  \/**\n   * 用户自定义事件，来自拦截器或后端\n   *\/\n  User,\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eenum\x3c\/span\x3e HttpEventType {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * 表示请求已经被发送\n   *\/\x3c\/span\x3e\n  Sent,\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * 已接收到上传进度事件\n   *\/\x3c\/span\x3e\n  UploadProgress,\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * 已接收到响应状态码和响应头\n   *\/\x3c\/span\x3e\n  ResponseHeader,\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * 已接收到下载进度事件\n   *\/\x3c\/span\x3e\n  DownloadProgress,\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * 已接收全部响应，包含响应体 \n   *\/\x3c\/span\x3e\n  Response,\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * 用户自定义事件，来自拦截器或后端\n   *\/\x3c\/span\x3e\n  User,\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其实除了上面介绍三个新的功能之外，还有以下两个新的功能：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e基于 Angular 内部测试框架的 \x3ccode\x3ePost-request verification\x3c\/code\x3e 和 \x3ccode\x3eflush\x3c\/code\x3e 功能\x3c\/li\x3e\n\x3cli\x3e类型化，同步响应体访问，包括对 JSON 响应体类型的支持。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e最后我们来通过 \x3ca href=\x22https:\/\/github.com\/angular\/angular\/blob\/master\/packages\/common\/http\/test\/client_spec.ts\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eclient_spec.ts\x3c\/a\x3e 文件中的测试用例，来进一步感受一下上述的新特性。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e其它特性\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e发送 GET 请求\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22describe(\x27HttpClient\x27, () =\x3e {\n    let client: HttpClient = null !;\n    let backend: HttpClientTestingBackend = null !;\n    beforeEach(() =\x3e {\n      backend = new HttpClientTestingBackend();\n      client = new HttpClient(backend);\n    });\n    afterEach(() =\x3e { backend.verify(); }); \/\/ 请求验证\n  \n    describe(\x27makes a basic request\x27, () =\x3e {\n      it(\x27for JSON data\x27, (done: DoneFn) =\x3e {\n        client.get(\x27\/test\x27).subscribe(res =\x3e {\n          expect((res as any)[\x27data\x27]).toEqual(\x27hello world\x27);\n          done();\n        });\n        backend.expectOne(\x27\/test\x27).flush({\x27data\x27: \x27hello world\x27});\n      });\n      \n      it(\x27for an arraybuffer\x27, (done: DoneFn) =\x3e {\n        const body = new ArrayBuffer(4);\n        \/\/ 还支持 {responseType: \x27text\x27}、{responseType: \x27blob\x27}\n        client.get(\x27\/test\x27, {responseType: \x27arraybuffer\x27}).subscribe(res =\x3e {\n          expect(res).toBe(body);\n          done();\n        });\n        backend.expectOne(\x27\/test\x27).flush(body);\n      });\n      \n      it(\x27that returns a response\x27, (done: DoneFn) =\x3e {\n        const body = {\x27data\x27: \x27hello world\x27};\n        client.get(\x27\/test\x27, {observe: \x27response\x27}).subscribe(res =\x3e {\n          expect(res instanceof HttpResponse).toBe(true);\n          expect(res.body).toBe(body);\n          done();\n        });\n        backend.expectOne(\x27\/test\x27).flush(body);\n      });\n    });\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3edescribe(\x3cspan class=\x22hljs-string\x22\x3e\x27HttpClient\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e client: HttpClient = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e !;\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e backend: HttpClientTestingBackend = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e !;\n    beforeEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      backend = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e HttpClientTestingBackend();\n      client = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e HttpClient(backend);\n    });\n    afterEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e { backend.verify(); }); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 请求验证\x3c\/span\x3e\n  \n    describe(\x3cspan class=\x22hljs-string\x22\x3e\x27makes a basic request\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      it(\x3cspan class=\x22hljs-string\x22\x3e\x27for JSON data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edone: DoneFn\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        client.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/test\x27\x3c\/span\x3e).subscribe(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n          expect((res \x3cspan class=\x22hljs-keyword\x22\x3eas\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e)[\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e]).toEqual(\x3cspan class=\x22hljs-string\x22\x3e\x27hello world\x27\x3c\/span\x3e);\n          done();\n        });\n        backend.expectOne(\x3cspan class=\x22hljs-string\x22\x3e\x27\/test\x27\x3c\/span\x3e).flush({\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27hello world\x27\x3c\/span\x3e});\n      });\n      \n      it(\x3cspan class=\x22hljs-string\x22\x3e\x27for an arraybuffer\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edone: DoneFn\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e body = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eArrayBuffer\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 还支持 {responseType: \x27text\x27}、{responseType: \x27blob\x27}\x3c\/span\x3e\n        client.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/test\x27\x3c\/span\x3e, {responseType: \x3cspan class=\x22hljs-string\x22\x3e\x27arraybuffer\x27\x3c\/span\x3e}).subscribe(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n          expect(res).toBe(body);\n          done();\n        });\n        backend.expectOne(\x3cspan class=\x22hljs-string\x22\x3e\x27\/test\x27\x3c\/span\x3e).flush(body);\n      });\n      \n      it(\x3cspan class=\x22hljs-string\x22\x3e\x27that returns a response\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edone: DoneFn\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e body = {\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27hello world\x27\x3c\/span\x3e};\n        client.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/test\x27\x3c\/span\x3e, {observe: \x3cspan class=\x22hljs-string\x22\x3e\x27response\x27\x3c\/span\x3e}).subscribe(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n          expect(res \x3cspan class=\x22hljs-keyword\x22\x3einstanceof\x3c\/span\x3e HttpResponse).toBe(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n          expect(res.body).toBe(body);\n          done();\n        });\n        backend.expectOne(\x3cspan class=\x22hljs-string\x22\x3e\x27\/test\x27\x3c\/span\x3e).flush(body);\n      });\n    });\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e发送 POST 请求\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22describe(\x27makes a POST request\x27, () =\x3e {\n      it(\x27with text data\x27, (done: DoneFn) =\x3e {\n        client.post(\x27\/test\x27, \x27text body\x27, {observe: \x27response\x27, responseType: \x27text\x27})\n            .subscribe(res =\x3e {\n              expect(res.ok).toBeTruthy();\n              expect(res.status).toBe(200);\n              done();\n            });\n        backend.expectOne(\x27\/test\x27).flush(\x27hello world\x27);\n      });\n  \n      it(\x27with json data\x27, (done: DoneFn) =\x3e {\n        const body = {data: \x27json body\x27};\n        client.post(\x27\/test\x27, body, {observe: \x27response\x27, \n          responseType: \x27text\x27}).subscribe(res =\x3e {\n          expect(res.ok).toBeTruthy();\n          expect(res.status).toBe(200);\n          done();\n        });\n        const testReq = backend.expectOne(\x27\/test\x27);\n        expect(testReq.request.body).toBe(body);\n        testReq.flush(\x27hello world\x27);\n      });\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3edescribe(\x3cspan class=\x22hljs-string\x22\x3e\x27makes a POST request\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      it(\x3cspan class=\x22hljs-string\x22\x3e\x27with text data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edone: DoneFn\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        client.post(\x3cspan class=\x22hljs-string\x22\x3e\x27\/test\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27text body\x27\x3c\/span\x3e, {observe: \x3cspan class=\x22hljs-string\x22\x3e\x27response\x27\x3c\/span\x3e, responseType: \x3cspan class=\x22hljs-string\x22\x3e\x27text\x27\x3c\/span\x3e})\n            .subscribe(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n              expect(res.ok).toBeTruthy();\n              expect(res.status).toBe(\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e);\n              done();\n            });\n        backend.expectOne(\x3cspan class=\x22hljs-string\x22\x3e\x27\/test\x27\x3c\/span\x3e).flush(\x3cspan class=\x22hljs-string\x22\x3e\x27hello world\x27\x3c\/span\x3e);\n      });\n  \n      it(\x3cspan class=\x22hljs-string\x22\x3e\x27with json data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edone: DoneFn\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e body = {data: \x3cspan class=\x22hljs-string\x22\x3e\x27json body\x27\x3c\/span\x3e};\n        client.post(\x3cspan class=\x22hljs-string\x22\x3e\x27\/test\x27\x3c\/span\x3e, body, {observe: \x3cspan class=\x22hljs-string\x22\x3e\x27response\x27\x3c\/span\x3e, \n          responseType: \x3cspan class=\x22hljs-string\x22\x3e\x27text\x27\x3c\/span\x3e}).subscribe(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n          expect(res.ok).toBeTruthy();\n          expect(res.status).toBe(\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e);\n          done();\n        });\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e testReq = backend.expectOne(\x3cspan class=\x22hljs-string\x22\x3e\x27\/test\x27\x3c\/span\x3e);\n        expect(testReq.request.body).toBe(body);\n        testReq.flush(\x3cspan class=\x22hljs-string\x22\x3e\x27hello world\x27\x3c\/span\x3e);\n      });\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e发送 JSONP 请求\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22describe(\x27makes a JSONP request\x27, () =\x3e {\n      it(\x27with properly set method and callback\x27, (done: DoneFn) =\x3e {\n        client.jsonp(\x27\/test\x27, \x27myCallback\x27).subscribe(() =\x3e done());\n        backend.expectOne({method: \x27JSONP\x27, url: \x27\/test?myCallback=JSONP_CALLBACK\x27})\n            .flush(\x27hello world\x27);\n      });\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3edescribe(\x3cspan class=\x22hljs-string\x22\x3e\x27makes a JSONP request\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      it(\x3cspan class=\x22hljs-string\x22\x3e\x27with properly set method and callback\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edone: DoneFn\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        client.jsonp(\x3cspan class=\x22hljs-string\x22\x3e\x27\/test\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27myCallback\x27\x3c\/span\x3e).subscribe(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e done());\n        backend.expectOne({method: \x3cspan class=\x22hljs-string\x22\x3e\x27JSONP\x27\x3c\/span\x3e, url: \x3cspan class=\x22hljs-string\x22\x3e\x27\/test?myCallback=JSONP_CALLBACK\x27\x3c\/span\x3e})\n            .flush(\x3cspan class=\x22hljs-string\x22\x3e\x27hello world\x27\x3c\/span\x3e);\n      });\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e参考资源\x3c\/h2\x3e\n\x3cul\x3e\x3cli\x3e\x3ca href=\x22https:\/\/netbasal.com\/a-taste-from-the-new-angular-http-client-38fcdc6b359b\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eA Taste From The New Angular HTTP Client\x3c\/a\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>激动人心的 Angular HttpClient</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010116848">https://segmentfault.com/a/1190000010116848</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/wcsb24lq8a/" target="_blank">https://alili.tech/archive/wcsb24lq8a/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>