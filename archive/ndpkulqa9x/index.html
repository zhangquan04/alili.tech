<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="node学习之路（一）—— 网络请求"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>node学习之路（一）—— 网络请求 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/ndpkulqa9x/",
				"appid": "1613049289050283", 
				"title": "node学习之路（一）—— 网络请求 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-06T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/4ctgk29pkfe/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/8plbygbrrxs/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fndpkulqa9x%2f&text=node%e5%ad%a6%e4%b9%a0%e4%b9%8b%e8%b7%af%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20%e7%bd%91%e7%bb%9c%e8%af%b7%e6%b1%82"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fndpkulqa9x%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fndpkulqa9x%2f&text=node%e5%ad%a6%e4%b9%a0%e4%b9%8b%e8%b7%af%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20%e7%bd%91%e7%bb%9c%e8%af%b7%e6%b1%82"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fndpkulqa9x%2f&title=node%e5%ad%a6%e4%b9%a0%e4%b9%8b%e8%b7%af%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20%e7%bd%91%e7%bb%9c%e8%af%b7%e6%b1%82"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fndpkulqa9x%2f&is_video=false&description=node%e5%ad%a6%e4%b9%a0%e4%b9%8b%e8%b7%af%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20%e7%bd%91%e7%bb%9c%e8%af%b7%e6%b1%82"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=node%e5%ad%a6%e4%b9%a0%e4%b9%8b%e8%b7%af%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20%e7%bd%91%e7%bb%9c%e8%af%b7%e6%b1%82&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fndpkulqa9x%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fndpkulqa9x%2f&title=node%e5%ad%a6%e4%b9%a0%e4%b9%8b%e8%b7%af%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20%e7%bd%91%e7%bb%9c%e8%af%b7%e6%b1%82"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fndpkulqa9x%2f&title=node%e5%ad%a6%e4%b9%a0%e4%b9%8b%e8%b7%af%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20%e7%bd%91%e7%bb%9c%e8%af%b7%e6%b1%82"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fndpkulqa9x%2f&title=node%e5%ad%a6%e4%b9%a0%e4%b9%8b%e8%b7%af%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20%e7%bd%91%e7%bb%9c%e8%af%b7%e6%b1%82"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fndpkulqa9x%2f&title=node%e5%ad%a6%e4%b9%a0%e4%b9%8b%e8%b7%af%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20%e7%bd%91%e7%bb%9c%e8%af%b7%e6%b1%82"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">node学习之路（一）—— 网络请求</h1><div class="meta"><div class="postdate"><time datetime="2019-01-06" itemprop="datePublished">2019-01-06</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e\x3cstrong\x3e文章来源：小青年原创\x3c\/strong\x3e\x3cbr\x3e\x3cstrong\x3e发布时间：2016-09-29\x3c\/strong\x3e\x3cbr\x3e\x3cstrong\x3e关键词：JavaScript，nodejs，http，url ，Query String，爬虫\x3c\/strong\x3e\x3cbr\x3e\x3cstrong\x3e转载需标注本文原始地址: \x3ca href=\x22http:\/\/zhaomenghuan.github.io\/#!\/blog\/20160929\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/zhaomenghuan.github.io...\x3c\/a\x3e\x3c\/strong\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3e一直以来想学习一下node，一来是自己目前也没有什么时间去学习服务器端语言，但是有时候又想自己撸一下服务器端，本着爱折腾的精神开始写一写关于node的文章记录学习心得。本系列文章不会过多去讲解node安装、基本API等内容，而是通过一些实例去总结常用用法。本文主要讲解node网络操作的相关内容，node中的网络操作依赖于http模块，http模块提供了两种使用方式：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e作为服务器端使用，创建一个http服务器，监听http客户端请求并返回响应；\x3c\/li\x3e\n\x3cli\x3e作为客户端使用，发起一个http客户端请求，获取服务器端响应。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3enode http模块创建服务器\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3enode 处理 get 请求实例\x3c\/h3\x3e\n\x3cp\x3e毕竟作为一个前端，我们经常需要自己搭建一个服务器做测试，这里我们先来讲一下node http模块作为服务器端使用。首先我们需要，使用createServer创建一个服务，然后通过listen监听客服端http请求。\x3c\/p\x3e\n\x3cp\x3e我们可以创建一个最简单的服务器，在页面输出\x3ccode\x3ehello world\x3c\/code\x3e，我们可以创建helloworld.js，内容如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var http = require(\x27http\x27);\n\nhttp.createServer(function(request, response){\n    response.writeHead(200, { \x27Content-Type\x27: \x27text-plain\x27 });\n    response.end(\x27hello world!\x27)\n}).listen(8888);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e http = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27http\x27\x3c\/span\x3e);\n\nhttp.createServer(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erequest, response\x3c\/span\x3e)\x3c\/span\x3e{\n    response.writeHead(\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e, { \x3cspan class=\x22hljs-string\x22\x3e\x27Content-Type\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27text-plain\x27\x3c\/span\x3e });\n    response.end(\x3cspan class=\x22hljs-string\x22\x3e\x27hello world!\x27\x3c\/span\x3e)\n}).listen(\x3cspan class=\x22hljs-number\x22\x3e8888\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在命令行输入node helloworld.js即可，我们打开在浏览器打开\x3ca href=\x22http:\/\/127.0.0.1:8888\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:8888\/\x3c\/a\x3e就可以看到页面输出hello world!。\x3c\/p\x3e\n\x3cp\x3e下面我们在本地写一个页面，通过jsonp访问我们创建的node服务器：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!DOCTYPE html\x3e\n\x3chtml\x3e\n    \x3chead\x3e\n        \x3cmeta charset=\x26quot;utf-8\x26quot; \/\x3e\n        \x3ctitle\x3e\x3c\/title\x3e\n    \x3c\/head\x3e\n    \x3cbody\x3e\n        \x3cdiv id=\x26quot;output\x26quot;\x3e\x3c\/div\x3e\n        \n        \x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n            \/\/ 创建script标签\n            function importScript(src){\n                var el = document.createElement(\x27script\x27);\n                el.src = src;\n                el.async = true;\n                el.defer = true;\n                document.body.appendChild(el);\n            }\n            \n            \/\/ 响应的方法\n            function jsonpcallback(rs) {\n                console.log(JSON.stringify(rs));\n                document.getElementById(\x26quot;output\x26quot;).innerHTML = JSON.stringify(rs);\n            }\n            \n            \/\/ 发起get请求\n            importScript(\x27http:\/\/127.0.0.1:8888?userid=xiaoqingnian\x26amp;callback=jsonpcallback\x27);\n        \x3c\/script\x3e\n    \x3c\/body\x3e\n\x3c\/html\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x26lt;!DOCTYPE html\x26gt;\n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22utf-8\x22\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22output\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建script标签\x3c\/span\x3e\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eimportScript\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3esrc\x3c\/span\x3e)\x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e el = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27script\x27\x3c\/span\x3e);\n                el.src = src;\n                el.async = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n                el.defer = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n                \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(el);\n            }\n            \n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 响应的方法\x3c\/span\x3e\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ejsonpcallback\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ers\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(rs));\n                \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22output\x22\x3c\/span\x3e).innerHTML = \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(rs);\n            }\n            \n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 发起get请求\x3c\/span\x3e\n            importScript(\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/127.0.0.1:8888?userid=xiaoqingnian\x26amp;callback=jsonpcallback\x27\x3c\/span\x3e);\n        \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们当然需要将上述node服务器中的代码稍作修改：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var http = require(\x27http\x27); \/\/ 提供web服务\nvar url = require(\x27url\x27);    \/\/ 解析GET请求\n  \nvar data = {\n    \x27name\x27: \x27zhaomenghuan\x27, \n    \x27age\x27: \x2722\x27\n};\n  \nhttp.createServer(function(req, res){  \n    \/\/ 将url字符串转换成Url对象\n    var params = url.parse(req.url, true);  \n    console.log(params);\n    \/\/ 查询参数\n    if(params.query){\n        \/\/ 根据附件条件查询\n        if(params.query.userid === \x27xiaoqingnian\x27){\n            \/\/ 判断是否为jsonp方式请求，若是则使用jsonp方式，否则为普通web方式\n            if (params.query.callback) {  \n                var resurlt =  params.query.callback \x2b \x27(\x27 \x2b JSON.stringify(data) \x2b \x27)\x27;\n                res.end(resurlt);  \n            } else {  \n                res.end(JSON.stringify(data));\n            }\n        } \n    }      \n}).listen(8888);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e http = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27http\x27\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 提供web服务\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e url = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27url\x27\x3c\/span\x3e);    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 解析GET请求\x3c\/span\x3e\n  \n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data = {\n    \x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27zhaomenghuan\x27\x3c\/span\x3e, \n    \x3cspan class=\x22hljs-string\x22\x3e\x27age\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2722\x27\x3c\/span\x3e\n};\n  \nhttp.createServer(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e)\x3c\/span\x3e{  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将url字符串转换成Url对象\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e params = url.parse(req.url, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);  \n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(params);\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 查询参数\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(params.query){\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据附件条件查询\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(params.query.userid === \x3cspan class=\x22hljs-string\x22\x3e\x27xiaoqingnian\x27\x3c\/span\x3e){\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 判断是否为jsonp方式请求，若是则使用jsonp方式，否则为普通web方式\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (params.query.callback) {  \n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e resurlt =  params.query.callback \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27(\x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(data) \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27)\x27\x3c\/span\x3e;\n                res.end(resurlt);  \n            } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {  \n                res.end(\x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(data));\n            }\n        } \n    }      \n}).listen(\x3cspan class=\x22hljs-number\x22\x3e8888\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们在命令行可以看到：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Url {\n  protocol: null,\n  slashes: null,\n  auth: null,\n  host: null,\n  port: null,\n  hostname: null,\n  hash: null,\n  search: \x27?userid=xiaoqingnian\x26amp;callback=jsonpcallback\x27,\n  query: { userid: \x27xiaoqingnian\x27, callback: \x27jsonpcallback\x27 },\n  pathname: \x27\/\x27,\n  path: \x27\/?userid=xiaoqingnian\x26amp;callback=jsonpcallback\x27,\n  href: \x27\/?userid=xiaoqingnian\x26amp;callback=jsonpcallback\x27 }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eUrl {\n  \x3cspan class=\x22hljs-attr\x22\x3eprotocol\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eslashes\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eauth\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehost\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eport\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehostname\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehash\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3esearch\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27?userid=xiaoqingnian\x26amp;callback=jsonpcallback\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3equery\x3c\/span\x3e: { \x3cspan class=\x22hljs-attr\x22\x3euserid\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27xiaoqingnian\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ecallback\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27jsonpcallback\x27\x3c\/span\x3e },\n  \x3cspan class=\x22hljs-attr\x22\x3epathname\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/?userid=xiaoqingnian\x26amp;callback=jsonpcallback\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/?userid=xiaoqingnian\x26amp;callback=jsonpcallback\x27\x3c\/span\x3e }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e经过服务器端jsonp处理，然后返回一个函数：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22jsonpcallback({\x26quot;name\x26quot;:\x26quot;zhaomenghuan\x26quot;,\x26quot;age\x26quot;:\x26quot;22\x26quot;})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3ejsonpcallback({\x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22zhaomenghuan\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22age\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x2222\x22\x3c\/span\x3e})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而我们在页面中定义了一个jsonpcallback()的方法，所以当我们在请求页面动态生成script调用服务器地址，这样相当于在页面执行了下我们定义的函数。jsonp的实现原理主要是script标签src可以跨域执行代码，类似于你引用js库，然后调用这个js库里面的方法；这是这里我们可以认为反过来了，你是在本地定义函数，调用的逻辑通过服务器返回的一个函数执行了，所以jsonp并没有什么神奇的，和XMLHttpRequest、ajax半毛钱关系都没有，而且JSONP需要服务器端支持，始终是无状态连接，不能获悉连接状态和错误事件，而且只能走GET的形式。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3enode 处理 post 请求实例\x3c\/h3\x3e\n\x3cp\x3e当然这里我们可以直接在后台设置响应头进行跨域（CORS），如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var http = require(\x26quot;http\x26quot;);    \/\/ 提供web服务\nvar query = require(\x26quot;querystring\x26quot;);    \/\/ 解析POST请求\n\nhttp.createServer(function(req,res){\n      \/\/ 报头添加Access-Control-Allow-Origin标签，值为特定的URL或\x26quot;*\x26quot;(表示允许所有域访问当前域)\n      res.setHeader(\x26quot;Access-Control-Allow-Origin\x26quot;,\x26quot;*\x26quot;);\n      \n      var postdata = \x27\x27;\n      \/\/ 一旦监听器被添加，可读流会触发 \x27data\x27 事件\n    req.addListener(\x26quot;data\x26quot;,function(chunk){\n        postdata \x2b= chunk;\n    })\n    \/\/ \x27end\x27 事件表明已经得到了完整的 body\n    req.addListener(\x26quot;end\x26quot;,function(){\n        console.log(postdata);     \/\/ \x27appid=xiaoqingnian\x27\n        \/\/ 将接收到参数串转换位为json对象\n        var params = query.parse(postdata);\n        if(params.userid == \x27xiaoqingnian\x27){\n            res.end(\x27{\x26quot;name\x26quot;:\x26quot;zhaomenghuan\x26quot;,\x26quot;age\x26quot;:\x26quot;22\x26quot;}\x27);\n        }\n    })\n    \n}).listen(8080);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e http = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22http\x22\x3c\/span\x3e);    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 提供web服务\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e query = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22querystring\x22\x3c\/span\x3e);    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 解析POST请求\x3c\/span\x3e\n\nhttp.createServer(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq,res\x3c\/span\x3e)\x3c\/span\x3e{\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 报头添加Access-Control-Allow-Origin标签，值为特定的URL或\x22*\x22(表示允许所有域访问当前域)\x3c\/span\x3e\n      res.setHeader(\x3cspan class=\x22hljs-string\x22\x3e\x22Access-Control-Allow-Origin\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22*\x22\x3c\/span\x3e);\n      \n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e postdata = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 一旦监听器被添加，可读流会触发 \x27data\x27 事件\x3c\/span\x3e\n    req.addListener(\x3cspan class=\x22hljs-string\x22\x3e\x22data\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3echunk\x3c\/span\x3e)\x3c\/span\x3e{\n        postdata \x2b= chunk;\n    })\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x27end\x27 事件表明已经得到了完整的 body\x3c\/span\x3e\n    req.addListener(\x3cspan class=\x22hljs-string\x22\x3e\x22end\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(postdata);     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x27appid=xiaoqingnian\x27\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将接收到参数串转换位为json对象\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e params = query.parse(postdata);\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(params.userid == \x3cspan class=\x22hljs-string\x22\x3e\x27xiaoqingnian\x27\x3c\/span\x3e){\n            res.end(\x3cspan class=\x22hljs-string\x22\x3e\x27{\x22name\x22:\x22zhaomenghuan\x22,\x22age\x22:\x2222\x22}\x27\x3c\/span\x3e);\n        }\n    })\n    \n}).listen(\x3cspan class=\x22hljs-number\x22\x3e8080\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e我们通过流的形式接收前端post传递的参数，通过监听data和end事件，后面在讲解event模块的时候再深入探究。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3eCORS默认只支持GET\/POST这两种http请求类型，如果要开启PUT\/DELETE之类的方式，需要在服务端在添加一个\x22Access-Control-Allow-Methods\x22报头标签：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22res.setHeader(\n      \x26quot;Access-Control-Allow-Methods\x26quot;,\n      \x26quot;PUT, GET, POST, DELETE, HEAD, PATCH\x26quot;\n);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eres.setHeader(\n      \x3cspan class=\x22hljs-string\x22\x3e\x22Access-Control-Allow-Methods\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22PUT, GET, POST, DELETE, HEAD, PATCH\x22\x3c\/span\x3e\n);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e前端访问代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\nxhr.onload = function () {\n    console.log(this.responseText);\n};\nxhr.onreadystatechange = function() {\n    console.log(this.readyState);\n};\n\nxhr.open(\x26quot;post\x26quot;, \x26quot;http:\/\/127.0.0.1:8080\x26quot;, true);\nxhr.setRequestHeader(\x26quot;Content-Type\x26quot;, \x26quot;application\/x-www-form-urlencoded\x26quot;);\nxhr.send(\x26quot;userid=xiaoqingnian\x26quot;);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.responseText);\n};\nxhr.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.readyState);\n};\n\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x22post\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/127.0.0.1:8080\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\nxhr.setRequestHeader(\x3cspan class=\x22hljs-string\x22\x3e\x22Content-Type\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22application\/x-www-form-urlencoded\x22\x3c\/span\x3e);\nxhr.send(\x3cspan class=\x22hljs-string\x22\x3e\x22userid=xiaoqingnian\x22\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3eurl 模块API详解\x3c\/h3\x3e\n\x3ch4\x3eurl.parse——解析url字符串\x3c\/h4\x3e\n\x3cp\x3e上述代码中比较关键的是我们通过url.parse方法将url字符串转成Url对象，用法如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22url.parse(urlStr, [parseQueryString], [slashesDenoteHost])\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eurl.parse(urlStr, [parseQueryString], [slashesDenoteHost])\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e接收参数：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3eurlStr\x3c\/strong\x3e：url字符串\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3cstrong\x3eparseQueryString\x3c\/strong\x3e：参数为true时，query会被解析为JSON格式，否则为普通字符串格式，默认为false；如：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e参数为true：\x3ccode\x3equery: { userid: \x27xiaoqingnian\x27, callback: \x27jsonpcallback\x27 }\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3e参数为false：\x3ccode\x3equery: \x27userid=xiaoqingnian\x26amp;callback=jsonpcallback\x27\x3c\/code\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eslashesDenoteHost\x3c\/strong\x3e：默认为false，当url是 ‘\x3ca\x3ehttp:\/\/\x3c\/a\x3e’ 或 ‘ftp:\/\/’ 等标志的协议前缀打头的，或直接以地址打头，如 ‘127.0.0.1’ 或 ‘localhost’ 时候是没有区别的；当且仅当以2个斜杠打头的时候，比如 ‘\/\/127.0.0.1’ 才有区别。这时候，如果其值为true，则第一个单个 ‘\/’ 之前的部分被解析为 ‘host’ 和 ‘hostname’，如 ” host : ‘127.0.0.1’ “，如果为false，包括2个反斜杠在内的所有字符串被解析为pathname。如：\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3e url.parse(\x27\/\/www.foo\/bar\x27,true,true)\nUrl {\n  protocol: null,\n  slashes: true,\n  auth: null,\n  host: \x27www.foo\x27,\n  port: null,\n  hostname: \x27www.foo\x27,\n  hash: null,\n  search: \x27\x27,\n  query: {},\n  pathname: \x27\/bar\x27,\n  path: \x27\/bar\x27,\n  href: \x27\/\/www.foo\/bar\x27 }\n\x3e url.parse(\x27\/\/www.foo\/bar\x27,true,false)\nUrl {\n  protocol: null,\n  slashes: null,\n  auth: null,\n  host: null,\n  port: null,\n  hostname: null,\n  hash: null,\n  search: \x27\x27,\n  query: {},\n  pathname: \x27\/\/www.foo\/bar\x27,\n  path: \x27\/\/www.foo\/bar\x27,\n  href: \x27\/\/www.foo\/bar\x27 }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x26gt; url.parse(\x3cspan class=\x22hljs-string\x22\x3e\x27\/\/www.foo\/bar\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e)\nUrl {\n  \x3cspan class=\x22hljs-attr\x22\x3eprotocol\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eslashes\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eauth\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehost\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27www.foo\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eport\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehostname\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27www.foo\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehash\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3esearch\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3equery\x3c\/span\x3e: {},\n  \x3cspan class=\x22hljs-attr\x22\x3epathname\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/bar\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/bar\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\/www.foo\/bar\x27\x3c\/span\x3e }\n\x26gt; url.parse(\x3cspan class=\x22hljs-string\x22\x3e\x27\/\/www.foo\/bar\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\nUrl {\n  \x3cspan class=\x22hljs-attr\x22\x3eprotocol\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eslashes\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eauth\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehost\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eport\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehostname\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehash\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3esearch\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3equery\x3c\/span\x3e: {},\n  \x3cspan class=\x22hljs-attr\x22\x3epathname\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\/www.foo\/bar\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\/www.foo\/bar\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\/www.foo\/bar\x27\x3c\/span\x3e }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里的URL对象和浏览器中的location对象类似，location中如果我们需要使用类似的方法，我们需要自己构造。\x3c\/p\x3e\n\x3ch4\x3eurl.format——格式化URL对象\x3c\/h4\x3e\n\x3cp\x3e我们可以通过url.format方法将一个解析后的URL对象格式化成url字符串，用法为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22url.format(urlObj)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eurl.format(urlObj)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22url.format({\n  protocol: \x27http:\x27,\n  slashes: true,\n  auth: \x27user:pass\x27,\n  host: \x27host.com:8080\x27,\n  port: \x278080\x27,\n  hostname: \x27host.com\x27,\n  hash: \x27#hash\x27,\n  search: \x27?query=string\x27,\n  query: \x27query=string\x27,\n  pathname: \x27\/p\/a\/t\/h\x27,\n  path: \x27\/p\/a\/t\/h?query=string\x27,\n  href: \x27http:\/\/user:pass@host.com:8080\/p\/a\/t\/h?query=string#hash\x27 \n})\n\n结果为：\n\x27http:\/\/user:pass@host.com:8080\/p\/a\/t\/h?query=string#hash\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eurl.format({\n  \x3cspan class=\x22hljs-attr\x22\x3eprotocol\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eslashes\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eauth\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27user:pass\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehost\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27host.com:8080\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eport\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x278080\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehostname\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27host.com\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehash\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27#hash\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3esearch\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27?query=string\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3equery\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27query=string\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3epathname\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/p\/a\/t\/h\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/p\/a\/t\/h?query=string\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/user:pass@host.com:8080\/p\/a\/t\/h?query=string#hash\x27\x3c\/span\x3e \n})\n\n结果为：\n\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/user:pass@host.com:8080\/p\/a\/t\/h?query=string#hash\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3eurl.resolve——拼接url字符串\x3c\/h4\x3e\n\x3cp\x3e我们可以通过url.resolve为URL或 href 插入 或 替换原有的标签，接收参数：\x3cbr\x3efrom源地址，to需要添加或替换的标签。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22url.resolve(from, to)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eurl.resolve(\x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e, to)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e例子为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22url.resolve(\x27\/one\/two\/three\x27, \x27four\x27)\n=\x3e \x27\/one\/two\/four\x27\nurl.resolve(\x27http:\/\/example.com\/\x27, \x27\/one\x27)    \n=\x3e \x27http:\/\/example.com\/one\x27\nurl.resolve(\x27http:\/\/example.com\/one\x27, \x27\/two\x27) \n=\x3e \x27http:\/\/example.com\/two\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eurl.resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27\/one\/two\/three\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27four\x27\x3c\/span\x3e)\n=\x26gt; \x3cspan class=\x22hljs-string\x22\x3e\x27\/one\/two\/four\x27\x3c\/span\x3e\nurl.resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/example.com\/\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/one\x27\x3c\/span\x3e)    \n=\x26gt; \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/example.com\/one\x27\x3c\/span\x3e\nurl.resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/example.com\/one\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/two\x27\x3c\/span\x3e) \n=\x26gt; \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/example.com\/two\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3eQuery String 模块Query String\x3c\/h3\x3e\n\x3ch4\x3equerystring.escape——字符串编码\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22querystring.escape(\x27appkey=123\x26amp;version=1.0.0\x2b\x27)\n\/\/ \x27appkey%3D123%26version%3D1.0.0%2B\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3equerystring.escape(\x3cspan class=\x22hljs-string\x22\x3e\x27appkey=123\x26amp;version=1.0.0\x2b\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x27appkey%3D123%26version%3D1.0.0%2B\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3equerystring.unescape——字符串解码\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22querystring.unescape(\x27appkey%3D123%26version%3D1.0.0%2B\x27)\n\/\/ \x27appkey=123\x26amp;version=1.0.0\x2b\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3equerystring.unescape(\x3cspan class=\x22hljs-string\x22\x3e\x27appkey%3D123%26version%3D1.0.0%2B\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x27appkey=123\x26amp;version=1.0.0\x2b\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3equerystring.stringify(querystring.encode)——序列化对象\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22querystring.stringify(obj[, sep][, eq][, options])\nquerystring.encode(obj[, sep][, eq][, options])\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3equerystring.stringify(obj[, sep][, eq][, options])\nquerystring.encode(obj[, sep][, eq][, options])\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e接收参数\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3eobj\x3c\/strong\x3e： 欲转换的对象\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3esep\x3c\/strong\x3e：设置分隔符，默认为 ‘\x26amp;\x27\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eeq\x3c\/strong\x3e：设置赋值符，默认为 ‘=\x27\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22querystring.stringify({foo: \x27bar\x27, baz: [\x27qux\x27, \x27quux\x27], corge: \x27\x27})\n\/\/ \x27foo=bar\x26amp;baz=qux\x26amp;baz=quux\x26amp;corge=\x27\n\nquerystring.stringify({foo: \x27bar\x27, baz: [\x27qux\x27, \x27quux\x27], corge: \x27\x27},\x27,\x27,\x27:\x27)\n\/\/ \x27foo:bar,baz:qux,baz:quux,corge:\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3equerystring.stringify({\x3cspan class=\x22hljs-attr\x22\x3efoo\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27bar\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ebaz\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27qux\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27quux\x27\x3c\/span\x3e], \x3cspan class=\x22hljs-attr\x22\x3ecorge\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e})\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x27foo=bar\x26amp;baz=qux\x26amp;baz=quux\x26amp;corge=\x27\x3c\/span\x3e\n\nquerystring.stringify({\x3cspan class=\x22hljs-attr\x22\x3efoo\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27bar\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ebaz\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27qux\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27quux\x27\x3c\/span\x3e], \x3cspan class=\x22hljs-attr\x22\x3ecorge\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e},\x3cspan class=\x22hljs-string\x22\x3e\x27,\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27:\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x27foo:bar,baz:qux,baz:quux,corge:\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3equerystring.parse(querystring.decode)——解析query字符串\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22querystring.parse(str[, sep][, eq][, options])\nquerystring.decode(str[, sep][, eq][, options])\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3equerystring.parse(str[, sep][, eq][, options])\nquerystring.decode(str[, sep][, eq][, options])\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e接收参数\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3estr\x3c\/strong\x3e：欲转换的字符串\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3esep\x3c\/strong\x3e：设置分隔符，默认为 ‘\x26amp;\x27\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eeq\x3c\/strong\x3e：设置赋值符，默认为 ‘=\x27\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3e[options]\x3c\/strong\x3e maxKeys 可接受字符串的最大长度，默认为1000\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22querystring.parse(\x27foo=bar\x26amp;baz=qux\x26amp;baz=quux\x26amp;corge=\x27)\n\/\/ { foo: \x27bar\x27, baz: [ \x27qux\x27, \x27quux\x27 ], corge: \x27\x27 }\n\nquerystring.parse(\x27foo:bar,baz:qux,baz:quux,corge:\x27,\x27,\x27,\x27:\x27)\n{ foo: \x27bar\x27, baz: [ \x27qux\x27, \x27quux\x27 ], corge: \x27\x27 }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3equerystring.parse(\x3cspan class=\x22hljs-string\x22\x3e\x27foo=bar\x26amp;baz=qux\x26amp;baz=quux\x26amp;corge=\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ { foo: \x27bar\x27, baz: [ \x27qux\x27, \x27quux\x27 ], corge: \x27\x27 }\x3c\/span\x3e\n\nquerystring.parse(\x3cspan class=\x22hljs-string\x22\x3e\x27foo:bar,baz:qux,baz:quux,corge:\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27,\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27:\x27\x3c\/span\x3e)\n{ \x3cspan class=\x22hljs-attr\x22\x3efoo\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27bar\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ebaz\x3c\/span\x3e: [ \x3cspan class=\x22hljs-string\x22\x3e\x27qux\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27quux\x27\x3c\/span\x3e ], \x3cspan class=\x22hljs-attr\x22\x3ecorge\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3enode http模块发起请求\x3c\/h2\x3e\n\x3cp\x3e平时喜欢看博客，毕竟买书要钱而且有时候没有耐心读完整本书，所以很喜欢逛一些网站，但是很多时候把所有的站逛一下又没有那么多时间，哈哈，所以就准备把常去的网站的文章爬出来做一个文章列表，一来省去收集的时间，二来借此熟悉熟悉node相关的东西。这里我们首先看一个爬虫的小例子，下面以SF为例加以说明（希望不要被封号）。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3ehttp.request与http.get的区别\x3c\/h3\x3e\n\x3ch4\x3ehttp.request(options, callback)\x3c\/h4\x3e\n\x3cp\x3eoptions可以是一个对象或一个字符串。如果options是一个字符串, 它将自动使用url.parse()解析。http.request() 返回一个 http.ClientRequest类的实例。ClientRequest实例是一个可写流对象。如果需要用POST请求上传一个文件的话，就将其写入到ClientRequest对象。使用http.request()方法时都必须总是调用req.end()以表明这个请求已经完成，即使响应body里没有任何数据。如果在请求期间发生错误（DNS解析、TCP级别的错误或实际HTTP解析错误），在返回的请求对象会触发一个\x27error\x27事件。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eOptions配置说明：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3ehost：请求发送到的服务器的域名或IP地址。默认为\x27localhost\x27。\x3c\/li\x3e\n\x3cli\x3ehostname：用于支持url.parse()。hostname比host更好一些\x3c\/li\x3e\n\x3cli\x3eport：远程服务器的端口。默认值为80。\x3c\/li\x3e\n\x3cli\x3elocalAddress：用于绑定网络连接的本地接口。\x3c\/li\x3e\n\x3cli\x3esocketPath：Unix域套接字（使用host:port或socketPath）\x3c\/li\x3e\n\x3cli\x3emethod：指定HTTP请求方法的字符串。默认为\x27GET\x27。\x3c\/li\x3e\n\x3cli\x3epath：请求路径。默认为\x27\/\x27。如果有查询字符串，则需要包含。例如\x27\/index.html?page=12\x27。请求路径包含非法字符时抛出异常。目前，只否决空格，不过在未来可能改变。\x3c\/li\x3e\n\x3cli\x3eheaders：包含请求头的对象。\x3c\/li\x3e\n\x3cli\x3eauth：用于计算认证头的基本认证，即\x27user:password\x27\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eagent：控制Agent的行为。当使用了一个Agent的时候，请求将默认为Connection: keep-alive。可能的值为：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eundefined（默认）：在这个主机和端口上使用[全局Agent][]。\x3c\/li\x3e\n\x3cli\x3eAgent对象：在Agent中显式使用passed。\x3c\/li\x3e\n\x3cli\x3efalse：在对Agent进行资源池的时候，选择停用连接，默认请求为：Connection: close。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3ekeepAlive：{Boolean} 保持资源池周围的套接字在未来被用于其它请求。默认值为false\x3c\/li\x3e\n\x3cli\x3ekeepAliveMsecs：{Integer} 当使用HTTP KeepAlive的时候，通过正在保持活动的套接字发送TCP KeepAlive包的频繁程度。默认值为1000。仅当keepAlive被设置为true时才相关。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3ehttp.get(options, callback)\x3c\/h4\x3e\n\x3cp\x3e因为大部分的请求是没有报文体的GET请求，所以Node提供了这种便捷的方法。该方法与http.request()的唯一区别是它设置的是GET方法并自动调用req.end()。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e爬虫实例\x3c\/h3\x3e\n\x3cp\x3e这里我们使用es6的新特性写：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const https = require(\x27https\x27);\nhttps.get(\x27https:\/\/segmentfault.com\/blogs\x27, (res) =\x3e {\n    console.log(\x27statusCode: \x27, res.statusCode);\n      console.log(\x27headers: \x27, res.headers);\n      var data = \x27\x27;\n      res.on(\x27data\x27, (chunk) =\x3e {\n        data \x2b= chunk;\n      });\n      res.on(\x27end\x27, () =\x3e {\n          console.log(data);\n      })\n}).on(\x27error\x27, (e) =\x3e {\n      console.error(e);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e https = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27https\x27\x3c\/span\x3e);\nhttps.get(\x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/segmentfault.com\/blogs\x27\x3c\/span\x3e, (res) =\x26gt; {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27statusCode: \x27\x3c\/span\x3e, res.statusCode);\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27headers: \x27\x3c\/span\x3e, res.headers);\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n      res.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, (chunk) =\x26gt; {\n        data \x2b= chunk;\n      });\n      res.on(\x3cspan class=\x22hljs-string\x22\x3e\x27end\x27\x3c\/span\x3e, () =\x26gt; {\n          \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(data);\n      })\n}).on(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e, (e) =\x26gt; {\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样一小段代码我们就可以拿到segmentfault的博客页面的源码，需要说明的是因为这里请求的网站是https协议，所以我们需要引入https模块，用法同http一致。下面需要做的是解析html代码，下面我们需要做的就是解析源码，这里我们可以引入cheerio，一个node版的类jQuery模块，npm地址：\x3ca href=\x22https:\/\/www.npmjs.com\/package\/cheerio\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.npmjs.com\/package...\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e首先第一步安装：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install cheerio\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enpm install cheerio\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后就是将html代码load进来，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var cheerio = require(\x27cheerio\x27),\nvar $ = cheerio.load(html);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cheerio = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27cheerio\x27\x3c\/span\x3e),\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e $ = cheerio.load(html);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后我们就是分析dom结构咯，通过类似于jQuery的方法获取DOM元素的内容，然后就将数据重新组装成json结构的数据。这里就是分析源码然后，这里我就不详细分析了，直接上代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function htmlparser(html){\n    var baseUrl = \x27https:\/\/segmentfault.com\x27;\n    \n    var $ = cheerio.load(html);\n    var bloglist = $(\x27.stream-list__item\x27);\n    \n    var data = [];\n    \n    bloglist.each(function(item){\n        var page = $(this);\n        var summary = page.find(\x27.summary\x27);\n        var blogrank = page.find(\x27.blog-rank\x27);\n        \n        var title = summary.find(\x27.title a\x27).text();\n        var href = baseUrl \x2b summary.find(\x27.title a\x27).attr(\x27href\x27);\n        var author = summary.find(\x27.author li a\x27).first().text().trim();\n        var origin = summary.find(\x27.author li a\x27).last().text().trim();\n        var time = summary.find(\x27.author li span\x27)[0].nextSibling.data.trim();\n        var excerpt = summary.find(\x27p.excerpt\x27).text().trim();\n        var votes = blogrank.find(\x27.votes\x27).text().trim();\n        var views = blogrank.find(\x27.views\x27).text().trim();\n        \n        data.push({\n            title: title,\n            href: href,\n            author: author,\n            origin: origin,\n            time: time,\n            votes: votes,\n            views: views,\n            excerpt: excerpt\n        })\n    })\n    \n    return data;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ehtmlparser\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ehtml\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e baseUrl = \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/segmentfault.com\x27\x3c\/span\x3e;\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e $ = cheerio.load(html);\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e bloglist = $(\x3cspan class=\x22hljs-string\x22\x3e\x27.stream-list__item\x27\x3c\/span\x3e);\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data = [];\n    \n    bloglist.each(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e page = $(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e summary = page.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.summary\x27\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e blogrank = page.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.blog-rank\x27\x3c\/span\x3e);\n        \n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e title = summary.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.title a\x27\x3c\/span\x3e).text();\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e href = baseUrl \x2b summary.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.title a\x27\x3c\/span\x3e).attr(\x3cspan class=\x22hljs-string\x22\x3e\x27href\x27\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e author = summary.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.author li a\x27\x3c\/span\x3e).first().text().trim();\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e origin = summary.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.author li a\x27\x3c\/span\x3e).last().text().trim();\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e time = summary.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.author li span\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].nextSibling.data.trim();\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e excerpt = summary.find(\x3cspan class=\x22hljs-string\x22\x3e\x27p.excerpt\x27\x3c\/span\x3e).text().trim();\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e votes = blogrank.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.votes\x27\x3c\/span\x3e).text().trim();\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e views = blogrank.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.views\x27\x3c\/span\x3e).text().trim();\n        \n        data.push({\n            \x3cspan class=\x22hljs-attr\x22\x3etitle\x3c\/span\x3e: title,\n            \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e: href,\n            \x3cspan class=\x22hljs-attr\x22\x3eauthor\x3c\/span\x3e: author,\n            \x3cspan class=\x22hljs-attr\x22\x3eorigin\x3c\/span\x3e: origin,\n            \x3cspan class=\x22hljs-attr\x22\x3etime\x3c\/span\x3e: time,\n            \x3cspan class=\x22hljs-attr\x22\x3evotes\x3c\/span\x3e: votes,\n            \x3cspan class=\x22hljs-attr\x22\x3eviews\x3c\/span\x3e: views,\n            \x3cspan class=\x22hljs-attr\x22\x3eexcerpt\x3c\/span\x3e: excerpt\n        })\n    })\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e data;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e结果如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22[{ title: \x27转换流\x27,\n    href: \x27https:\/\/segmentfault.com\/a\/1190000007036273\x27,\n    author: \x27SwiftGG翻译组\x27,\n    origin: \x27SwiftGG翻译组\x27,\n    time: \x271 小时前\x27,\n    votes: \x270推荐\x27,\n    views: \x2714浏览\x27,\n    excerpt: \x27作者：Erica Sadun，原文链接，原文日期：2016-08-29译者：Darren；校对：shank\ns；定稿：千叶知风 我在很多地方都表达了我对流的喜爱。我在 Swift Cookbook 中介绍了一些。现\n在，我将通过 Pearson 的内容更新计划...\x27 },\n......\n]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e[{ \x3cspan class=\x22hljs-attr\x22\x3etitle\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27转换流\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/segmentfault.com\/a\/1190000007036273\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eauthor\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27SwiftGG翻译组\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eorigin\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27SwiftGG翻译组\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3etime\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x271 小时前\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3evotes\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x270推荐\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eviews\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2714浏览\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eexcerpt\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27作者：Erica Sadun，原文链接，原文日期：2016-08-29译者：Darren；校对：shank\ns；定稿：千叶知风 我在很多地方都表达了我对流的喜爱。我在 Swift Cookbook 中介绍了一些。现\n在，我将通过 Pearson 的内容更新计划...\x27\x3c\/span\x3e },\n......\n]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里我们只是抓取了文章列表的一页，如果需要抓取多页，只需要将内容再次封装一下，传入一个地址参数?page=2，如：\x3ca href=\x22https:\/\/segmentfault.com\/blogs?page=2\x22\x3ehttps:\/\/segmentfault.com\/blog...\x3c\/a\x3e\x3cbr\x3e另外我们也没有将详情页进一步爬虫，毕竟文章的目的只是学习，同时方便自己查看列表，这里保留原始地址。\x3c\/p\x3e\n\x3cp\x3e温馨提示：大家不要都拿sf做测试哦，不然玩坏了就不好。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e模拟登陆\x3c\/h3\x3e\n\x3cp\x3e哈哈，写到这里已经很晚了，用node试了试模拟登陆SF，结果404，暂时没有什么思路，等有时间再试试专门开篇讲解咯。这里推荐一篇之前看到的文章：\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000003851057\x22 target=\x22_blank\x22\x3e记一次用 NodeJs 实现模拟登录的思路\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e参考\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/nodejs.org\/docs\/latest-v5.x\/api\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3enodejs官网API文档\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.imooc.com\/learn\/348\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e进击Node.js基础（一）\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/nodeapi.ucdok.com\/#\/api\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eNode.js v4.2.4 文档 中文版\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e\x3cp\x3e文章代码源码下载：\x3ca href=\x22https:\/\/github.com\/zhaomenghuan\/learn-javascript\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/zhaomenghu...\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>node学习之路（一）—— 网络请求</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010455932">https://segmentfault.com/a/1190000010455932</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/ndpkulqa9x/" target="_blank">https://alili.tech/archive/ndpkulqa9x/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>