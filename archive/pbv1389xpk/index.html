<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="同源策略与JS跨域（JSONP , CORS）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>同源策略与JS跨域（JSONP , CORS） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/pbv1389xpk/",
				"appid": "1613049289050283", 
				"title": "同源策略与JS跨域（JSONP , CORS） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-13T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/0l4t5koi1d4h/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/4vnxpvp0pkj/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fpbv1389xpk%2f&text=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e4%b8%8eJS%e8%b7%a8%e5%9f%9f%ef%bc%88JSONP%20%2c%20CORS%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fpbv1389xpk%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fpbv1389xpk%2f&text=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e4%b8%8eJS%e8%b7%a8%e5%9f%9f%ef%bc%88JSONP%20%2c%20CORS%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fpbv1389xpk%2f&title=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e4%b8%8eJS%e8%b7%a8%e5%9f%9f%ef%bc%88JSONP%20%2c%20CORS%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fpbv1389xpk%2f&is_video=false&description=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e4%b8%8eJS%e8%b7%a8%e5%9f%9f%ef%bc%88JSONP%20%2c%20CORS%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e4%b8%8eJS%e8%b7%a8%e5%9f%9f%ef%bc%88JSONP%20%2c%20CORS%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fpbv1389xpk%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fpbv1389xpk%2f&title=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e4%b8%8eJS%e8%b7%a8%e5%9f%9f%ef%bc%88JSONP%20%2c%20CORS%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fpbv1389xpk%2f&title=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e4%b8%8eJS%e8%b7%a8%e5%9f%9f%ef%bc%88JSONP%20%2c%20CORS%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fpbv1389xpk%2f&title=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e4%b8%8eJS%e8%b7%a8%e5%9f%9f%ef%bc%88JSONP%20%2c%20CORS%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fpbv1389xpk%2f&title=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e4%b8%8eJS%e8%b7%a8%e5%9f%9f%ef%bc%88JSONP%20%2c%20CORS%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">同源策略与JS跨域（JSONP , CORS）</h1><div class="meta"><div class="postdate"><time datetime="2019-01-13" itemprop="datePublished">2019-01-13</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e本文按照政治问答题必备套路分为以下3个部分：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e为什么要跨域？\x3c\/li\x3e\n\x3cli\x3e跨域是什么？\x3c\/li\x3e\n\x3cli\x3e如何实现跨域？\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3eSection1、为什么要跨域？\x3c\/h1\x3e\n\x3cp\x3e自古以来（1995年起），为了用户的信息安全，浏览器就引入了同源策略。那么同源策略是如何保证用户的信息安全的呢？\x3c\/p\x3e\n\x3cp\x3e栗子1：如果没有同源策略，你打开了你的银行账户页面A，又打开了另一个不相关的页面B，这时候如果B是恶意网站，B可以通过Javascript轻松访问和修改A页面中的内容。\x3c\/p\x3e\n\x3cp\x3e栗子2：现在我们广泛的使用cookie来维护用户的登录状态，而如果没有同源策略，这些cookie信息就会泄露，其他网站就可以冒充这个登录用户。\x3c\/p\x3e\n\x3cp\x3e由此可以看出，同源策略确实是必不可少的，那么它会带来哪些限制呢？\x3c\/p\x3e\n\x3cp\x3e1、Cookie、LocalStorage和IndexDB无法读取。\x3cbr\x3e2、DOM无法获得。\x3cbr\x3e3、AJAX请求不能发送。\x3c\/p\x3e\n\x3cp\x3e有时候我们需要突破上述限制，就需要用跨域的方法来解决。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3eSection2、跨域是什么？\x3c\/h1\x3e\n\x3cp\x3e什么叫做不同的域？比如：\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.a.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.a.com\x3c\/a\x3e:8000\/a.js\x3cbr\x3e协议（http）、域名（www.a.com）、端口（8000）三者中有一个不同就叫不同的域。\x3c\/p\x3e\n\x3cp\x3e跨域就是不同的域间相互访问时使用某些方法来突破上述限制。\x3c\/p\x3e\n\x3cp\x3e【注意：协议或者端口的不同，只能通过后台来解决。】\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3eSection3、怎么跨域？\x3c\/h1\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e一、解决Section1中提到的1、2两点限制：\x3c\/h2\x3e\n\x3cp\x3e1.Cookie、LocalStorage和IndexDB无法读取。\x3cbr\x3e2.DOM无法获得。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e方法1、通过document.domain跨子域\x3c\/h3\x3e\n\x3cp\x3e【适用范围：（1）两个域只是子域不同；（2）只适用于\x3cb\x3eiframe窗口与父窗口之间\x3c\/b\x3e互相获取cookie和DOM节点，不能突破LocalStorage和IndexDB的限制。】\x3c\/p\x3e\n\x3cp\x3e当两个不同的域只是子域不同时，可以通过把document.domain设置为他们共同的父域来解决。\x3c\/p\x3e\n\x3cp\x3e栗子：\x3c\/p\x3e\n\x3cp\x3eA: \x3ca href=\x22http:\/\/www.example.com\/a.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.example.com\/a.html\x3c\/a\x3e\x3cbr\x3eB: \x3ca href=\x22http:\/\/example.com\/b.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/example.com\/b.html\x3c\/a\x3e\x3cbr\x3e当A、B想要获取对方的\x3cb\x3ecookie或者DOM节点\x3c\/b\x3e时，可以设置:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22document.domain=\x27example.com\x27;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.domain=\x3cspan class=\x22hljs-string\x22\x3e\x27example.com\x27\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e来解决。\x3c\/p\x3e\n\x3cp\x3e这时A网页通过脚本设置:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22document.cookie = \x26quot;testA=hello\x26quot;;\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs abnf\x22\x3e\x3ccode\x3edocument.cookie = \x3cspan class=\x22hljs-string\x22\x3e\x22testA=hello\x22\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eB网页就可以拿到这个cookie：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var aCookie = document.cookie;\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dart\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e aCookie = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.cookie;\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e方法2、通过window.name跨域\x3c\/h3\x3e\n\x3cp\x3e【适用范围：（1）可以是两个完全不同源的域；（2）同一个窗口内：即同一个标签页内先后打开的窗口。】\x3c\/p\x3e\n\x3cp\x3epre-condition：\x3c\/p\x3e\n\x3cp\x3ewindow.name属性有个特征：即在一个窗口(window)的生命周期内,窗口载入的所有的页面都是共享一个window.name的，每个页面对window.name都有读写的权限，window.name是持久存在一个窗口载入过的所有页面中的。\x3c\/p\x3e\n\x3cp\x3e基于这个思想，我们可以在某个页面设置好 window.name 的值，然后在本标签页内跳转到另外一个域下的页面。在这个页面中就可以获取到我们刚刚设置的 window.name 了。\x3c\/p\x3e\n\x3cp\x3e结合iframe还有更高级的用法：\x3c\/p\x3e\n\x3cp\x3e父窗口先打开一个与自己不同源的子窗口，在这个子窗口里设置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.name = data;\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fortran\x22\x3e\x3ccode\x3ewindow.\x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后让子窗口跳转到一个与父窗口同域的网址：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22location=\x27http:\/\/www.parent.com\/a.html\x27;\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ebnf\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attribute\x22\x3elocation\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/www.parent.com\/a.html\x27\x3c\/span\x3e;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这时，因为同域并且同一窗口window.name是不变的，所以父窗口可以获取到子窗口下的window.name。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var data = document.getElementById(\x27myFrame\x27).contentWindow.name;\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dart\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27myFrame\x27\x3c\/span\x3e).contentWindow.name;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e优点：window.name容量很大，可以放置非常长的字符串；缺点：必须监听子窗口window.name属性的变化，影响网页性能。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e方法3、使用HTML5的window.postMessage跨域\x3c\/h3\x3e\n\x3cp\x3ewindow.postMessage(message,targetOrigin) 方法是html5新引进的特性，可以使用它来向其它的window对象发送消息，无论这个window对象是属于同源或不同源，目前IE8\x2b、FireFox、Chrome、Opera等浏览器都已经支持window.postMessage方法。\x3c\/p\x3e\n\x3cp\x3e\x3cb\x3eotherWindow.postMessage(message, targetOrigin);\x3c\/b\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cb\x3eotherWindow:\x3c\/b\x3e接受消息页面的window的引用。可以是页面中iframe的contentWindow属性；window.open的返回值；通过name或下标从window.frames取到的值。\x3cbr\x3e\x3cb\x3emessage:\x3c\/b\x3e所要发送的数据，string类型。\x3cbr\x3e\x3cb\x3etargetOrigin:\x3c\/b\x3e用于限制otherWindow，*表示不做限制。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e栗子1：\x3c\/h3\x3e\n\x3cp\x3e在父页面中嵌入子页面，通过postMessage发送数据。\x3cbr\x3eparent.com\/index.html中的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3ciframe id=\x26quot;ifr\x26quot; src=\x26quot;child.com\/index.html\x26quot;\x3e\x3c\/iframe\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\nwindow.onload = function() {\n    var ifr = document.getElementById(\x27ifr\x27);\n    var targetOrigin = \x27http:\/\/child.com\x27; \n    \/\/ 若写成\x27http:\/\/child.com\/c\/proxy.html\x27效果一样\n    \/\/ 若写成\x27http:\/\/c.com\x27就不会执行postMessage了\n    ifr.contentWindow.postMessage(\x27I was there!\x27, targetOrigin);\n};\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22ifr\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22child.com\/index.html\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ifr = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27ifr\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e targetOrigin = \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/child.com\x27\x3c\/span\x3e; \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 若写成\x27http:\/\/child.com\/c\/proxy.html\x27效果一样\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 若写成\x27http:\/\/c.com\x27就不会执行postMessage了\x3c\/span\x3e\n    ifr.contentWindow.postMessage(\x3cspan class=\x22hljs-string\x22\x3e\x27I was there!\x27\x3c\/span\x3e, targetOrigin);\n};\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在子页面中通过message事件监听父页面发送来的消息并显示。\x3cbr\x3echild.com\/index.html中的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\nwindow.addEventListener(\x27message\x27, function(event){\n    \/\/ 通过origin属性判断消息来源地址\n    if (event.origin == \x27http:\/\/parent.com\x27) {\n        alert(event.data);    \/\/ 弹出\x26quot;I was there!\x26quot;\n        alert(event.source);  \n        \/\/ 对parent.com、index.html中window对象的引用\n        \/\/ 但由于同源策略，这里event.source不可以访问window对象\n    }\n}, false);\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27message\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 通过origin属性判断消息来源地址\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.origin == \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/parent.com\x27\x3c\/span\x3e) {\n        alert(event.data);    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 弹出\x22I was there!\x22\x3c\/span\x3e\n        alert(event.source);  \n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 对parent.com、index.html中window对象的引用\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 但由于同源策略，这里event.source不可以访问window对象\x3c\/span\x3e\n    }\n}, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e栗子2：\x3c\/h3\x3e\n\x3cp\x3e假设在a.html里嵌套个\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3ciframe src=\x26quot;http:\/\/www.child.com\/b.html\x26quot; frameborder=\x26quot;0\x26quot;\x3e\x3c\/iframe\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/www.child.com\/b.html\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eframeborder\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x220\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在这两个页面里互相通信\x3c\/p\x3e\n\x3cp\x3ea.html\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.onload = function() {\n    window.addEventListener(\x26quot;message\x26quot;, function(e) {\n        alert(e.data);\n    });\n\n    window.frames[0].postMessage(\x26quot;b data\x26quot;, \x26quot;http:\/\/www.child.com\/b.html\x26quot;);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22message\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n        alert(e.data);\n    });\n\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.frames[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].postMessage(\x3cspan class=\x22hljs-string\x22\x3e\x22b data\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/www.child.com\/b.html\x22\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eb.html\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.onload = function() {\n    window.addEventListener(\x26quot;message\x26quot;, function(e) {\n        alert(e.data);\n    });\n    window.parent.postMessage(\x26quot;a data\x26quot;, \x26quot;http:\/\/www.parent.com\/a.html\x26quot;);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22message\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n        alert(e.data);\n    });\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.parent.postMessage(\x3cspan class=\x22hljs-string\x22\x3e\x22a data\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/www.parent.com\/a.html\x22\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样打开a页面，首先监听到了b.html通过postMessage传来的消息，就先弹出 a data，然后a通过postMessage传递消息给子页面b.html，这时会弹出 b data。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e二、解决第3点限制：\x3c\/h2\x3e\n\x3cp\x3e3）AJAX请求不能发送。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e方法4、通过JSONP跨域\x3c\/h3\x3e\n\x3cp\x3e【适用范围：（1）可以是两个完全不同源的域；（2）只支持HTTP请求中的GET方式；（3）老式浏览器全部支持；（4）需要服务端支持】\x3c\/p\x3e\n\x3cp\x3eJSONP(JSON with Padding)是资料格式JSON的一种使用模式，可以让网页从别的网域要资料。\x3c\/p\x3e\n\x3cp\x3e由于浏览器的同源策略，在网页端出现了这个“跨域”的问题，然而我们发现，所有的 src 属性并没有受到相关的限制，比如 img \/ script 等。\x3c\/p\x3e\n\x3cp\x3eJSONP 的原理就要从 script 说起。script 可以引用其他域的脚本文件，比如这样：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22a.html\n...\n\x3cscript\x3e\n    function callback(data) {\n        console.log(data.url)\n    }\n\x3c\/script\x3e\n\x3cscript src=\x27b.js\x27\x3e\x3c\/script\x3e\n...\n\nb.js\ncallback({url: \x27http:\/\/www.rccoder.net\x27})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3ea.html\n...\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecallback\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(data.url)\n    }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x27b.js\x27\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n...\n\nb.js\ncallback({url: \x27http:\/\/www.rccoder.net\x27})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这就类似于JSONP的原理了。\x3c\/p\x3e\n\x3cp\x3eJSONP的基本思想是：先在网页上添加一个script标签，设置这个script标签的src属性用于向服务器请求JSON数据 ，需要注意的是，src属性的查询字符串一定要加一个callback参数，用来指定回调函数的名字 。而这个函数是在资源加载之前就已经在前端定义好的，这个函数接受一个参数并利用这个参数做一些事情。向服务器请求后，服务器会将JSON数据放在一个指定名字的回调函数里作为其参数传回来。这时，因为函数已经在前端定义好了，所以会直接调用。\x3c\/p\x3e\n\x3cp\x3e一个栗子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function addScriptTag(src) {\n    var script = document.createElement(\x27script\x27);\n    script.setAttribute(\x26quot;type\x26quot;,\x26quot;text\/javascript\x26quot;);\n    script.src = src;\n    document.body.appendChild(script);\n}\n\nwindow.onload = function () {\n    addScriptTag(\x27http:\/\/example.com\/ip?callback=foo\x27);\/\/请求服务器数据并规定回调函数为foo\n}\n\nfunction foo(data) {\n    console.log(\x27Your public IP address is: \x27 \x2b data.ip);\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eaddScriptTag\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3esrc\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e script = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27script\x27\x3c\/span\x3e);\n    script.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e);\n    script.src = src;\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(script);\n}\n\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    addScriptTag(\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/example.com\/ip?callback=foo\x27\x3c\/span\x3e);\x3cspan class=\x22hljs-comment\x22\x3e\/\/请求服务器数据并规定回调函数为foo\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efoo\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27Your public IP address is: \x27\x3c\/span\x3e \x2b data.ip);\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e向服务器example.com请求数据，这时服务器会先生成JSON数据，这里是{\x22ip\x22: \x228.8.8.8\x22}，然后以JS语法的方式生成一个函数，函数名就是传递上来的callback参数的值，最后将数据放在函数的参数中返回：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22foo({\n    \x26quot;ip\x26quot;: \x26quot;8.8.8.8\x26quot;\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lisp\x22\x3e\x3ccode\x3efoo({\n    \x3cspan class=\x22hljs-string\x22\x3e\x22ip\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x228.8.8.8\x22\x3c\/span\x3e\n})\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e客户端解析script标签，执行返回的JS代码，调用函数。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e方法5、通过CORS跨域\x3c\/h3\x3e\n\x3cp\x3e【适用范围：（1）可以是两个完全不同源的域；（2）支持所有类型的HTTP请求；（3）被绝大多数现代浏览器支持，老式浏览器不支持；（4）需要服务端支持】\x3c\/p\x3e\n\x3cp\x3e对于前端开发者来说，跨域的CORS通信与同源的AJAX通信没有差别，代码完全一样。因此，实现CORS通信的关键是服务器。\x3cb\x3e只要服务器实现了CORS接口，就可以跨源通信。\x3c\/b\x3e\x3c\/p\x3e\n\x3cp\x3e浏览器将CORS请求分成两类：简单请求（simple request）和非简单请求（not-so-simple request）。\x3c\/p\x3e\n\x3cp\x3e只要同时满足以下两大条件，就属于简单请求。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22（1) 请求方法是以下三种方法之一：\nHEAD\nGET\nPOST\n（2）HTTP的头信息不超出以下几种字段：\nAccept\nAccept-Language\nContent-Language\nLast-Event-ID\nContent-Type：只限于三个值application\/x-www-form-urlencoded、multipart\/form-data、text\/plain\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3e（1) 请求方法是以下三种方法之一：\nHEAD\n\x3cspan class=\x22hljs-built_in\x22\x3eGET\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3ePOST\x3c\/span\x3e\n（2）HTTP的头信息不超出以下几种字段：\nAccept\nAccept-Language\nContent-Language\nLast-Event-ID\nContent-\x3cspan class=\x22hljs-keyword\x22\x3eType\x3c\/span\x3e：只限于三个值application\/x-www-\x3cspan class=\x22hljs-keyword\x22\x3eform\x3c\/span\x3e-urlencoded、multipart\/\x3cspan class=\x22hljs-keyword\x22\x3eform\x3c\/span\x3e-data、text\/plain\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e凡是不同时满足上面两个条件，就属于非简单请求。\x3cbr\x3e浏览器对这两种请求的处理，是不一样的。\x3c\/p\x3e\n\x3ch4\x3e简单请求：\x3c\/h4\x3e\n\x3cp\x3e下面是一次跨源AJAX请求，浏览器发现它是简单请求，就会直接在头信息中加一个origin字段：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22GET \/cors HTTP\/1.1\nOrigin: http:\/\/api.bob.com\nHost: api.alice.com\nAccept-Language: en-US\nConnection: keep-alive\nUser-Agent: Mozilla\/5.0...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs http\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eGET\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\/cors\x3c\/span\x3e HTTP\/1.1\n\x3cspan class=\x22hljs-attribute\x22\x3eOrigin\x3c\/span\x3e: http:\/\/api.bob.com\n\x3cspan class=\x22hljs-attribute\x22\x3eHost\x3c\/span\x3e: api.alice.com\n\x3cspan class=\x22hljs-attribute\x22\x3eAccept-Language\x3c\/span\x3e: en-US\n\x3cspan class=\x22hljs-attribute\x22\x3eConnection\x3c\/span\x3e: keep-alive\n\x3cspan class=\x22hljs-attribute\x22\x3eUser-Agent\x3c\/span\x3e: Mozilla\/5.0...\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e服务器收到这条请求，如果这个origin指定的源在许可范围内，那么服务器返回的头信息中会包含Access-Control-Allow-Origin字段，值与origin的值相同，以及其他几个相关字段：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Origin: http:\/\/api.bob.com\nAccess-Control-Allow-Credentials: true\nAccess-Control-Expose-Headers: FooBar\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3eAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/api.bob.com\x3c\/span\x3e\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eCredentials:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\nAccess-Control-Expose-\x3cspan class=\x22hljs-string\x22\x3eHeaders:\x3c\/span\x3e FooBar\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cb\x3eAccess-Control-Allow-Origin: \x3c\/b\x3e该字段是必须的。要么与origin相同，要么为*\x3cbr\x3e\x3cb\x3eAccess-Control-Allow-Credentials: \x3c\/b\x3e该字段可选。设为true表示服务器允许发送cookie\x3cbr\x3e\x3cb\x3eAccess-Control-Expose-Headers: \x3c\/b\x3e该字段可选。CORS请求时，XMLHttpRequest对象的getResponseHeader()方法只能拿到6个基本字段：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma。如果想拿到其他字段，就必须在Access-Control-Expose-Headers里面指定。上面的例子指定，getResponseHeader(\x27FooBar\x27)可以返回FooBar字段的值。\x3c\/p\x3e\n\x3cp\x3e想要发送cookie，这里还有两点需要额外注意：\x3c\/p\x3e\n\x3cp\x3e1）开发者必须在AJAX请求中打开withCredentials属性。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\nxhr.withCredentials = true;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eXMLHttpRequest\x3c\/span\x3e();\nxhr.withCredentials = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e否则即使服务器允许，客户端也不会发送。\x3c\/p\x3e\n\x3cp\x3e2）Access-Control-Allow-Origin不能设为星号，必须指定明确的、与请求网页一致的域名。同时，Cookie依然遵循同源政策，只有用服务器域名设置的Cookie才会上传，其他域名的Cookie并不会上传，且（跨源）原网页代码中的document.cookie也无法读取服务器域名下的Cookie。\x3c\/p\x3e\n\x3ch4\x3e非简单请求：\x3c\/h4\x3e\n\x3cp\x3e1.预检请求：\x3c\/p\x3e\n\x3cp\x3e非简单请求会在正式通信前加一次预检（preflight）请求。作用是浏览器先询问服务器当前网页所在域名是否在服务器的许可名单中，以及可以使用哪些HTTP方法以及头信息字段。只有得到肯定答复，浏览器才会发送XMLHttpRequest，否则报错。\x3c\/p\x3e\n\x3cp\x3e一个栗子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var url = \x27http:\/\/api.alice.com\/cors\x27;\nvar xhr = new XMLHttpRequest();\nxhr.open(\x27PUT\x27, url, true);\nxhr.setRequestHeader(\x27X-Custom-Header\x27, \x27value\x27);\nxhr.send();\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/api.alice.com\/cors\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27PUT\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\nxhr.setRequestHeader(\x3cspan class=\x22hljs-string\x22\x3e\x27X-Custom-Header\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27value\x27\x3c\/span\x3e);\nxhr.send();\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eHTTP请求方法为PUT，并发送一个自定义头信息\x22X-Custom-Header\x22，浏览器发现这是一个非简单请求，就会自动发送一个预检请求，预检请求的HTTP头信息如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22OPTIONS \/cors HTTP\/1.1\nOrigin: http:\/\/api.bob.com\nAccess-Control-Request-Method: PUT\nAccess-Control-Request-Headers: X-Custom-Header\nHost: api.alice.com\nAccept-Language: en-US\nConnection: keep-alive\nUser-Agent: Mozilla\/5.0...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs oxygene\x22\x3e\x3ccode\x3eOPTIONS \/cors HTTP\/\x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e\nOrigin: http:\x3cspan class=\x22hljs-comment\x22\x3e\/\/api.bob.com\x3c\/span\x3e\nAccess-Control-Request-\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eMethod\x3c\/span\x3e:\x3c\/span\x3e PUT\nAccess-Control-Request-Headers: X-Custom-Header\nHost: api.alice.com\nAccept-Language: en-US\nConnection: keep-alive\nUser-Agent: Mozilla\/\x3cspan class=\x22hljs-number\x22\x3e5.0\x3c\/span\x3e...\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e请求方法是OPTIONS，表示这个请求是用来询问的，头信息中的关键信息有3个：\x3c\/p\x3e\n\x3cp\x3e（1）表示请求来自哪个源\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Origin: http:\/\/api.bob.com\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/api.bob.com\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e（2）列出浏览器的CORS请求会用到哪些HTTP方法\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\nAccess-Control-Request-Method: PUT\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs oxygene\x22\x3e\x3ccode\x3e\nAccess-Control-Request-\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eMethod\x3c\/span\x3e:\x3c\/span\x3e PUT\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e（3）指定浏览器CORS请求会额外发送的头信息字段\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Request-Headers: X-Custom-Header\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eAccess\x3c\/span\x3e-Control-Request-Headers: X-Custom-Header\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.预检请求的回应（有两种情况：A允许、B不允许）\x3c\/p\x3e\n\x3cp\x3eA.服务器允许这次跨域请求\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22HTTP\/1.1 200 OK\nDate: Mon, 01 Dec 2008 01:15:39 GMT\nServer: Apache\/2.0.61 (Unix)\nAccess-Control-Allow-Origin: http:\/\/api.bob.com\nAccess-Control-Allow-Methods: GET, POST, PUT\nAccess-Control-Allow-Headers: X-Custom-Header\nContent-Type: text\/html; charset=utf-8\nContent-Encoding: gzip\nContent-Length: 0\nKeep-Alive: timeout=2, max=100\nConnection: Keep-Alive\nContent-Type: text\/plain\nAccess-Control-Allow-Credentials: true\nAccess-Control-Max-Age: 1728000\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3eHTTP\/\x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e OK\n\x3cspan class=\x22hljs-string\x22\x3eDate:\x3c\/span\x3e Mon, \x3cspan class=\x22hljs-number\x22\x3e01\x3c\/span\x3e Dec \x3cspan class=\x22hljs-number\x22\x3e2008\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e01\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e15\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e39\x3c\/span\x3e GMT\n\x3cspan class=\x22hljs-string\x22\x3eServer:\x3c\/span\x3e Apache\/\x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e.61\x3c\/span\x3e (Unix)\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/api.bob.com\x3c\/span\x3e\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eMethods:\x3c\/span\x3e GET, POST, PUT\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eHeaders:\x3c\/span\x3e X-Custom-Header\nContent-\x3cspan class=\x22hljs-string\x22\x3eType:\x3c\/span\x3e text\/html; charset=utf\x3cspan class=\x22hljs-number\x22\x3e-8\x3c\/span\x3e\nContent-\x3cspan class=\x22hljs-string\x22\x3eEncoding:\x3c\/span\x3e gzip\nContent-\x3cspan class=\x22hljs-string\x22\x3eLength:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\nKeep-\x3cspan class=\x22hljs-string\x22\x3eAlive:\x3c\/span\x3e timeout=\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, max=\x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eConnection:\x3c\/span\x3e Keep-Alive\nContent-\x3cspan class=\x22hljs-string\x22\x3eType:\x3c\/span\x3e text\/plain\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eCredentials:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\nAccess-Control-Max-\x3cspan class=\x22hljs-string\x22\x3eAge:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1728000\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e服务器返回中要注意的字段：\x3c\/p\x3e\n\x3cp\x3e（1）服务器同意的跨域请求源：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Origin: http:\/\/api.bob.com\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/api.bob.com\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e（2）服务器支持的所有跨域请求的方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 Access-Control-Allow-Methods: GET, POST, PUT   \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e \x3cspan class=\x22hljs-keyword\x22\x3eAccess\x3c\/span\x3e-Control-Allow-Methods: GET, POST, PUT   \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e（3）表明服务器支持的所有头信息字段：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Headers: X-Custom-Header\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eAccess\x3c\/span\x3e-Control-Allow-Headers: X-Custom-Header\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e（4）指定本次预检请求的有效期，单位为秒，即允许请求该条回应在有效期之前都不用再发送预检请求：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Max-Age: 1728000\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fortran\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eAccess\x3c\/span\x3e-Control-\x3cspan class=\x22hljs-built_in\x22\x3eMax\x3c\/span\x3e-Age: \x3cspan class=\x22hljs-number\x22\x3e1728000\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eB.服务器不允许这次跨域请求\x3cbr\x3e即origin指定的源不在许可范围内，服务器会返回一个正常的HTTP回应。但是头信息中没有包含Access-Control-Allow-Origin字段，就知道出错了，从而抛出一个错误，被XMLHttpRequest的onerror回调函数捕获。但是要注意的是，这种HTTP回应的状态码很有可能是200，所以无法通过状态码识别这种错误。\x3c\/p\x3e\n\x3cp\x3e3.正式请求\x3cbr\x3e过了预检请求，非简单请求的正式请求就与简单请求一样了。\x3c\/p\x3e\n\x3ch4\x3e参考资料\x3c\/h4\x3e\n\x3col\x3e\n\x3cli\x3e《Javascript高级程序设计》 P582\x3c\/li\x3e\n\x3cli\x3e《Javascript权威指南》 P668 22.3 跨域消息传递\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2016\/04\/same-origin-policy.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.ruanyifeng.com\/blo...\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2016\/04\/cors.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.ruanyifeng.com\/blo...\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000000718840\x22\x3ehttps:\/\/segmentfault.com\/a\/11...\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000003642057#articleHeader3\x22 target=\x22_blank\x22\x3ehttps:\/\/segmentfault.com\/a\/11...\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000003882126\x22\x3ehttps:\/\/segmentfault.com\/a\/11...\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/rainman\/archive\/2011\/02\/20\/1959325.html#m5\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.cnblogs.com\/rainma...\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>同源策略与JS跨域（JSONP , CORS）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009624849">https://segmentfault.com/a/1190000009624849</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/pbv1389xpk/" target="_blank">https://alili.tech/archive/pbv1389xpk/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>