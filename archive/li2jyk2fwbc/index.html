<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="使用 AVA 做自动化测试"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>使用 AVA 做自动化测试 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/li2jyk2fwbc/",
				"appid": "1613049289050283", 
				"title": "使用 AVA 做自动化测试 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-06T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/intcmuqtk4/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/p0ig7q2v9ac/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fli2jyk2fwbc%2f&text=%e4%bd%bf%e7%94%a8%20AVA%20%e5%81%9a%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fli2jyk2fwbc%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fli2jyk2fwbc%2f&text=%e4%bd%bf%e7%94%a8%20AVA%20%e5%81%9a%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fli2jyk2fwbc%2f&title=%e4%bd%bf%e7%94%a8%20AVA%20%e5%81%9a%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fli2jyk2fwbc%2f&is_video=false&description=%e4%bd%bf%e7%94%a8%20AVA%20%e5%81%9a%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%bf%e7%94%a8%20AVA%20%e5%81%9a%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fli2jyk2fwbc%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fli2jyk2fwbc%2f&title=%e4%bd%bf%e7%94%a8%20AVA%20%e5%81%9a%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fli2jyk2fwbc%2f&title=%e4%bd%bf%e7%94%a8%20AVA%20%e5%81%9a%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fli2jyk2fwbc%2f&title=%e4%bd%bf%e7%94%a8%20AVA%20%e5%81%9a%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fli2jyk2fwbc%2f&title=%e4%bd%bf%e7%94%a8%20AVA%20%e5%81%9a%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">使用 AVA 做自动化测试</h1><div class="meta"><div class="postdate"><time datetime="2019-01-06" itemprop="datePublished">2019-01-06</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch3 id=\x22articleHeader0\x22\x3e目录\x3c\/h3\x3e\n\x3cp\x3e1、为什么选择 AVA ？\x3cbr\x3e2、API 概览。\x3cbr\x3e3、准备工作。\x3cbr\x3e4、单元测试，测试一个简单的工具函数。\x3cbr\x3e5、使用 Promise、Async\/await、Observable 。\x3cbr\x3e6、使用 JSDOM 模拟浏览器环境。\x3cbr\x3e7、单元测试，测试一个简单的 React 组件。\x3cbr\x3e8、Http 接口测试，GitHub 用户信息接口测试。\x3cbr\x3e9、串行测试。\x3cbr\x3e10、快照断言。\x3cbr\x3e11、覆盖率报告：nyc \x2b Coveralls 。\x3cbr\x3e12、持续集成：CircleCI 。\x3cbr\x3e13、学习借鉴，一些使用 AVA 做测试的开源项目。\x3cbr\x3e14、e2e测试框架推荐：TestCafe 。\x3cbr\x3e15、参考。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e为什么选择 AVA\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e原子测试 - 名词的链接属于自己猜测，不知作者本人是否也是表达这个意思。\x3cbr\x3e断言 - 通俗的讲，就是用来判断 \x3ccode\x3e“ 函数的返回值 ”\x3c\/code\x3e 与我们想要的值是否一致，一致则测试通过，不一致则不通过。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e1、轻量，高效，简单。\x3cbr\x3e2、并发测试，强制编写\x3ca href=\x22https:\/\/baike.baidu.com\/item\/%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e原子测试\x3c\/a\x3e。\x3cbr\x3e3、没有隐藏的全局变量，每个测试文件独立环境。\x3cbr\x3e4、支持 ES2017，Promise，Generator，Async，Observable。\x3cbr\x3e5、内置断言，强化断言信息。\x3cbr\x3e6、\x3ca href=\x22https:\/\/github.com\/avajs\/ava#tap-reporter\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e可选的 TAP 输出显示\x3c\/a\x3e。\x3cbr\x3e7、为什么不用 Mocha，Tape，Tap？\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e官方文档解释：\x3ca href=\x22https:\/\/github.com\/avajs\/ava#faq\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/avajs\/ava#faq\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3e一些测试框架的对比：\x3ca href=\x22https:\/\/github.com\/koajs\/koa\/issues\/703\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/koajs\/koa\/...\x3c\/a\x3e\n\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3eAPI 概览\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22test([title], implementation)                     基本测试\ntest.serial([title], implementation)              串行运行测试\ntest.cb([title], implementation)                  回调函数形式\ntest.only([title], implementation)                运行指定的测试\ntest.skip([title], implementation)                跳过测试\ntest.todo(title)                                  备忘测试\ntest.failing([title], implementation)             失败的测试\ntest.before([title], implementation)              钩子函数，这个会在所有测试前运行\ntest.after([title], implementation)               钩子函数，这个会在所有测试之后运行\ntest.beforeEach([title], implementation)          钩子函数，这个会在每个测试之前运行\ntest.afterEach([title], implementation)           钩子函数，这个会在每个测试之后运行\ntest.after.always([title], implementation)        钩子函数，这个会在所有测试之后运行，不管之前的测试是否失败\ntest.afterEach.always([title], implementation)    钩子函数，这个会在每个测试之后运行，不管之前的测试是否失败\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)                     基本测试\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.serial\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)              串行运行测试\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.cb\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)                  回调函数形式\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.only\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)                运行指定的测试\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.skip\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)                跳过测试\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.todo\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-tag\x22\x3etitle\x3c\/span\x3e)                                  备忘测试\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.failing\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)             失败的测试\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.before\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)              钩子函数，这个会在所有测试前运行\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.after\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)               钩子函数，这个会在所有测试之后运行\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.beforeEach\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)          钩子函数，这个会在每个测试之前运行\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.afterEach\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)           钩子函数，这个会在每个测试之后运行\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.after\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.always\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)        钩子函数，这个会在所有测试之后运行，不管之前的测试是否失败\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.afterEach\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.always\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-attr\x22\x3e[title]\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3eimplementation\x3c\/span\x3e)    钩子函数，这个会在每个测试之后运行，不管之前的测试是否失败\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e内置断言\x3c\/h4\x3e\n\x3cblockquote\x3e\x3cp\x3e也可以用 \x3ccode\x3echai\x3c\/code\x3e, \x3ccode\x3enode assert\x3c\/code\x3e 等其他断言库\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.pass([message])                                  测试通过\n.fail([message])                                  断言失败\n.truthy(value, [message])                         断言 value 是否是真值\n.falsy(value, [message])                          断言 value 是否是假值\n.true(value, [message])                           断言 value 是否是 true\n.false(value, [message])                          断言 value 是否是 false\n.is(value, expected, [message])                   断言 value 是否和 expected 相等\n.not(value, expected, [message])                  断言 value 是否和 expected 不等\n.deepEqual(value, expected, [message])            断言 value 是否和 expected 深度相等\n.notDeepEqual(value, expected, [message])         断言 value 是否和 expected 深度不等\n.throws(function|promise, [error, [message]])     断言 function 抛出一个异常，或者 promise reject 一个错误\n.notThrows(function|promise, [message])           断言 function 没有抛出一个异常，或者 promise resolve\n.regex(contents, regex, [message])                断言 contents 匹配 regex\n.notRegex(contents, regex, [message])             断言 contents 不匹配 regex\n.ifError(error, [message])                        断言 error 是假值\n.snapshot(expected, [message])                    将预期值与先前记录的快照进行比较\n.snapshot(expected, [options], [message])         将预期值与先前记录的快照进行比较\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs delphi\x22\x3e\x3ccode\x3e.pass([\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])                                  测试通过\n.fail([\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])                                  断言失败\n.truthy(value, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])                         断言 value 是否是真值\n.falsy(value, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])                          断言 value 是否是假值\n.true(value, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])                           断言 value 是否是 true\n.false(value, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])                          断言 value 是否是 false\n.\x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e(value, expected, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])                   断言 value 是否和 expected 相等\n.\x3cspan class=\x22hljs-keyword\x22\x3enot\x3c\/span\x3e(value, expected, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])                  断言 value 是否和 expected 不等\n.deepEqual(value, expected, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])            断言 value 是否和 expected 深度相等\n.notDeepEqual(value, expected, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])         断言 value 是否和 expected 深度不等\n.throws(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e|\x3cspan class=\x22hljs-title\x22\x3epromise\x3c\/span\x3e, [\x3cspan class=\x22hljs-title\x22\x3eerror\x3c\/span\x3e, [\x3cspan class=\x22hljs-title\x22\x3emessage\x3c\/span\x3e]])     断言 \x3cspan class=\x22hljs-title\x22\x3efunction\x3c\/span\x3e 抛出一个异常，或者 \x3cspan class=\x22hljs-title\x22\x3epromise\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ereject\x3c\/span\x3e 一个错误\n.\x3cspan class=\x22hljs-title\x22\x3enotThrows\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e|promise, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])\x3c\/span\x3e           断言 \x3cspan class=\x22hljs-title\x22\x3efunction\x3c\/span\x3e 没有抛出一个异常，或者 \x3cspan class=\x22hljs-title\x22\x3epromise\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eresolve\x3c\/span\x3e\n.\x3cspan class=\x22hljs-title\x22\x3eregex\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(contents, regex, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])\x3c\/span\x3e                断言 \x3cspan class=\x22hljs-title\x22\x3econtents\x3c\/span\x3e 匹配 \x3cspan class=\x22hljs-title\x22\x3eregex\x3c\/span\x3e\n.\x3cspan class=\x22hljs-title\x22\x3enotRegex\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(contents, regex, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])\x3c\/span\x3e             断言 \x3cspan class=\x22hljs-title\x22\x3econtents\x3c\/span\x3e 不匹配 \x3cspan class=\x22hljs-title\x22\x3eregex\x3c\/span\x3e\n.\x3cspan class=\x22hljs-title\x22\x3eifError\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(error, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])\x3c\/span\x3e                        断言 \x3cspan class=\x22hljs-title\x22\x3eerror\x3c\/span\x3e 是假值\n.\x3cspan class=\x22hljs-title\x22\x3esnapshot\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(expected, [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])\x3c\/span\x3e                    将预期值与先前记录的快照进行比较\n.\x3cspan class=\x22hljs-title\x22\x3esnapshot\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(expected, [options], [\x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e])\x3c\/span\x3e         将预期值与先前记录的快照进行比较\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e准备工作\x3c\/h3\x3e\n\x3cp\x3e务虚已过，编写测试用例之前我们需要先安装 \x3ccode\x3eAVA\x3c\/code\x3e。\x3cbr\x3e先全局安装：\x3ccode\x3enpm i --global ava\x3c\/code\x3e\x3cbr\x3e再在项目根目录安装一次：\x3ccode\x3enpm i --save-dev ava\x3c\/code\x3e\x3cbr\x3e\x3cem\x3e这是通俗的安装方式，全局安装方便 AVA 自身命令行调用，不用太纠结。\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e像我们刚刚说的，\x3ccode\x3eAVA\x3c\/code\x3e 已经内置支持 \x3ccode\x3eES2017\x3c\/code\x3e 的语法，安装 \x3ccode\x3eAVA\x3c\/code\x3e 的时候已经帮我们安装了一些关于 \x3ccode\x3ebabel\x3c\/code\x3e 的模块，不过我们还再安装几个我们需要用到的 \x3ccode\x3ebabel\x3c\/code\x3e 模块，如下。\x3cbr\x3e\x3ccode\x3enpm i --save-dev babel-polyfill babel-preset-es2015 babel-preset-react babel-preset-stage-0\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22babel-polyfill                        \/\/ 包含 ES2015 及以后的功能函数，如：Object.assign\nbabel-preset-es2015                   \/\/ 支持 ES2015 语法\nbabel-preset-react                    \/\/ 支持 React 语法\nbabel-preset-stage-0                  \/\/ 支持 ECMA TC39 对 JS 语言定义的最早一个阶段的想法的语法\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lsl\x22\x3e\x3ccode\x3ebabel-polyfill                        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 包含 ES2015 及以后的功能函数，如：Object.assign\x3c\/span\x3e\nbabel-preset-es2015                   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 支持 ES2015 语法\x3c\/span\x3e\nbabel-preset-react                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 支持 React 语法\x3c\/span\x3e\nbabel-preset-stage\x3cspan class=\x22hljs-number\x22\x3e-0\x3c\/span\x3e                  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 支持 ECMA TC39 对 JS 语言定义的最早一个阶段的想法的语法\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e关于 \x3ccode\x3eAVA\x3c\/code\x3e 的一些基础配置的意思，可以查看一下\x3ca href=\x22https:\/\/github.com\/avajs\/ava#configuration\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e官方文档\x3c\/a\x3e。\x3cbr\x3e实际用到的配置也不多，我们在 \x3ccode\x3epackage.json\x3c\/code\x3e 文件中配置一下 \x3ccode\x3eAVA\x3c\/code\x3e :\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;scripts\x26quot;: {\n  \x26quot;test\x26quot;: \x26quot;ava --verbose\x26quot;             \/\/ 添加测试命令，方便我们直接输入一小段命令 npm test。--verbose 表示输出的测试信息尽量详细\n},\n\x26quot;ava\x26quot;: {\n  \x26quot;babel\x26quot;: \x26quot;inherit\x26quot;,                 \/\/ 继承已有的 babel 配置，就是继承我们下面 .babelrc 的文件配置\n  \x26quot;require\x26quot;: [                        \/\/ 每个测试前，先加载 require 里面的模块\n    \x26quot;babel-register\x26quot;,                 \/\/ 默认引入的，安装 AVA 时已经自带安装好\n    \x26quot;babel-polyfill\x26quot;\n  ]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs 1c\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n  \x3cspan class=\x22hljs-string\x22\x3e\x22test\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22ava --verbose\x22\x3c\/span\x3e             \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加测试命令，方便我们直接输入一小段命令 npm test。--verbose 表示输出的测试信息尽量详细\x3c\/span\x3e\n},\n\x3cspan class=\x22hljs-string\x22\x3e\x22ava\x22\x3c\/span\x3e: {\n  \x3cspan class=\x22hljs-string\x22\x3e\x22babel\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22inherit\x22\x3c\/span\x3e,                 \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 继承已有的 babel 配置，就是继承我们下面 .babelrc 的文件配置\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e\x22require\x22\x3c\/span\x3e: [                        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 每个测试前，先加载 require 里面的模块\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x22babel-register\x22\x3c\/span\x3e,                 \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 默认引入的，安装 AVA 时已经自带安装好\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x22babel-polyfill\x22\x3c\/span\x3e\n  ]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在项目根目录创建 \x3ccode\x3e.babelrc\x3c\/code\x3e 文件, 并输入以下内容：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e这里的坑在于，如果不创建 \x3ccode\x3e.babelrc\x3c\/code\x3e 文件，而是把 \x3ccode\x3ebabel\x3c\/code\x3e 的配置写在 \x3ccode\x3epackage.json\x3c\/code\x3e 里，在使用 \x3ccode\x3eimport\x3c\/code\x3e 导入 \x3ccode\x3eReact\x3c\/code\x3e 组件时，会报语法错误。\x3cbr\x3e可使用命令行创建文件：\x3ccode\x3etouch .babelrc\x3c\/code\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;presets\x26quot;: [\x26quot;es2015\x26quot;, \x26quot;stage-0\x26quot;, \x26quot;react\x26quot;]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22presets\x22\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22es2015\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22stage-0\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22react\x22\x3c\/span\x3e]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e看看现在的目录结构是怎么样的：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVRzKL?w=469\x26amp;h=129\x22 src=\x22https:\/\/static.alili.tech\/img\/bVRzKL?w=469\x26amp;h=129\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e单元测试，测试一个简单的工具函数\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e在 \x3ccode\x3etest\x3c\/code\x3e 目录创建一个 \x3ccode\x3esimple_test.js\x3c\/code\x3e 文件，内容如下\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import test from \x27ava\x27;\n\nfunction trimAll(string) {\n    return string.replace(\/[\\s\\b]\/g, \x27\x27);\n}\n\ntest(\x27trimAll testing\x27, t =\x3e {\n    \/\/ 字符串内含有空格符、制表符等空字符都应删除\n    t.is(trimAll(\x27 \\n \\r \\t \\v \\b \\f B a r r  i  o  r  \\n  \\r  \\t  \\v  \\b  \\f  \x27), \x27Barrior\x27);\n\n    \/\/ 无空字符时，输出值应为输入值\n    t.is(trimAll(\x27Barrior\x27), \x27Barrior\x27);\n\n    \/\/ 输入 new String 对象应与输入基本类型字符串结果相同\n    t.is(trimAll(new String(\x27 T o m \x27)), \x27Tom\x27);\n\n    \/\/ 输入其他非字符串数据类型时，应抛出错误\n    [undefined, null, 0, true, [], {}, () =\x3e {}, Symbol()].forEach(type =\x3e {\n        t.throws(() =\x3e {\n            trimAll(type);\n        });\n    });\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e test \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27ava\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etrimAll\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e.replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/[\\s\\b]\/g\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e);\n}\n\ntest(\x3cspan class=\x22hljs-string\x22\x3e\x27trimAll testing\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3et\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 字符串内含有空格符、制表符等空字符都应删除\x3c\/span\x3e\n    t.is(trimAll(\x3cspan class=\x22hljs-string\x22\x3e\x27 \\n \\r \\t \\v \\b \\f B a r r  i  o  r  \\n  \\r  \\t  \\v  \\b  \\f  \x27\x3c\/span\x3e), \x3cspan class=\x22hljs-string\x22\x3e\x27Barrior\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 无空字符时，输出值应为输入值\x3c\/span\x3e\n    t.is(trimAll(\x3cspan class=\x22hljs-string\x22\x3e\x27Barrior\x27\x3c\/span\x3e), \x3cspan class=\x22hljs-string\x22\x3e\x27Barrior\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 输入 new String 对象应与输入基本类型字符串结果相同\x3c\/span\x3e\n    t.is(trimAll(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27 T o m \x27\x3c\/span\x3e)), \x3cspan class=\x22hljs-string\x22\x3e\x27Tom\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 输入其他非字符串数据类型时，应抛出错误\x3c\/span\x3e\n    [\x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, [], {}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {}, Symbol()].forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3etype\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        t.throws(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            trimAll(\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e);\n        });\n    });\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3etest()\x3c\/code\x3e：执行一个测试，第一个参数为标题，第二参数为测试用例函数，接收一个包含内置断言 \x3ccode\x3eAPI\x3c\/code\x3e 的参数 \x3ccode\x3et\x3c\/code\x3e，也是唯一一个参数；按照惯例这个参数名字叫做 \x3ccode\x3et\x3c\/code\x3e，没必要重新取名字。\x3c\/p\x3e\n\x3cp\x3e这里使用到的内置断言：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3et.is(resultValue, expected)\x3c\/code\x3e, 断言\x3ccode\x3e结果值\x3c\/code\x3e等于我们想要的\x3ccode\x3e预期值\x3c\/code\x3e，则测试通过。全等判断。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3et.throws(function)\x3c\/code\x3e, 在 \x3ccode\x3ethrows\x3c\/code\x3e 里放入一个函数，函数自动执行，里面执行的结果必须抛出错误，则测试通过。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e运行 \x3ccode\x3enpm test\x3c\/code\x3e，可以看到如下结果，一个测试用例通过。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVRzMw?w=620\x26amp;h=159\x22 src=\x22https:\/\/static.alili.tech\/img\/bVRzMw?w=620\x26amp;h=159\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e改动一下测试用例，看看测试不通过是怎么样的。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22t.is(trimAll(\x27Barrior123\x27), \x27Barrior\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3et.\x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e(trimAll(\x3cspan class=\x22hljs-symbol\x22\x3e\x27Barrior123\x3c\/span\x3e\x27), \x3cspan class=\x22hljs-symbol\x22\x3e\x27Barrior\x3c\/span\x3e\x27);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行 \x3ccode\x3enpm test\x3c\/code\x3e\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVRzQl?w=617\x26amp;h=316\x22 src=\x22https:\/\/static.alili.tech\/img\/bVRzQl?w=617\x26amp;h=316\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e红色框框就是我们说的\x3ccode\x3e强化断言信息\x3c\/code\x3e，将\x3ccode\x3e结果值\x3c\/code\x3e与\x3ccode\x3e预期值\x3c\/code\x3e进行了差异对比，帮助我们定位错误。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e使用 Promise、Async\/await、Observable\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ccode\x3ePromise\x3c\/code\x3e、\x3ccode\x3eAsync\/await\x3c\/code\x3e 都是语法层面的东西，\x3ccode\x3eObservable\x3c\/code\x3e 还没深入了解过，\x3cbr\x3e语法糖的代码就不贴来占用空间了，可以下载\x3ca href=\x22https:\/\/github.com\/Barrior\/ava-testing-examples\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3e示例代码\x3c\/code\x3e\x3c\/a\x3e看看就会了。\x3cbr\x3e\x3ccode\x3eObservable\x3c\/code\x3e 这里的坑在于需要引入 \x3ccode\x3eRxJS\x3c\/code\x3e: \x3ccode\x3enpm i --save rxjs\x3c\/code\x3e，官方文档并没有说明。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import test from \x27ava\x27;\nimport {Observable} from \x27rxjs\x27;\n\ntest(t =\x3e {\n    t.plan(3);\n    return Observable\n        .of(1, 2, 3, 4, 5, 6)\n        .filter(n =\x3e {\n            return n % 2 === 0;\n        })\n        .map(() =\x3e t.pass());\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e test \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27ava\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {Observable} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rxjs\x27\x3c\/span\x3e;\n\ntest(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3et\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    t.plan(\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Observable\n        .of(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e)\n        .filter(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3en\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e n % \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        })\n        .map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e t.pass());\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e使用 JSDOM 模拟浏览器环境\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e安装 \x3ccode\x3eJSDOM\x3c\/code\x3e 模块：\x3ccode\x3enpm i --save-dev jsdom\x3c\/code\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e在目录下创建一个 \x3ccode\x3ejsdom.js\x3c\/code\x3e 文件，内容如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import test from \x27ava\x27;\nimport {JSDOM} from \x27jsdom\x27;\n\nconst html = `\n\x3c!DOCTYPE html\x3e\n\x3chtml\x3e\n\x3chead\x3e\x3c\/head\x3e\n\x3cbody\x3e\n    \x3cdiv class=\x26quot;comment-box\x26quot;\x3e\n        \x3ctextarea\x3e\x3c\/textarea\x3e\n        \x3cdiv class=\x26quot;btn\x26quot;\x3e发布\x3c\/div\x3e\n        \x3cul class=\x26quot;list\x26quot;\x3e\x3c\/ul\x3e\n    \x3c\/div\x3e\n    \x3cscript\x3e\n        const textarea = document.querySelector(\x27.comment-box textarea\x27);\n        const btn = document.querySelector(\x27.btn\x27);\n        const list = document.querySelector(\x27.list\x27);\n\n        btn.addEventListener(\x27click\x27, () =\x3e {\n            const content = textarea.value;\n            if (content) {\n                const li = document.createElement(\x27li\x27);\n                li.innerHTML = content;\n                list.insertBefore(li, list.children[0]);\n                textarea.value = \x27\x27;\n            }\n        });\n    \x3c\/script\x3e\n\x3c\/body\x3e\n\x3c\/html\x3e\n`;\n\nconst {window} = new JSDOM(html, {runScripts: \x27dangerously\x27});\nconst document = window.document;\n\ntest(\x27emulate DOM environment with JSDOM\x27, t =\x3e {\n    const textarea = document.querySelector(\x27.comment-box textarea\x27);\n    const btn = document.querySelector(\x27.btn\x27);\n    const list = document.querySelector(\x27.list\x27);\n    const text = \x27hello world\x27;\n\n    btn.click();                                 \/\/ 触发按钮的点击事件，此时文本框中没有输入内容\n    t.is(list.children.length, 0);               \/\/ 列表应该保持为空\n\n    textarea.value = text;                       \/\/ 文本框中输入内容\n    btn.click();                                 \/\/ 触发按钮的点击事件\n    t.is(list.children.length, 1);               \/\/ 此时列表的长度应该为 1\n    t.is(list.children[0].innerHTML, text);      \/\/ 此时，第一个评论的内容应该等于刚刚我们输入的内容\n    t.falsy(textarea.value);                     \/\/ 评论完后，文本框应该清空   \n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e test \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27ava\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {JSDOM} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27jsdom\x27\x3c\/span\x3e;\n\nconst html = `\x3cspan class=\x22javascript\x22\x3e\n\x26lt;!DOCTYPE html\x26gt;\n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22comment-box\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etextarea\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etextarea\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22btn\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e发布\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22list\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e textarea = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.comment-box textarea\x27\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e btn = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.btn\x27\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e list = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.list\x27\x3c\/span\x3e);\n\n        btn.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, () =\x26gt; {\n            \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e content = textarea.value;\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (content) {\n                \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e li = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e);\n                li.innerHTML = content;\n                list.insertBefore(li, list.children[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]);\n                textarea.value = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n            }\n        });\n    \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n\x3c\/span\x3e`;\n\nconst {\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e} = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e JSDOM(html, {runScripts: \x3cspan class=\x22hljs-string\x22\x3e\x27dangerously\x27\x3c\/span\x3e});\nconst \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e;\n\ntest(\x3cspan class=\x22hljs-string\x22\x3e\x27emulate DOM environment with JSDOM\x27\x3c\/span\x3e, t =\x26gt; {\n    const textarea = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.comment-box textarea\x27\x3c\/span\x3e);\n    const btn = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.btn\x27\x3c\/span\x3e);\n    const list = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.list\x27\x3c\/span\x3e);\n    const text = \x3cspan class=\x22hljs-string\x22\x3e\x27hello world\x27\x3c\/span\x3e;\n\n    btn.click();                                 \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 触发按钮的点击事件，此时文本框中没有输入内容\n    t.\x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e(list.children.length, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);               \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 列表应该保持为空\n\n    textarea.value = text;                       \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 文本框中输入内容\n    btn.click();                                 \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 触发按钮的点击事件\n    t.\x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e(list.children.length, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);               \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 此时列表的长度应该为 \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n    t.\x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e(list.children[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].innerHTML, text);      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 此时，第一个评论的内容应该等于刚刚我们输入的内容\n    t.falsy(textarea.value);                     \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 评论完后，文本框应该清空   \n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e简单介绍 \x3ccode\x3eJSDOM API\x3c\/code\x3e。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3enew JSDOM(html, {runScripts: \x27dangerously\x27});\x3c\/code\x3e ：创建一个 \x3ccode\x3eDOM\x3c\/code\x3e 环境，可以传入完整的 \x3ccode\x3eHTML\x3c\/code\x3e 文档，也可以值传入一行 \x3ccode\x3eHTML\x3c\/code\x3e 文档声明，如：\x3ccode\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/code\x3e。\x3c\/li\x3e\n\x3cli\x3e参数 \x3ccode\x3erunScripts: \x27dangerously\x27\x3c\/code\x3e 表示让文档里的 \x3ccode\x3eJavaScript\x3c\/code\x3e 可以运行，默认禁止运行。\x3c\/li\x3e\n\x3cli\x3e创建后返回一个对象，里面包含一个 \x3ccode\x3ewindow\x3c\/code\x3e 对象，我们便是需要用到这个 \x3ccode\x3ewindow\x3c\/code\x3e 对象，及其属性 \x3ccode\x3edocument\x3c\/code\x3e 对象，用在我们的测试。\x3c\/li\x3e\n\x3cli\x3e\x3cem\x3e更多使用方法和配置可以查看一下\x3ca href=\x22https:\/\/github.com\/tmpvar\/jsdom\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e官方文档\x3c\/a\x3e。\x3c\/em\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e测试里面的代码就是原生的 \x3ccode\x3eJavaScript DOM\x3c\/code\x3e 操作代码。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e单元测试，测试一个简单的 React 组件\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e测试 \x3ccode\x3eReact\x3c\/code\x3e 组件需要依赖 \x3ccode\x3eJSDOM\x3c\/code\x3e, 所以我们放在这里讲。\x3cbr\x3e安装需要依赖的一些模块：\x3ccode\x3enpm i --save react react-dom\x3c\/code\x3e, \x3ccode\x3enpm i --save-dev enzyme react-test-renderer\x3c\/code\x3e。这里也不用纠结为什么一会用 \x3ccode\x3e--save\x3c\/code\x3e, 一会用 \x3ccode\x3e--save-dev\x3c\/code\x3e, 因为 \x3ccode\x3e--save\x3c\/code\x3e 表示这些模块在线上项目也需要用到，而 \x3ccode\x3e--save-dev\x3c\/code\x3e 表示这些模块只用作开发或者测试等，线上项目不需要用到这些模块。\x3cbr\x3e\x3ccode\x3eEnzyme\x3c\/code\x3e 是一个 \x3ccode\x3eReact\x3c\/code\x3e 测试工具，可以说是把 \x3ccode\x3eReact\x3c\/code\x3e 组件渲染在我们测试的环境里，不需要依赖真实的浏览器。\x3cbr\x3e\x3ccode\x3eEnzyme\x3c\/code\x3e 依赖 \x3ccode\x3ereact-test-renderer\x3c\/code\x3e，\x3ccode\x3eReact \x26gt;=15.5\x3c\/code\x3e 安装 \x3ccode\x3ereact-test-renderer\x3c\/code\x3e，其它版本安装 \x3ccode\x3ereact-addons-test-utils\x3c\/code\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e在 \x3ccode\x3esrc\x3c\/code\x3e 目录下创建 \x3ccode\x3etodo.js\x3c\/code\x3e 文件，内容如下，一个简单的备忘录组件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import React from \x27react\x27;\nimport ReactDOM from \x27react-dom\x27;\n\nexport default class Todo extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            names: props.names || []\n        };\n    }\n\n    add() {\n        const elem = this.refs.textarea;\n        const name = elem.value;\n        if (name) {\n            elem.value = \x27\x27;\n            this.state.names.push(name);\n            this.setState({});\n        } else {\n            elem.focus();\n        }\n    }\n\n    del(i) {\n        this.state.names.splice(i, 1);\n        this.setState({});\n    }\n\n    render() {\n        return (\n            \x3cdiv className=\x26quot;todo\x26quot;\x3e\n                \x3cdiv\x3e\n                    \x3ctextarea\n                        cols=\x26quot;30\x26quot;\n                        rows=\x26quot;10\x26quot;\n                        ref=\x26quot;textarea\x26quot;\n                        placeholder=\x26quot;Type member name\x26quot;\x3e\n                    \x3c\/textarea\x3e\n                    \x3cbutton\n                        className=\x26quot;btn\x26quot;\n                        onClick={this.add.bind(this)}\x3e\n                        Add member\n                    \x3c\/button\x3e\n                \x3c\/div\x3e\n                \x3cul\x3e\n                    {\n                        this.state.names.map((name, i) =\x3e {\n                            return (\n                                \x3cli key={i}\x3e\n                                    \x3cspan\x3eMember name: {name}\x3c\/span\x3e\n                                    \x3cbutton\n                                        className=\x26quot;btn\x26quot;\n                                        onClick={this.del.bind(this, i)}\x3e\n                                        Remove member\n                                    \x3c\/button\x3e\n                                \x3c\/li\x3e\n                            )\n                        })\n                    }\n                \x3c\/ul\x3e\n            \x3c\/div\x3e\n        )\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e ReactDOM \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react-dom\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eTodo\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(props) {\n        \x3cspan class=\x22hljs-keyword\x22\x3esuper\x3c\/span\x3e(props);\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state = {\n            \x3cspan class=\x22hljs-attr\x22\x3enames\x3c\/span\x3e: props.names || []\n        };\n    }\n\n    add() {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e elem = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.refs.textarea;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e name = elem.value;\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (name) {\n            elem.value = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state.names.push(name);\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({});\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            elem.focus();\n        }\n    }\n\n    del(i) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state.names.splice(i, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({});\n    }\n\n    render() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n            \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22todo\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etextarea\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-attr\x22\x3ecols\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x2230\x22\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-attr\x22\x3erows\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-attr\x22\x3eref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22textarea\x22\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-attr\x22\x3eplaceholder\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22Type member name\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etextarea\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22btn\x22\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{this.add.bind(this)}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                        Add member\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    {\n                        this.state.names.map((name, i) =\x26gt; {\n                            return (\n                                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{i}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3eMember name: {name}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\n                                        \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22btn\x22\x3c\/span\x3e\n                                        \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{this.del.bind(this,\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ei\x3c\/span\x3e)}\x26gt;\x3c\/span\x3e\n                                        Remove member\n                                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                            )\n                        })\n                    }\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n        )\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在 \x3ccode\x3etest\x3c\/code\x3e 目录下创建一个 \x3ccode\x3ehelpers\x3c\/code\x3e 文件夹，并在文件夹里面创建 \x3ccode\x3esetup_dom_env.js\x3c\/code\x3e 文件, 内容如下。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ccode\x3eAVA\x3c\/code\x3e 的规则会忽略 \x3ccode\x3ehelpers\x3c\/code\x3e 文件夹，不会将里面的文件当做测试文件执行。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import {JSDOM} from \x27jsdom\x27;\nconst dom = new JSDOM(\x27\x3c!DOCTYPE html\x3e\x27);\nglobal.window = dom.window;\nglobal.document = dom.window.document;\nglobal.navigator = dom.window.navigator;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {JSDOM} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27jsdom\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dom = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e JSDOM(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;!DOCTYPE html\x26gt;\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3eglobal\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e = dom.\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3eglobal\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e = dom.\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3eglobal\x3c\/span\x3e.navigator = dom.\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.navigator;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这就是 \x3ccode\x3eReact\x3c\/code\x3e 组件需要依赖的 \x3ccode\x3eJSDOM\x3c\/code\x3e 模拟的 \x3ccode\x3eDOM\x3c\/code\x3e 环境的代码。\x3cbr\x3e需要将 \x3ccode\x3ewindow\x3c\/code\x3e、\x3ccode\x3edocument\x3c\/code\x3e、\x3ccode\x3enavigator\x3c\/code\x3e 等对象挂载到 \x3ccode\x3eglobal\x3c\/code\x3e 对象上，组件才能运行。\x3c\/p\x3e\n\x3cp\x3e在 \x3ccode\x3etest\x3c\/code\x3e 目录下创建 \x3ccode\x3ereact_component.js\x3c\/code\x3e, 内容如下，先引入模拟 \x3ccode\x3eDOM\x3c\/code\x3e 环境的文件。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import \x27.\/helpers\/setup_dom_env\x27;\nimport test from \x27ava\x27;\nimport React from \x27react\x27;\nimport {mount} from \x27enzyme\x27;\n\nimport Todo from \x27..\/src\/todo\x27;\n\ntest(\x27actual testing for react component\x27, t =\x3e {\n    const wrapper = mount(\x3cTodo names={[\x27Barrior\x27, \x27Tom\x27]} \/\x3e);  \/\/ 让组件运行，返回一个对象\n\n    const list = wrapper.find(\x27ul\x27);                             \/\/ 从对象里找到 render 里的 DOM 元素 ul\n    t.is(list.find(\x27li\x27).length, 2);                             \/\/ 断言备忘录有 2 条记录\n\n    wrapper.find(\x27textarea\x27).node.value = \x27Lily\x27;                \/\/ 文本框写入值\n    wrapper.find(\x27textarea \x2b button\x27).simulate(\x27click\x27);         \/\/ 触发按钮的点击事件\n    t.is(list.find(\x27li\x27).length, 3);                             \/\/ 断言备忘录有 3 条记录\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/helpers\/setup_dom_env\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e test \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27ava\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {mount} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27enzyme\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Todo \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/src\/todo\x27\x3c\/span\x3e;\n\ntest(\x3cspan class=\x22hljs-string\x22\x3e\x27actual testing for react component\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3et\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e wrapper = mount(\x26lt;Todo names={[\x3cspan class=\x22hljs-string\x22\x3e\x27Barrior\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27Tom\x27\x3c\/span\x3e]} \/\x26gt;);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 让组件运行，返回一个对象\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e list = wrapper.find(\x3cspan class=\x22hljs-string\x22\x3e\x27ul\x27\x3c\/span\x3e);                             \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 从对象里找到 render 里的 DOM 元素 ul\x3c\/span\x3e\n    t.is(list.find(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e).length, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);                             \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 断言备忘录有 2 条记录\x3c\/span\x3e\n\n    wrapper.find(\x3cspan class=\x22hljs-string\x22\x3e\x27textarea\x27\x3c\/span\x3e).node.value = \x3cspan class=\x22hljs-string\x22\x3e\x27Lily\x27\x3c\/span\x3e;                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 文本框写入值\x3c\/span\x3e\n    wrapper.find(\x3cspan class=\x22hljs-string\x22\x3e\x27textarea \x2b button\x27\x3c\/span\x3e).simulate(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e);         \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 触发按钮的点击事件\x3c\/span\x3e\n    t.is(list.find(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e).length, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e);                             \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 断言备忘录有 3 条记录\x3c\/span\x3e\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e简单介绍 \x3ca href=\x22https:\/\/github.com\/airbnb\/enzyme#enzyme\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eEnzyme API\x3c\/code\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3emount\x3c\/code\x3e: 表示渲染组件的时候支持生命周期，个人觉得测试时一般都会用这个，因为真实组件生命周期的调用是极为平常的事。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eEnzyme API\x3c\/code\x3e 和 \x3ccode\x3ejQuery API\x3c\/code\x3e 很相似，会 \x3ccode\x3ejQuery\x3c\/code\x3e 应该很容易理解。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3eHttp 接口测试，GitHub 用户信息接口测试\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e打开接口：\x3ca href=\x22https:\/\/api.github.com\/users\/Barrior\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/api.github.com\/users\/...\x3c\/a\x3e，返回用户的一些基本信息，有些字段值是动态改变的，用户修改即变，这样的动态字段我们可以查询数据库来对比。这里我们以一个假设不变的 \x3ccode\x3elogin\x3c\/code\x3e 字段来演示。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e先安装 \x3ca href=\x22https:\/\/github.com\/request\/request\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eRequest\x3c\/code\x3e\x3c\/a\x3e 模块： \x3ccode\x3enpm i --save-dev request\x3c\/code\x3e，方便发送 \x3ccode\x3ehttp\x3c\/code\x3e 请求。\x3c\/p\x3e\n\x3cp\x3e在 \x3ccode\x3etest\x3c\/code\x3e 目录下创建 \x3ccode\x3ehttp.js\x3c\/code\x3e, 内容如下。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import test from \x27ava\x27;\nimport request from \x27request\x27;\n\n\/\/ test.cb() 回调函数形式测试异步代码，异步结束调用 t.end()\ntest.cb(\x27http api testing\x27, t =\x3e {\n\n    \/\/ 基于 Request API 创建 http 请求的配置\n    const options = {\n        baseUrl: \x27https:\/\/api.github.com\x27,\n        url: \x27\/users\/Barrior\x27,\n        \/\/ 请求超时时间\n        timeout: 5 * 1000,\n        \/\/ http 请求头部，模拟得跟浏览器越像越好，不然被服务器处理成爬虫或者其他就可能得不到我们想要的响应\n        headers: {\n            \x27User-Agent\x27: \x27Mozilla\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/59.0.3071.115 Safari\/537.36\x27\n        }\n    };\n\n    \/\/ Request API 发送 GET 请求\n    request.get(options, (err, res, body) =\x3e {\n        if (err) t.fail(\x27服务器响应超时！\x27);\n\n        if (res \x26amp;\x26amp; res.statusCode === 200) {\n            body = JSON.parse(body);\n            t.is(body.login, \x27Barrior\x27);\n        } else {\n            t.fail(\x27无响应内容或状态码错误！\x27);\n        }\n        \n        \/\/ 异步结束\n        t.end();\n    });\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e test \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27ava\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e request \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27request\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ test.cb() 回调函数形式测试异步代码，异步结束调用 t.end()\x3c\/span\x3e\ntest.cb(\x3cspan class=\x22hljs-string\x22\x3e\x27http api testing\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3et\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 基于 Request API 创建 http 请求的配置\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e options = {\n        baseUrl: \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/api.github.com\x27\x3c\/span\x3e,\n        url: \x3cspan class=\x22hljs-string\x22\x3e\x27\/users\/Barrior\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 请求超时时间\x3c\/span\x3e\n        timeout: \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ http 请求头部，模拟得跟浏览器越像越好，不然被服务器处理成爬虫或者其他就可能得不到我们想要的响应\x3c\/span\x3e\n        headers: {\n            \x3cspan class=\x22hljs-string\x22\x3e\x27User-Agent\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Mozilla\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/59.0.3071.115 Safari\/537.36\x27\x3c\/span\x3e\n        }\n    };\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Request API 发送 GET 请求\x3c\/span\x3e\n    request.get(options, \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr, res, body\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (err) t.fail(\x3cspan class=\x22hljs-string\x22\x3e\x27服务器响应超时！\x27\x3c\/span\x3e);\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (res \x26amp;\x26amp; res.statusCode === \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e) {\n            body = \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.parse(body);\n            t.is(body.login, \x3cspan class=\x22hljs-string\x22\x3e\x27Barrior\x27\x3c\/span\x3e);\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            t.fail(\x3cspan class=\x22hljs-string\x22\x3e\x27无响应内容或状态码错误！\x27\x3c\/span\x3e);\n        }\n        \n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 异步结束\x3c\/span\x3e\n        t.end();\n    });\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行 \x3ccode\x3enpm test\x3c\/code\x3e，可以看到测试通过。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVRP9j?w=291\x26amp;h=22\x22 src=\x22https:\/\/static.alili.tech\/img\/bVRP9j?w=291\x26amp;h=22\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e串行测试\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e很多情况并行测试就好，但某些场景我们需要测试按顺序一个接一个的执行，即使是异步，并且后面的测试可能依赖前面测试的结果，这时就需要用到串行测试，\x3ccode\x3etest.serial()\x3c\/code\x3e。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e在 \x3ccode\x3etest\x3c\/code\x3e 目录下创建 \x3ccode\x3eserial.js\x3c\/code\x3e, 内容如下，一个简单的串行测试演示。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import test from \x27ava\x27;\n\nconst globalData = {};\n\ntest.serial(\x27serial testing: step one\x27, t =\x3e {\n    return new Promise(resolve =\x3e {\n        setTimeout(() =\x3e {\n            globalData.name = \x27Barrior\x27;\n            t.pass();\n            resolve();\n        }, 500);\n    });\n});\n\ntest(\x27serial testing: step two\x27, t =\x3e {\n    t.is(globalData.name, \x27Barrior\x27);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e test \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27ava\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e globalData = {};\n\ntest.serial(\x3cspan class=\x22hljs-string\x22\x3e\x27serial testing: step one\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3et\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            globalData.name = \x3cspan class=\x22hljs-string\x22\x3e\x27Barrior\x27\x3c\/span\x3e;\n            t.pass();\n            resolve();\n        }, \x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e);\n    });\n});\n\ntest(\x3cspan class=\x22hljs-string\x22\x3e\x27serial testing: step two\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3et\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    t.is(globalData.name, \x3cspan class=\x22hljs-string\x22\x3e\x27Barrior\x27\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里只是 \x3ccode\x3eserial.js\x3c\/code\x3e 文件串行执行，如果想所有文件都串行执行，需要在命令行传递 \x3ccode\x3e--serial\x3c\/code\x3e 标志。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e快照断言\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ccode\x3et.snapshot(expected, [options])\x3c\/code\x3e, 将预期值与先前记录的快照进行比较。\x3cbr\x3e第一次运行测试，快照断言会将预期值存储起来，待第二次及以后运行测试，则拿已经存储好的快照与新的预期值进行比较，吻合则测试通过，否则测试失败。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e一般用于预期值比较庞大的情况，如：\x3ccode\x3eHtml\x3c\/code\x3e 模板，\x3ccode\x3eReact\x3c\/code\x3e 渲染出来的模板，或许还可以用于 \x3ccode\x3eHttp\x3c\/code\x3e 接口返回的一堆数据。\x3c\/p\x3e\n\x3cp\x3e如下，做个简单演示。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import test from \x27ava\x27;\n\nfunction getUserInfo(uid) {\n    return [{\n        id: 0,\n        name: \x27Barrior\x27,\n        sex: \x27male\x27\n    }, {\n        id: 1,\n        name: \x27Tom\x27,\n        sex: \x27male\x27\n    }][uid]\n}\n\nfunction renderUserDom(uid) {\n    const userInfo = getUserInfo(uid);\n    return `\n        \x3cdiv class=\x26quot;user-info\x26quot;\x3e\n            \x3cdiv class=\x26quot;name\x26quot;\x3e${userInfo.name}\x3c\/div\x3e\n            \x3cdiv class=\x26quot;sex\x26quot;\x3e${userInfo.sex}\x3c\/div\x3e\n            \x3cdiv\x3e...There are a lot of information\x3c\/div\x3e\n        \x3c\/div\x3e\n    `;\n}\n\ntest(\x27snapshot\x27, t =\x3e {\n    const user1 = renderUserDom(0);\n    const user2 = renderUserDom(1);\n\n    \/\/ 自定义 id 必须是一个字符串或者 buffer\n    \/\/ 不定义，AVA 会默认生成一个 id\n    t.snapshot(user1, {id: \x271\x27});\n    t.snapshot(user2, {id: \x272\x27});\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e test from \x3cspan class=\x22hljs-string\x22\x3e\x27ava\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetUserInfo\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3euid\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e [{\n        \x3cspan class=\x22hljs-attribute\x22\x3eid:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e 0,\n        name\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Barrior\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attribute\x22\x3esex\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27male\x27\x3c\/span\x3e\n    }, {\n        \x3cspan class=\x22hljs-attribute\x22\x3eid:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e 1,\n        name\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Tom\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attribute\x22\x3esex\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27male\x27\x3c\/span\x3e\n    }][uid]\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erenderUserDom\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3euid\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e userInfo = getUserInfo(uid);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e`\n        \x26lt;div class=\x22user-info\x22\x26gt;\n            \x26lt;div class=\x22name\x22\x26gt;\x3cspan class=\x22hljs-subst\x22\x3e${userInfo.name}\x3c\/span\x3e\x26lt;\/div\x26gt;\n            \x26lt;div class=\x22sex\x22\x26gt;\x3cspan class=\x22hljs-subst\x22\x3e${userInfo.sex}\x3c\/span\x3e\x26lt;\/div\x26gt;\n            \x26lt;div\x26gt;...There are a lot of information\x26lt;\/div\x26gt;\n        \x26lt;\/div\x26gt;\n    `\x3c\/span\x3e;\n}\n\ntest(\x3cspan class=\x22hljs-string\x22\x3e\x27snapshot\x27\x3c\/span\x3e, t =\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e user1 = renderUserDom(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e user2 = renderUserDom(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 自定义 id 必须是一个字符串或者 buffer\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 不定义，AVA 会默认生成一个 id\x3c\/span\x3e\n    t.snapshot(user1, {\x3cspan class=\x22hljs-attribute\x22\x3eid:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e \x271\x27});\n    t.snapshot\x3c\/span\x3e(user2, {\x3cspan class=\x22hljs-attribute\x22\x3eid:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e \x272\x27});\n});\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e覆盖率报告：nyc \x2b Coveralls\x3c\/h3\x3e\n\x3cp\x3e安装模块 \x3ccode\x3enyc\x3c\/code\x3e 和 \x3ccode\x3ecoveralls\x3c\/code\x3e：\x3ccode\x3enpm i --save-dev nyc coveralls\x3c\/code\x3e\x3cbr\x3e扩展测试命令，前面加个 \x3ccode\x3enyc\x3c\/code\x3e 即可：\x3ccode\x3e\x22test\x22: \x22nyc ava --verbose\x22\x3c\/code\x3e\x3cbr\x3e测试覆盖率是基于文件被测试的情况来反馈出指标，所以我们把 \x3ccode\x3esimple_test.js\x3c\/code\x3e 里的 \x3ccode\x3etrimAll\x3c\/code\x3e 函数单独提出来作为一个文件，放到 \x3ccode\x3esrc\x3c\/code\x3e 目录，命名为 \x3ccode\x3etrim_all.js\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e运行 \x3ccode\x3enpm test\x3c\/code\x3e，简洁的覆盖率报告如下。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVRRgR?w=643\x26amp;h=353\x22 src=\x22https:\/\/static.alili.tech\/img\/bVRRgR?w=643\x26amp;h=353\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eStmts\x3c\/code\x3e: Statement 的缩写，语句覆盖，通常指某一行代码是否被测试覆盖了，不包括注释，条件等。\x3cbr\x3e\x3ccode\x3eBranch\x3c\/code\x3e: 分支覆盖或条件覆盖，指某一个条件语句是否被测试覆盖了，如：\x3ccode\x3eif\x3c\/code\x3e、\x3ccode\x3ewhile\x3c\/code\x3e；分支数是条件语句的两倍。\x3cbr\x3e\x3ccode\x3eFuncs\x3c\/code\x3e: Function 的缩写，函数覆盖，指这个函数是否被测试代码调用了。\x3cbr\x3e\x3ccode\x3eLines\x3c\/code\x3e: 行覆盖，通常情况等于语句覆盖。一行未必只有一条语句（官方给的差异解释）：\x3ca href=\x22https:\/\/github.com\/gotwarlost\/istanbul\/issues\/407\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/gotwarlost...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e这里有一篇关于这几个指标的具体解释和演示说明，和对做覆盖率报告的思考：\x3ca href=\x22http:\/\/www.infoq.com\/cn\/articles\/test-coverage-rate-role\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.infoq.com\/cn\/artic...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e如果想看具体报告的信息，可以输出成 \x3ccode\x3ehtml\x3c\/code\x3e 文档来瞧瞧，如下添加输出报告命令。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;scripts\x26quot;: {\n   ...\n  \x26quot;report\x26quot;: \x26quot;nyc report --reporter=html\x26quot;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clean\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n   ...\n  \x3cspan class=\x22hljs-string\x22\x3e\x22report\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22nyc report --reporter=html\x22\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行 \x3ccode\x3enpm run report\x3c\/code\x3e，\x3ccode\x3ecoverage\x3c\/code\x3e 目录就会生成一些相关文件，浏览器打开 \x3ccode\x3eindex.html\x3c\/code\x3e，就可以看到如下内容。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVRRn2?w=850\x26amp;h=227\x22 src=\x22https:\/\/static.alili.tech\/img\/bVRRn2?w=850\x26amp;h=227\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e点击文件进去，可以查看该文件测试覆盖的详情。\x3c\/p\x3e\n\x3ch4\x3eCoveralls\x3c\/h4\x3e\n\x3cblockquote\x3e\x3cp\x3e一个将项目覆盖率展示到网页上，适合开源项目。\x3cbr\x3e网址：\x3ca href=\x22https:\/\/coveralls.io\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/coveralls.io\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e先注册登录，然后在项目根目录添加 \x3ccode\x3e.coveralls.yml\x3c\/code\x3e，内容如下。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22service_name: travis-ci\nrepo_token: 你自己的项目 token, Coveralls 网站提供的私有令牌\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs avrasm\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-symbol\x22\x3eservice_name:\x3c\/span\x3e travis-ci\n\x3cspan class=\x22hljs-symbol\x22\x3erepo_token:\x3c\/span\x3e 你自己的项目 token, Coveralls 网站提供的私有令牌\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e添加上传命令。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;scripts\x26quot;: {\n   ...\n  \x26quot;coverage\x26quot;: \x26quot;nyc report --reporter=text-lcov | coveralls\x26quot;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clean\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n   ...\n  \x3cspan class=\x22hljs-string\x22\x3e\x22coverage\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22nyc report --reporter=text-lcov | coveralls\x22\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行 \x3ccode\x3enpm run coverage\x3c\/code\x3e，等待报告上传完毕，就可以在网站上看到报告。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e持续集成：CircleCI\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e通俗的讲，持续集成就是每次提交代码，自动化程序就自动构建（包括编译，发布，自动化测试等）来验证代码，从而尽早地发现代码中的错误。\x3cbr\x3e网址：\x3ca href=\x22https:\/\/circleci.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/circleci.com\/\x3c\/a\x3e，适合开源项目。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e在项目根目录添加 \x3ccode\x3ecircle.yml\x3c\/code\x3e 文件，内容如下，配置项都可以在\x3ca href=\x22https:\/\/circleci.com\/docs\/1.0\/language-nodejs\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e文档\x3c\/a\x3e中找到。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22# 配置 NodeJS 的版本为 7\nmachine:\n  node:\n    version: 7\n\n# 安装依赖的命令\ndependencies:\n  override:\n    - npm i -g ava\n    - npm i\n\n# 运行的测试命令\ntest:\n  override:\n    - npm test\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e# 配置 NodeJS 的版本为 7\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3emachine:\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  node:\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    version:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-meta\x22\x3e# 安装依赖的命令\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3edependencies:\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  override:\x3c\/span\x3e\n    - npm i -g ava\n    - npm i\n\n\x3cspan class=\x22hljs-meta\x22\x3e# 运行的测试命令\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3etest:\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  override:\x3c\/span\x3e\n    - npm test\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e使用 \x3ccode\x3eGitHub\x3c\/code\x3e 账号登录 \x3ccode\x3eCircleCI\x3c\/code\x3e 网站，选择持续集成这个项目，这里我们用的是 \x3ccode\x3e1.0\x3c\/code\x3e 平台，不要选 \x3ccode\x3e2.0\x3c\/code\x3e，因为配置的写法不一样。\x3cbr\x3e至此，每次提交代码到这个项目，\x3ccode\x3eCircleCI\x3c\/code\x3e 就会自动帮我们集成。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVRRTh?w=1146\x26amp;h=162\x22 src=\x22https:\/\/static.alili.tech\/img\/bVRRTh?w=1146\x26amp;h=162\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e完成了覆盖率和持续集成，这两个网站都提供了小徽章给我们，类似如下，可以贴到项目中以显某种态度。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVRRSk?w=1085\x26amp;h=76\x22 src=\x22https:\/\/static.alili.tech\/img\/bVRRSk?w=1085\x26amp;h=76\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3e学习借鉴，一些使用 AVA 做测试的开源项目\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/sindresorhus\/pageres\/blob\/master\/test\/test.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3epageres\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/ben-eb\/postcss-discard-comments\/blob\/master\/src\/__tests__\/index.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3epostcss-discard-comments\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/postcss\/postcss-selector-parser\/blob\/master\/src\/__tests__\/lossy.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3epostcss-selector-parser\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/kevva\/download\/blob\/master\/test.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3edownload\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/Barrior\/JParticles\/blob\/master\/test\/unit\/jparticles.spec.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejparticles\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3ee2e测试框架推荐：TestCafe\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e官网地址：\x3ca href=\x22https:\/\/devexpress.github.io\/testcafe\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/devexpress.github.io\/...\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e推荐理由（缺点须躬行）：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e无需配置繁琐的环境。\x3c\/li\x3e\n\x3cli\x3e基于 \x3ccode\x3eNodeJS\x3c\/code\x3e 生态。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader15\x22\x3e参考\x3c\/h3\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/i5ting.github.io\/ava-practice\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3c\/a\x3e\x3ca href=\x22http:\/\/i5ting.github.io\/ava-practice\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/i5ting.github.io\/ava-p...\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/github.com\/avajs\/ava\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3c\/a\x3e\x3ca href=\x22https:\/\/github.com\/avajs\/ava\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/avajs\/ava\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3e最后\x3c\/h3\x3e\n\x3cp\x3e文中的代码托放于 \x3ca href=\x22https:\/\/github.com\/Barrior\/ava-testing-examples\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eGitHub\x3c\/code\x3e\x3c\/a\x3e，可供参考。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>使用 AVA 做自动化测试</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010416900">https://segmentfault.com/a/1190000010416900</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/li2jyk2fwbc/" target="_blank">https://alili.tech/archive/li2jyk2fwbc/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>