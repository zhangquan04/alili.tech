<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Promise介绍--规范篇"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Promise介绍--规范篇 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/yr7v8e9fao/",
				"appid": "1613049289050283", 
				"title": "Promise介绍--规范篇 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-30T02:30:23"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/9lyxyz4wc6g/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/3txhfn3ejcb/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fyr7v8e9fao%2f&text=Promise%e4%bb%8b%e7%bb%8d--%e8%a7%84%e8%8c%83%e7%af%87"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fyr7v8e9fao%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fyr7v8e9fao%2f&text=Promise%e4%bb%8b%e7%bb%8d--%e8%a7%84%e8%8c%83%e7%af%87"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fyr7v8e9fao%2f&title=Promise%e4%bb%8b%e7%bb%8d--%e8%a7%84%e8%8c%83%e7%af%87"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fyr7v8e9fao%2f&is_video=false&description=Promise%e4%bb%8b%e7%bb%8d--%e8%a7%84%e8%8c%83%e7%af%87"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Promise%e4%bb%8b%e7%bb%8d--%e8%a7%84%e8%8c%83%e7%af%87&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fyr7v8e9fao%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fyr7v8e9fao%2f&title=Promise%e4%bb%8b%e7%bb%8d--%e8%a7%84%e8%8c%83%e7%af%87"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyr7v8e9fao%2f&title=Promise%e4%bb%8b%e7%bb%8d--%e8%a7%84%e8%8c%83%e7%af%87"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyr7v8e9fao%2f&title=Promise%e4%bb%8b%e7%bb%8d--%e8%a7%84%e8%8c%83%e7%af%87"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyr7v8e9fao%2f&title=Promise%e4%bb%8b%e7%bb%8d--%e8%a7%84%e8%8c%83%e7%af%87"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Promise介绍--规范篇</h1><div class="meta"><div class="postdate"><time datetime="2019-01-30" itemprop="datePublished">2019-01-30</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e本篇文章是\x3ccode\x3ePromise\x3c\/code\x3e系列文章的第二篇，主要是讲解基于\x3ccode\x3ePromise\/A\x2b\x3c\/code\x3e规范，在传入不同类型的参数时，\x3ccode\x3epromise\x3c\/code\x3e内部分别会如何处理。本章的主要目的是让大家对\x3ccode\x3epromise\x3c\/code\x3e有一个更加深入的理解，也为下一篇讲如何实现一个\x3ccode\x3epromise\x3c\/code\x3e库做准备。（写完之后觉得好水。。。）\x3c\/p\x3e\n\x3cp\x3e英文版本的规范见\x3ca href=\x22https:\/\/promisesaplus.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e，segmentfault上也有人把规范翻译为中文，见\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000002452115\x22\x3e这里\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e在此，我主要是通过使用例子，讲解一下规范中\x3ccode\x3ethen\x3c\/code\x3e方法和\x3ccode\x3ePromise Resolution Procedure\x3c\/code\x3e的每一种情况。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3econstructor\x3c\/h2\x3e\n\x3cp\x3e规范中对于构造函数没有明确说明，所以在此处拿出来讲解一下。\x3c\/p\x3e\n\x3cp\x3e和普通JavaScript对象一样，我们同样是通过new关键词来创建一个\x3ccode\x3ePromise\x3c\/code\x3e对象实例。构造函数只接收一个参数，且该参数必须是一个函数，任何其他的值比如\x3ccode\x3eundefined\x3c\/code\x3e、\x3ccode\x3enull\x3c\/code\x3e、\x3ccode\x3e5\x3c\/code\x3e、\x3ccode\x3etrue\x3c\/code\x3e等都会报一个\x3ccode\x3eTypeError\x3c\/code\x3e的错误。例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise(true)\n\/\/ Uncaught TypeError: Promise resolver true is not a function(…)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e)\n\/\/ Uncaught TypeError: Promise resolver \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enot\x3c\/span\x3e a \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(…)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e同样，如果你没有通过new关键词创建，而是直接执行Promise()，同样也会报一个\x3ccode\x3eTypeError\x3c\/code\x3e的错误。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise()\n\/\/ Uncaught TypeError: undefined is not a promise(…)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3ePromise\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Uncaught TypeError: undefined is not a promise(…)\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e所以，我们必须通过\x3ccode\x3enew Promise(function()=\x26gt;{})\x3c\/code\x3e的方式来创建一个Promise实例。通常我们见到的创建一个Promise实例的代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var promise = new Promise(function(resolve, reject) {\n    \/\/ 进行一些异步操作\n    \/\/ 然后调用resolve或reject方法\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 进行一些异步操作\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 然后调用resolve或reject方法\x3c\/span\x3e\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这才是正确的姿势~ 从该例子中，我们可以看到创建Promise实例时传入的函数，同时还接受两个参数，它们分别对应Promise内部实现的两个方法。上一篇文章中，我提到过Promise有三种状态，\x3ccode\x3epending\x3c\/code\x3e、\x3ccode\x3efulfilled\x3c\/code\x3e、\x3ccode\x3erejected\x3c\/code\x3e，实例刚创建时处于\x3ccode\x3epending\x3c\/code\x3e状态，当执行\x3ccode\x3ereject\x3c\/code\x3e方法时，变为\x3ccode\x3erejected\x3c\/code\x3e状态，如下所示：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise(function(resolve, reject){\n    reject(Promise.resolve(5))\n}).then(function(value){\n    console.log(\x27fulfill\x27, value)\n}, function(reason){\n    console.log(\x27reject\x27, reason)\n})\n\/\/ reject Promise {[[PromiseStatus]]: \x26quot;resolved\x26quot;, [[PromiseValue]]: 5}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lua\x22\x3e\x3ccode\x3enew Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve, reject)\x3c\/span\x3e\x3c\/span\x3e{\n    reject(Promise.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e))\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e\x3c\/span\x3e{\n    console.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e, value)\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(reason)\x3c\/span\x3e\x3c\/span\x3e{\n    console.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e, reason)\n})\n\/\/ reject Promise {\x3cspan class=\x22hljs-string\x22\x3e[[PromiseStatus]]\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22resolved\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e[[PromiseValue]]\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而当执行\x3ccode\x3eresolve\x3c\/code\x3e方法时，它可能变为\x3ccode\x3efulfilled\x3c\/code\x3e，也有可能变为\x3ccode\x3erejected\x3c\/code\x3e状态。也就是说\x3ccode\x3eresolve != fulfill\x3c\/code\x3e。如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise(function(resolve, reject){\n    resolve(Promise.reject(5))\n}).then(function(value){\n    console.log(\x27fulfill\x27, value)\n}, function(reason){\n    console.log(\x27reject\x27, reason)\n})\n\/\/ reject 5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    resolve(\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e))\n}).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e, value)\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e, reason)\n})\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ reject 5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e那么\x3ccode\x3eresolve\x3c\/code\x3e是个什么东西呢？它是根据什么变为\x3ccode\x3efulfilled\x3c\/code\x3e或\x3ccode\x3erejected\x3c\/code\x3e的呢？这就是我们接下来要讲解的\x3ccode\x3ePromise Resolution Procedure\x3c\/code\x3e，我把它称作“Promise处理程序”。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3ePromise Resolution Procedure\x3c\/h2\x3e\n\x3cp\x3e讲之前，我们先说几个\x3ccode\x3epromise\x3c\/code\x3e规范中的几个术语。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3epromise\x3c\/strong\x3e 它是一个拥有\x3ccode\x3ethen\x3c\/code\x3e方法的对象或函数，且符合该规范\x3cbr\x3e\x3cstrong\x3ethenable\x3c\/strong\x3e 拥有\x3ccode\x3ethen\x3c\/code\x3e方法的对象或函数\x3cbr\x3e\x3cstrong\x3evalue\x3c\/strong\x3e 是指一个合法的 \x3ccode\x3eJavascript\x3c\/code\x3e 值\x3cbr\x3e\x3cstrong\x3eexception\x3c\/strong\x3e \x3ccode\x3ethrow\x3c\/code\x3e语句抛出的异常\x3cbr\x3e\x3cstrong\x3ereason\x3c\/strong\x3e 描述promise为什么失败的值\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ePromise Resolution Procedure\x3c\/code\x3e是对传入的promise和value进行抽象操作。我们可一个把它理解成\x3ccode\x3eresolve(promise, value)\x3c\/code\x3e，对参数promise和value进行一系列处理操作。下面我们按照规范中的顺序，依次介绍每种情况。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2.3.1\x3c\/strong\x3e 如果\x3ccode\x3epromise\x3c\/code\x3e和\x3ccode\x3evalue\x3c\/code\x3e指向同一个对象，则\x3ccode\x3ereject\x3c\/code\x3e该\x3ccode\x3epromise\x3c\/code\x3e并以一个\x3ccode\x3eTypeError\x3c\/code\x3e作为\x3ccode\x3ereason\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var defer = {}\nvar promise = new Promise(function(resolve){ \n    defer.resolve = resolve\n})\npromise.catch(function(reason){\n    console.log(reason)\n})\ndefer.resolve(promise)\n\/\/ TypeError: Chaining cycle detected for promise #\x3cPromise\x3e(…)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e defer = {}\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e)\x3c\/span\x3e{ \n    defer.resolve = resolve\n})\npromise.catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason)\n})\ndefer.resolve(promise)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ TypeError: Chaining cycle detected for promise #\x26lt;Promise\x26gt;(…)\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们把resolve函数保存在defer中，这样就可以在外部对\x3ccode\x3epromise\x3c\/code\x3e进行状态改变，\x3ccode\x3edefer.resolve(promise)\x3c\/code\x3e中的\x3ccode\x3epromise\x3c\/code\x3e正是我们创建的对象，根据规范抛出了\x3ccode\x3eTypeError\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2.3.2\x3c\/strong\x3e 如果\x3ccode\x3evalue\x3c\/code\x3e是一个\x3ccode\x3epromise\x3c\/code\x3e对象，且是基于当前实现创建的。\x3c\/p\x3e\n\x3cp\x3e2.3.2.1 如果\x3ccode\x3evalue\x3c\/code\x3e处于\x3ccode\x3epending\x3c\/code\x3e状态，则\x3ccode\x3epromise\x3c\/code\x3e同样\x3ccode\x3epending\x3c\/code\x3e并直到\x3ccode\x3evalue\x3c\/code\x3e状态改变。\x3cbr\x3e2.3.2.2 如果\x3ccode\x3evalue\x3c\/code\x3e处于\x3ccode\x3efulfilled\x3c\/code\x3e状态，则使用相同的value值fulfill \x3ccode\x3epromise\x3c\/code\x3e。\x3cbr\x3e2.3.2.3 如果\x3ccode\x3evalue\x3c\/code\x3e处于\x3ccode\x3erejected\x3c\/code\x3e状态，则使用相同的reason值reject \x3ccode\x3epromise\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var promise1 = new Promise((resolve) =\x3e {\n    setTimeout(() =\x3e {\n        resolve(5)\n    },3000)\n});\nconsole.time(\x27fulfill\x27)\nvar promise = new Promise((resolve) =\x3e {\n    resolve(promise1)\n})\npromise.then((value) =\x3e {\n    console.timeEnd(\x27fulfill\x27)\n    console.log(\x27fulfill\x27, value)\n})\nsetTimeout(()=\x3e{\n    console.log(\x27setTimeout\x27, promise)\n}, 1000)\n\n\/\/ setTimeout Promise {[[PromiseStatus]]: \x26quot;pending\x26quot;, [[PromiseValue]]: undefined}\n\/\/ fulfill: 3.01e\x2b03ms\n\/\/ fulfill 5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3evar promise1 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n    },\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e)\n});\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.time(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e)\nvar promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    resolve(promise1)\n})\npromise.\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.timeEnd(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e, value)\n})\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27setTimeout\x27\x3c\/span\x3e, promise)\n}, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e setTimeout Promise {[[PromiseStatus]]: \x3cspan class=\x22hljs-string\x22\x3e\x22pending\x22\x3c\/span\x3e, [[PromiseValue]]: \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e}\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e fulfill: \x3cspan class=\x22hljs-number\x22\x3e3.01e\x2b03\x3c\/span\x3ems\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e fulfill \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过该例子可以看出，最后\x3ccode\x3esetTimeout\x3c\/code\x3e延迟1秒查看\x3ccode\x3epromise\x3c\/code\x3e状态时，它依然处于\x3ccode\x3epending\x3c\/code\x3e状态，当3秒后\x3ccode\x3epromise1\x3c\/code\x3e变为\x3ccode\x3efulfilled\x3c\/code\x3e后，\x3ccode\x3epromise\x3c\/code\x3e随即变为\x3ccode\x3efulfilled\x3c\/code\x3e并以5作为value传给\x3ccode\x3ethen\x3c\/code\x3e添加的成功回调函数中。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var promise1 = new Promise((resolve, reject) =\x3e {\n    setTimeout(() =\x3e {\n        reject(new Error(\x27error\x27))\n    }, 3000)\n});\nconsole.time(\x27reject\x27)\nvar promise = new Promise((resolve) =\x3e {\n    resolve(promise1)\n})\npromise.catch((reason) =\x3e {\n    console.timeEnd(\x27reject\x27)\n    console.log(\x27reject\x27, reason)\n})\nsetTimeout(()=\x3e{\n    console.log(\x27setTimeout\x27, promise)\n}, 1000)\n\n\/\/ setTimeout Promise {[[PromiseStatus]]: \x26quot;pending\x26quot;, [[PromiseValue]]: undefined}\n\/\/ reject: 3e\x2b03ms\n\/\/ reject Error: error(…)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3evar promise1 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve, reject)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Error(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e))\n    }, \x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e)\n});\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.time(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e)\nvar promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    resolve(promise1)\n})\npromise.\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(reason)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.timeEnd(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e, reason)\n})\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27setTimeout\x27\x3c\/span\x3e, promise)\n}, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e setTimeout Promise {[[PromiseStatus]]: \x3cspan class=\x22hljs-string\x22\x3e\x22pending\x22\x3c\/span\x3e, [[PromiseValue]]: \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e}\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e reject: \x3cspan class=\x22hljs-number\x22\x3e3e\x2b03\x3c\/span\x3ems\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e reject Error: error(…)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e失败时例子与成功时类似。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2.3.3\x3c\/strong\x3e 如果\x3ccode\x3evalue\x3c\/code\x3e是一个对象或函数\x3cbr\x3e2.3.3.1 使\x3ccode\x3ethen\x3c\/code\x3e等于\x3ccode\x3evalue.then\x3c\/code\x3e\x3cbr\x3e2.3.3.2 如果获取\x3ccode\x3evalue.then\x3c\/code\x3e的值时抛出异常，这通过该异常\x3ccode\x3ereject\x3c\/code\x3e \x3ccode\x3epromise\x3c\/code\x3e，例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise((resolve)=\x3e{\n    resolve({then:(()=\x3e{\n        throw new Error(\x27error\x27)\n        })()\n    })\n}).catch((reason)=\x3e{\n    console.log(reason)\n})\n\/\/ Error: error(…)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e{\n    resolve({then:\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)=\x26gt;{\n        \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x27error\x27\x3c\/span\x3e)\n        }\x3c\/span\x3e)\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\n    })\n}).\x3cspan class=\x22hljs-params\x22\x3ecatch\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)=\x26gt;{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\n}\x3c\/span\x3e)\n\/\/ \x3cspan class=\x22hljs-params\x22\x3eError\x3c\/span\x3e: \x3cspan class=\x22hljs-params\x22\x3eerror\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e…\x3c\/span\x3e)\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上例中获取\x3ccode\x3evalue.then\x3c\/code\x3e时，会抛出异常\x3c\/p\x3e\n\x3cp\x3e2.3.3.3 如果\x3ccode\x3ethen\x3c\/code\x3e是一个函数，则把\x3ccode\x3evalue\x3c\/code\x3e作为函数中\x3ccode\x3ethis\x3c\/code\x3e指向来调用它，第一个参数是\x3ccode\x3eresolvePromise\x3c\/code\x3e，第二个参数是\x3ccode\x3erejectPromise\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e其实这里主要是为了兼容两种情况，第一种是传入的\x3ccode\x3evalue\x3c\/code\x3e是个\x3ccode\x3eDeferred\x3c\/code\x3e对象，则状态和\x3ccode\x3eDeferred\x3c\/code\x3e对象一致；另一种情况是不是使用当前构造函数创建的\x3ccode\x3ePromise\x3c\/code\x3e对象，通过这种方式可以兼容，达到一致的效果。\x3c\/p\x3e\n\x3cp\x3e2.3.3.3.1 如果\x3ccode\x3eresolvePromise\x3c\/code\x3e通过传入\x3ccode\x3ey\x3c\/code\x3e来调用，则执行\x3ccode\x3eresolve(promise, y)\x3c\/code\x3e，例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise((resolve)=\x3e{\n    resolve({then:(resolvePromise, rejectPromise)=\x3e{\n        resolvePromise(5)\n        }\n    })\n}).then((value)=\x3e{\n    console.log(value)\n})\n\/\/ 5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    resolve({then:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolvePromise, rejectPromise)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n        resolvePromise(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n        }\n    })\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value)\n})\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.3.3.3.2 如果\x3ccode\x3erejectPromise \x3c\/code\x3e通过传入原因\x3ccode\x3er\x3c\/code\x3e来调用，则传入\x3ccode\x3er\x3c\/code\x3e来\x3ccode\x3ereject\x3c\/code\x3e \x3ccode\x3epromise\x3c\/code\x3e，例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise((resolve)=\x3e{\n    resolve({then:(resolvePromise, rejectPromise)=\x3e{\n        rejectPromise(new Error(\x27error\x27))\n        }\n    })\n}).catch((reason)=\x3e{\n    console.log(reason)\n})\n\/\/ Error: error(…)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    resolve({then:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolvePromise, rejectPromise)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n        rejectPromise(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Error(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e))\n        }\n    })\n}).\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(reason)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason)\n})\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e Error: error(…)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.3.3.3.3 如果\x3ccode\x3eresolvePromise\x3c\/code\x3e和\x3ccode\x3erejectPromise\x3c\/code\x3e都被调用，或其中一个被调用了多次，则以第一次调用的为准，并忽略之后的调用。例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise((resolve)=\x3e{\n    resolve({then:(resolvePromise, rejectPromise)=\x3e{\n        resolvePromise(5)\n        rejectPromise(new Error(\x27error\x27))\n        }\n    })\n}).then((value)=\x3e{\n    console.log(value)\n}, (reason)=\x3e{\n    console.log(reason)\n})\n\/\/ 5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    resolve({then:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolvePromise, rejectPromise)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n        resolvePromise(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n        rejectPromise(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Error(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e))\n        }\n    })\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value)\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(reason)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason)\n})\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.3.3.3.4 如果调用\x3ccode\x3ethen\x3c\/code\x3e抛出异常\x3ccode\x3ee\x3c\/code\x3e:\x3c\/p\x3e\n\x3cp\x3e2.3.3.3.4.1 如果\x3ccode\x3eresolvePromise\x3c\/code\x3e或\x3ccode\x3erejectPromise\x3c\/code\x3e已经调用，则忽略它，例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise((resolve)=\x3e{\n    resolve({then:(resolvePromise, rejectPromise)=\x3e{\n        resolvePromise(5)\n        throw new Error(\x27error\x27)\n        }\n    })\n}).then((value)=\x3e{\n    console.log(value)\n}, (reason)=\x3e{\n    console.log(reason)\n})\n\/\/ 5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    resolve({then:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolvePromise, rejectPromise)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n        resolvePromise(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n        \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Error(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e)\n        }\n    })\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value)\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(reason)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason)\n})\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.3.3.3.4.2 否则，则传入\x3ccode\x3ee\x3c\/code\x3e来\x3ccode\x3ereject\x3c\/code\x3e \x3ccode\x3epromise\x3c\/code\x3e，例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise((resolve)=\x3e{\n    resolve({then:(resolvePromise, rejectPromise)=\x3e{\n        throw new Error(\x27error\x27)\n        }\n    })\n}).then((value)=\x3e{\n    console.log(value)\n}, (reason)=\x3e{\n    console.log(reason)\n})\n\/\/ Error: error(…)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    resolve({then:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolvePromise, rejectPromise)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Error(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e)\n        }\n    })\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value)\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(reason)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason)\n})\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e Error: error(…)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.3.3.4 如果\x3ccode\x3ethen\x3c\/code\x3e不是一个函数，则传入\x3ccode\x3evalue\x3c\/code\x3e来\x3ccode\x3efulfill\x3c\/code\x3e \x3ccode\x3epromise\x3c\/code\x3e，例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise((resolve)=\x3e{\n    resolve({then:5})\n}).then((value)=\x3e{\n    console.log(value)\n}, (reason)=\x3e{\n    console.log(reason)\n})\n\/\/ Object {then: 5}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    resolve({then:\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e})\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value)\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(reason)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason)\n})\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e Object {then: \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3e\n\x3ccode\x3ethen\x3c\/code\x3e 方法\x3c\/h1\x3e\n\x3cp\x3e一个\x3ccode\x3epromise\x3c\/code\x3e必须提供一个\x3ccode\x3ethen\x3c\/code\x3e方法来处理成功或失败。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ethen\x3c\/code\x3e方法接收两个参数：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22promise.then(onFulfilled, onRejected)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mercury\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3epromise\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3ethen\x3c\/span\x3e(onFulfilled, onRejected)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e2.2.1\x3c\/strong\x3e \x3ccode\x3eonFulfilled\x3c\/code\x3e和\x3ccode\x3eonRejected\x3c\/code\x3e都是可选的\x3cbr\x3e2.2.1.1 如果\x3ccode\x3eonFulfilled\x3c\/code\x3e不是一个函数，则忽略。例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.resolve(5)\n    .then(true,function(reason){\n        console.log(reason)\n    })\n    .then(function(value){\n        console.log(value)\n    })\n\/\/ 5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livecodeserver\x22\x3e\x3ccode\x3ePromise.\x3cspan class=\x22hljs-built_in\x22\x3eresolve\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n    .\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-title\x22\x3ereason\x3c\/span\x3e){\x3c\/span\x3e\n        console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(reason)\n    })\n    .\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-title\x22\x3evalue\x3c\/span\x3e){\x3c\/span\x3e\n        console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3evalue\x3c\/span\x3e)\n    })\x3cspan class=\x22hljs-comment\x22\x3e\n\/\/ 5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.2.1.2 如果\x3ccode\x3eonRejected\x3c\/code\x3e不是一个函数，则忽略。例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.reject(new Error(\x27error\x27))\n    .then(true,null)\n    .then(undefined,function(reason){\n        console.log(reason)\n    })\n\n\/\/ Error: error(…)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e))\n    .then(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e)\n    .then(\x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason)\n    })\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Error: error(…)\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e2.2.2\x3c\/strong\x3e 如果\x3ccode\x3eonFulfilled\x3c\/code\x3e是一个函数\x3cbr\x3e2.2.2.1 它必须在\x3ccode\x3epromise\x3c\/code\x3e变为\x3ccode\x3efulfilled\x3c\/code\x3e之后调用，且把\x3ccode\x3epromise\x3c\/code\x3e的\x3ccode\x3evalue\x3c\/code\x3e作为它的第一个参数\x3c\/p\x3e\n\x3cp\x3e这个从我们所有的例子中都可以看出\x3c\/p\x3e\n\x3cp\x3e2.2.2.2 它不可以在\x3ccode\x3epromise\x3c\/code\x3e变为\x3ccode\x3efulfilled\x3c\/code\x3e之前调用\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var defer = {}\nconsole.time(\x27fulfill\x27)\nvar promise = new Promise((resolve)=\x3e{\n    defer.resolve = resolve\n});\npromise.then((value)=\x3e{\n    console.timeEnd(\x27fulfill\x27)\n})\nsetTimeout(()=\x3e{\n    defer.resolve(5)\n},1000);\n\/\/ fulfill: 1e\x2b03ms  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3evar defer = {}\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.time(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e)\nvar promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    defer.resolve = resolve\n});\npromise.\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.timeEnd(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e)\n})\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    defer.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n},\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e fulfill: \x3cspan class=\x22hljs-number\x22\x3e1e\x2b03\x3c\/span\x3ems  \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e从\x3ccode\x3eonFulfilled\x3c\/code\x3e执行的时间可以看出\x3ccode\x3epromise\x3c\/code\x3e直到变为\x3ccode\x3efulfilled\x3c\/code\x3e后才调用\x3c\/p\x3e\n\x3cp\x3e2.2.2.3 它只可以被调用一次\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var defer = {}\nvar promise = new Promise((resolve)=\x3e{\n    defer.resolve = resolve\n});\npromise.then((value)=\x3e{\n    console.log(value\x2b\x2b)\n})\ndefer.resolve(5)\n\/\/ 5\ndefer.resolve(6)\n\/\/ 后面不再次执行\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e defer = {}\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e{\n    defer.resolve = resolve\n});\npromise.then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value\x2b\x2b)\n})\ndefer.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 5\x3c\/span\x3e\ndefer.resolve(\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 后面不再次执行\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e2.2.3\x3c\/strong\x3e 如果\x3ccode\x3eonRejected\x3c\/code\x3e是一个函数\x3cbr\x3e2.2.3.1 它必须在\x3ccode\x3epromise\x3c\/code\x3e变为\x3ccode\x3erejected\x3c\/code\x3e之后调用，且把\x3ccode\x3epromise\x3c\/code\x3e的\x3ccode\x3ereason\x3c\/code\x3e作为它的第一个参数\x3cbr\x3e2.2.3.2 它不可以在\x3ccode\x3epromise\x3c\/code\x3e变为\x3ccode\x3erejected\x3c\/code\x3e之前调用\x3cbr\x3e2.2.3.3 它只可以被调用一次\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eonRejected\x3c\/code\x3e和\x3ccode\x3eonFulfilled\x3c\/code\x3e基本类似，这里不再次赘述\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2.2.4\x3c\/strong\x3e \x3ccode\x3eonFulfilled\x3c\/code\x3e和\x3ccode\x3eonRejected\x3c\/code\x3e是在执行环境中仅包含平台代码时调用\x3c\/p\x3e\n\x3cp\x3e这里有一个备注，平台代码是指引擎、执行环境、以及\x3ccode\x3epromise\x3c\/code\x3e的实现代码。实际过程中，要确保\x3ccode\x3eonFulfilled\x3c\/code\x3e和\x3ccode\x3eonRejected\x3c\/code\x3e是异步执行的，它是在\x3ccode\x3eevent loop\x3c\/code\x3e过程中\x3ccode\x3ethen\x3c\/code\x3e方法被调用之后的新调用栈中执行。我们可以使用\x3ccode\x3esetTimeout\x3c\/code\x3e或\x3ccode\x3esetImmediate\x3c\/code\x3e等\x3ccode\x3emacro-task\x3c\/code\x3e机制来实现，也可以使用\x3ccode\x3eMutationObserver\x3c\/code\x3e或\x3ccode\x3eprocess.nextTick\x3c\/code\x3e等\x3ccode\x3emicro-task\x3c\/code\x3e机制来实现。\x3ccode\x3epromise\x3c\/code\x3e的实现本身就被看作是平台代码，它本身就包含一个处理器可以调用的任务调度队列。\x3c\/p\x3e\n\x3cp\x3e才疏学浅，没理解它这一条到底要表达一个什么意思。。。应该指的就是异步执行，因为异步执行的时候，页面中同步的逻辑都已经执行完毕，所以只剩下平台代码。\x3c\/p\x3e\n\x3cp\x3e注：原生的\x3ccode\x3ePromise\x3c\/code\x3e实现属于\x3ccode\x3emicro-task\x3c\/code\x3e机制。\x3ccode\x3emacro-task\x3c\/code\x3e和\x3ccode\x3emicro-task\x3c\/code\x3e分别是两种异步任务，它们的不同后面会单独讲一下。下面列出了常见的异步方法都属于那种异步机制：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3emacro-task\x3c\/strong\x3e: script（整体代码）, setTimeout, setInterval, setImmediate, I\/O, UI rendering\x3cbr\x3e\x3cstrong\x3emicro-task\x3c\/strong\x3e: process.nextTick, 原生Promise, Object.observe, MutationObserver\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2.2.5\x3c\/strong\x3e \x3ccode\x3eonFulfilled\x3c\/code\x3e和\x3ccode\x3eonRejected\x3c\/code\x3e必须作为函数来调用，没有\x3ccode\x3ethis\x3c\/code\x3e值\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.resolve(5).then(function(){\n    console.log(this)\n})\n\/\/ Window {speechSynthesis: SpeechSynthesis, caches: CacheStorage, localStorage: Storage, sessionStorage: Storage, webkitStorageInfo: DeprecatedStorageInfo…}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e)\n})\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Window {speechSynthesis: SpeechSynthesis, caches: CacheStorage, localStorage: Storage, sessionStorage: Storage, webkitStorageInfo: DeprecatedStorageInfo…}\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e2.2.6\x3c\/strong\x3e 同一个\x3ccode\x3epromise\x3c\/code\x3e上的\x3ccode\x3ethen\x3c\/code\x3e方法可能会调用多次\x3cbr\x3e2.2.6.1 如果\x3ccode\x3epromise\x3c\/code\x3e \x3ccode\x3efulfilled\x3c\/code\x3e，则所有的\x3ccode\x3eonFulfilled\x3c\/code\x3e回调函数按照它们添加的顺序依次调用。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var defer = {}\nvar promise = new Promise((resolve)=\x3e{\n    defer.resolve = resolve\n});\npromise.then((value)=\x3e{\n    console.log(1,value\x2b\x2b)\n})\npromise.then((value)=\x3e{\n    console.log(2,value\x2b\x2b)\n})\npromise.then((value)=\x3e{\n    console.log(3,value\x2b\x2b)\n})\ndefer.resolve(5)\n\n\/\/ 1 5\n\/\/ 2 5\n\/\/ 3 5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3evar defer = {}\nvar promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    defer.resolve = resolve\n});\npromise.\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,value\x2b\x2b)\n})\npromise.\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e,value\x2b\x2b)\n})\npromise.\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e,value\x2b\x2b)\n})\ndefer.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e\n\/\/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e\n\/\/ \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.2.6.2 如果\x3ccode\x3epromise\x3c\/code\x3e \x3ccode\x3erejected\x3c\/code\x3e，则所有的\x3ccode\x3eonRejected\x3c\/code\x3e回调函数按照它们添加的顺序依次调用。\x3c\/p\x3e\n\x3cp\x3e例子与上例类似\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2.2.7\x3c\/strong\x3e \x3ccode\x3ethen\x3c\/code\x3e方法会返回一个全新的\x3ccode\x3epromise\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22promise2 = promise1.then(onFulfilled, onRejected);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ini\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-attr\x22\x3epromise2\x3c\/span\x3e = promise1.then(\x3cspan class=\x22hljs-literal\x22\x3eon\x3c\/span\x3eFulfilled, \x3cspan class=\x22hljs-literal\x22\x3eon\x3c\/span\x3eRejected);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.2.7.1 如果\x3ccode\x3eonFulfilled\x3c\/code\x3e或\x3ccode\x3eonRejected\x3c\/code\x3e返回了一个值\x3ccode\x3ex\x3c\/code\x3e，则执行\x3ccode\x3eresolve(promise2, x)\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.resolve(5).then(function(value){\n    return \x2b\x2bvalue\n}).then(function(value){\n    console.log(value)\n})\n\/\/ 6\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fortran\x22\x3e\x3ccode\x3ePromise.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x2b\x2b\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e\x3c\/span\x3e{\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e)\n})\n\/\/ \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.2.7.2 如果\x3ccode\x3eonFulfilled\x3c\/code\x3e或\x3ccode\x3eonRejected\x3c\/code\x3e抛出了异常\x3ccode\x3ee\x3c\/code\x3e，则\x3ccode\x3ereject\x3c\/code\x3e \x3ccode\x3epromise2\x3c\/code\x3e并传入原因\x3ccode\x3ee\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.resolve(5).then(function(value){\n    throw new Error(\x27error\x27)\n}).catch(function(reason){\n    console.log(reason)\n})\n\/\/ Error: error(…)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e)\n}).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason)\n})\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Error: error(…)\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.2.7.3 如果\x3ccode\x3eonFulfilled\x3c\/code\x3e不是一个函数且\x3ccode\x3epromise1\x3c\/code\x3e \x3ccode\x3efulfilled\x3c\/code\x3e，则\x3ccode\x3epromise2\x3c\/code\x3e以同样的\x3ccode\x3evalue\x3c\/code\x3e \x3ccode\x3efulfill\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.resolve(5).then(\x26quot;tiaoguo\x26quot;).then(function(value){\n    console.log(value)\n})\n\/\/ 5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livecodeserver\x22\x3e\x3ccode\x3ePromise.\x3cspan class=\x22hljs-built_in\x22\x3eresolve\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22tiaoguo\x22\x3c\/span\x3e).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-title\x22\x3evalue\x3c\/span\x3e){\x3c\/span\x3e\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3evalue\x3c\/span\x3e)\n})\x3cspan class=\x22hljs-comment\x22\x3e\n\/\/ 5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.2.7.4 如果\x3ccode\x3eonRejected\x3c\/code\x3e不是一个函数且\x3ccode\x3epromise1\x3c\/code\x3e \x3ccode\x3erejected\x3c\/code\x3e，则\x3ccode\x3epromise2\x3c\/code\x3e以同样的\x3ccode\x3ereason\x3c\/code\x3e \x3ccode\x3ereject\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.reject(new Error(\x27error\x27)).catch(\x27tiaoguo\x27).catch(function(reason){\n    console.log(reason)\n})\n\/\/ Error: error(…)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e)).catch(\x3cspan class=\x22hljs-string\x22\x3e\x27tiaoguo\x27\x3c\/span\x3e).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason)\n})\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Error: error(…)\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e更多的测试代码，大家可以去\x3ca href=\x22https:\/\/github.com\/promises-aplus\/promises-tests\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3epromises-tests\x3c\/a\x3e中查看，这是一个基于规范的\x3ccode\x3epromise\x3c\/code\x3e测试库。\x3c\/p\x3e\n\x3cp\x3e以上基本是整个\x3ccode\x3ePromise\/A\x2b\x3c\/code\x3e规范的所有内容，如有错误，欢迎批评指正。下一篇我会根据规范一步一步实现一个\x3ccode\x3ePromise\x3c\/code\x3e \x3ccode\x3epolyfill\x3c\/code\x3e库。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Promise介绍&ndash;规范篇</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007719379">https://segmentfault.com/a/1190000007719379</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/yr7v8e9fao/" target="_blank">https://alili.tech/archive/yr7v8e9fao/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>