<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="React实现滑动选择插件（仿Antd-mobile Picker）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>React实现滑动选择插件（仿Antd-mobile Picker） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/cspxm3gudku/",
				"appid": "1613049289050283", 
				"title": "React实现滑动选择插件（仿Antd-mobile Picker） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-13T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/2bd3gfrgiw6/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/63ihc1gvycq/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fcspxm3gudku%2f&text=React%e5%ae%9e%e7%8e%b0%e6%bb%91%e5%8a%a8%e9%80%89%e6%8b%a9%e6%8f%92%e4%bb%b6%ef%bc%88%e4%bb%bfAntd-mobile%20Picker%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fcspxm3gudku%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fcspxm3gudku%2f&text=React%e5%ae%9e%e7%8e%b0%e6%bb%91%e5%8a%a8%e9%80%89%e6%8b%a9%e6%8f%92%e4%bb%b6%ef%bc%88%e4%bb%bfAntd-mobile%20Picker%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fcspxm3gudku%2f&title=React%e5%ae%9e%e7%8e%b0%e6%bb%91%e5%8a%a8%e9%80%89%e6%8b%a9%e6%8f%92%e4%bb%b6%ef%bc%88%e4%bb%bfAntd-mobile%20Picker%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fcspxm3gudku%2f&is_video=false&description=React%e5%ae%9e%e7%8e%b0%e6%bb%91%e5%8a%a8%e9%80%89%e6%8b%a9%e6%8f%92%e4%bb%b6%ef%bc%88%e4%bb%bfAntd-mobile%20Picker%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=React%e5%ae%9e%e7%8e%b0%e6%bb%91%e5%8a%a8%e9%80%89%e6%8b%a9%e6%8f%92%e4%bb%b6%ef%bc%88%e4%bb%bfAntd-mobile%20Picker%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fcspxm3gudku%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fcspxm3gudku%2f&title=React%e5%ae%9e%e7%8e%b0%e6%bb%91%e5%8a%a8%e9%80%89%e6%8b%a9%e6%8f%92%e4%bb%b6%ef%bc%88%e4%bb%bfAntd-mobile%20Picker%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fcspxm3gudku%2f&title=React%e5%ae%9e%e7%8e%b0%e6%bb%91%e5%8a%a8%e9%80%89%e6%8b%a9%e6%8f%92%e4%bb%b6%ef%bc%88%e4%bb%bfAntd-mobile%20Picker%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fcspxm3gudku%2f&title=React%e5%ae%9e%e7%8e%b0%e6%bb%91%e5%8a%a8%e9%80%89%e6%8b%a9%e6%8f%92%e4%bb%b6%ef%bc%88%e4%bb%bfAntd-mobile%20Picker%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fcspxm3gudku%2f&title=React%e5%ae%9e%e7%8e%b0%e6%bb%91%e5%8a%a8%e9%80%89%e6%8b%a9%e6%8f%92%e4%bb%b6%ef%bc%88%e4%bb%bfAntd-mobile%20Picker%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">React实现滑动选择插件（仿Antd-mobile Picker）</h1><div class="meta"><div class="postdate"><time datetime="2019-01-13" itemprop="datePublished">2019-01-13</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e效果图\x3c\/h1\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVOuxh?w=382\x26amp;h=689\x22 src=\x22https:\/\/static.alili.tech\/img\/bVOuxh?w=382\x26amp;h=689\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e需求\x3c\/h1\x3e\n\x3cp\x3e由于移动端iOS和安卓原生select样式和效果不同，同一个控件在不同系统上效果不同。\x3cbr\x3e所以决定制作一个跟iOS风格类似的，可以滚动，选择器插件。\x3cbr\x3e之后看到了antd-mobile里面的picker插件符合我们的要求，使用了一段时间感觉其效果不错，隧查看源码，探究其制作过程。\x3cbr\x3e但是antd-mobile是Typescript编写的，跟React类似，但是又不太一样。所以基本是关键问题查看其做参考，剩下的自己实现。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3eStep1 组件分析\x3c\/h1\x3e\n\x3cp\x3e经过查看和分析后 可以得出结论（如下图）\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVOux2?w=766\x26amp;h=1354\x22 src=\x22https:\/\/static.alili.tech\/img\/bVOux2?w=766\x26amp;h=1354\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e该组件（Picker）大致分成3个部分\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3echildren 触发组件弹出的部分，一般为List Item。其实就是该组件的this.props.children。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3emask 组件弹出之后的遮罩，点击遮罩组件消失，值不变（相当于是点击取消）。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3epopup 组件弹出之后的内容，分成上下两个部分，其中下半部分是核心（antd-mobile中将其单独提出来 叫做PickerView）。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e第3部分PickerView即为极为复杂，考虑到扩展性：\x3cbr\x3e这里面的列数是可变的（最多不能超过5个）；\x3cbr\x3e每一列滚动结束 其后面的列对应的数组和默认值都要发生改变；\x3cbr\x3e每一列都是支持滚动操作的（手势操作）。\x3cbr\x3e组件化之后如图：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVOuyx?w=780\x26amp;h=1038\x22 src=\x22https:\/\/static.alili.tech\/img\/bVOuyx?w=780\x26amp;h=1038\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e分析之后可以看出 第3部分是该组件的核心应该优先制作。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3eStep 2 使用方法确定\x3c\/h1\x3e\n\x3cp\x3e在做之前应该想好输入和输出。\x3cbr\x3e该组件需要哪些参数，参数多少也决定了功能多少。\x3cbr\x3e参照antd-mobile的文档 确定参数如下：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3edata：组件的数据源 每列应该显示的数据的一个集合 有固定的数据结构\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ecol：组件应该显示的列数\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evalue：默认显示的值 一个数组 每一项对应各个列的值\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3etext：popup组件中间的提示文字\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ecancelText：取消按钮可自定义的文字 默认为取消\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3econfirmText：确定按钮自定义的文字 默认为确定\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ecascade：是否级联 就是每一列的值变化 是否会影响其后面的列对应数组和值得变化 是否级联也会影响到数据源数据结果的不同\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eonChange：点击确定之后 组件值发生变化之后的回调\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eonPickerChange：每一列的值变化之后的回调\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eonCancel：取消之后的回调\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e参数确定之后要确定两个核心参数的数据结构\x3cbr\x3e级联时候data的数据结构\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const areaArray = [\n    {label: \x27北京市\x27, value: \x27北京市\x27, children: [\n        {label: \x27北京市\x27, value: \x27北京市\x27, children: [\n            {label: \x27朝阳区\x27, value: \x27朝阳区\x27},            {label: \x27海淀区\x27, value: \x27朝阳区\x27},            {label: \x27东城区\x27, value: \x27朝阳区\x27},            {label: \x27西城区\x27, value: \x27朝阳区\x27}\n        ]}\n    ]},    {label: \x27辽宁省\x27, value: \x27辽宁省\x27, children: [\n        {label: \x27沈阳市\x27, value: \x27沈阳市\x27, children: [\n            {label: \x27沈河区\x27, value: \x27沈河区\x27},            {label: \x27浑南区\x27, value: \x27浑南区\x27},            {label: \x27沈北新区\x27, value: \x27沈北新区\x27},        ]},        {label: \x27本溪市\x27, value: \x27本溪市\x27, children: [\n            {label: \x27溪湖区\x27, value: \x27溪湖区\x27},            {label: \x27东明区\x27, value: \x27东明区\x27},            {label: \x27桓仁满族自治县\x27, value: \x27桓仁满族自治县\x27},        ]}\n    ]},    {label: \x27云南省\x27, value: \x27云南省\x27, children: [\n        {label: \x27昆明市\x27, value: \x27昆明市\x27, children:[\n            {label: \x27五华区\x27, value: \x27五华区\x27},            {label: \x27官渡区\x27, value: \x27官渡区\x27},            {label: \x27呈贡区\x27, value: \x27呈贡区\x27},        ]}\n    ]},];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3econst areaArray = [\n    {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27北京市\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27北京市\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3echildren:\x3c\/span\x3e [\n        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27北京市\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27北京市\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3echildren:\x3c\/span\x3e [\n            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27朝阳区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27朝阳区\x27\x3c\/span\x3e},            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27海淀区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27朝阳区\x27\x3c\/span\x3e},            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27东城区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27朝阳区\x27\x3c\/span\x3e},            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27西城区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27朝阳区\x27\x3c\/span\x3e}\n        ]}\n    ]},    {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27辽宁省\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27辽宁省\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3echildren:\x3c\/span\x3e [\n        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27沈阳市\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27沈阳市\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3echildren:\x3c\/span\x3e [\n            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27沈河区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27沈河区\x27\x3c\/span\x3e},            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27浑南区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27浑南区\x27\x3c\/span\x3e},            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27沈北新区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27沈北新区\x27\x3c\/span\x3e},        ]},        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27本溪市\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27本溪市\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3echildren:\x3c\/span\x3e [\n            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27溪湖区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27溪湖区\x27\x3c\/span\x3e},            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27东明区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27东明区\x27\x3c\/span\x3e},            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27桓仁满族自治县\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27桓仁满族自治县\x27\x3c\/span\x3e},        ]}\n    ]},    {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27云南省\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27云南省\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3echildren:\x3c\/span\x3e [\n        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27昆明市\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27昆明市\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3echildren:\x3c\/span\x3e[\n            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27五华区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27五华区\x27\x3c\/span\x3e},            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27官渡区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27官渡区\x27\x3c\/span\x3e},            {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27呈贡区\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27呈贡区\x27\x3c\/span\x3e},        ]}\n    ]},];\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e对应value的数据结构：\x3ccode\x3e[\x27辽宁省\x27, \x27本溪市\x27, \x27桓仁满族自治县’]\x3c\/code\x3e\x3cbr\x3e不级联的时候 data则为\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const numberArray = [\n    [\n        {label: \x27一\x27, value: \x27一\x27},        {label: \x27二\x27, value: \x27二\x27},        {label: \x27三\x27, value: \x27三\x27}\n    ],    [\n        {label: \x271\x27, value: \x271\x27},        {label: \x272\x27, value: \x272\x27},        {label: \x273\x27, value: \x273\x27},        {label: \x274\x27, value: \x274\x27}\n    ],    [\n        {label: \x27壹\x27, value: \x27壹\x27},        {label: \x27貮\x27, value: \x27貮\x27},        {label: \x27叁\x27, value: \x27叁\x27}\n    ]\n];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3econst numberArray = [\n    [\n        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27一\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27一\x27\x3c\/span\x3e},        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27二\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27二\x27\x3c\/span\x3e},        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27三\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27三\x27\x3c\/span\x3e}\n    ],    [\n        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e},        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e},        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x273\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x273\x27\x3c\/span\x3e},        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x274\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x274\x27\x3c\/span\x3e}\n    ],    [\n        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27壹\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27壹\x27\x3c\/span\x3e},        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27貮\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27貮\x27\x3c\/span\x3e},        {\x3cspan class=\x22hljs-string\x22\x3elabel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27叁\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27叁\x27\x3c\/span\x3e}\n    ]\n];\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e此时value为：\x3ccode\x3e[\x27一\x27, \x274\x27, \x27貮’]\x3c\/code\x3e。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader4\x22\x3eStep 3 PickerView制作\x3c\/h1\x3e\n\x3cp\x3ePicker组件的核心就是PickerView组件 \x3cbr\x3ePickerView组件里面每个列功能比较集中，重用程度较高，故将其封装成PickerColumn组件。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3eStep 3-1 PickerView搭建\x3c\/h2\x3e\n\x3cp\x3ePickerView主要的功能就是根据传给自己的props，整理出需要渲染几列PickerColumn，并且整理出PickerColumn需要的参数和回调。\x3cbr\x3ePickerView起到在Picker和PickerColumn中的做数据转换和传递的功能。\x3cbr\x3e这里要注意的几点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3ePickerView是个非受控组件，初始化的时候，将props中的value存成自己的state，以后向外暴露自己的state。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e在级联的情况下，每次PickerColumn的值变化的时候，都要给每个Column计算他对应的data，这里用到了递归调用，这里的算法写的不是很完美（重点是handleValueChange, getColums, getColumnData, getNewValue这几个方法）。\x3cbr\x3ePickerView的源码如下：\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import React from \x27react\x27\nimport PickerColumn from \x27.\/PickerColumn\x27\n\n\/\/ 选择器组件\nclass PickerView extends React.Component {\n    static defaultProps = {\n        col: 1,\n        cascade: true\n    };\n    static propTypes = {\n        col: React.PropTypes.number,\n        data: React.PropTypes.array,\n        value: React.PropTypes.array,\n        cascade: React.PropTypes.bool,\n        onChange: React.PropTypes.func\n    };\n    constructor (props) {\n        super(props);\n        this.state = {\n            defaultSelectedValue: []\n        }\n    }\n    componentDidMount () {\n        \/\/ picker view 当做一个非受控组件\n        let {value} = this.props;\n        this.setState({\n            defaultSelectedValue: value\n        });\n    }\n    handleValueChange (newValue, index) {\n        \/\/ 子组件column发生变化的回调函数\n        \/\/ 每次值发生变化 都要判断整个值数组的新值\n        let {defaultSelectedValue} = this.state;\n        let {data, cascade, onChange} = this.props;\n        let oldValue = defaultSelectedValue.slice();\n        oldValue[index] = newValue;\n\n        if(cascade){\n            \/\/ 如果级联的情况下\n            const newState = this.getNewValue(data, oldValue, [], 0);\n\n            this.setState({\n                defaultSelectedValue: newState\n            });\n\n            \/\/ 如果有回调\n            if(onChange){\n                onChange(newState);\n            }\n        } else {\n            \/\/ 不级联 单纯改对应数据\n            this.setState({\n                defaultSelectedValue: oldValue\n            });\n\n            \/\/ 如果有回调\n            if(onChange){\n                onChange(oldValue);\n            }\n        }\n    }\n    getColumns () {\n        let result = [];\n        let {col, data, cascade} = this.props;\n        let {defaultSelectedValue} = this.state;\n\n        if(defaultSelectedValue.length == 0) return;\n\n        let array;\n\n        if(cascade){\n            array = this.getColumnsData(data, defaultSelectedValue, [], 0);\n        } else {\n            array = data;\n        }\n\n        for(let i = 0; i \x3c col; i\x2b\x2b){\n            result.push(\x3cPickerColumn\n                key={i}\n                value={defaultSelectedValue[i]}\n                data={array[i]}\n                index={i}\n                onValueChange={this.handleValueChange.bind(this)}\n            \/\x3e);\n        }\n\n        return result;\n    }\n    getColumnsData (tree, value, hasFind, deep) {\n        \/\/ 遍历tree\n        let has;\n        let array = [];\n        for(let i = 0; i \x3c tree.length; i\x2b\x2b){\n            array.push({label: tree[i].label, value: tree[i].value});\n            if(tree[i].value == value[deep]) {\n                has = i;\n            }\n        }\n\n        \/\/ 判断有没有找到\n        \/\/ 没找到return\n        \/\/ 找到了 没有下一集 也return\n        \/\/ 有下一级 则递归\n        if(has == undefined) return hasFind;\n\n        hasFind.push(array);\n        if(tree[has].children) {\n            this.getColumnsData(tree[has].children, value, hasFind, deep\x2b1);\n        }\n\n        return hasFind;\n    }\n    getNewValue (tree, oldValue, newValue, deep) {\n        \/\/ 遍历tree\n        let has;\n        for(let i = 0; i \x3c tree.length; i\x2b\x2b){\n            if(tree[i].value == oldValue[deep]) {\n                newValue.push(tree[i].value);\n                has = i;\n            }\n        }\n\n        if(has == undefined) {\n            has = 0;\n            newValue.push(tree[has].value);\n        }\n\n        if(tree[has].children) {\n            this.getNewValue(tree[has].children, oldValue, newValue, deep\x2b1);\n        }\n\n        return newValue;\n    }\n    render () {\n        const columns = this.getColumns();\n\n        return (\n            \x3cdiv className=\x26quot;zby-picker-view-box\x26quot;\x3e\n                {columns}\n            \x3c\/div\x3e\n        )\n    }\n}\n\nexport default PickerView\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React from \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e PickerColumn from \x3cspan class=\x22hljs-string\x22\x3e\x27.\/PickerColumn\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 选择器组件\x3c\/span\x3e\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ePickerView\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n    static defaultProps = {\n        col: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n        cascade: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n    };\n    static propTypes = {\n        col: React.PropTypes.number,\n        \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e: React.PropTypes.array,\n        value: React.PropTypes.array,\n        cascade: React.PropTypes.bool,\n        onChange: React.PropTypes.func\n    };\n    \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e (props) {\n        \x3cspan class=\x22hljs-keyword\x22\x3esuper\x3c\/span\x3e(props);\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state = {\n            defaultSelectedValue: []\n        }\n    }\n    componentDidMount () {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ picker view 当做一个非受控组件\x3c\/span\x3e\n        let {value} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n            defaultSelectedValue: value\n        });\n    }\n    handleValueChange (newValue, index) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 子组件column发生变化的回调函数\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 每次值发生变化 都要判断整个值数组的新值\x3c\/span\x3e\n        let {defaultSelectedValue} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state;\n        let {\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e, cascade, onChange} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n        let oldValue = defaultSelectedValue.slice();\n        oldValue[index] = newValue;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(cascade){\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果级联的情况下\x3c\/span\x3e\n            const newState = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getNewValue(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e, oldValue, [], \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n                defaultSelectedValue: newState\n            });\n\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果有回调\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(onChange){\n                onChange(newState);\n            }\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 不级联 单纯改对应数据\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n                defaultSelectedValue: oldValue\n            });\n\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果有回调\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(onChange){\n                onChange(oldValue);\n            }\n        }\n    }\n    getColumns () {\n        let result = [];\n        let {col, \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e, cascade} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n        let {defaultSelectedValue} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(defaultSelectedValue.length == \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n\n        let array;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(cascade){\n            array = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getColumnsData(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e, defaultSelectedValue, [], \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            array = \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e;\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(let i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; col; i\x2b\x2b){\n            result.push(\x26lt;PickerColumn\n                key={i}\n                value={defaultSelectedValue[i]}\n                \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e={array[i]}\n                index={i}\n                onValueChange={\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleValueChange.bind(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e)}\n            \/\x26gt;);\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e result;\n    }\n    getColumnsData (tree, value, hasFind, deep) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 遍历tree\x3c\/span\x3e\n        let has;\n        let array = [];\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(let i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; tree.length; i\x2b\x2b){\n            array.push({label: tree[i].label, value: tree[i].value});\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(tree[i].value == value[deep]) {\n                has = i;\n            }\n        }\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 判断有没有找到\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 没找到return\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 找到了 没有下一集 也return\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 有下一级 则递归\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(has == undefined) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e hasFind;\n\n        hasFind.push(array);\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(tree[has].children) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getColumnsData(tree[has].children, value, hasFind, deep\x2b\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e hasFind;\n    }\n    getNewValue (tree, oldValue, newValue, deep) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 遍历tree\x3c\/span\x3e\n        let has;\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(let i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; tree.length; i\x2b\x2b){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(tree[i].value == oldValue[deep]) {\n                newValue.push(tree[i].value);\n                has = i;\n            }\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(has == undefined) {\n            has = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n            newValue.push(tree[has].value);\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(tree[has].children) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getNewValue(tree[has].children, oldValue, newValue, deep\x2b\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e newValue;\n    }\n    render () {\n        const columns = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getColumns();\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n            \x26lt;div className=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-view-box\x22\x3c\/span\x3e\x26gt;\n                {columns}\n            \x26lt;\/div\x26gt;\n        )\n    }\n}\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e PickerView\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3eStep 3-2 PickerColumn封装\x3c\/h2\x3e\n\x3cp\x3ePickerColumn是PickerView的核心，其作用：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e根据data生成选项列表\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e根据value 选中对应选项\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e识别滚动手势操作 用户在每一列自由滚动\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e滚动停止时候 识别当前选中的值 并反馈给PickerView\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e这里前两项都好做，关键是3 4两项\x3cbr\x3e移动端手势操作之前一直使用的是Hammer.js。\x3cbr\x3e但是在React中，并没有太好的插件，github上有一个人封装的\x3ca href=\x22https:\/\/github.com\/JedWatson\/react-hammerjs\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-hammer\x3c\/a\x3e插件，start到是很多(400\x2b) 但是最近用起来总是报错。。。。\x3cbr\x3e有人提问 却没人解决 所以也没敢选用\x3cbr\x3e后来想引入Hammer.js自己进行封装 然后发现要封装的东西不少。。。。\x3cbr\x3e最后看了Antd-mobile的源码 选用了何一鸣的\x3ca href=\x22https:\/\/github.com\/yiminghe\/zscroller\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ezscroller\x3c\/a\x3e插件 \x3cbr\x3e该插件可以说很好地满足了这里的需要 很不错 推荐\x3c\/p\x3e\n\x3cp\x3e选好了插件之后 问题就简单了很多 PickerColumn也就没什么难度了 \x3cbr\x3e最后吐槽一句 这个zscroller是好，但是文档太少了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import React from \x27react\x27\nimport ZScroller from \x27zscroller\x27\nimport classNames from \x27classnames\x27\n\n\/\/ picker-view 中的列\nclass PickerColumn extends React.Component {\n    static propTypes = {\n        index: React.PropTypes.number,\n        data: React.PropTypes.array,\n        value: React.PropTypes.string,\n        onValueChange: React.PropTypes.func\n    };\n    componentDidMount () {\n        \/\/ 绑定事件\n        this.bindScrollEvent();\n        \/\/ 列表滚到对应位置\n        this.scrollToPosition();\n    }\n    componentDidUpdate() {\n        this.zscroller.reflow();\n        this.scrollToPosition();\n    }\n    componentWillUnmount() {\n        this.zscroller.destroy();\n    }\n    bindScrollEvent () {\n        \/\/ 绑定滚动的事件\n        const content = this.refs.content;\n        \/\/ getBoundingClientRect js原生方法\n        this.itemHeight = this.refs.indicator.getBoundingClientRect().height;\n\n        \/\/ 最后还是用了何一鸣的zscroll插件\n        \/\/ 但是这个插件并没有太多的文档介绍 gg\n        \/\/ 插件demo地址：http:\/\/yiminghe.me\/zscroller\/examples\/demo.html\n        let t = this;\n        this.zscroller = new ZScroller(content, {\n            scrollbars: false,\n            scrollingX: false,\n            snapping: true, \/\/ 滚动结束之后 滑动对应的位置\n            penetrationDeceleration: .1,\n            minVelocityToKeepDecelerating: 0.5,\n            scrollingComplete () {\n                \/\/ 滚动结束 回调\n                t.scrollingComplete();\n            }\n        });\n\n        \/\/ 设置每个格子的高度 这样滚动结束 自动滚到对应格子上\n        \/\/ 单位必须是px 所以要动态取一下\n        this.zscroller.scroller.setSnapSize(0, this.itemHeight);\n    }\n    scrollingComplete () {\n        \/\/ 滚动结束 判断当前选中值\n        const { top } = this.zscroller.scroller.getValues();\n        const {data, value, index, onValueChange} = this.props;\n\n        let currentIndex = top \/ this.itemHeight;\n        const floor = Math.floor(currentIndex);\n        if (currentIndex - floor \x3e 0.5) {\n            currentIndex = floor \x2b 1;\n        } else {\n            currentIndex = floor;\n        }\n\n        const selectedValue = data[currentIndex].value;\n\n        if(selectedValue != value){\n            \/\/ 值发生变化 通知父组件\n            onValueChange(selectedValue, index);\n        }\n    }\n    scrollToPosition () {\n        \/\/ 滚动到选中的位置\n        let {data, value} = this.props;\n\n        data.map((item)=\x3e{\n            if(item.value == value){\n                this.selectByIndex();\n                return;\n            }\n        });\n\n        for(let i = 0; i \x3c data.length; i\x2b\x2b){\n            if(data[i].value == value){\n                this.selectByIndex(i);\n                return;\n            }\n        }\n\n        this.selectByIndex(0);\n    }\n    selectByIndex (index) {\n        \/\/ 滚动到index对应的位置\n        let top = this.itemHeight * index;\n\n        this.zscroller.scroller.scrollTo(0, top);\n    }\n    getCols () {\n        \/\/ 根据value 和 index 获取到对应的data\n        let {data, value, index} = this.props;\n        let result = [];\n\n        for(let i = 0; i \x3c data.length; i\x2b\x2b){\n            result.push(\x3cdiv key={index \x2b \x26quot;-\x26quot; \x2b i} className={classNames([\x27zby-picker-view-col\x27, {\x27selected\x27: data[i].value == value}])}\x3e{data[i].label}\x3c\/div\x3e);\n        }\n\n        return result;\n    }\n    render () {\n        let cols = this.getCols();\n\n        return (\n            \x3cdiv className=\x26quot;zby-picker-view-item\x26quot;\x3e\n                \x3cdiv className=\x26quot;zby-picker-view-list\x26quot;\x3e\n                    \x3cdiv className=\x26quot;zby-picker-view-window\x26quot;\x3e\x3c\/div\x3e\n                    \x3cdiv className=\x26quot;zby-picker-view-indicator\x26quot; ref=\x26quot;indicator\x26quot;\x3e\x3c\/div\x3e\n                    \x3cdiv className=\x26quot;zby-picker-view-content\x26quot; ref=\x26quot;content\x26quot;\x3e\n                        {cols}\n                    \x3c\/div\x3e\n                \x3c\/div\x3e\n            \x3c\/div\x3e\n        )\n    }\n}\n\nexport default PickerColumn;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e ZScroller \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27zscroller\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e classNames \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27classnames\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ picker-view 中的列\x3c\/span\x3e\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ePickerColumn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3estatic\x3c\/span\x3e propTypes = {\n        \x3cspan class=\x22hljs-attr\x22\x3eindex\x3c\/span\x3e: React.PropTypes.number,\n        \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e: React.PropTypes.array,\n        \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: React.PropTypes.string,\n        \x3cspan class=\x22hljs-attr\x22\x3eonValueChange\x3c\/span\x3e: React.PropTypes.func\n    };\n    componentDidMount () {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绑定事件\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.bindScrollEvent();\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 列表滚到对应位置\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.scrollToPosition();\n    }\n    componentDidUpdate() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.zscroller.reflow();\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.scrollToPosition();\n    }\n    componentWillUnmount() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.zscroller.destroy();\n    }\n    bindScrollEvent () {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绑定滚动的事件\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e content = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.refs.content;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ getBoundingClientRect js原生方法\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.itemHeight = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.refs.indicator.getBoundingClientRect().height;\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 最后还是用了何一鸣的zscroll插件\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 但是这个插件并没有太多的文档介绍 gg\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插件demo地址：http:\/\/yiminghe.me\/zscroller\/examples\/demo.html\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e t = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.zscroller = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ZScroller(content, {\n            \x3cspan class=\x22hljs-attr\x22\x3escrollbars\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3escrollingX\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3esnapping\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 滚动结束之后 滑动对应的位置\x3c\/span\x3e\n            penetrationDeceleration: \x3cspan class=\x22hljs-number\x22\x3e.1\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eminVelocityToKeepDecelerating\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e0.5\x3c\/span\x3e,\n            scrollingComplete () {\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 滚动结束 回调\x3c\/span\x3e\n                t.scrollingComplete();\n            }\n        });\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置每个格子的高度 这样滚动结束 自动滚到对应格子上\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 单位必须是px 所以要动态取一下\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.zscroller.scroller.setSnapSize(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.itemHeight);\n    }\n    scrollingComplete () {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 滚动结束 判断当前选中值\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e { top } = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.zscroller.scroller.getValues();\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e {data, value, index, onValueChange} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e currentIndex = top \/ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.itemHeight;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e floor = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(currentIndex);\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (currentIndex - floor \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0.5\x3c\/span\x3e) {\n            currentIndex = floor \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            currentIndex = floor;\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e selectedValue = data[currentIndex].value;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(selectedValue != value){\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 值发生变化 通知父组件\x3c\/span\x3e\n            onValueChange(selectedValue, index);\n        }\n    }\n    scrollToPosition () {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 滚动到选中的位置\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e {data, value} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n\n        data.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(item.value == value){\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.selectByIndex();\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n            }\n        });\n\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; data.length; i\x2b\x2b){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(data[i].value == value){\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.selectByIndex(i);\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n            }\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.selectByIndex(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n    }\n    selectByIndex (index) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 滚动到index对应的位置\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e top = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.itemHeight * index;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.zscroller.scroller.scrollTo(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, top);\n    }\n    getCols () {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据value 和 index 获取到对应的data\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e {data, value, index} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e result = [];\n\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; data.length; i\x2b\x2b){\n            result.push(\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{index\x3c\/span\x3e \x2b \x22\x3cspan class=\x22hljs-attr\x22\x3e-\x3c\/span\x3e\x22 \x2b \x3cspan class=\x22hljs-attr\x22\x3ei\x3c\/span\x3e} \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{classNames([\x3c\/span\x3e\x27\x3cspan class=\x22hljs-attr\x22\x3ezby-picker-view-col\x3c\/span\x3e\x27, {\x27\x3cspan class=\x22hljs-attr\x22\x3eselected\x3c\/span\x3e\x27\x3cspan class=\x22hljs-attr\x22\x3e:\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e[\x3cspan class=\x22hljs-attr\x22\x3ei\x3c\/span\x3e]\x3cspan class=\x22hljs-attr\x22\x3e.value\x3c\/span\x3e == \x3cspan class=\x22hljs-string\x22\x3evalue}])}\x3c\/span\x3e\x26gt;\x3c\/span\x3e{data[i].label}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e);\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e result;\n    }\n    render () {\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e cols = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getCols();\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n            \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-view-item\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-view-list\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-view-window\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-view-indicator\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22indicator\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-view-content\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                        {cols}\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n        )\n    }\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e PickerColumn;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里还有一点要注意，就是CSS\x3cbr\x3eColumn有个遮罩，遮罩的上半部分和下半部分有个白色白透明效果。\x3cbr\x3e这个是照抄antd-mobile实现的，两个高度一般的渐变，作为上半部分和下班部分的background来实现，中间则是透明的。\x3cbr\x3e到此PickerView制作完成，Picker插件的核心也就完成了。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader7\x22\x3eStep 4 Picker制作\x3c\/h1\x3e\n\x3cp\x3e剩下的Picker功能就是很常规的业务了\x3cbr\x3e1.自定义文案的显示\x3cbr\x3e2.popup和mask的显示和隐藏\x3cbr\x3e3.数据的传递回调函数\x3c\/p\x3e\n\x3cp\x3e这里有一点：考虑到页面如果有大量的Picker组件，会产生很多，隐藏的popup和mask，而且每个PickerColumn都要初始化zscroller性能不是很好。所以当没有点击picker的时候mask和popup都是不输出在页面内的；\x3cbr\x3e但是这样就造成了一个问题：mask和popup显示和隐藏的时候比较突兀，加了一个iOS上常见的淡入淡出和滑入滑出动画。所以写了个setTimeout来等动画完成之后，显示和隐藏。不知道有没有什么更好的方法实现这类动画效果。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import React from \x27react\x27\nimport classNames from \x27classnames\x27\nimport PickerView from \x27.\/PickerView\x27\nimport Touchable from \x27rc-touchable\x27\n\n\/\/ 选择器组件\nclass Picker extends React.Component {\n    static defaultProps = {\n        col: 1,\n        cancelText: \x26quot;取消\x26quot;,\n        confirmText: \x26quot;确定\x26quot;,\n        cascade: true\n    };\n    static propTypes = {\n        col: React.PropTypes.number,\n        data: React.PropTypes.array,\n        value: React.PropTypes.array,\n        cancelText: React.PropTypes.string,\n        title: React.PropTypes.string,\n        confirmText: React.PropTypes.string,\n        cascade: React.PropTypes.bool,\n        onChange: React.PropTypes.func,\n        onCancel: React.PropTypes.func\n    };\n    constructor (props) {\n        super(props);\n        this.state = {\n            defaultValue: undefined,\n            selectedValue: undefined,\n            animation: \x26quot;out\x26quot;,\n            show: false\n        }\n    }\n    componentDidMount () {\n        \/\/ picker 当做一个非受控组件\n        let {value} = this.props;\n        this.setState({\n            defaultValue: value,\n            selectedValue: value\n        });\n    }\n    handleClickOpen (e) {\n\n        if(e) e.preventDefault();\n\n        this.setState({\n            show: true\n        });\n\n        let t = this;\n        let timer = setTimeout(()=\x3e{\n            t.setState({\n                animation: \x26quot;in\x26quot;\n            });\n            clearTimeout(timer);\n        }, 0);\n    }\n    handleClickClose (e) {\n\n        if(e) e.preventDefault();\n\n        this.setState({\n            animation: \x26quot;out\x26quot;\n        });\n\n        let t = this;\n        let timer = setTimeout(()=\x3e{\n            t.setState({\n                show: false\n            });\n            clearTimeout(timer);\n        }, 300);\n    }\n    handlePickerViewChange (newValue) {\n        let {onPickerChange} = this.props;\n\n        this.setState({\n            defaultValue: newValue\n        });\n\n        if(onPickerChange){\n            onPickerChange(newValue);\n        }\n    }\n    handleCancel () {\n        const {defaultValue} = this.state;\n        const {onCancel} = this.props;\n\n        this.handleClickClose();\n\n        this.setState({\n            selectedValue: defaultValue\n        });\n\n        if(onCancel){\n            onCancel();\n        }\n    }\n    handleConfirm () {\n        \/\/ 点击确认之后的回调\n        const {defaultValue} = this.state;\n\n        this.handleClickClose();\n\n        if (this.props.onChange) this.props.onChange(defaultValue);\n    }\n    getPopupDOM () {\n        const {show, animation} = this.state;\n        const {cancelText, title, confirmText} = this.props;\n        const pickerViewDOM = this.getPickerView();\n\n        if(show){\n            return \x3cdiv\x3e\n                \x3cTouchable\n                    onPress={this.handleCancel.bind(this)}\x3e\n                    \x3cdiv className={classNames([\x27zby-picker-popup-mask\x27, {\x27hide\x27: animation == \x26quot;out\x26quot;}])}\x3e\x3c\/div\x3e\n                \x3c\/Touchable\x3e\n                \x3cdiv className={classNames([\x27zby-picker-popup-wrap\x27, {\x27popup\x27: animation == \x26quot;in\x26quot;}])}\x3e\n                    \x3cdiv className=\x26quot;zby-picker-popup-header\x26quot;\x3e\n                        \x3cTouchable\n                            onPress={this.handleCancel.bind(this)}\x3e\n                            \x3cspan className=\x26quot;zby-picker-popup-item zby-header-left\x26quot;\x3e{cancelText}\x3c\/span\x3e\n                        \x3c\/Touchable\x3e\n                        \x3cspan className=\x26quot;zby-picker-popup-item zby-header-title\x26quot;\x3e{title}\x3c\/span\x3e\n                        \x3cTouchable\n                            onPress={this.handleConfirm.bind(this)}\x3e\n                            \x3cspan className=\x26quot;zby-picker-popup-item zby-header-right\x26quot;\x3e{confirmText}\x3c\/span\x3e\n                        \x3c\/Touchable\x3e\n                    \x3c\/div\x3e\n                    \x3cdiv className=\x26quot;zby-picker-popup-body\x26quot;\x3e\n                        {pickerViewDOM}\n                    \x3c\/div\x3e\n                \x3c\/div\x3e\n            \x3c\/div\x3e\n        }\n\n    }\n    getPickerView () {\n        const {col, data, cascade} = this.props;\n        const {defaultValue, show} = this.state;\n\n        if(defaultValue != undefined \x26amp;\x26amp; show){\n            return \x3cPickerView\n                col={col}\n                data={data}\n                value={defaultValue}\n                cascade={cascade}\n                onChange={this.handlePickerViewChange.bind(this)}\x3e\n            \x3c\/PickerView\x3e;\n        }\n    }\n    render () {\n        const popupDOM = this.getPopupDOM();\n\n        return (\n            \x3cdiv className=\x26quot;zby-picker-box\x26quot;\x3e\n                {popupDOM}\n                \x3cTouchable\n                    onPress={this.handleClickOpen.bind(this)}\x3e\n                    {this.props.children}\n                \x3c\/Touchable\x3e\n            \x3c\/div\x3e\n        )\n    }\n}\n\nexport default Picker\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e classNames \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27classnames\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e PickerView \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/PickerView\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Touchable \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rc-touchable\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 选择器组件\x3c\/span\x3e\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ePicker\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3estatic\x3c\/span\x3e defaultProps = {\n        \x3cspan class=\x22hljs-attr\x22\x3ecol\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3ecancelText\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22取消\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3econfirmText\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22确定\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3ecascade\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n    };\n    \x3cspan class=\x22hljs-keyword\x22\x3estatic\x3c\/span\x3e propTypes = {\n        \x3cspan class=\x22hljs-attr\x22\x3ecol\x3c\/span\x3e: React.PropTypes.number,\n        \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e: React.PropTypes.array,\n        \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: React.PropTypes.array,\n        \x3cspan class=\x22hljs-attr\x22\x3ecancelText\x3c\/span\x3e: React.PropTypes.string,\n        \x3cspan class=\x22hljs-attr\x22\x3etitle\x3c\/span\x3e: React.PropTypes.string,\n        \x3cspan class=\x22hljs-attr\x22\x3econfirmText\x3c\/span\x3e: React.PropTypes.string,\n        \x3cspan class=\x22hljs-attr\x22\x3ecascade\x3c\/span\x3e: React.PropTypes.bool,\n        \x3cspan class=\x22hljs-attr\x22\x3eonChange\x3c\/span\x3e: React.PropTypes.func,\n        \x3cspan class=\x22hljs-attr\x22\x3eonCancel\x3c\/span\x3e: React.PropTypes.func\n    };\n    \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e (props) {\n        \x3cspan class=\x22hljs-keyword\x22\x3esuper\x3c\/span\x3e(props);\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state = {\n            \x3cspan class=\x22hljs-attr\x22\x3edefaultValue\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eselectedValue\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eanimation\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22out\x22\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eshow\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n        }\n    }\n    componentDidMount () {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ picker 当做一个非受控组件\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e {value} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n            \x3cspan class=\x22hljs-attr\x22\x3edefaultValue\x3c\/span\x3e: value,\n            \x3cspan class=\x22hljs-attr\x22\x3eselectedValue\x3c\/span\x3e: value\n        });\n    }\n    handleClickOpen (e) {\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(e) e.preventDefault();\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n            \x3cspan class=\x22hljs-attr\x22\x3eshow\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n        });\n\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e t = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e timer = setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n            t.setState({\n                \x3cspan class=\x22hljs-attr\x22\x3eanimation\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22in\x22\x3c\/span\x3e\n            });\n            clearTimeout(timer);\n        }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n    }\n    handleClickClose (e) {\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(e) e.preventDefault();\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n            \x3cspan class=\x22hljs-attr\x22\x3eanimation\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22out\x22\x3c\/span\x3e\n        });\n\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e t = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e timer = setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n            t.setState({\n                \x3cspan class=\x22hljs-attr\x22\x3eshow\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n            });\n            clearTimeout(timer);\n        }, \x3cspan class=\x22hljs-number\x22\x3e300\x3c\/span\x3e);\n    }\n    handlePickerViewChange (newValue) {\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e {onPickerChange} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n            \x3cspan class=\x22hljs-attr\x22\x3edefaultValue\x3c\/span\x3e: newValue\n        });\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(onPickerChange){\n            onPickerChange(newValue);\n        }\n    }\n    handleCancel () {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e {defaultValue} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e {onCancel} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleClickClose();\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n            \x3cspan class=\x22hljs-attr\x22\x3eselectedValue\x3c\/span\x3e: defaultValue\n        });\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(onCancel){\n            onCancel();\n        }\n    }\n    handleConfirm () {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 点击确认之后的回调\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e {defaultValue} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleClickClose();\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props.onChange) \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props.onChange(defaultValue);\n    }\n    getPopupDOM () {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e {show, animation} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e {cancelText, title, confirmText} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e pickerViewDOM = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getPickerView();\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(show){\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eTouchable\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-attr\x22\x3eonPress\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{this.handleCancel.bind(this)}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{classNames([\x3c\/span\x3e\x27\x3cspan class=\x22hljs-attr\x22\x3ezby-picker-popup-mask\x3c\/span\x3e\x27, {\x27\x3cspan class=\x22hljs-attr\x22\x3ehide\x3c\/span\x3e\x27\x3cspan class=\x22hljs-attr\x22\x3e:\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eanimation\x3c\/span\x3e == \x3cspan class=\x22hljs-string\x22\x3e\x22out\x22\x3c\/span\x3e}])}\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eTouchable\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{classNames([\x3c\/span\x3e\x27\x3cspan class=\x22hljs-attr\x22\x3ezby-picker-popup-wrap\x3c\/span\x3e\x27, {\x27\x3cspan class=\x22hljs-attr\x22\x3epopup\x3c\/span\x3e\x27\x3cspan class=\x22hljs-attr\x22\x3e:\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eanimation\x3c\/span\x3e == \x3cspan class=\x22hljs-string\x22\x3e\x22in\x22\x3c\/span\x3e}])}\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-popup-header\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eTouchable\x3c\/span\x3e\n                            \x3cspan class=\x22hljs-attr\x22\x3eonPress\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{this.handleCancel.bind(this)}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-popup-item zby-header-left\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e{cancelText}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eTouchable\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-popup-item zby-header-title\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e{title}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eTouchable\x3c\/span\x3e\n                            \x3cspan class=\x22hljs-attr\x22\x3eonPress\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{this.handleConfirm.bind(this)}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-popup-item zby-header-right\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e{confirmText}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eTouchable\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-popup-body\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                        {pickerViewDOM}\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n        }\n\n    }\n    getPickerView () {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e {col, data, cascade} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e {defaultValue, show} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(defaultValue != \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e \x26amp;\x26amp; show){\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ePickerView\x3c\/span\x3e\n                \x3cspan class=\x22hljs-attr\x22\x3ecol\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{col}\x3c\/span\x3e\n                \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{data}\x3c\/span\x3e\n                \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{defaultValue}\x3c\/span\x3e\n                \x3cspan class=\x22hljs-attr\x22\x3ecascade\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{cascade}\x3c\/span\x3e\n                \x3cspan class=\x22hljs-attr\x22\x3eonChange\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{this.handlePickerViewChange.bind(this)}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ePickerView\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e;\n        }\n    }\n    render () {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e popupDOM = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getPopupDOM();\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n            \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22zby-picker-box\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                {popupDOM}\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eTouchable\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-attr\x22\x3eonPress\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{this.handleClickOpen.bind(this)}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    {this.props.children}\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eTouchable\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n        )\n    }\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e Picker\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader8\x22\x3e总结\x3c\/h1\x3e\n\x3cp\x3ePicker到这就结束了，还可以添加一些功能，比如禁止选择的项等。\x3cbr\x3e样式上Column没有做到iOS那种滚轮效果（Column看起来像个圆形的轮子一样）这个css可以后期加上\x3cbr\x3e知道原理了，可以尝试着自己实现日期选择器datepicker。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/Aus0049\/react-component\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e最后项目源码\x3c\/a\x3e，\x3ca href=\x22https:\/\/github.com\/react-component\/m-picker\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAntd-Mobile\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>React实现滑动选择插件（仿Antd-mobile Picker）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009611839">https://segmentfault.com/a/1190000009611839</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/cspxm3gudku/" target="_blank">https://alili.tech/archive/cspxm3gudku/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>