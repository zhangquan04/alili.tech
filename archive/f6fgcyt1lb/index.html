<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="React系列---Redux高阶运用"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>React系列---Redux高阶运用 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/f6fgcyt1lb/",
				"appid": "1613049289050283", 
				"title": "React系列---Redux高阶运用 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-08T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/frayg2h5coq/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/xp0vmchrrkn/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2ff6fgcyt1lb%2f&text=React%e7%b3%bb%e5%88%97---Redux%e9%ab%98%e9%98%b6%e8%bf%90%e7%94%a8"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2ff6fgcyt1lb%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2ff6fgcyt1lb%2f&text=React%e7%b3%bb%e5%88%97---Redux%e9%ab%98%e9%98%b6%e8%bf%90%e7%94%a8"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2ff6fgcyt1lb%2f&title=React%e7%b3%bb%e5%88%97---Redux%e9%ab%98%e9%98%b6%e8%bf%90%e7%94%a8"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2ff6fgcyt1lb%2f&is_video=false&description=React%e7%b3%bb%e5%88%97---Redux%e9%ab%98%e9%98%b6%e8%bf%90%e7%94%a8"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=React%e7%b3%bb%e5%88%97---Redux%e9%ab%98%e9%98%b6%e8%bf%90%e7%94%a8&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2ff6fgcyt1lb%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2ff6fgcyt1lb%2f&title=React%e7%b3%bb%e5%88%97---Redux%e9%ab%98%e9%98%b6%e8%bf%90%e7%94%a8"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ff6fgcyt1lb%2f&title=React%e7%b3%bb%e5%88%97---Redux%e9%ab%98%e9%98%b6%e8%bf%90%e7%94%a8"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ff6fgcyt1lb%2f&title=React%e7%b3%bb%e5%88%97---Redux%e9%ab%98%e9%98%b6%e8%bf%90%e7%94%a8"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ff6fgcyt1lb%2f&title=React%e7%b3%bb%e5%88%97---Redux%e9%ab%98%e9%98%b6%e8%bf%90%e7%94%a8"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">React系列---Redux高阶运用</h1><div class="meta"><div class="postdate"><time datetime="2019-01-08" itemprop="datePublished">2019-01-08</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e参考资料：《深入React技术栈》\x3c\/p\x3e\n\x3chr\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3e高阶reducer\x3c\/h1\x3e\n\x3cblockquote\x3e高阶函数是指将函数作为参数或返回值的函数，高阶reducer就是指将reducer作为参数或返回值的函数。\x3c\/blockquote\x3e\n\x3cp\x3e在Redux架构中，reducer是一个纯函数，它的职责是根据previousState和action计算出新的state。在复杂应用中，Redux提供的combineReducers让我们可以把顶层的reducer拆分成多个小的reducer，分别独立地操作state树的不同部分。而在一个应用中，很多小粒度的reducer往往有很多重复的逻辑，那么对于这些reducer，如何抽取公共逻辑，减少代码冗余呢？这种情况下，使用高阶reducer是一种较好的解决方案。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3ereducer复用\x3c\/h2\x3e\n\x3cp\x3e我们将顶层的reduce拆分成多个小的reducer，肯定会碰到reducer复用问题。例如有A和B两个模块，它们的UI部分相似，此时可以通过配置不同的props来区别它们。那么这种情况下，A和B模块能不能共用一个reducer呢？答案是否定的。我们先来看一个简单reducer：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const LOAD_DATA = \x27LOAD_DATA\x27;\nconst initialState = { ... };\n\nfunction loadData() {\n    return {\n        type: LOAD_DATA,\n        ...\n    };\n}\n\nfunction reducer(state = initialState, action) {\n    switch(action.type) {\n        case LOAD_DATA:\n            return {\n                ...state,\n                data: action.payload\n            };\n        default:\n            return state;\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3econst LOAD_DATA = \x27LOAD_DATA\x27;\nconst initialState = { ... };\n\nfunction \x3cspan class=\x22hljs-built_in\x22\x3eload\x3c\/span\x3eData() {\n    return {\n        type: LOAD_DATA,\n        ...\n    };\n}\n\nfunction reducer(\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e = initialState, action) {\n    switch(action.type) {\n        case LOAD_DATA:\n            return {\n                ...\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e,\n                data: action.payload\n            };\n        \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e:\n            return \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e;\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果我们将这个reducer绑定到A和B两个不同模块，造成的问题将会是，当A模块调用loadData来分发相应的action时，A和B的reducer都会处理这个action，然后A和B的内容就完全一致了。\x3c\/p\x3e\n\x3cp\x3e这里我们必需意识到，在一个应用中，不同模块间的actionType必须是全局唯一的。\x3c\/p\x3e\n\x3cp\x3e因此，要解决actionType唯一的问题，还有一个方法就是通过添加前缀的方式来做到：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function generateReducer(prefix, state) {\n    const LOAD_DATA = prefix \x2b \x27LOAD_DATA\x27;\n    \n    const initialState = { ...state, ...};\n    \n    return function reducer(state = initialState, action) {\n        switch(action.type) {\n            case LOAD_DATA:\n                return {\n                    ...state,\n                    data: action.payload\n                };\n            default:\n                return state;\n        }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3efunction generateReducer(prefix, \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e) {\n    const LOAD_DATA = prefix \x2b \x27LOAD_DATA\x27;\n    \n    const initialState = { ...\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, ...};\n    \n    return function reducer(\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e = initialState, action) {\n        switch(action.type) {\n            case LOAD_DATA:\n                return {\n                    ...\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e,\n                    data: action.payload\n                };\n            \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e:\n                return \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e;\n        }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样只要A和B模块分别调用generateReducer来生成相应的reducer，就能解决reducer复用的问题了。而对于prefix，我们可以根据自己的项目结构来决定，例如${页面名称}_${模块名称}。只要能够保证全局唯一性，就可以写成一种前缀。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3ereducer增强\x3c\/h2\x3e\n\x3cp\x3e除了解决复用问题，高阶reducer的另一个重要作用就是对原始的reducer进行增强。redux-undo就是典型的利用高阶reducer来增强reducer的例子，它主要作用是使任意reducer变成可以执行撤销和重做的全新reducer。我们来看看它的核心代码实现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function undoable(reducer) {\n    const initialState = {\n        \/\/ 记录过去的state\n        past: [],\n        \/\/ 以一个空的action调用reducer来产生当前值的初始值\n        present: reducer(undefined, {}),\n        \/\/ 记录后续的state\n        future: []\n    };\n    \n    return function(state = initialState, action) {\n        const { past, present, future } = state;\n        \n        switch(action.type) {\n            case \x27@@redux-undo\/UNDO\x27:\n                const previous = past[past.length - 1];\n                const newPast = past.slice(0, past.length - 1);\n                \n                return {\n                    past: newPast,\n                    present: previous,\n                    future: [ present, ...future ]\n                };\n            case \x27@@redux-undo\/REDO\x27:\n                const next = future[0];\n                const newFuture = future.slice(1);\n                \n                return {\n                    past: [ ...past, present ],\n                    present: next,\n                    future: newFuture\n                };\n            default:\n                \/\/ 将其他action委托给原始的reducer处理\n                const newPresent = reducer(present, action);\n                \n                if(present === newPresent) {\n                    return state;\n                }\n                \n                return {\n                    past: [ ...past, present ],\n                    present: newPresent,\n                    future: []\n                };\n        }\n    };\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eundoable\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(reducer)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e initialState = {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 记录过去的state\x3c\/span\x3e\n        past: [],\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 以一个空的action调用reducer来产生当前值的初始值\x3c\/span\x3e\n        present: reducer(\x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e, {}),\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 记录后续的state\x3c\/span\x3e\n        future: []\n    };\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(state = initialState, action)\x3c\/span\x3e \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e { past, present, future } = state;\n        \n        \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e(action.type) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@@redux-undo\/UNDO\x27\x3c\/span\x3e:\n                \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e previous = past[past.length - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e];\n                \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e newPast = past.slice(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, past.length - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n                \n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n                    past: newPast,\n                    present: previous,\n                    future: [ present, ...future ]\n                };\n            \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@@redux-undo\/REDO\x27\x3c\/span\x3e:\n                \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e next = future[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n                \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e newFuture = future.slice(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n                \n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n                    past: [ ...past, present ],\n                    present: next,\n                    future: newFuture\n                };\n            \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e:\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将其他action委托给原始的reducer处理\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e newPresent = reducer(present, action);\n                \n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(present === newPresent) {\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e state;\n                }\n                \n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n                    past: [ ...past, present ],\n                    present: newPresent,\n                    future: []\n                };\n        }\n    };\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e有了这高阶reducer，就可以对任意一个reducer进行封装：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { createStore } from \x27redux\x27;\n\nfunction todos(state = [], action) {\n    switch(action.type) {\n        case: \x27ADD_TODO\x27:\n        \/\/ ...\n    }\n}\n\nconst undoableTodos = undoable(todos);\nconst store = createStore(undoableTodos);\n\nstore.dispatch({\n    type: \x27ADD_TODO\x27,\n    text: \x27Use Redux\x27\n});\n\nstore.dispatch({\n    type: \x27ADD_TODO\x27,\n    text: \x27Implement Undo\x27\n});\n\nstore.dispatch({\n    type: \x27@@redux-undo\/UNDO\x27\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sqf\x22\x3e\x3ccode\x3eimport { createStore } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27redux\x27\x3c\/span\x3e;\n\nfunction todos(state = [], \x3cspan class=\x22hljs-built_in\x22\x3eaction\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3eaction\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3etype\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27ADD_TODO\x27\x3c\/span\x3e:\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    }\n}\n\nconst undoableTodos = undoable(todos);\nconst store = createStore(undoableTodos);\n\nstore.dispatch({\n    \x3cspan class=\x22hljs-built_in\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27ADD_TODO\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-built_in\x22\x3etext\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Use Redux\x27\x3c\/span\x3e\n});\n\nstore.dispatch({\n    \x3cspan class=\x22hljs-built_in\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27ADD_TODO\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-built_in\x22\x3etext\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Implement Undo\x27\x3c\/span\x3e\n});\n\nstore.dispatch({\n    \x3cspan class=\x22hljs-built_in\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27@@redux-undo\/UNDO\x27\x3c\/span\x3e\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e查看高阶reducer undoable的实现代码可以发现，高阶reducer主要通过下面3点来增强reducer：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e能够处理额外的action;\x3c\/li\x3e\n\x3cli\x3e能够维护更多的state;\x3c\/li\x3e\n\x3cli\x3e将不能处理的action委托给原始reducer处理。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3eRedux与表单\x3c\/h1\x3e\n\x3cp\x3eReact单向绑定的特性极大地提升了应用的执行效率，但是相比于简单易用的双向绑定，单向绑定在处理表单等交互的时候着实有些力不从心。具体到React应用中，单向绑定意味着你需要手动给每个表单控件提供onChange回调函数，同时需要将它们的状态初始化在this.state中。不仅如此，一个体验友好的表单还需要有明确的错误状态和错误信息，甚至某些输入项还需要异步校验功能。也就是说，表单里的一个有效字段至少需要2~3个本地状态。\x3c\/p\x3e\n\x3cp\x3e在Angular.js中，表单相关的问题在框架层面已经得到了很好的解决。那么，对于React\x2bRedux应用，有没有什么好的方案呢？\x3c\/p\x3e\n\x3cp\x3e下面我们从两个层面来解答这个问题：对于简单的表单应用，为了减少重复冗余的代码，可以使用redux-form-utils这个工具库，它能利用高阶组件的特性为表单的每个字段提供value和onChange等必须值，而无需你手动创建；对于复杂的表单，则可以利用redux-form。虽然同样基于高阶组件的原理，但如果说redux-form-utils是一把水果刀的话，那么redux-form就是一把多功能的瑞士军刀。除了提供表单必须的字段外，redux-form还能实现表单同步验证、异步验证甚至嵌套表单等复杂功能。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e使用redux-form-utils减少创建表单的冗余代码\x3c\/h2\x3e\n\x3cp\x3e了解redux-form-utils之前，先来看看如何使用原生React处理表单：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import React, { Component } from \x27react\x27;\n\nclass Form extends Component {\n    constructor(props) {\n        super(props);\n        \n        this.handleChangeAddress = this.handleChangeAddress.bind(this);\n        this.handleChangeGender = this.handleChangeGender.bind(this);\n        \n        this.state = {\n            name: \x27\x27,\n            address: \x27\x27,\n            gender: \x27\x27\n        };\n    }\n    \n    handleChangeName(e) {\n        this.setState({\n            name: e.target.value\n        });\n    }\n    \n    handleChangeAddress(e) {\n        this.setState({\n            address: e.target.value\n        });\n    }\n    \n    handleChangeGender(e) {\n        this.setState({\n            gender: e.target.value\n        });\n    }\n    \n    render() {\n        const { name, address, gender } = this.state;\n        return (\n            \x3cform className=\x26quot;form\x26quot;\x3e\n              \x3cinput name=\x26quot;name\x26quot; value={name} onChange={this.handleChangeName} \/\x3e\n              \x3cinput name=\x26quot;address\x26quot; value={address} onChange={this.handleChangeAddress} \/\x3e\n              \x3cselect name=\x26quot;gender\x26quot; value={gender} onChange={this.handleChangeGender}\x3e    \n                \x3coption value=\x26quot;male\x26quot; \/\x3e\n                \x3coption value=\x26quot;female\x26quot; \/\x3e\n              \x3c\/select\x3e\n            \x3c\/form\x3e\n        );\n    };\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React, { Component } from \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eForm\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(props) {\n        \x3cspan class=\x22hljs-keyword\x22\x3esuper\x3c\/span\x3e(props);\n        \n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleChangeAddress = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleChangeAddress.bind(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleChangeGender = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleChangeGender.bind(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n        \n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state = {\n            name: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n            address: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n            gender: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n        };\n    }\n    \n    handleChangeName(e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n            name: e.target.value\n        });\n    }\n    \n    handleChangeAddress(e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n            address: e.target.value\n        });\n    }\n    \n    handleChangeGender(e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n            gender: e.target.value\n        });\n    }\n    \n    render() {\n        const { name, address, gender } = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n            \x26lt;form className=\x3cspan class=\x22hljs-string\x22\x3e\x22form\x22\x3c\/span\x3e\x26gt;\n              \x26lt;input name=\x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e value={name} onChange={\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleChangeName} \/\x26gt;\n              \x26lt;input name=\x3cspan class=\x22hljs-string\x22\x3e\x22address\x22\x3c\/span\x3e value={address} onChange={\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleChangeAddress} \/\x26gt;\n              \x26lt;select name=\x3cspan class=\x22hljs-string\x22\x3e\x22gender\x22\x3c\/span\x3e value={gender} onChange={\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleChangeGender}\x26gt;    \n                \x26lt;option value=\x3cspan class=\x22hljs-string\x22\x3e\x22male\x22\x3c\/span\x3e \/\x26gt;\n                \x26lt;option value=\x3cspan class=\x22hljs-string\x22\x3e\x22female\x22\x3c\/span\x3e \/\x26gt;\n              \x26lt;\/select\x26gt;\n            \x26lt;\/form\x26gt;\n        );\n    };\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看到，虽然我们的表单里只有3个字段，但是已经有非常多的冗余代码。如果还需要加上验证等功能，那么这个表单对应的处理代码将会更加膨胀。\x3c\/p\x3e\n\x3cp\x3e仔细分析表单的代码实现，我们发现几乎所有的onChange处理器逻辑都很类似，只是需要改变表单字段即可。对于某些复杂的输入控件，比如自己封装了一个TimePicker组件，也许回调名称不是onChange，而是onSelect。同样，onSelect回调里提供的参数也许并不是React的合成事件，而是一个具体的值。通过分析表单控件可能的输入和输出，我们将通过使用redux-form-utils减少Redux处理表单应用时的冗余代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ components\/MyForm.js\nimport React, { Component } from \x27react\x27;\nimport { createForm } from \x27redux-form-utils\x27;\n\n@createForm({\n    form: \x27my-form\x27,\n    fields: [\x27name\x27, \x27address\x27, \x27gender\x27]\n})\n\nclass Form extends Component {\n    render(){\n        const { name, address, gender } = this.props.fields;\n        return (\n          \x3cform className=\x26quot;form\x26quot;\x3e\n            \x3cinput name=\x26quot;name\x26quot; value={...name} \/\x3e\n            \x3cinput name=\x26quot;address\x26quot; value={...address} \/\x3e\n            \x3cselect {...gender}\x3e    \n              \x3coption value=\x26quot;male\x26quot; \/\x3e\n              \x3coption value=\x26quot;female\x26quot; \/\x3e\n            \x3c\/select\x3e\n          \x3c\/form\x3e\n        );\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scala\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ components\/MyForm.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eReact\x3c\/span\x3e, { \x3cspan class=\x22hljs-type\x22\x3eComponent\x3c\/span\x3e } from \x3cspan class=\x22hljs-symbol\x22\x3e\x27reac\x3c\/span\x3et\x27;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { createForm } from \x3cspan class=\x22hljs-symbol\x22\x3e\x27redux\x3c\/span\x3e-form-utils\x27;\n\n\x3cspan class=\x22hljs-meta\x22\x3e@createForm\x3c\/span\x3e({\n    form: \x3cspan class=\x22hljs-symbol\x22\x3e\x27my\x3c\/span\x3e-form\x27,\n    fields: [\x3cspan class=\x22hljs-symbol\x22\x3e\x27nam\x3c\/span\x3ee\x27, \x3cspan class=\x22hljs-symbol\x22\x3e\x27addres\x3c\/span\x3es\x27, \x3cspan class=\x22hljs-symbol\x22\x3e\x27gende\x3c\/span\x3er\x27]\n})\n\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eForm\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n    render(){\n        const { name, address, gender } = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props.fields;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n          \x26lt;form className=\x3cspan class=\x22hljs-string\x22\x3e\x22form\x22\x3c\/span\x3e\x26gt;\n            \x26lt;input name=\x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e value={...name} \/\x26gt;\n            \x26lt;input name=\x3cspan class=\x22hljs-string\x22\x3e\x22address\x22\x3c\/span\x3e value={...address} \/\x26gt;\n            \x26lt;select {...gender}\x26gt;    \n              \x26lt;option value=\x3cspan class=\x22hljs-string\x22\x3e\x22male\x22\x3c\/span\x3e \/\x26gt;\n              \x26lt;option value=\x3cspan class=\x22hljs-string\x22\x3e\x22female\x22\x3c\/span\x3e \/\x26gt;\n            \x26lt;\/select\x26gt;\n          \x26lt;\/form\x26gt;\n        );\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看到，实现同样功能的表单，代码量减少了近一半以上。\x3c\/p\x3e\n\x3cp\x3eredux-form-utils提供了两个方便的工具函数---createForm(config)和bindRedux(config)，前者可以当作decorate使用，传入表单的配置，自动为被装饰的组件添加表单相关的props；而后者可以生成与Redux应用相关的reducer、initialState和actionCreator等。\x3c\/p\x3e\n\x3cp\x3e下面先看看如何在reducer里整合redux-form-utils：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ reducer\/MyForm.js\nimport { bindRedux } from \x27redux-form-utils\x27;\n\nconst { state: formState, reducer: formReducer } = bindRedux({\n    form: \x27my-form\x27,\n    fields: [\x27name\x27, \x27address\x27, \x27gender\x27],\n});\n\nconst initialState = {\n    foo: 1,\n    bar: 2,\n    ...formState\n};\n\nfunction myReducer(state = initialState, action) {\n    switch(action.type) {\n        case \x27MY_ACTION\x27: {\n            \/\/ ...\n        }\n        \n        default:\n            return formReducer(state, action);\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ reducer\/MyForm.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { bindRedux } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27redux-form-utils\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e { \x3cspan class=\x22hljs-attr\x22\x3estate\x3c\/span\x3e: formState, \x3cspan class=\x22hljs-attr\x22\x3ereducer\x3c\/span\x3e: formReducer } = bindRedux({\n    \x3cspan class=\x22hljs-attr\x22\x3eform\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27my-form\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3efields\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27address\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27gender\x27\x3c\/span\x3e],\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e initialState = {\n    \x3cspan class=\x22hljs-attr\x22\x3efoo\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ebar\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e,\n    ...formState\n};\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emyReducer\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3estate = initialState, action\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e(action.type) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27MY_ACTION\x27\x3c\/span\x3e: {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n        }\n        \n        \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e:\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e formReducer(state, action);\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们把同样的配置传给bindRedux方法，并获得这个表单对应的reducer和初始状态formState，并将这些内容整合在reducer中。\x3c\/p\x3e\n\x3cp\x3e完成createForm和bindRedux这两个函数后，一个基于Redux的表单应用就完成了。为了后续修改表单更加灵活，建议将配置文件单独保存，并分别在组件和reducer中引入对应的配置文件。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e使用redux-form完成表单异步验证\x3c\/h2\x3e\n\x3cp\x3eredux-form-utils为我们提供了实现表单最基本的功能，但是为了填写表单的体验更加友好，在把数据提交到服务端之前，我们应该做一些基本的表单校验，比如填写字段不能为空等。要实现校验等复杂的表单功能，需要用到redux-form。\x3c\/p\x3e\n\x3cp\x3e在使用和配置方面，redux-form与redux-form-utils没有太多的差异，唯一不同的是redux-form需要在Redux应用的state树中挂载一个独立的节点。这意味着，所有使用redux-form创建的表单中的字段都会在一个固定的位置，如state.form.myForm或state.form.myOtherForm均挂载在state.form下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { createStore, combineReducers } from \x27redux\x27;\nimport { reducer as formReducer } from \x27redux-form\x27;\n\nconst reducers = {\n    \/\/ 其他的reducer...\n    \/\/ 所有表单相关的reducer挂载在form下\n    form: formReducer\n};\n\nconst reducer = combineReducers(reducers);\nconst store = createStore(reducer);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { createStore, combineReducers } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27redux\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { reducer \x3cspan class=\x22hljs-keyword\x22\x3eas\x3c\/span\x3e formReducer } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27redux-form\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e reducers = {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 其他的reducer...\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 所有表单相关的reducer挂载在form下\x3c\/span\x3e\n    form: formReducer\n};\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e reducer = combineReducers(reducers);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e store = createStore(reducer);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e完成了基本的配置后，现在看看redux-form如何帮我们完成表单验证功能：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import React, { Component } from \x27react\x27;\nimport { reduxForm } from \x27redux-form\x27;\n\nfunction validate(values) {\n    if(values.name == null || values.name === \x27\x27) {\n        return {\n            name: \x27请填写名称\x27\n        };\n    }\n}\n\n@reduxForm({\n    form: \x27my-form\x27,\n    fields: [\x27name\x27, \x27address\x27, \x27gender\x27],\n    validate\n});\n\nclass Form extends Component {\n    render(){\n        const { name, address, gender } = this.props.fields;\n        return (\n          \x3cform className=\x26quot;form\x26quot;\x3e\n            \x3cinput name=\x26quot;name\x26quot; value={...name} \/\x3e\n            { name.error \x26amp;\x26amp; \x3cspan\x3e{name.error}\x3c\/span\x3e }\n            \x3cinput name=\x26quot;address\x26quot; value={...address} \/\x3e\n            \x3cselect {...gender}\x3e    \n              \x3coption value=\x26quot;male\x26quot; \/\x3e\n              \x3coption value=\x26quot;female\x26quot; \/\x3e\n            \x3c\/select\x3e\n            \x3cbutton type=\x26quot;submit\x26quot;\x3e提交\x3c\/button\x3e\n          \x3c\/form\x3e\n        );\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scala\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eReact\x3c\/span\x3e, { \x3cspan class=\x22hljs-type\x22\x3eComponent\x3c\/span\x3e } from \x3cspan class=\x22hljs-symbol\x22\x3e\x27reac\x3c\/span\x3et\x27;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { reduxForm } from \x3cspan class=\x22hljs-symbol\x22\x3e\x27redux\x3c\/span\x3e-form\x27;\n\nfunction validate(values) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(values.name == \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e || values.name === \x27\x27) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n            name: \x27请填写名称\x27\n        };\n    }\n}\n\n\x3cspan class=\x22hljs-meta\x22\x3e@reduxForm\x3c\/span\x3e({\n    form: \x3cspan class=\x22hljs-symbol\x22\x3e\x27my\x3c\/span\x3e-form\x27,\n    fields: [\x3cspan class=\x22hljs-symbol\x22\x3e\x27nam\x3c\/span\x3ee\x27, \x3cspan class=\x22hljs-symbol\x22\x3e\x27addres\x3c\/span\x3es\x27, \x3cspan class=\x22hljs-symbol\x22\x3e\x27gende\x3c\/span\x3er\x27],\n    validate\n});\n\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eForm\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n    render(){\n        const { name, address, gender } = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props.fields;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n          \x26lt;form className=\x3cspan class=\x22hljs-string\x22\x3e\x22form\x22\x3c\/span\x3e\x26gt;\n            \x26lt;input name=\x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e value={...name} \/\x26gt;\n            { name.error \x26amp;\x26amp; \x26lt;span\x26gt;{name.error}\x26lt;\/span\x26gt; }\n            \x26lt;input name=\x3cspan class=\x22hljs-string\x22\x3e\x22address\x22\x3c\/span\x3e value={...address} \/\x26gt;\n            \x26lt;select {...gender}\x26gt;    \n              \x26lt;option value=\x3cspan class=\x22hljs-string\x22\x3e\x22male\x22\x3c\/span\x3e \/\x26gt;\n              \x26lt;option value=\x3cspan class=\x22hljs-string\x22\x3e\x22female\x22\x3c\/span\x3e \/\x26gt;\n            \x26lt;\/select\x26gt;\n            \x26lt;button \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22submit\x22\x3c\/span\x3e\x26gt;提交\x26lt;\/button\x26gt;\n          \x26lt;\/form\x26gt;\n        );\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在上面的表单中，我们在提交时对name字段做了非空验证，而在Form组件的render方法中，同时添加了显示相应错误的逻辑。触发验证、重新渲染、表单纯洁性判断等过程，均被redux-form进行了封装，对使用者透明。\x3c\/p\x3e\n\x3cp\x3e可以看到，使用redux-form校验表单十分简单易用，从很大程度上填补了Redux应用在框架层面处理表单应用的不足。\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3e参考资料：《深入React技术栈》\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>React系列&mdash;Redux高阶运用</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010205508">https://segmentfault.com/a/1190000010205508</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/f6fgcyt1lb/" target="_blank">https://alili.tech/archive/f6fgcyt1lb/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>