<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="理解多区域配置中的 firewalld"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>理解多区域配置中的 firewalld | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/a0qwdu2q1c5/",
				"appid": "1613049289050283", 
				"title": "理解多区域配置中的 firewalld | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-22T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/h1xkveqgddr/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/2uixz9s7bq2/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fa0qwdu2q1c5%2f&text=%e7%90%86%e8%a7%a3%e5%a4%9a%e5%8c%ba%e5%9f%9f%e9%85%8d%e7%bd%ae%e4%b8%ad%e7%9a%84%20firewalld"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fa0qwdu2q1c5%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fa0qwdu2q1c5%2f&text=%e7%90%86%e8%a7%a3%e5%a4%9a%e5%8c%ba%e5%9f%9f%e9%85%8d%e7%bd%ae%e4%b8%ad%e7%9a%84%20firewalld"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fa0qwdu2q1c5%2f&title=%e7%90%86%e8%a7%a3%e5%a4%9a%e5%8c%ba%e5%9f%9f%e9%85%8d%e7%bd%ae%e4%b8%ad%e7%9a%84%20firewalld"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fa0qwdu2q1c5%2f&is_video=false&description=%e7%90%86%e8%a7%a3%e5%a4%9a%e5%8c%ba%e5%9f%9f%e9%85%8d%e7%bd%ae%e4%b8%ad%e7%9a%84%20firewalld"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e7%90%86%e8%a7%a3%e5%a4%9a%e5%8c%ba%e5%9f%9f%e9%85%8d%e7%bd%ae%e4%b8%ad%e7%9a%84%20firewalld&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fa0qwdu2q1c5%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fa0qwdu2q1c5%2f&title=%e7%90%86%e8%a7%a3%e5%a4%9a%e5%8c%ba%e5%9f%9f%e9%85%8d%e7%bd%ae%e4%b8%ad%e7%9a%84%20firewalld"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fa0qwdu2q1c5%2f&title=%e7%90%86%e8%a7%a3%e5%a4%9a%e5%8c%ba%e5%9f%9f%e9%85%8d%e7%bd%ae%e4%b8%ad%e7%9a%84%20firewalld"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fa0qwdu2q1c5%2f&title=%e7%90%86%e8%a7%a3%e5%a4%9a%e5%8c%ba%e5%9f%9f%e9%85%8d%e7%bd%ae%e4%b8%ad%e7%9a%84%20firewalld"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fa0qwdu2q1c5%2f&title=%e7%90%86%e8%a7%a3%e5%a4%9a%e5%8c%ba%e5%9f%9f%e9%85%8d%e7%bd%ae%e4%b8%ad%e7%9a%84%20firewalld"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">理解多区域配置中的 firewalld</h1><div class="meta"><div class="postdate"><time datetime="2019-01-22" itemprop="datePublished">2019-01-22</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3ch1\x3e\x3ca href=\x22#理解多区域配置中的-firewalld\x22\x3e\x3c\/a\x3e理解多区域配置中的 firewalld\x3c\/h1\x3e\n\x3cp\x3e现在的新闻里充斥着服务器被攻击和数据失窃事件。对于一个阅读过安全公告博客的人来说，通过访问错误配置的服务器，利用最新暴露的安全漏洞或通过窃取的密码来获得系统控制权，并不是件多困难的事情。在一个典型的 Linux 服务器上的任何互联网服务都可能存在漏洞，允许未经授权的系统访问。\x3c\/p\x3e\n\x3cp\x3e因为在应用程序层面上强化系统以防范任何可能的威胁是不可能做到的事情，而防火墙可以通过限制对系统的访问提供了安全保证。防火墙基于源 IP、目标端口和协议来过滤入站包。因为这种方式中，仅有几个 IP\/端口\/协议的组合与系统交互，而其它的方式做不到过滤。\x3c\/p\x3e\n\x3cp\x3eLinux 防火墙是通过 netfilter 来处理的，它是内核级别的框架。这十几年来，iptables 被作为 netfilter 的用户态抽象层（LCTT 译注： userland，一个基本的 UNIX 系统是由 kernel 和 userland 两部分构成，除 kernel 以外的称为 userland）。iptables 将包通过一系列的规则进行检查，如果包与特定的 IP\/端口\/协议的组合匹配，规则就会被应用到这个包上，以决定包是被通过、拒绝或丢弃。\x3c\/p\x3e\n\x3cp\x3eFirewalld 是最新的 netfilter 用户态抽象层。遗憾的是，由于缺乏描述多区域配置的文档，它强大而灵活的功能被低估了。这篇文章提供了一个示例去改变这种情况。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#firewalld-的设计目标\x22\x3e\x3c\/a\x3eFirewalld 的设计目标\x3c\/h3\x3e\n\x3cp\x3efirewalld 的设计者认识到大多数的 iptables 使用案例仅涉及到几个单播源 IP，仅让每个符合白名单的服务通过，而其它的会被拒绝。这种模式的好处是，firewalld 可以通过定义的源 IP 和\/或网络接口将入站流量分类到不同区域zone。每个区域基于指定的准则按自己配置去通过或拒绝包。\x3c\/p\x3e\n\x3cp\x3e另外的改进是基于 iptables 进行语法简化。firewalld 通过使用服务名而不是它的端口和协议去指定服务，使它更易于使用，例如，是使用 samba 而不是使用 UDP 端口 137 和 138 和 TCP 端口 139 和 445。它进一步简化语法，消除了 iptables 中对语句顺序的依赖。\x3c\/p\x3e\n\x3cp\x3e最后，firewalld 允许交互式修改 netfilter，允许防火墙独立于存储在 XML 中的永久配置而进行改变。因此，下面的的临时修改将在下次重新加载时被覆盖：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs cpp\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e# firewall-cmd \x3cspan class=\x22hljs-meta-string\x22\x3e\x26lt;some modification\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e而，以下的改变在重加载后会永久保存：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs hsp\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e# firewall-\x3cspan class=\x22hljs-meta-keyword\x22\x3ecmd\x3c\/span\x3e --permanent \x26lt;some modification\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-meta\x22\x3e# firewall-\x3cspan class=\x22hljs-meta-keyword\x22\x3ecmd\x3c\/span\x3e --reload\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3e\x3ca href=\x22#区域\x22\x3e\x3c\/a\x3e区域\x3c\/h3\x3e\n\x3cp\x3e在 firewalld 中最上层的组织是区域。如果一个包匹配区域相关联的网络接口或源 IP\/掩码 ，它就是区域的一部分。可用的几个预定义区域：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs vala\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e# firewall-cmd --get-zones\x3c\/span\x3e\nblock dmz drop external home \x3cspan class=\x22hljs-keyword\x22\x3einternal\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e trusted work\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e任何配置了一个\x3cstrong\x3e网络接口\x3c\/strong\x3e和\/或一个\x3cstrong\x3e源\x3c\/strong\x3e的区域就是一个活动区域active zone。列出活动的区域：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs vala\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e# firewall-cmd --get-active-zones\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e\n  interfaces: eno1 eno2\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3cstrong\x3eInterfaces\x3c\/strong\x3e （接口）是系统中的硬件和虚拟的网络适配器的名字，正如你在上面的示例中所看到的那样。所有的活动的接口都将被分配到区域，要么是默认的区域，要么是用户指定的一个区域。但是，一个接口不能被分配给多于一个的区域。\x3c\/p\x3e\n\x3cp\x3e在缺省配置中，firewalld 设置所有接口为 public 区域，并且不对任何区域设置源。其结果是，\x3ccode\x3epublic\x3c\/code\x3e 区域是唯一的活动区域。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eSources\x3c\/strong\x3e （源）是入站 IP 地址的范围，它也可以被分配到区域。一个源（或重叠的源）不能被分配到多个区域。这样做的结果是产生一个未定义的行为，因为不清楚应该将哪些规则应用于该源。\x3c\/p\x3e\n\x3cp\x3e因为指定一个源不是必需的，任何包都可以通过接口匹配而归属于一个区域，而不需要通过源匹配来归属一个区域。这表示通过使用优先级方式，优先到达多个指定的源区域，稍后将详细说明这种情况。首先，我们来检查 \x3ccode\x3epublic\x3c\/code\x3e 区域的配置：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --zone=public --list-all\x3c\/span\x3e\npublic (default, active)\n  interfaces: eno1 eno2\n  sources:\n  services: dhcpv6-client ssh\n  ports:\n  masquerade: \x3cspan class=\x22hljs-literal\x22\x3eno\x3c\/span\x3e\n  forward-ports:\n  icmp-blocks:\n  rich rules:\n\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --permanent --zone=public --get-target\x3c\/span\x3e\x3cspan class=\x22hljs-built_in\x22\x3e\ndefault\n\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e逐行说明如下：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ccode\x3epublic (default, active)\x3c\/code\x3e 表示 \x3ccode\x3epublic\x3c\/code\x3e 区域是默认区域（当接口启动时会自动默认），并且它是活动的，因为，它至少有一个接口或源分配给它。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3einterfaces: eno1 eno2\x3c\/code\x3e 列出了这个区域上关联的接口。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3esources:\x3c\/code\x3e 列出了这个区域的源。现在这里什么都没有，但是，如果这里有内容，它们应该是这样的格式 xxx.xxx.xxx.xxx\/xx。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3eservices: dhcpv6-client ssh\x3c\/code\x3e 列出了允许通过这个防火墙的服务。你可以通过运行 \x3ccode\x3efirewall-cmd --get-services\x3c\/code\x3e 得到一个防火墙预定义服务的详细列表。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3eports:\x3c\/code\x3e 列出了一个允许通过这个防火墙的目标端口。它是用于你需要去允许一个没有在 firewalld 中定义的服务的情况下。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3emasquerade: no\x3c\/code\x3e 表示这个区域是否允许 IP 伪装。如果允许，它将允许 IP 转发，它可以让你的计算机作为一个路由器。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3eforward-ports:\x3c\/code\x3e 列出转发的端口。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3eicmp-blocks:\x3c\/code\x3e 阻塞的 icmp 流量的黑名单。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3erich rules:\x3c\/code\x3e 在一个区域中优先处理的高级配置。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3edefault\x3c\/code\x3e 是目标区域，它决定了与该区域匹配而没有由上面设置中显式处理的包的动作。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3\x3e\x3ca href=\x22#一个简单的单区域配置示例\x22\x3e\x3c\/a\x3e一个简单的单区域配置示例\x3c\/h3\x3e\n\x3cp\x3e如果只是简单地锁定你的防火墙。简单地在删除公共区域上当前允许的服务，并重新加载：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=public\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eremove\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=dhcpv6\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eclient\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=public\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eremove\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=ssh\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ereload\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e在下面的防火墙上这些命令的结果是：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --zone=public --list-all\x3c\/span\x3e\npublic (default, active)\n  interfaces: eno1 eno2\n  sources:\n  services:\n  ports:\n  masquerade: \x3cspan class=\x22hljs-literal\x22\x3eno\x3c\/span\x3e\n  forward-ports:\n  icmp-blocks:\n  rich rules:\n\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --permanent --zone=public --get-target\x3c\/span\x3e\x3cspan class=\x22hljs-built_in\x22\x3e\ndefault\n\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e本着尽可能严格地保证安全的精神，如果发生需要在你的防火墙上临时开放一个服务的情况（假设是 ssh），你可以增加这个服务到当前会话中（省略 \x3ccode\x3e--permanent\x3c\/code\x3e），并且指示防火墙在一个指定的时间之后恢复修改：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=public\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=ssh\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3etimeout=5m\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这个 \x3ccode\x3etimeout\x3c\/code\x3e 选项是一个以秒（\x3ccode\x3es\x3c\/code\x3e）、分（\x3ccode\x3em\x3c\/code\x3e）或小时（\x3ccode\x3eh\x3c\/code\x3e）为单位的时间值。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#目标\x22\x3e\x3c\/a\x3e目标\x3c\/h3\x3e\n\x3cp\x3e当一个区域处理它的源或接口上的一个包时，但是，没有处理该包的显式规则时，这时区域的目标target决定了该行为：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ccode\x3eACCEPT\x3c\/code\x3e：通过这个包。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3e%%REJECT%%\x3c\/code\x3e：拒绝这个包，并返回一个拒绝的回复。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3eDROP\x3c\/code\x3e：丢弃这个包，不回复任何信息。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3edefault\x3c\/code\x3e：不做任何事情。该区域不再管它，把它踢到“楼上”。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e在 firewalld 0.3.9 中有一个 bug （已经在 0.3.10 中修复），对于一个目标是除了“default”以外的源区域，不管允许的服务是什么，这的目标都会被应用。例如，一个使用目标 \x3ccode\x3eDROP\x3c\/code\x3e 的源区域，将丢弃所有的包，甚至是白名单中的包。遗憾的是，这个版本的 firewalld 被打包到 RHEL7 和它的衍生版中，使它成为一个相当常见的 bug。本文中的示例避免了可能出现这种行为的情况。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#优先权\x22\x3e\x3c\/a\x3e优先权\x3c\/h3\x3e\n\x3cp\x3e活动区域中扮演两个不同的角色。关联接口行为的区域作为接口区域，并且，关联源行为的区域作为源区域（一个区域能够扮演两个角色）。firewalld 按下列顺序处理一个包：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e相应的源区域。可以存在零个或一个这样的区域。如果这个包满足一个富规则rich rule、服务是白名单中的、或者目标没有定义，那么源区域处理这个包，并且在这里结束。否则，向上传递这个包。\x3c\/li\x3e\n\x3cli\x3e相应的接口区域。肯定有一个这样的区域。如果接口处理这个包，那么到这里结束。否则，向上传递这个包。\x3c\/li\x3e\n\x3cli\x3efirewalld 默认动作。接受 icmp 包并拒绝其它的一切。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e这里的关键信息是，源区域优先于接口区域。因此，对于多区域的 firewalld 配置的一般设计模式是，创建一个优先源区域来允许指定的 IP 对系统服务的提升访问，并在一个限制性接口区域限制其它访问。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#一个简单的多区域示例\x22\x3e\x3c\/a\x3e一个简单的多区域示例\x3c\/h3\x3e\n\x3cp\x3e为演示优先权，让我们在 \x3ccode\x3epublic\x3c\/code\x3e 区域中将 \x3ccode\x3ehttp\x3c\/code\x3e 替换成 \x3ccode\x3essh\x3c\/code\x3e，并且为我们喜欢的 IP 地址，如 1.1.1.1，设置一个默认的 \x3ccode\x3einternal\x3c\/code\x3e 区域。以下的命令完成这个任务：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=public\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eremove\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=ssh\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=public\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=http\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=internal\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3esource=1\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e1\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e1\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e1\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ereload\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这些命令的结果是生成如下的配置：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --zone=public --list-all\x3c\/span\x3e\npublic (default, active)\n  interfaces: eno1 eno2\n  sources:\n  services: dhcpv6-client http\n  ports:\n  masquerade: \x3cspan class=\x22hljs-literal\x22\x3eno\x3c\/span\x3e\n  forward-ports:\n  icmp-blocks:\n  rich rules:\n\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --permanent --zone=public --get-target\x3c\/span\x3e\x3cspan class=\x22hljs-built_in\x22\x3e\ndefault\n\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --zone=internal --list-all\x3c\/span\x3e\ninternal (active)\n  interfaces:\n  sources: 1.1.1.1\n  services: dhcpv6-client mdns samba-client ssh\n  ports:\n  masquerade: \x3cspan class=\x22hljs-literal\x22\x3eno\x3c\/span\x3e\n  forward-ports:\n  icmp-blocks:\n  rich rules:\n\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --permanent --zone=internal --get-target\x3c\/span\x3e\x3cspan class=\x22hljs-built_in\x22\x3e\ndefault\n\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e在上面的配置中，如果有人尝试从 1.1.1.1 去 \x3ccode\x3essh\x3c\/code\x3e，这个请求将会成功，因为这个源区域（\x3ccode\x3einternal\x3c\/code\x3e）被首先应用，并且它允许 \x3ccode\x3essh\x3c\/code\x3e 访问。\x3c\/p\x3e\n\x3cp\x3e如果有人尝试从其它的地址，如 2.2.2.2，去访问 \x3ccode\x3essh\x3c\/code\x3e，它不是这个源区域的，因为和这个源区域不匹配。因此，这个请求被直接转到接口区域（\x3ccode\x3epublic\x3c\/code\x3e），它没有显式处理 \x3ccode\x3essh\x3c\/code\x3e，因为，public 的目标是 \x3ccode\x3edefault\x3c\/code\x3e，这个请求被传递到默认动作，它将被拒绝。\x3c\/p\x3e\n\x3cp\x3e如果 1.1.1.1 尝试进行 \x3ccode\x3ehttp\x3c\/code\x3e 访问会怎样？源区域（\x3ccode\x3einternal\x3c\/code\x3e）不允许它，但是，目标是 \x3ccode\x3edefault\x3c\/code\x3e，因此，请求将传递到接口区域（\x3ccode\x3epublic\x3c\/code\x3e），它被允许访问。\x3c\/p\x3e\n\x3cp\x3e现在，让我们假设有人从 3.3.3.3 拖你的网站。要限制从那个 IP 的访问，简单地增加它到预定义的 \x3ccode\x3edrop\x3c\/code\x3e 区域，正如其名，它将丢弃所有的连接：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=drop\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3esource=3\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e3\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e3\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e3\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ereload\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e下一次 3.3.3.3 尝试去访问你的网站，firewalld 将转发请求到源区域（\x3ccode\x3edrop\x3c\/code\x3e）。因为目标是 \x3ccode\x3eDROP\x3c\/code\x3e，请求将被拒绝，并且它不会被转发到接口区域（\x3ccode\x3epublic\x3c\/code\x3e）。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#一个实用的多区域示例\x22\x3e\x3c\/a\x3e一个实用的多区域示例\x3c\/h3\x3e\n\x3cp\x3e假设你为你的组织的一台服务器配置防火墙。你希望允许全世界使用 \x3ccode\x3ehttp\x3c\/code\x3e 和 \x3ccode\x3ehttps\x3c\/code\x3e 的访问，你的组织（1.1.0.0\/16）和工作组（1.1.1.0\/8）使用 \x3ccode\x3essh\x3c\/code\x3e 访问，并且你的工作组可以访问 \x3ccode\x3esamba\x3c\/code\x3e 服务。使用 firewalld 中的区域，你可以用一个很直观的方式去实现这个配置。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3epublic\x3c\/code\x3e 这个命名，它的逻辑似乎是把全世界访问指定为公共区域，而 \x3ccode\x3einternal\x3c\/code\x3e 区域用于为本地使用。从在 \x3ccode\x3epublic\x3c\/code\x3e 区域内设置使用 \x3ccode\x3ehttp\x3c\/code\x3e 和 \x3ccode\x3ehttps\x3c\/code\x3e 替换 \x3ccode\x3edhcpv6-client\x3c\/code\x3e 和 \x3ccode\x3essh\x3c\/code\x3e 服务来开始：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=public\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eremove\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=dhcpv6\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eclient\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=public\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eremove\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=ssh\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=public\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=http\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=public\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=https\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e然后，取消 \x3ccode\x3einternal\x3c\/code\x3e 区域的 \x3ccode\x3emdns\x3c\/code\x3e、\x3ccode\x3esamba-client\x3c\/code\x3e 和 \x3ccode\x3edhcpv6-client\x3c\/code\x3e 服务（仅保留 \x3ccode\x3essh\x3c\/code\x3e），并增加你的组织为源：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=internal\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eremove\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=mdns\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=internal\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eremove\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=samba\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eclient\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=internal\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eremove\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eservice=dhcpv6\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eclient\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3efirewall\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecmd\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3epermanent\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ezone=internal\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3esource=1\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e1\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e0\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e0\/16\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e为容纳你提升的 \x3ccode\x3esamba\x3c\/code\x3e 的权限，增加一个富规则：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs hsp\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e# firewall-\x3cspan class=\x22hljs-meta-keyword\x22\x3ecmd\x3c\/span\x3e --permanent --zone=internal --add-rich-rule=\x27rule family=ipv4 source address=\x3cspan class=\x22hljs-meta-string\x22\x3e\x221.1.1.0\/8\x22\x3c\/span\x3e service name=\x3cspan class=\x22hljs-meta-string\x22\x3e\x22samba\x22\x3c\/span\x3e accept\x27\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e最后，重新加载，把这些变化拉取到会话中：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs hsp\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e# firewall-\x3cspan class=\x22hljs-meta-keyword\x22\x3ecmd\x3c\/span\x3e --reload\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e仅剩下少数的细节了。从一个 \x3ccode\x3einternal\x3c\/code\x3e 区域以外的 IP 去尝试通过 \x3ccode\x3essh\x3c\/code\x3e 到你的服务器，结果是回复一个拒绝的消息。它是 firewalld 默认的。更为安全的作法是去显示不活跃的 IP 行为并丢弃该连接。改变 \x3ccode\x3epublic\x3c\/code\x3e 区域的目标为 \x3ccode\x3eDROP\x3c\/code\x3e，而不是 \x3ccode\x3edefault\x3c\/code\x3e 来实现它：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs shell\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e#\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e firewall-cmd --permanent --zone=public --\x3cspan class=\x22hljs-built_in\x22\x3eset\x3c\/span\x3e-target=DROP\x3c\/span\x3e\n\x3cspan class=\x22hljs-meta\x22\x3e#\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e firewall-cmd --reload\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e但是，等等，你不再可以 ping 了，甚至是从内部区域！并且 icmp （ping 使用的协议）并不在 firewalld 可以列入白名单的服务列表中。那是因为，icmp 是第 3 层的 IP 协议，它没有端口的概念，不像那些捆绑了端口的服务。在设置公共区域为 \x3ccode\x3eDROP\x3c\/code\x3e 之前，ping 能够通过防火墙是因为你的 \x3ccode\x3edefault\x3c\/code\x3e 目标通过它到达防火墙的默认动作（default），即允许它通过。但现在它已经被删除了。\x3c\/p\x3e\n\x3cp\x3e为恢复内部网络的 ping，使用一个富规则：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs hsp\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e# firewall-\x3cspan class=\x22hljs-meta-keyword\x22\x3ecmd\x3c\/span\x3e --permanent --zone=internal --add-rich-rule=\x27rule protocol value=\x3cspan class=\x22hljs-meta-string\x22\x3e\x22icmp\x22\x3c\/span\x3e accept\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-meta\x22\x3e# firewall-\x3cspan class=\x22hljs-meta-keyword\x22\x3ecmd\x3c\/span\x3e --reload\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e结果如下，这里是两个活动区域的配置：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --zone=public --list-all\x3c\/span\x3e\npublic (default, active)\n  interfaces: eno1 eno2\n  sources:\n  services: http https\n  ports:\n  masquerade: \x3cspan class=\x22hljs-literal\x22\x3eno\x3c\/span\x3e\n  forward-ports:\n  icmp-blocks:\n  rich rules:\n\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --permanent --zone=public --get-target\x3c\/span\x3e\nDROP\n\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --zone=internal --list-all\x3c\/span\x3e\ninternal (active)\n  interfaces:\n  sources: 1.1.0.0\/16\n  services: ssh\n  ports:\n  masquerade: \x3cspan class=\x22hljs-literal\x22\x3eno\x3c\/span\x3e\n  forward-ports:\n  icmp-blocks:\n  rich rules:\n        rule \x3cspan class=\x22hljs-attribute\x22\x3efamily\x3c\/span\x3e=ipv4 source \x3cspan class=\x22hljs-attribute\x22\x3eaddress\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x221.1.1.0\/8\x22\x3c\/span\x3e\x3cspan class=\x22hljs-built_in\x22\x3e service \x3c\/span\x3e\x3cspan class=\x22hljs-attribute\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22samba\x22\x3c\/span\x3e accept\n        rule protocol \x3cspan class=\x22hljs-attribute\x22\x3evalue\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22icmp\x22\x3c\/span\x3e accept\n\x3cspan class=\x22hljs-comment\x22\x3e# firewall-cmd --permanent --zone=internal --get-target\x3c\/span\x3e\x3cspan class=\x22hljs-built_in\x22\x3e\ndefault\n\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这个设置演示了一个三层嵌套的防火墙。最外层，\x3ccode\x3epublic\x3c\/code\x3e，是一个接口区域，包含全世界的访问。紧接着的一层，\x3ccode\x3einternal\x3c\/code\x3e，是一个源区域，包含你的组织，它是 \x3ccode\x3epublic\x3c\/code\x3e 的一个子集。最后，一个富规则增加到最内层，包含了你的工作组，它是 \x3ccode\x3einternal\x3c\/code\x3e 的一个子集。\x3c\/p\x3e\n\x3cp\x3e这里的关键信息是，当在一个场景中可以突破到嵌套层，最外层将使用接口区域，接下来的将使用一个源区域，并且在源区域中额外使用富规则。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#调试\x22\x3e\x3c\/a\x3e调试\x3c\/h3\x3e\n\x3cp\x3efirewalld 采用直观范式来设计防火墙，但比它的前任 iptables 更容易产生歧义。如果产生无法预料的行为，或者为了更好地理解 firewalld 是怎么工作的，则可以使用 iptables 描述 netfilter 是如何配置操作的。前一个示例的输出如下，为了简单起见，将输出和日志进行了修剪:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs haml\x22\x3e# iptables -S\n-\x3cspan class=\x22ruby\x22\x3eP INPUT ACCEPT\n\x3c\/span\x3e... (forward and output lines) ...\n-\x3cspan class=\x22ruby\x22\x3eN INPUT_ZONES\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eN INPUT_ZONES_SOURCE\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eN INPUT_direct\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eN IN_internal\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eN IN_internal_allow\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eN IN_internal_deny\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eN IN_public\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eN IN_public_allow\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eN IN_public_deny\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA INPUT -i lo -j ACCEPT\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA INPUT -j INPUT_ZONES_SOURCE\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA INPUT -j INPUT_ZONES\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA INPUT -p icmp -j ACCEPT\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA INPUT -m conntrack --ctstate INVALID -j DROP\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA INPUT -j REJECT --reject-with icmp-host-prohibited\n\x3c\/span\x3e... (forward and output lines) ...\n-\x3cspan class=\x22ruby\x22\x3eA INPUT_ZONES -i eno1 -j IN_public\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA INPUT_ZONES -i eno2 -j IN_public\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA INPUT_ZONES -j IN_public\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA INPUT_ZONES_SOURCE -s \x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\/\x3cspan class=\x22hljs-number\x22\x3e16\x3c\/span\x3e -g IN_internal\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_internal -j IN_internal_deny\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_internal -j IN_internal_allow\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_internal_allow -p tcp -m tcp --dport \x3cspan class=\x22hljs-number\x22\x3e22\x3c\/span\x3e -m conntrack --ctstate NEW -j ACCEPT\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_internal_allow -s \x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e1.0\x3c\/span\x3e\/\x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e -p udp -m udp --dport \x3cspan class=\x22hljs-number\x22\x3e137\x3c\/span\x3e -m conntrack --ctstate NEW -j ACCEPT\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_internal_allow -s \x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e1.0\x3c\/span\x3e\/\x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e -p udp -m udp --dport \x3cspan class=\x22hljs-number\x22\x3e138\x3c\/span\x3e -m conntrack --ctstate NEW -j ACCEPT\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_internal_allow -s \x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e1.0\x3c\/span\x3e\/\x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e -p tcp -m tcp --dport \x3cspan class=\x22hljs-number\x22\x3e139\x3c\/span\x3e -m conntrack --ctstate NEW -j ACCEPT\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_internal_allow -s \x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e1.0\x3c\/span\x3e\/\x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e -p tcp -m tcp --dport \x3cspan class=\x22hljs-number\x22\x3e445\x3c\/span\x3e -m conntrack --ctstate NEW -j ACCEPT\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_internal_allow -p icmp -m conntrack --ctstate NEW -j ACCEPT\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_public -j IN_public_deny\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_public -j IN_public_allow\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_public -j DROP\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_public_allow -p tcp -m tcp --dport \x3cspan class=\x22hljs-number\x22\x3e80\x3c\/span\x3e -m conntrack --ctstate NEW -j ACCEPT\n\x3c\/span\x3e-\x3cspan class=\x22ruby\x22\x3eA IN_public_allow -p tcp -m tcp --dport \x3cspan class=\x22hljs-number\x22\x3e443\x3c\/span\x3e -m conntrack --ctstate NEW -j ACCEPT\n\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e在上面的 iptables 输出中，新的链（以 \x3ccode\x3e-N\x3c\/code\x3e 开始的行）是被首先声明的。剩下的规则是附加到（以 \x3ccode\x3e-A\x3c\/code\x3e 开始的行） iptables 中的。已建立的连接和本地流量是允许通过的，并且入站包被转到 \x3ccode\x3eINPUT_ZONES_SOURCE\x3c\/code\x3e 链，在那里如果存在相应的区域，IP 将被发送到那个区域。从那之后，流量被转到 \x3ccode\x3eINPUT_ZONES\x3c\/code\x3e 链，从那里它被路由到一个接口区域。如果在那里它没有被处理，icmp 是允许通过的，无效的被丢弃，并且其余的都被拒绝。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#结论\x22\x3e\x3c\/a\x3e结论\x3c\/h3\x3e\n\x3cp\x3efirewalld 是一个文档不足的防火墙配置工具，它的功能远比大多数人认识到的更为强大。以创新的区域范式，firewalld 允许系统管理员去分解流量到每个唯一处理它的分类中，简化了配置过程。因为它直观的设计和语法，它在实践中不但被用于简单的单一区域中也被用于复杂的多区域配置中。\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3evia: \x3ca href=\x22https:\/\/www.linuxjournal.com\/content\/understanding-firewalld-multi-zone-configurations?page=0,0\x22\x3ehttps:\/\/www.linuxjournal.com\/content\/understanding-firewalld-multi-zone-configurations?page=0,0\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e作者：\x3ca href=\x22https:\/\/www.linuxjournal.com\/users\/nathan-vance\x22\x3eNathan Vance\x3c\/a\x3e 译者：\x3ca href=\x22https:\/\/github.com\/qhwdw\x22\x3eqhwdw\x3c\/a\x3e 校对：\x3ca href=\x22https:\/\/github.com\/wxy\x22\x3ewxy\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e本文由 \x3ca href=\x22https:\/\/github.com\/LCTT\/TranslateProject\x22\x3eLCTT\x3c\/a\x3e 原创编译，\x3ca href=\x22https:\/\/linux.cn\/\x22\x3eLinux中国\x3c\/a\x3e 荣誉推出\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>理解多区域配置中的 firewalld</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/understanding-firewalld-in-multi-zone-configurations">https://www.zcfy.cc/article/understanding-firewalld-in-multi-zone-configurations</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/a0qwdu2q1c5/" target="_blank">https://alili.tech/archive/a0qwdu2q1c5/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>