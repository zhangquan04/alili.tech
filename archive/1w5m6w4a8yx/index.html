<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="今天，你的浏览器 “滚动” 了吗？"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>今天，你的浏览器 “滚动” 了吗？ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/1w5m6w4a8yx/",
				"appid": "1613049289050283", 
				"title": "今天，你的浏览器 “滚动” 了吗？ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-05T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/mo1uernrg47/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/jspac2304gh/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f1w5m6w4a8yx%2f&text=%e4%bb%8a%e5%a4%a9%ef%bc%8c%e4%bd%a0%e7%9a%84%e6%b5%8f%e8%a7%88%e5%99%a8%20%e2%80%9c%e6%bb%9a%e5%8a%a8%e2%80%9d%20%e4%ba%86%e5%90%97%ef%bc%9f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f1w5m6w4a8yx%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f1w5m6w4a8yx%2f&text=%e4%bb%8a%e5%a4%a9%ef%bc%8c%e4%bd%a0%e7%9a%84%e6%b5%8f%e8%a7%88%e5%99%a8%20%e2%80%9c%e6%bb%9a%e5%8a%a8%e2%80%9d%20%e4%ba%86%e5%90%97%ef%bc%9f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f1w5m6w4a8yx%2f&title=%e4%bb%8a%e5%a4%a9%ef%bc%8c%e4%bd%a0%e7%9a%84%e6%b5%8f%e8%a7%88%e5%99%a8%20%e2%80%9c%e6%bb%9a%e5%8a%a8%e2%80%9d%20%e4%ba%86%e5%90%97%ef%bc%9f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f1w5m6w4a8yx%2f&is_video=false&description=%e4%bb%8a%e5%a4%a9%ef%bc%8c%e4%bd%a0%e7%9a%84%e6%b5%8f%e8%a7%88%e5%99%a8%20%e2%80%9c%e6%bb%9a%e5%8a%a8%e2%80%9d%20%e4%ba%86%e5%90%97%ef%bc%9f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bb%8a%e5%a4%a9%ef%bc%8c%e4%bd%a0%e7%9a%84%e6%b5%8f%e8%a7%88%e5%99%a8%20%e2%80%9c%e6%bb%9a%e5%8a%a8%e2%80%9d%20%e4%ba%86%e5%90%97%ef%bc%9f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f1w5m6w4a8yx%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f1w5m6w4a8yx%2f&title=%e4%bb%8a%e5%a4%a9%ef%bc%8c%e4%bd%a0%e7%9a%84%e6%b5%8f%e8%a7%88%e5%99%a8%20%e2%80%9c%e6%bb%9a%e5%8a%a8%e2%80%9d%20%e4%ba%86%e5%90%97%ef%bc%9f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1w5m6w4a8yx%2f&title=%e4%bb%8a%e5%a4%a9%ef%bc%8c%e4%bd%a0%e7%9a%84%e6%b5%8f%e8%a7%88%e5%99%a8%20%e2%80%9c%e6%bb%9a%e5%8a%a8%e2%80%9d%20%e4%ba%86%e5%90%97%ef%bc%9f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1w5m6w4a8yx%2f&title=%e4%bb%8a%e5%a4%a9%ef%bc%8c%e4%bd%a0%e7%9a%84%e6%b5%8f%e8%a7%88%e5%99%a8%20%e2%80%9c%e6%bb%9a%e5%8a%a8%e2%80%9d%20%e4%ba%86%e5%90%97%ef%bc%9f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1w5m6w4a8yx%2f&title=%e4%bb%8a%e5%a4%a9%ef%bc%8c%e4%bd%a0%e7%9a%84%e6%b5%8f%e8%a7%88%e5%99%a8%20%e2%80%9c%e6%bb%9a%e5%8a%a8%e2%80%9d%20%e4%ba%86%e5%90%97%ef%bc%9f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">今天，你的浏览器 “滚动” 了吗？</h1><div class="meta"><div class="postdate"><time datetime="2019-01-05" itemprop="datePublished">2019-01-05</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e今天，你的浏览器 “滚动” 了吗？\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e序\x3c\/h3\x3e\n\x3cp\x3e在 Web 页面中，一个有高度或者宽度的容器是最常见的构成元素，而在其中的子元素有很大的概率超过父容器的尺寸限制，我们称之为“溢出”。而应对“溢出”，隐藏或者滚动是最常见的处理方式。滚动，作为 FEers 最经常处理的一种行为，却因为不同浏览器的各种表现形式让大家头痛不已，今天笔者从自身维护的组件出发，和大家分享一下自己在处理滚动和滚动条时遇到的问题，以及解决的办法，希望能够给你在解决同类问题时带来一些启发。同时本文也是 “从零开始的 React 组件开发之路” 系列的第二篇 - 表格篇番外。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e遇到的问题 1：尴尬的双滚动条\x3c\/h3\x3e\n\x3cp\x3e笔者在团队中负责基础组件的开发和维护，作为一个 B 类业务较多的团队，表格是最常用和需求最为旺盛的组件，假设有下方这样一个最简单的表格结构。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594252\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594252\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e图1：最简单的表格结构\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e因为空间有限，我们希望表格高度限定，这样势必引入表格上下滚动的情况。同时，为了查看的方便，我们希望表格头不会一起滚动，即表格头需要固定，只有表格体滚动，因此我们需要把表格头和表格体放入两个容器中，而只让表格体的容器滚动。这是很普通的需求，也很容易实现，到目前为止一切都很顺利。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594253\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594253\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e图2：表头固定，表格体滚动\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e然而这一切的美好，随着表格列数的增多，变的有了一点乌云。因为页面宽度受到电脑屏幕的限制，我们往往对表格的宽度也有限制，不可能无限延展开。那么如果有很多的列呢？显然，让表格左右滚动是一个很自然的想法。由于我们的表头和表格体在两个不同的容器中，让这件事变的稍微麻烦一点。关于如何让表头和表格体同步左右滚动，不是这篇文章讨论的重点，所以不做详细讨论，简单来说，我们通过监听横向滚动的事件和不断获取当前的 \x3ccode\x3escrollLeft\x3c\/code\x3e 来获得同步。有一个麻烦的点是，我们不希望只能通过滚动表格体来实现表格滚动，也希望可以通过滚动表头来实现表格的左右滚动，这就要求必须设置表头的容器为 \x3ccode\x3eoverflow-x: auto\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594254\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594254\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e图3：由于表格头和表格体都需要横向滚动，会引入两个滚动条。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e这显然突破了大多数人对表格的认知，横向滚动会有两个滚动条，一点都不美观，需要我们在这个基础之上进行优化。表格体上的横向滚动条是没有问题的，主要问题在于表格头的，我们既希望能够横向滚动，又不想看到那个该死的滚动条，怎么办呢？想办法隐藏掉他就好了！首先我们设置表格头的容器 \x3ccode\x3eoverflow-x: scroll\x3c\/code\x3e 以保证无论是否需要横向滚动都会出现滚动条，方便我们简化状态的判断。接下来我们可以再设置表格头的容器 \x3ccode\x3emargin-bottom: -scrollBarWidth\x3c\/code\x3e 来隐藏让他的父级帮忙吞掉这个滚动条，一切就大功告成了。但令人头大的是，滚动条的尺寸在不同浏览器，甚至是不同系统（例如 Windows 和 Mac 下的 chrome）中都是不一样的！ 我们无法很暴力地通过制定一个固定的值来做这件事，因此我们需要在表格渲染到页面上去之后，主动去探测滚动条的宽度。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const scrollbarMeasure = {\n  position: \x27absolute\x27,\n  top: \x27-9999px\x27,\n  width: \x2750px\x27,\n  height: \x2750px\x27,\n  overflow: \x27scroll\x27,\n};\n\nlet scrollbarWidth;\n\nconst measureScrollbar = () =\x3e {\n  if (typeof document === \x27undefined\x27 || typeof window === \x27undefined\x27) {\n    return 0; \/\/ 如果 document 不在，则证明不在浏览器环境，直接返回，兼容 node server render。\n  }\n  if (scrollbarWidth) {\n    return scrollbarWidth; \/\/ 滚动条在固定的环境下宽度不会改变，因此只做一次探测即可，优化性能。\n  }\n  const scrollDiv = document.createElement(\x27div\x27);\n  Object.keys(scrollbarMeasure).forEach((scrollProp) =\x3e {\n    if (Object.prototype.hasOwnProperty.call(scrollbarMeasure, scrollProp)) {\n      scrollDiv.style[scrollProp] = scrollbarMeasure[scrollProp];\n    }\n  }); \/\/ 创造一个远离人世的带滚动条的 div 用于探测，用户对于此无感知。\n  document.body.appendChild(scrollDiv);\n  const width = scrollDiv.offsetWidth - scrollDiv.clientWidth; \/\/ 获取滚动条的宽度，offsetWidth 和 clientWidth 的区别，你能说清楚吗？\n  document.body.removeChild(scrollDiv); \/\/ 探测完成，销毁测试元素，减少对页面的影响。\n  scrollbarWidth = width; \/\/ 缓存结果，优化性能\n  return scrollbarWidth;\n};\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e scrollbarMeasure = {\n  \x3cspan class=\x22hljs-attr\x22\x3eposition\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27absolute\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3etop\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27-9999px\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ewidth\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2750px\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eheight\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2750px\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eoverflow\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27scroll\x27\x3c\/span\x3e,\n};\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e scrollbarWidth;\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e measureScrollbar = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27undefined\x27\x3c\/span\x3e || \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27undefined\x27\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果 document 不在，则证明不在浏览器环境，直接返回，兼容 node server render。\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (scrollbarWidth) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e scrollbarWidth; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 滚动条在固定的环境下宽度不会改变，因此只做一次探测即可，优化性能。\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e scrollDiv = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(scrollbarMeasure).forEach(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3escrollProp\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.prototype.hasOwnProperty.call(scrollbarMeasure, scrollProp)) {\n      scrollDiv.style[scrollProp] = scrollbarMeasure[scrollProp];\n    }\n  }); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创造一个远离人世的带滚动条的 div 用于探测，用户对于此无感知。\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(scrollDiv);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e width = scrollDiv.offsetWidth - scrollDiv.clientWidth; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取滚动条的宽度，offsetWidth 和 clientWidth 的区别，你能说清楚吗？\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.removeChild(scrollDiv); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 探测完成，销毁测试元素，减少对页面的影响。\x3c\/span\x3e\n  scrollbarWidth = width; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 缓存结果，优化性能\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e scrollbarWidth;\n};\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e遇到的问题 2：对不齐的表头和数据\x3c\/h3\x3e\n\x3cp\x3e通过上面的方法，我们成功地隐藏了表格头的横向滚动条。稍微滚动一下，一切正常，一切都按照预想的执行，直到一直滚动到头，问题出现了，最后一列的表头和下面的数据居然是对不齐的！！\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594255\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594255\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e图4：当表格体又可以左右滚动时，问题开始复杂起来~\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch4\x3e这是怎么回事呢？\x3c\/h4\x3e\n\x3cp\x3e原来，因为我们允许表格体上下滚动，使得在容器右侧出现了一个纵向的滚动条。而表头因为我们希望他是固定的，因此放在了另一个容器中，这导致他不能共享这个滚动条。因此，这使得表格体拉到头的时的 scrollLeft 也正好是表格头到头的位置，两个到头的位置上差了一个滚动条的宽度！看到这里，也许有的小伙伴可能会开始自己操练起来看看是不是这样，然后发现并没有类似问题，大呼坑爹，他们看到的情况大致如下图：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594256\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594256\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e图4：Mac 某些设置下，看到的是另一份景象。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e这引出了一个 Mac 下一个比较好玩的小设置，在 Mac 下滚动条何时显示也可以配置，大致分为三类，具体的配置可以在 \x3ccode\x3e系统偏好设置 -\x26gt; 通用\x3c\/code\x3e 中看到。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594257\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594257\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e当我们选择 \x3cstrong\x3e滚动时\x3c\/strong\x3e 的时候，只有当我们滚动一个元素的时候才会显示滚动条，且这个滚动条是飘在内容上，不会占据体积，于是便能看到 图3 中的情景。这个兼容性上升到了系统的程度，在 PC 上还是比较少见的（笑）。\x3c\/p\x3e\n\x3cp\x3e所以这个问题只会在这种情况下没有出现，在 Mac 下选择 \x3cstrong\x3e始终显示\x3c\/strong\x3e，也同样会出现。\x3c\/p\x3e\n\x3ch4\x3e那么如何解决这个问题呢？\x3c\/h4\x3e\n\x3cp\x3e其实，从上面的分析中我们也可以也大致地找到了问题的根源，\x3cstrong\x3e表头没有共享表格体的纵向滚动条\x3c\/strong\x3e，那么我们只要想办法解决这个就好了。这个说起来简单，但毕竟不是在同一个容器中，如何共享呢？方案一：插入一个和滚动条相同宽度的 dom 元素充当滚动条，但这会引起另一个问题就是表格头和表格体的实际宽度不同，在各种滚动计算上引发很多麻烦。方案二：滚动条虽然在不同系统、不同浏览器里都不一样尺寸，但却有个优点就是，只要在同一系统、统一浏览器里不管因为什么原因，出现在什么地方，他的尺寸总是保持一致的。利用这个特点，我们可以设置表头容器的 \x3ccode\x3eoverflow-y: scroll\x3c\/code\x3e,总是包含一个纵向滚动条的道，这样就兵不血刃的解决了这个麻烦的问题。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594258\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594258\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e图5：利用空的滚动条连接下面的滚动条来就可以解决上面的问题。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch4\x3e但这样又引入了新的问题\x3c\/h4\x3e\n\x3cp\x3e这样虽然比较好的解决了表格体有滚动条的情况，但是如果表格体没有滚动的情况下，遇到的问题就正好逆转了，又会出现对不齐的情况！\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594259\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594259\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e图6：当表格体没有纵向滚动条的情况下，又会出现新的问题。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e解决这个问题也有几种思路，简单一点的思路可以模仿上面，给表格体也设置 \x3ccode\x3eoverflow-y: scroll\x3c\/code\x3e，这样不管是否有滚动，看起来都是一样而且不会错位了。但是这种方法并不十分美观，尤其在 windows 下显得比较丑陋。于是在此方案基础之上，我们加入了对于表格体纵向滚动的检测，当滚动区域的高度不大于容器高度时，即可认为没有滚动，此时同时设置表头和表格体 \x3ccode\x3eoverflow-y: hidden\x3c\/code\x3e ，就可以达到解决上述问题，而在没有滚动的情况下也保持美观的要求。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e遇到的问题3：列固定下的整体横向滚动\x3c\/h3\x3e\n\x3cp\x3e解决了上面两个问题之后，一个完整的支持表头固定和横向滚动的表格就完成了。接下来又有了新的需求，要在原有表格基础之上，支持左右侧列固定。这也是表格中比较常见的需求，一些数据列或者操作列处于高频使用下，希望能够固定，这时就产生两种处理表格体横向滚动条的方式。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594260\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594260\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594261\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594261\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e图7：支持左右列固定后的方案 A 和 B\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e方案 A 模仿表头的设计方案，将固定的列放在另一个容器当中，把需要滚动的列单独放置在一个可以滚动的容器当中。这种方案的问题在于，固定列的宽度和列数都不像表头一样固定且较小。当固定区域很大的时候，会严重挤压中间滚动区域滚动条的可操作区域，影响用户体验。同时他也会遇到和表头一样，滚动至最后一行对不齐的情况。方案 B 则比较好的解决了方案 A 的第一个问题，左右侧漂浮在表格的左右两边，覆盖对应的固定区域，横向滚动条可以覆盖整个表格，不会受到固定列宽度的限制。\x3c\/p\x3e\n\x3ch4\x3e方案 B 虽然好，但是仍有两个问题需要解决\x3c\/h4\x3e\n\x3col\x3e\n\x3cli\x3e如何实现在固定区域也可以做到整个表格上下滚动\x3c\/li\x3e\n\x3cli\x3e漂浮的固定列会遮盖住全局的横向滚动条。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e对于问题 1，他的解决思路其实和刚才表头的解决思路类似。主要是通过适当地设置 margin 来隐藏本应存在的滚动条，这里不再赘述。  \x3cbr\x3e对应问题 2，如果是没有纵向滚动，即 \x3ccode\x3eheight: auto\x3c\/code\x3e 这样的情况下经过测试不存在这个问题，float 的元素会很自然地不占用滚动条的体积，因此不会有遮挡。如果是有纵向滚动的，情况则复杂了一些，当 float 的元素和下面的主表格等高时会出现遮挡的情况。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594262\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594262\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e图8：方案 B 引入的遮挡滚动条的问题\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e那既然同高会有遮挡的问题，只要我们对应的减掉对应的滚动条高度就可以了，解决第一个问题时我们得到的大杀器，获取滚动条的高度，也可以用在这里。这个方案也能很好地应该对 Mac 下有的设置不显示滚动条的情况，在不显示滚动条的情况下，我们获取到的宽度是 0，即没有影响。而滚动时，滚动条会自动浮在最高的位置，因此仍然整条可见。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e总结\x3c\/h3\x3e\n\x3cp\x3e那么，今天，你的浏览器 “滚动” 了吗？你是否已经笑对其中了呢~  \x3c\/p\x3e\n\x3cp\x3e本文从实际的组件需求出发，通过三个有关滚动条的问题出现和解决为线索，和大家分享了如何跨系统、跨浏览器地兼容滚动尤其是滚动条的问题，虽然是以表格为核心阐述，但解决方案不局限于表格之中，希望能给大家在遇到类似问题时提供一些灵感。文中涉及的行列固定相关的知识，因为非本文重点，故一笔带过，如果有兴趣了解实现详情，可以参考我们团队开源的 PC 端 UI 组件库 \x3ca href=\x22https:\/\/github.com\/uxcore\/uxcore\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eUXCore\x3c\/a\x3e 和对应的组件 \x3ca href=\x22https:\/\/github.com\/uxcore\/uxcore-table\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eTable\x3c\/a\x3e 里的代码~\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/segmentfault.com\/image?src=https:\/\/gw.alicdn.com\/tps\/TB1TVapKFXXXXbbXpXXXXXXXXXX-1000-500.png\x26amp;objectId=1190000006201488\x26amp;token=ab294cff2351c1260dca388f99ab72c3\x22 src=\x22https:\/\/static.alili.techhttps:\/\/segmentfault.com\/image?src=https:\/\/gw.alicdn.com\/tps\/TB1TVapKFXXXXbbXpXXXXXXXXXX-1000-500.png\x26amp;objectId=1190000006201488\x26amp;token=ab294cff2351c1260dca388f99ab72c3\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010594263\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010594263\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>今天，你的浏览器 “滚动” 了吗？</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010594249">https://segmentfault.com/a/1190000010594249</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/1w5m6w4a8yx/" target="_blank">https://alili.tech/archive/1w5m6w4a8yx/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>