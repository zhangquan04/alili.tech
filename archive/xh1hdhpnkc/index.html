<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="第三方 CSS 并不安全"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>第三方 CSS 并不安全 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/xh1hdhpnkc/",
				"appid": "1613049289050283", 
				"title": "第三方 CSS 并不安全 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-24T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/3ivg0ddae6n/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/hvks3gpluns/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fxh1hdhpnkc%2f&text=%e7%ac%ac%e4%b8%89%e6%96%b9%20CSS%20%e5%b9%b6%e4%b8%8d%e5%ae%89%e5%85%a8"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fxh1hdhpnkc%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fxh1hdhpnkc%2f&text=%e7%ac%ac%e4%b8%89%e6%96%b9%20CSS%20%e5%b9%b6%e4%b8%8d%e5%ae%89%e5%85%a8"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fxh1hdhpnkc%2f&title=%e7%ac%ac%e4%b8%89%e6%96%b9%20CSS%20%e5%b9%b6%e4%b8%8d%e5%ae%89%e5%85%a8"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fxh1hdhpnkc%2f&is_video=false&description=%e7%ac%ac%e4%b8%89%e6%96%b9%20CSS%20%e5%b9%b6%e4%b8%8d%e5%ae%89%e5%85%a8"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e7%ac%ac%e4%b8%89%e6%96%b9%20CSS%20%e5%b9%b6%e4%b8%8d%e5%ae%89%e5%85%a8&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fxh1hdhpnkc%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fxh1hdhpnkc%2f&title=%e7%ac%ac%e4%b8%89%e6%96%b9%20CSS%20%e5%b9%b6%e4%b8%8d%e5%ae%89%e5%85%a8"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxh1hdhpnkc%2f&title=%e7%ac%ac%e4%b8%89%e6%96%b9%20CSS%20%e5%b9%b6%e4%b8%8d%e5%ae%89%e5%85%a8"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxh1hdhpnkc%2f&title=%e7%ac%ac%e4%b8%89%e6%96%b9%20CSS%20%e5%b9%b6%e4%b8%8d%e5%ae%89%e5%85%a8"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxh1hdhpnkc%2f&title=%e7%ac%ac%e4%b8%89%e6%96%b9%20CSS%20%e5%b9%b6%e4%b8%8d%e5%ae%89%e5%85%a8"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">第三方 CSS 并不安全</h1><div class="meta"><div class="postdate"><time datetime="2019-01-24" itemprop="datePublished">2019-01-24</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3ch1\x3e第三方 CSS 并不安全\x3c\/h1\x3e\n\x3cp\x3e发布于 2018.2.27\x3c\/p\x3e\n\x3cp\x3e最近一段时间，关于 \x3ca href=\x22https:\/\/github.com\/maxchehab\/CSS-Keylogging\x22\x3e通过 CSS 创建 “keylogger”（键盘记录器）\x3c\/a\x3e 的讨论很多。\x3c\/p\x3e\n\x3cp\x3e有些人呼吁浏览器厂商去“修复”它。有些人则深入研究，表示它仅能影响通过类 React 框架建立的网站，并指责 React。而真正的问题却在于认为第三方内容是“安全”的。\x3c\/p\x3e\n\x3ch2\x3e第三方图片\x3c\/h2\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3e\x26lt;img \x3cspan class=\x22hljs-attribute\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/example.com\/kitten.jpg\x22\x3c\/span\x3e\x26gt;\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e如果我将上述代码引入我的文件中，即表示信任 \x3ccode\x3eexample.com\x3c\/code\x3e。对方可能会删除资源，给我一个 404，导致网站不完整，从而破坏这种信任关系。或者，他们可能会用其他非预期的数据来替代小猫图片的数据。\x3c\/p\x3e\n\x3cp\x3e但是，图片的影响仅限于元素本身的内容区域。我可以向用户解释并希望用户相信，“此处的内容来自 \x3ccode\x3eexample.com\x3c\/code\x3e，如果它有误，则是原站点的问题，并不是本站造成的”。但这个问题肯定不会影响到密码输入框等内容。\x3c\/p\x3e\n\x3ch2\x3e第三方脚本\x3c\/h2\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/example.com\/script.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e与图片相比，第三方脚本则有更多的控制权。如果我将上述代码引入我的文件中，则表示我赋予了 \x3ccode\x3eexample.com\x3c\/code\x3e 完全控制我的网站的权限。该脚本能：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e读取\/修改页面内容。\x3c\/li\x3e\n\x3cli\x3e监听用户的所有交互。\x3c\/li\x3e\n\x3cli\x3e运行耗费大量计算资源的代码（如 cryptocoin 挖矿程序）。\x3c\/li\x3e\n\x3cli\x3e通过向本站发请求，这样能附带用户的 cookie，转发响应。\x3ccode\x3e（译注：盗取用户的 cookie 及其他数据）\x3c\/code\x3e\x3c\/li\x3e\n\x3cli\x3e读取\/修改本地存储。\x3c\/li\x3e\n\x3cli\x3e......可以做任何对方想做的事情。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e“本地存储”非常重要。如果脚本通过 IndexedDB 或缓存 API 发起攻击，则即使在删除脚本后，攻击仍可能在整个站点内继续存在。\x3c\/p\x3e\n\x3cp\x3e如果你引入了其他站点的脚本，则必须绝对相信对方及对方的防护能力。\x3c\/p\x3e\n\x3cp\x3e如果你遭到恶意脚本的攻击，则可设置 \x3ca href=\x22https:\/\/w3c.github.io\/webappsec-clear-site-data\/\x22\x3e Clear-Site-Data header（清空站点数据响应头）\x3c\/a\x3e 清除站点所有数据。\x3c\/p\x3e\n\x3ch2\x3e第三方CSS\x3c\/h2\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3e\x26lt;link \x3cspan class=\x22hljs-attribute\x22\x3erel\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22stylesheet\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attribute\x22\x3ehref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/example.com\/style.css\x22\x3c\/span\x3e\x26gt;\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e相比图片，CSS 在能力上更接近脚本。像脚本一样，它适用于整个页面。它可以：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e删除\/添加\/修改页面内容。\x3c\/li\x3e\n\x3cli\x3e根据页面内容发起请求。\x3c\/li\x3e\n\x3cli\x3e可响应多种用户交互。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e虽然 CSS 不能修改本地存储，也不能通过 CSS 运行 cryptocoin 挖矿程序（也许是可能的，只是我不知道而已），但恶意 CSS 代码仍然能造成很大的损失。\x3c\/p\x3e\n\x3ch3\x3e键盘记录器\x3c\/h3\x3e\n\x3cp\x3e从引起广泛关注的代码开始讲起：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs markdown\x22\x3einput[\x3cspan class=\x22hljs-string\x22\x3etype=\x22password\x22\x3c\/span\x3e][\x3cspan class=\x22hljs-symbol\x22\x3evalue$=\x22p\x22\x3c\/span\x3e] {\n  background: url(\x27\/password?p\x27);\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e如果输入框的 \x3ccode\x3evalue\x3c\/code\x3e 属性值以 \x3ccode\x3ep\x3c\/code\x3e 结尾，上述代码将会向 \x3ccode\x3e\/password?p\x3c\/code\x3e 发起请求。每个字符都可触发这个操作，通过它能获取到很多数据。\x3c\/p\x3e\n\x3cp\x3e默认情况下，浏览器不会将用户输入的值存储在 \x3ccode\x3evalue\x3c\/code\x3e 属性中，因此这种攻击需要依赖某些能同步这些值的东西，如 React。\x3c\/p\x3e\n\x3cp\x3e要应对这个问题，React 可用另一种同步密码字段的方式，或浏览器可限制那些能匹配密码字段属性的选择器。但是，这仅仅是一种虚假的安全。你只解决了在特殊情况下的该问题，而其他情况依旧。\x3c\/p\x3e\n\x3cp\x3e如果 React 改为使用 \x3ccode\x3edata-value\x3c\/code\x3e 属性，则该应对方法无效。如果网站将输入框更改为 \x3ccode\x3etype=\x22text\x22\x3c\/code\x3e，以便用户可以看到他们正在输入的内容，则该应对方法无效。如果网站创建了一个 \x3ccode\x3e\x26lt;better-password-input\x26gt;\x3c\/code\x3e  组件并暴露 \x3ccode\x3evalue\x3c\/code\x3e 作为属性，则该应对方法无效。\x3c\/p\x3e\n\x3cp\x3e此外，还有很多其他的基于 CSS 的攻击方式：\x3c\/p\x3e\n\x3ch3\x3e消失的内容\x3c\/h3\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs css\x22\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3ebody\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3edisplay\x3c\/span\x3e: none;\n}\n\n\x3cspan class=\x22hljs-selector-tag\x22\x3ehtml\x3c\/span\x3e\x3cspan class=\x22hljs-selector-pseudo\x22\x3e::after\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3econtent\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27HTTP 500 Server Error\x27\x3c\/span\x3e;\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e以上是一个极端的例子，但想象一下，如果第三方仅对某一小部分用户这样做。不但你很难调试，还会失去用户的信任。\x3c\/p\x3e\n\x3cp\x3e更狡猾的方式如偶尔删除“购买”按钮，或重排内容段落。\x3c\/p\x3e\n\x3ch3\x3e添加内容\x3c\/h3\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs css\x22\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.price-value\x3c\/span\x3e\x3cspan class=\x22hljs-selector-pseudo\x22\x3e::before\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3econtent\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e;\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e哦，价格被标高了。\x3c\/p\x3e\n\x3ch3\x3e移动内容\x3c\/h3\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs css\x22\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.delete-everything-button\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3eopacity\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3eposition\x3c\/span\x3e: absolute;\n  \x3cspan class=\x22hljs-attribute\x22\x3etop\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e500px\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3eleft\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e300px\x3c\/span\x3e;\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e上面的按钮能做一些重要的操作，设置其为不可见，然后放在用户可能点击的地方。\x3c\/p\x3e\n\x3cp\x3e值得庆幸的是，如果按钮的操作确实非常重要，网站可能会先显示确认对话框。但也不是不可绕过，只需使用更多的 CSS 来欺骗用户点击 “确定” 按钮而不是“取消”按钮即可。\x3c\/p\x3e\n\x3cp\x3e假设浏览器确实采用上面的应对方法解决“键盘记录器”的问题。攻击者只需在页面上找到一个非密码文本输入框（可能是搜索输入框）并将其盖在密码输入框上即可。然后他们的攻击就又可用了。\x3c\/p\x3e\n\x3ch3\x3e读取属性\x3c\/h3\x3e\n\x3cp\x3e其实，你需要担心的不仅仅是密码输入框。你可能在属性中保存着其他的隐藏内容：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3e\x26lt;\x3cspan class=\x22hljs-selector-tag\x22\x3einput\x3c\/span\x3e type=\x3cspan class=\x22hljs-string\x22\x3e\x22hidden\x22\x3c\/span\x3e name=\x3cspan class=\x22hljs-string\x22\x3e\x22csrf\x22\x3c\/span\x3e value=\x3cspan class=\x22hljs-string\x22\x3e\x221687594325\x22\x3c\/span\x3e\x26gt;\n\x26lt;\x3cspan class=\x22hljs-selector-tag\x22\x3eimg\x3c\/span\x3e src=\x3cspan class=\x22hljs-string\x22\x3e\x22\/avatars\/samanthasmith83.jpg\x22\x3c\/span\x3e\x26gt;\n\x26lt;\x3cspan class=\x22hljs-selector-tag\x22\x3eiframe\x3c\/span\x3e src=\x3cspan class=\x22hljs-string\x22\x3e\x22\/\/cool-maps-service\/show?st-pancras-london\x22\x3c\/span\x3e\x26gt;\x26lt;\/iframe\x26gt;\n\x26lt;\x3cspan class=\x22hljs-selector-tag\x22\x3eimg\x3c\/span\x3e src=\x3cspan class=\x22hljs-string\x22\x3e\x22\/gender-icons\/female.png\x22\x3c\/span\x3e\x26gt;\n\x26lt;div\x26gt;\x26lt;\/div\x26gt;\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e所有这些都可以通过 CSS 选择器获取，且能发出请求。\x3c\/p\x3e\n\x3ch3\x3e监听交互\x3c\/h3\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs css\x22\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.login-button\x3c\/span\x3e\x3cspan class=\x22hljs-selector-pseudo\x22\x3e:hover\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3ebackground\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27\/login-button-hover\x27\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-selector-class\x22\x3e.login-button\x3c\/span\x3e\x3cspan class=\x22hljs-selector-pseudo\x22\x3e:active\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3ebackground\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27\/login-button-active\x27\x3c\/span\x3e);\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e可将 hover 和 active 状态发送到服务器。通过适当的 CSS，你就能获取到用户意图。\x3c\/p\x3e\n\x3ch3\x3e读取文本\x3c\/h3\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs css\x22\x3e@\x3cspan class=\x22hljs-keyword\x22\x3efont-face\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3efont-family\x3c\/span\x3e: blah;\n  \x3cspan class=\x22hljs-attribute\x22\x3esrc\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27\/page-contains-q\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-built_in\x22\x3eformat\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27woff\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-attribute\x22\x3eunicode-range\x3c\/span\x3e: U\x2b\x3cspan class=\x22hljs-number\x22\x3e85\x3c\/span\x3e;\n}\n\n\x3cspan class=\x22hljs-selector-tag\x22\x3ehtml\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3efont-family\x3c\/span\x3e: blah, sans-serif;\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e在这种情况下，如果页面内有 \x3ccode\x3eq\x3c\/code\x3e 字符，则会发送请求。你可以为不同的字符，并针对特定的元素，创建大量不同的字体。字体也可以包含 ligature（连字），所以你可以在开始检测字符序列。你甚至可以通过  \x3ca href=\x22https:\/\/gist.github.com\/securityMB\/d9e84bd3c7c245895360808360b9dc4e\x22\x3e将字体技巧与滚动条检测结合起来\x3c\/a\x3e 来推断内容。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e译注：关于 ligature（连字）, 可查看\x3c\/code\x3e \x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/Typographic_ligature\x22\x3eWikipedia Typographic Ligature \x3c\/a\x3e\x3c\/p\x3e\n\x3ch2\x3e第三方内容不安全\x3c\/h2\x3e\n\x3cp\x3e这些只是我所知道的一些技巧，我相信还有更多。\x3c\/p\x3e\n\x3cp\x3e第三方内容在其沙箱区域内具有强大的能力。一张图片或沙盒化的 iframe 仅在一个小范围内的沙箱中，但脚本和样式的范围却是你的页面，甚至是整个站点。\x3c\/p\x3e\n\x3cp\x3e如果你担心恶意用户诱使你的网站加载第三方资源，可以通过  \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/HTTP\/CSP\x22\x3eCSP\x3c\/a\x3e  用作防护手段，其可以限制加载图片，脚本和样式的来源。\x3c\/p\x3e\n\x3cp\x3e你还可以使用 \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/Security\/Subresource_Integrity\x22\x3eSubresource Integrity（子资源完整性 ）\x3c\/a\x3e 来确保脚本\/样式的内容匹配特定的 hash，否则将不加载。感谢 \x3ca href=\x22https:\/\/news.ycombinator.com\/item?id=16474151\x22\x3eHacker News上的Piskvorrr\x3c\/a\x3e 提醒我！\x3c\/p\x3e\n\x3cp\x3e如果你想了解更多如上述的 hack 技巧，包括滚动条技巧，更多信息请参阅 \x3ca href=\x22https:\/\/vimeo.com\/100264064#t=1290s\x22\x3eMathias Bynens\x27 talk from 2014\x3c\/a\x3e，\x3ca href=\x22https:\/\/www.youtube.com\/watch?v=eb3suf4REyI\x22\x3eMike West\x27s talk from 2013\x3c\/a\x3e，或 \x3ca href=\x22http:\/\/www.nds.rub.de\/media\/emma\/veroeffentlichungen\/2012\/08\/16\/scriptlessAttacks-ccs2012.pdf\x22\x3eMario Heiderich et al.\x27s paper from 2012\x3c\/a\x3e（PDF）。是的，这不是什么新东西。\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>第三方 CSS 并不安全</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/third-party-css-is-not-safe">https://www.zcfy.cc/article/third-party-css-is-not-safe</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/xh1hdhpnkc/" target="_blank">https://alili.tech/archive/xh1hdhpnkc/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>