<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="[译]教程：如何使用Rollup打包JavaScript"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>[译]教程：如何使用Rollup打包JavaScript | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/tosbjv63d4g/",
				"appid": "1613049289050283", 
				"title": "[译]教程：如何使用Rollup打包JavaScript | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-31T02:31:16"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/cnc4nju96vm/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/t8h3abzd8/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2ftosbjv63d4g%2f&text=%5b%e8%af%91%5d%e6%95%99%e7%a8%8b%ef%bc%9a%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8Rollup%e6%89%93%e5%8c%85JavaScript"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2ftosbjv63d4g%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2ftosbjv63d4g%2f&text=%5b%e8%af%91%5d%e6%95%99%e7%a8%8b%ef%bc%9a%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8Rollup%e6%89%93%e5%8c%85JavaScript"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2ftosbjv63d4g%2f&title=%5b%e8%af%91%5d%e6%95%99%e7%a8%8b%ef%bc%9a%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8Rollup%e6%89%93%e5%8c%85JavaScript"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2ftosbjv63d4g%2f&is_video=false&description=%5b%e8%af%91%5d%e6%95%99%e7%a8%8b%ef%bc%9a%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8Rollup%e6%89%93%e5%8c%85JavaScript"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%5b%e8%af%91%5d%e6%95%99%e7%a8%8b%ef%bc%9a%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8Rollup%e6%89%93%e5%8c%85JavaScript&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2ftosbjv63d4g%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2ftosbjv63d4g%2f&title=%5b%e8%af%91%5d%e6%95%99%e7%a8%8b%ef%bc%9a%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8Rollup%e6%89%93%e5%8c%85JavaScript"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftosbjv63d4g%2f&title=%5b%e8%af%91%5d%e6%95%99%e7%a8%8b%ef%bc%9a%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8Rollup%e6%89%93%e5%8c%85JavaScript"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftosbjv63d4g%2f&title=%5b%e8%af%91%5d%e6%95%99%e7%a8%8b%ef%bc%9a%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8Rollup%e6%89%93%e5%8c%85JavaScript"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftosbjv63d4g%2f&title=%5b%e8%af%91%5d%e6%95%99%e7%a8%8b%ef%bc%9a%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8Rollup%e6%89%93%e5%8c%85JavaScript"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">[译]教程：如何使用Rollup打包JavaScript</h1><div class="meta"><div class="postdate"><time datetime="2019-01-31" itemprop="datePublished">2019-01-31</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e教程：如何使用Rollup打包JavaScript\x3c\/h2\x3e\n\x3cp\x3e通过这个系列教程一步一步学习如何使用更小更快的Rollup取代webpack和Browserify打包JavaScript文件。\x3c\/p\x3e\n\x3cp\x3e这周，我们要使用Rollup构建我们的第一个项目，Rollup是一个打包JavaScript(和样式，不过下周才会做)的构建工具。\x3c\/p\x3e\n\x3cp\x3e通过这个教程，我们的Rollup将能够：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e合并scripts代码，\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e删除多余代码，\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e编译成对旧浏览器友好的代码，\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e支持在浏览器中使用Node模块，\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e能使用环境变量，\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e尽可能的压缩，减少文件大小。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e准备工作\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e至少懂一点JavaScript的话将会更好理解。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e对\x3ca href=\x22https:\/\/github.com\/getify\/You-Dont-Know-JS\/blob\/master\/es6%20%26%20beyond\/ch3.md#modules\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eES2015 modules\x3c\/a\x3e有基本了解，不过不了解也无妨。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e在你的设备上要有npm。(还没有？\x3ca href=\x22https:\/\/nodejs.org\/en\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e在这下载Node.js\x3c\/a\x3e)\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3eRollup是什么？\x3c\/h2\x3e\n\x3cp\x3e用他们自己的话说：\x3c\/p\x3e\n\x3cp\x3eRollup是下一代JavaScript模块打包工具。开发者可以在你的应用或库中使用ES2015模块，然后高效地将它们打包成一个单一文件用于浏览器和Node.js使用。\x3c\/p\x3e\n\x3cp\x3e和Browserify和webpack很像。\x3c\/p\x3e\n\x3cp\x3e你也可以称Rollup是一个构建工具，可以和像Grunt和Gulp等一起配置使用。但是，需要注意的一点是当你使用Grunt和Gulp来处理像打包JavaScript这样的任务时，这些工具的底层还是使用了像Rollup，Browserify或webpack这些东西。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e为什么应该关注Rollup？\x3c\/h2\x3e\n\x3cp\x3eRollup最令人激动的地方，就是能让打包文件体积很小。这么说很难理解，更详细的解释：相比其他JavaScript打包工具，Rollup总能打出更小，更快的包。\x3c\/p\x3e\n\x3cp\x3e因为Rollup基于ES2015模块，比webpack和Browserify使用的CommonJS模块机制更高效。这也让Rollup从模块中删除无用的代码，即\x3ccode\x3etree-shaking\x3c\/code\x3e变得更容易。\x3c\/p\x3e\n\x3cp\x3e当我们引入拥有大量函数和方法的三方工具或者框架时\x3ccode\x3etree-shaking\x3c\/code\x3e会变得很重要。想想\x3ccode\x3elodash\x3c\/code\x3e或者\x3ccode\x3ejQuery\x3c\/code\x3e，如果我们只使用一个或者两个方法，就会因为加载其余内容而产生大量无用的开销。\x3c\/p\x3e\n\x3cp\x3eBrowserify和webpack就会包含大量无用的代码。但是Rollup不会 - 它只会包括我们真正用到的东西。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e更新 (2016-08-22): 澄清一下，Rollup只能对ES模块上进行tree-shaking。CommonJS模块 - 像lodash和jQuery那样写的模块不能进行tree-shaking。然而，tree-shaking不是Rollup在速度\/性能上唯一的优势。可以看\x3ca href=\x22https:\/\/www.reddit.com\/r\/javascript\/comments\/4yprc5\/how_to_bundle_javascript_with_rollup_stepbystep\/d6qzgzm\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRich Harris的解释\x3c\/a\x3e和\x3ca href=\x22https:\/\/www.reddit.com\/r\/javascript\/comments\/4yprc5\/how_to_bundle_javascript_with_rollup_stepbystep\/d6qzmgh?context=3\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eNolan Lawson的补充\x3c\/a\x3e了解更多。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e还有一个大新闻。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e注意: 由于Rollup很高效，webpack 2 也将支持tree-shaking。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3ePart I: 如何使用Rollup处理并打包JavaScript文件\x3c\/h2\x3e\n\x3cp\x3e为了展示Rollup如何使用，让我们通过构建一个简单的项目来走一遍使用Rollup打包JavaScript的过程。\x3c\/p\x3e\n\x3ch4\x3eSTEP 0: 创建一个包含将被编译的JavaScript和CSS的项目.\x3c\/h4\x3e\n\x3cp\x3e为了开始工作，我们需要一些用来处理的代码。这个教程里，我们将用一个小应用，可从\x3ca href=\x22https:\/\/github.com\/jlengstorf\/learn-rollup\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGitHub\x3c\/a\x3e获取。\x3c\/p\x3e\n\x3cp\x3e目录结构如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22learn-rollup\/\n├── src\/\n│   ├── scripts\/\n│   │   ├── modules\/\n│   │   │   ├── mod1.js\n│   │   │   └── mod2.js\n│   │   └── main.js\n│   └── styles\/\n│       └── main.css\n└── package.json\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3elearn-rollup\/\n├── src\/\n│   ├── scripts\/\n│   │   ├── modules\/\n│   │   │   ├── mod1\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n│   │   │   └── mod2\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n│   │   └── main\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n│   └── styles\/\n│       └── main\x3cspan class=\x22hljs-selector-class\x22\x3e.css\x3c\/span\x3e\n└── package\x3cspan class=\x22hljs-selector-class\x22\x3e.json\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e你可以在终端执行下面的命令下载这个应用，我们将在这个教程中使用它。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22# Move to the folder where you keep your dev projects.\ncd \/path\/to\/your\/projects\n\n# Clone the starter branch of the app from GitHub.\ngit clone -b step-0 --single-branch https:\/\/github.com\/jlengstorf\/learn-rollup.git\n\n# The files are downloaded to \/path\/to\/your\/projects\/learn-rollup\/\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs awk\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e# Move to the folder where you keep your dev projects.\x3c\/span\x3e\ncd \x3cspan class=\x22hljs-regexp\x22\x3e\/path\/\x3c\/span\x3eto\x3cspan class=\x22hljs-regexp\x22\x3e\/your\/\x3c\/span\x3eprojects\n\n\x3cspan class=\x22hljs-comment\x22\x3e# Clone the starter branch of the app from GitHub.\x3c\/span\x3e\ngit clone -b step-\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e --single-branch https:\x3cspan class=\x22hljs-regexp\x22\x3e\/\/gi\x3c\/span\x3ethub.com\x3cspan class=\x22hljs-regexp\x22\x3e\/jlengstorf\/\x3c\/span\x3elearn-rollup.git\n\n\x3cspan class=\x22hljs-comment\x22\x3e# The files are downloaded to \/path\/to\/your\/projects\/learn-rollup\/\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3eSTEP 1: 安装Rollup并且创建配置文件。\x3c\/h4\x3e\n\x3cp\x3e第一步，执行下面的命令安装Rollup：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install --save-dev rollup\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs q\x22\x3e\x3ccode\x3enpm install --\x3cspan class=\x22hljs-built_in\x22\x3esave\x3c\/span\x3e-\x3cspan class=\x22hljs-built_in\x22\x3edev\x3c\/span\x3e rollup\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后，在\x3ccode\x3elearn-rollup\x3c\/code\x3e文件夹下新建\x3ccode\x3erollup.config.js\x3c\/code\x3e。在文件中添加如下内容。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export default {\n  entry: \x27src\/scripts\/main.js\x27,\n  dest: \x27build\/js\/main.min.js\x27,\n  format: \x27iife\x27,\n  sourceMap: \x27inline\x27,\n};\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3eentry\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27src\/scripts\/main.js\x27\x3c\/span\x3e,\n  dest: \x3cspan class=\x22hljs-string\x22\x3e\x27build\/js\/main.min.js\x27\x3c\/span\x3e,\n  format: \x3cspan class=\x22hljs-string\x22\x3e\x27iife\x27\x3c\/span\x3e,\n  sourceMap: \x3cspan class=\x22hljs-string\x22\x3e\x27inline\x27\x3c\/span\x3e,\n};\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e说说每个配置项实际上做了什么：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eentry\x3c\/code\x3e — 希望Rollup处理的文件路径。大多数应用中，它将是入口文件，初始化所有东西并启动应用。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3edest\x3c\/code\x3e — 编译完的文件需要被存放的路径。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eformat\x3c\/code\x3e — Rollup支持多种输出格式。因为我们是要在浏览器中使用，需要使用立即执行函数表达式(IIFE)[注1]\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3esourceMap\x3c\/code\x3e — 调试时sourcemap是非常有用的。这个配置项会在生成文件中添加一个sourcemap，让开发更方便。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e\x3cp\x3eNOTE: 对于其他的\x3ccode\x3eformat\x3c\/code\x3e选项以及你为什么需要他们，看\x3ca href=\x22https:\/\/github.com\/rollup\/rollup\/wiki\/JavaScript-API#format\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRollup’s wiki\x3c\/a\x3e。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch4\x3e测试Rollup配置\x3c\/h4\x3e\n\x3cp\x3e当创建好配置文件后，在终端执行下面的命令测试每项配置是否工作：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.\/node_modules\/.bin\/rollup -c\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs armasm\x22\x3e\x3ccode\x3e.\/node_modules\/.\x3cspan class=\x22hljs-keyword\x22\x3ebin\/rollup \x3c\/span\x3e-c\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在你的项目下会出现一个\x3ccode\x3ebuild\x3c\/code\x3e目录，包含\x3ccode\x3ejs\x3c\/code\x3e子目录，子目录中包含生成的\x3ccode\x3emain.min.js\x3c\/code\x3e文件。\x3c\/p\x3e\n\x3cp\x3e在浏览器中打开\x3ccode\x3ebuild\/index.html\x3c\/code\x3e可以看到打包文件正确生成了。\x3c\/p\x3e\n\x3cp\x3e完成第一步后我们的示例项目的状态。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e注意：现在，只有现代浏览器下不会报错。为了能够在不支持ES2015\/ES6的老浏览器中运行，我们需要添加一些插件。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch4\x3e看看打包出来的文件\x3c\/h4\x3e\n\x3cp\x3e事实上Rollup强大是因为它使用了“tree-shaking”，可以在你引入的模块中删除没有用的代码。举个例子，在\x3ccode\x3esrc\/scripts\/modules\/mod1.js\x3c\/code\x3e中的\x3ccode\x3esayGoodbyeTo()\x3c\/code\x3e函数在我们的应用中并没有使用 - 而且因为它从不会被使用，Rollup不会将它打包到bundle中：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(function () {\n\x27use strict\x27;\n\n\/**\n * Says hello.\n * @param  {String} name a name\n * @return {String}      a greeting for `name`\n *\/\nfunction sayHelloTo( name ) {\n  const toSay = `Hello, ${name}!`;\n\n  return toSay;\n}\n\n\/**\n * Adds all the values in an array.\n * @param  {Array} arr an array of numbers\n * @return {Number}    the sum of all the array values\n *\/\nconst addArray = arr =\x3e {\n  const result = arr.reduce((a, b) =\x3e a \x2b b, 0);\n\n  return result;\n};\n\n\/\/ Import a couple modules for testing.\n\/\/ Run some functions from our imported modules.\nconst result1 = sayHelloTo(\x27Jason\x27);\nconst result2 = addArray([1, 2, 3, 4]);\n\n\/\/ Print the results on the page.\nconst printTarget = document.getElementsByClassName(\x27debug__output\x27)[0];\n\nprintTarget.innerText = `sayHelloTo(\x27Jason\x27) =\x3e ${result1}\\n\\n`\nprintTarget.innerText \x2b= `addArray([1, 2, 3, 4]) =\x3e ${result2}`;\n\n}());\n\/\/# sourceMappingURL=data:application\/json;charset=utf-8;base64,...\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n\x3cspan class=\x22hljs-meta\x22\x3e\x27use strict\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Says hello.\n * @param  {String} name a name\n * @return {String}      a greeting for `name`\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esayHelloTo\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e name \x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e toSay = \x3cspan class=\x22hljs-string\x22\x3e`Hello, \x3cspan class=\x22hljs-subst\x22\x3e${name}\x3c\/span\x3e!`\x3c\/span\x3e;\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e toSay;\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Adds all the values in an array.\n * @param  {Array} arr an array of numbers\n * @return {Number}    the sum of all the array values\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e addArray = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3earr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e result = arr.reduce(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, b\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e a \x2b b, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e result;\n};\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Import a couple modules for testing.\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Run some functions from our imported modules.\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e result1 = sayHelloTo(\x3cspan class=\x22hljs-string\x22\x3e\x27Jason\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e result2 = addArray([\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e]);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Print the results on the page.\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e printTarget = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementsByClassName(\x3cspan class=\x22hljs-string\x22\x3e\x27debug__output\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n\nprintTarget.innerText = \x3cspan class=\x22hljs-string\x22\x3e`sayHelloTo(\x27Jason\x27) =\x26gt; \x3cspan class=\x22hljs-subst\x22\x3e${result1}\x3c\/span\x3e\\n\\n`\x3c\/span\x3e\nprintTarget.innerText \x2b= \x3cspan class=\x22hljs-string\x22\x3e`addArray([1, 2, 3, 4]) =\x26gt; \x3cspan class=\x22hljs-subst\x22\x3e${result2}\x3c\/span\x3e`\x3c\/span\x3e;\n\n}());\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/# sourceMappingURL=data:application\/json;charset=utf-8;base64,...\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其他的构建工具则不是这样的，所以如果我们引入了一个像lodash这样一个很大的库而只是使用其中一两个函数时，我们的包文件会变得非常大。\x3c\/p\x3e\n\x3cp\x3e比如使用\x3ca href=\x22https:\/\/webpack.github.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack\x3c\/a\x3e的话，\x3ccode\x3esayGoodbyeTo()\x3c\/code\x3e也会打包进去，产生的打包文件比Rollup生成的大了两倍多。\x3c\/p\x3e\n\x3ch4\x3eSTEP 2: 配置babel支持JavaScript新特性。\x3c\/h4\x3e\n\x3cp\x3e现在我们已经得到能在现代浏览器中运行的包文件了，但是在一些旧版本浏览器中就会崩溃 - 这并不理想。\x3c\/p\x3e\n\x3cp\x3e幸运的是，\x3ca href=\x22https:\/\/babeljs.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eBabel\x3c\/a\x3e已发布了。这个项目\x3ca href=\x22https:\/\/scotch.io\/tutorials\/javascript-transpilers-what-they-are-why-we-need-them\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e编译\x3c\/a\x3eJavaScript新特性(\x3ca href=\x22https:\/\/github.com\/getify\/You-Dont-Know-JS\/blob\/master\/es6%20%26%20beyond\/ch1.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eES6\/ES2015等等\x3c\/a\x3e)到ES5, 差不多在今天的任何浏览器上都能运行。\x3c\/p\x3e\n\x3cp\x3e如果你还没用过Babel，那么你的开发生涯要永远地改变了。使用JavaScript的新方法让语言更简单，更简洁而且整体上更友好。\x3c\/p\x3e\n\x3cp\x3e那么让我们为Rollup加上这个过程，就不用担心上面的问题了。\x3c\/p\x3e\n\x3ch4\x3eINSTALL THE NECESSARY MODULES.\x3c\/h4\x3e\n\x3ch4\x3e安装必要模块\x3c\/h4\x3e\n\x3cp\x3e首先，我们需要安装\x3ca href=\x22https:\/\/github.com\/rollup\/rollup-plugin-babel\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eBabel Rollup plugin\x3c\/a\x3e和适当的\x3ca href=\x22https:\/\/github.com\/rollup\/babel-preset-es2015-rollup\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eBabel preset\x3c\/a\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22# Install Rollup’s Babel plugin.\nnpm install --save-dev rollup-plugin-babel\n\n# Install the Babel preset for transpiling ES2015 using Rollup.\nnpm install --save-dev babel-preset-es2015-rollup\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mipsasm\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e# Install Rollup’s Babel plugin.\x3c\/span\x3e\nnpm \x3cspan class=\x22hljs-keyword\x22\x3einstall \x3c\/span\x3e--save-dev rollup-plugin-\x3cspan class=\x22hljs-keyword\x22\x3ebabel\n\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e# Install the Babel preset for transpiling ES2015 using Rollup.\x3c\/span\x3e\nnpm \x3cspan class=\x22hljs-keyword\x22\x3einstall \x3c\/span\x3e--save-dev \x3cspan class=\x22hljs-keyword\x22\x3ebabel-preset-es2015-rollup\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e提示: Babel preset是告诉Babel我们实际需要哪些babel插件的集合。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch4\x3e创建\x3ccode\x3e.babelrc\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e然后，在项目根目录(\x3ccode\x3elearn-rollup\/\x3c\/code\x3e)下创建一个\x3ccode\x3e.babelrc\x3c\/code\x3e文件。在文件中添加下面的JSON：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;presets\x26quot;: [\x26quot;es2015-rollup\x26quot;],\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22presets\x22\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22es2015-rollup\x22\x3c\/span\x3e],\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e它会告诉Babel在转换时哪些preset将会用到。\x3c\/p\x3e\n\x3ch4\x3e更新\x3ccode\x3erollup.config.js\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e为了让它能真正工作，我们需要更新\x3ccode\x3erollup.config.js\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e在文件中，\x3ccode\x3eimport\x3c\/code\x3eBabel插件，将它添加到新配置属性\x3ccode\x3eplugins\x3c\/code\x3e中，这个属性接收一个插件组成的数组。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Rollup plugins\nimport babel from \x27rollup-plugin-babel\x27;\n\nexport default {\n  entry: \x27src\/scripts\/main.js\x27,\n  dest: \x27build\/js\/main.min.js\x27,\n  format: \x27iife\x27,\n  sourceMap: \x27inline\x27,\n  plugins: [\n    babel({\n      exclude: \x27node_modules\/**\x27,\n    }),\n  ],\n};\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gradle\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Rollup plugins\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e babel \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-babel\x27\x3c\/span\x3e;\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  entry: \x3cspan class=\x22hljs-string\x22\x3e\x27src\/scripts\/main.js\x27\x3c\/span\x3e,\n  dest: \x3cspan class=\x22hljs-string\x22\x3e\x27build\/js\/main.min.js\x27\x3c\/span\x3e,\n  format: \x3cspan class=\x22hljs-string\x22\x3e\x27iife\x27\x3c\/span\x3e,\n  sourceMap: \x3cspan class=\x22hljs-string\x22\x3e\x27inline\x27\x3c\/span\x3e,\n  plugins: [\n    babel({\n      \x3cspan class=\x22hljs-keyword\x22\x3eexclude\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27node_modules\/**\x27\x3c\/span\x3e,\n    }),\n  ],\n};\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e为避免编译三方脚本，通过设置\x3ccode\x3eexclude\x3c\/code\x3e属性忽略\x3ccode\x3enode_modules\x3c\/code\x3e目录。\x3c\/p\x3e\n\x3ch4\x3e检查输出文件\x3c\/h4\x3e\n\x3cp\x3e全部都安装并配置好后，重新打包一下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.\/node_modules\/.bin\/rollup -c\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs armasm\x22\x3e\x3ccode\x3e.\/node_modules\/.\x3cspan class=\x22hljs-keyword\x22\x3ebin\/rollup \x3c\/span\x3e-c\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e再看一下输出结果，大部分是一样的。但是有一些地方不一样：比如，\x3ccode\x3eaddArray()\x3c\/code\x3e这个函数：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var addArray = function addArray(arr) {\n  var result = arr.reduce(function (a, b) {\n    return a \x2b b;\n  }, 0);\n\n  return result;\n};\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e addArray = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eaddArray\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(arr)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e result = arr.reduce(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(a, b)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e a \x2b b;\n  }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e result;\n};\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eBabel是如何将\x3ca href=\x22https:\/\/strongloop.com\/strongblog\/an-introduction-to-javascript-es6-arrow-functions\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e箭头函数\x3c\/a\x3e\x3ccode\x3e(arr.reduce((a, b) =\x26gt; a \x2b b, 0))\x3c\/code\x3e转换成一个普通函数的呢？\x3c\/p\x3e\n\x3cp\x3e这就是编译的意义：结果是相同的，但是现在的代码可以向后支持到IE9.\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e注意: Babel也提供了\x3ca href=\x22https:\/\/babeljs.io\/docs\/usage\/polyfill\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ebabel-polyfill\x3c\/a\x3e,使得像\x3ccode\x3eArray.prototype.reduce()\x3c\/code\x3e这些方法在IE8甚至更早的浏览器也能使用。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch4\x3eSTEP 3: 添加ESLint检查常规JavaScript错误\x3c\/h4\x3e\n\x3cp\x3e在你的项目中使用linter是个好主意，因为它强制统一了代码风格并且能帮你发现很难找到的bug，比如花括号或者圆括号。\x3c\/p\x3e\n\x3cp\x3e在这个项目中，我们将使用\x3ca href=\x22http:\/\/eslint.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eESLint\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch4\x3e安装模块\x3c\/h4\x3e\n\x3cp\x3e为使用ESLint，我们需要安装\x3ca href=\x22https:\/\/github.com\/TrySound\/rollup-plugin-eslint\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eESLint Rollup plugin\x3c\/a\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install --save-dev rollup-plugin-eslint\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs q\x22\x3e\x3ccode\x3enpm install --\x3cspan class=\x22hljs-built_in\x22\x3esave\x3c\/span\x3e-\x3cspan class=\x22hljs-built_in\x22\x3edev\x3c\/span\x3e rollup-plugin-eslint\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e生成一个\x3ccode\x3e.eslintrc.json\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e为确保我们只得到我们想检测的错误，首先要配置ESLint。很幸运，我们可以通过执行下面的命令自动生成大多数配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ .\/node_modules\/.bin\/eslint --init\n? How would you like to configure ESLint? Answer questions about your style\n? Are you using ECMAScript 6 features? Yes\n? Are you using ES6 modules? Yes\n? Where will your code run? Browser\n? Do you use CommonJS? No\n? Do you use JSX? No\n? What style of indentation do you use? Spaces\n? What quotes do you use for strings? Single\n? What line endings do you use? Unix\n? Do you require semicolons? Yes\n? What format do you want your config file to be in? JSON\nSuccessfully created .eslintrc.json file in \/Users\/jlengstorf\/dev\/code.lengstorf.com\/projects\/learn-rollup\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sql\x22\x3e\x3ccode\x3e$ .\/node_modules\/.bin\/eslint \x3cspan class=\x22hljs-comment\x22\x3e--init\x3c\/span\x3e\n? How would you like to configure ESLint? Answer questions about your style\n? Are you using ECMAScript 6 features? Yes\n? Are you using ES6 modules? Yes\n? Where will your code run? Browser\n? \x3cspan class=\x22hljs-keyword\x22\x3eDo\x3c\/span\x3e you \x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e CommonJS? \x3cspan class=\x22hljs-keyword\x22\x3eNo\x3c\/span\x3e\n? \x3cspan class=\x22hljs-keyword\x22\x3eDo\x3c\/span\x3e you \x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e JSX? \x3cspan class=\x22hljs-keyword\x22\x3eNo\x3c\/span\x3e\n? What \x3cspan class=\x22hljs-keyword\x22\x3estyle\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e indentation \x3cspan class=\x22hljs-keyword\x22\x3edo\x3c\/span\x3e you \x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e? Spaces\n? What quotes \x3cspan class=\x22hljs-keyword\x22\x3edo\x3c\/span\x3e you \x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e strings? Single\n? What line endings \x3cspan class=\x22hljs-keyword\x22\x3edo\x3c\/span\x3e you \x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e? Unix\n? \x3cspan class=\x22hljs-keyword\x22\x3eDo\x3c\/span\x3e you require semicolons? Yes\n? What \x3cspan class=\x22hljs-keyword\x22\x3eformat\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edo\x3c\/span\x3e you want your config \x3cspan class=\x22hljs-keyword\x22\x3efile\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eto\x3c\/span\x3e be \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e? \x3cspan class=\x22hljs-keyword\x22\x3eJSON\x3c\/span\x3e\nSuccessfully created .eslintrc.json \x3cspan class=\x22hljs-keyword\x22\x3efile\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \/\x3cspan class=\x22hljs-keyword\x22\x3eUsers\x3c\/span\x3e\/jlengstorf\/dev\/code.lengstorf.com\/projects\/learn-\x3cspan class=\x22hljs-keyword\x22\x3erollup\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果你按上面展示的那样回答问题，你将在生成的\x3ccode\x3e.eslintrc.json\x3c\/code\x3e中得到下面的内容：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;env\x26quot;: {\n    \x26quot;browser\x26quot;: true,\n    \x26quot;es6\x26quot;: true\n  },\n  \x26quot;extends\x26quot;: \x26quot;eslint:recommended\x26quot;,\n  \x26quot;parserOptions\x26quot;: {\n    \x26quot;sourceType\x26quot;: \x26quot;module\x26quot;\n  },\n  \x26quot;rules\x26quot;: {\n    \x26quot;indent\x26quot;: [\n      \x26quot;error\x26quot;,\n      4\n    ],\n    \x26quot;linebreak-style\x26quot;: [\n      \x26quot;error\x26quot;,\n      \x26quot;unix\x26quot;\n    ],\n    \x26quot;quotes\x26quot;: [\n      \x26quot;error\x26quot;,\n      \x26quot;single\x26quot;\n    ],\n    \x26quot;semi\x26quot;: [\n      \x26quot;error\x26quot;,\n      \x26quot;always\x26quot;\n    ]\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22env\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22browser\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22es6\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22extends\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22eslint:recommended\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22parserOptions\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22sourceType\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22module\x22\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22rules\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22indent\x22\x3c\/span\x3e: [\n      \x3cspan class=\x22hljs-string\x22\x3e\x22error\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\n    ],\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22linebreak-style\x22\x3c\/span\x3e: [\n      \x3cspan class=\x22hljs-string\x22\x3e\x22error\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22unix\x22\x3c\/span\x3e\n    ],\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22quotes\x22\x3c\/span\x3e: [\n      \x3cspan class=\x22hljs-string\x22\x3e\x22error\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22single\x22\x3c\/span\x3e\n    ],\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22semi\x22\x3c\/span\x3e: [\n      \x3cspan class=\x22hljs-string\x22\x3e\x22error\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22always\x22\x3c\/span\x3e\n    ]\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e修改\x3ccode\x3e.eslintrc.json\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e然而我们需要改动两个地方来避免项目报错。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e使用2空格代替4空格。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e后面会使用到\x3ccode\x3eENV\x3c\/code\x3e这个全局变量，因此要把它加入白名单中。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e在\x3ccode\x3e.eslintrc.json\x3c\/code\x3e进行如下修改 — 添加\x3ccode\x3eglobals\x3c\/code\x3e属性并修改\x3ccode\x3eindent\x3c\/code\x3e属性：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;env\x26quot;: {\n    \x26quot;browser\x26quot;: true,\n    \x26quot;es6\x26quot;: true\n  },\n  \x26quot;globals\x26quot;: {\n    \x26quot;ENV\x26quot;: true\n  },\n  \x26quot;extends\x26quot;: \x26quot;eslint:recommended\x26quot;,\n  \x26quot;parserOptions\x26quot;: {\n    \x26quot;sourceType\x26quot;: \x26quot;module\x26quot;\n  },\n  \x26quot;rules\x26quot;: {\n    \x26quot;indent\x26quot;: [\n      \x26quot;error\x26quot;,\n      2\n    ],\n    \x26quot;linebreak-style\x26quot;: [\n      \x26quot;error\x26quot;,\n      \x26quot;unix\x26quot;\n    ],\n    \x26quot;quotes\x26quot;: [\n      \x26quot;error\x26quot;,\n      \x26quot;single\x26quot;\n    ],\n    \x26quot;semi\x26quot;: [\n      \x26quot;error\x26quot;,\n      \x26quot;always\x26quot;\n    ]\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22env\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22browser\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22es6\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22globals\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22ENV\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22extends\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22eslint:recommended\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22parserOptions\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22sourceType\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22module\x22\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22rules\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22indent\x22\x3c\/span\x3e: [\n      \x3cspan class=\x22hljs-string\x22\x3e\x22error\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n    ],\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22linebreak-style\x22\x3c\/span\x3e: [\n      \x3cspan class=\x22hljs-string\x22\x3e\x22error\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22unix\x22\x3c\/span\x3e\n    ],\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22quotes\x22\x3c\/span\x3e: [\n      \x3cspan class=\x22hljs-string\x22\x3e\x22error\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22single\x22\x3c\/span\x3e\n    ],\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22semi\x22\x3c\/span\x3e: [\n      \x3cspan class=\x22hljs-string\x22\x3e\x22error\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22always\x22\x3c\/span\x3e\n    ]\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e更新\x3ccode\x3erollup.config.js\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e然后，引入ESLint插件并添加到Rollup配置中：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Rollup plugins\nimport babel from \x27rollup-plugin-babel\x27;\nimport eslint from \x27rollup-plugin-eslint\x27;\n\nexport default {\n  entry: \x27src\/scripts\/main.js\x27,\n  dest: \x27build\/js\/main.min.js\x27,\n  format: \x27iife\x27,\n  sourceMap: \x27inline\x27,\n  plugins: [\n    babel({\n      exclude: \x27node_modules\/**\x27,\n    }),\n    eslint({\n      exclude: [\n        \x27src\/styles\/**\x27,\n      ]\n    }),\n  ],\n};\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gradle\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Rollup plugins\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e babel \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-babel\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e eslint \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-eslint\x27\x3c\/span\x3e;\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  entry: \x3cspan class=\x22hljs-string\x22\x3e\x27src\/scripts\/main.js\x27\x3c\/span\x3e,\n  dest: \x3cspan class=\x22hljs-string\x22\x3e\x27build\/js\/main.min.js\x27\x3c\/span\x3e,\n  format: \x3cspan class=\x22hljs-string\x22\x3e\x27iife\x27\x3c\/span\x3e,\n  sourceMap: \x3cspan class=\x22hljs-string\x22\x3e\x27inline\x27\x3c\/span\x3e,\n  plugins: [\n    babel({\n      \x3cspan class=\x22hljs-keyword\x22\x3eexclude\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27node_modules\/**\x27\x3c\/span\x3e,\n    }),\n    eslint({\n      \x3cspan class=\x22hljs-keyword\x22\x3eexclude\x3c\/span\x3e: [\n        \x3cspan class=\x22hljs-string\x22\x3e\x27src\/styles\/**\x27\x3c\/span\x3e,\n      ]\n    }),\n  ],\n};\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e检查控制台输出\x3c\/h4\x3e\n\x3cp\x3e第一次，当执行\x3ccode\x3e.\/node_modules\/.bin\/rollup -c\x3c\/code\x3e时，似乎什么都没发生。因为这表示应用的代码通过了linter，没有问题。\x3c\/p\x3e\n\x3cp\x3e但是如果我们制造一个错误 - 比如删除一个分号 - 我们会看到ESLint是如何提示的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ .\/node_modules\/.bin\/rollup -c\n\n\/Users\/jlengstorf\/dev\/code.lengstorf.com\/projects\/learn-rollup\/src\/scripts\/main.js\n  12:64  error  Missing semicolon  semi\n\n✖ 1 problem (1 error, 0 warnings)\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e$ .\/node_modules\/.bin\/rollup -c\n\n\/Users\/jlengstorf\/dev\/\x3cspan class=\x22hljs-selector-tag\x22\x3ecode\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.lengstorf\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.com\x3c\/span\x3e\/projects\/learn-rollup\/src\/scripts\/main\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n  \x3cspan class=\x22hljs-number\x22\x3e12\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e64\x3c\/span\x3e  error  Missing semicolon  semi\n\n✖ \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e problem (\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e error, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e warnings)\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e一些包含潜在风险和解释神秘bug的东西立刻出现了，包括出现问题的文件，行和列。\x3c\/p\x3e\n\x3cp\x3e但是它不能排除我们调试时的所有问题，很多由于拼写错误和疏漏产生的bug还是要自己花时间去解决。\x3c\/p\x3e\n\x3ch4\x3eSTEP 4: 添加插件处理非ES模块\x3c\/h4\x3e\n\x3cp\x3e如果你的依赖中有任何使用Node风格的模块这个插件就很重要。如果没有它，你会得到关于\x3ccode\x3erequire\x3c\/code\x3e的错误。\x3c\/p\x3e\n\x3ch4\x3e添加一个Node模块作为依赖\x3c\/h4\x3e\n\x3cp\x3e在这个小项目中不引用三方模块很正常，但实际项目中不会如此。所以为了让我们的Rollup配置变得真正可用，需要保证在我们的代码中也能引用是三方模块。\x3c\/p\x3e\n\x3cp\x3e举个简单的例子，我们将使用\x3ca href=\x22https:\/\/www.npmjs.com\/package\/debug\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3edebug\x3c\/a\x3e包添加一个简单的日志打印器到项目中。先安装它：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install --save debug\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gauss\x22\x3e\x3ccode\x3enpm install --\x3cspan class=\x22hljs-keyword\x22\x3esave\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edebug\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e注意：因为它是会在主程序中引用的，应该使用\x3ccode\x3e--save\x3c\/code\x3e参数，可以避免在生产环境下出现错误，因为\x3ccode\x3edevDependencies\x3c\/code\x3e在生产环境下不会被安装。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e然后在\x3ccode\x3esrc\/scripts\/main.js\x3c\/code\x3e中添加一个简单的日志：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Import a couple modules for testing.\nimport { sayHelloTo } from \x27.\/modules\/mod1\x27;\nimport addArray from \x27.\/modules\/mod2\x27;\n\n\/\/ Import a logger for easier debugging.\nimport debug from \x27debug\x27;\nconst log = debug(\x27app:log\x27);\n\n\/\/ Enable the logger.\ndebug.enable(\x27*\x27);\nlog(\x27Logging is enabled!\x27);\n\n\/\/ Run some functions from our imported modules.\nconst result1 = sayHelloTo(\x27Jason\x27);\nconst result2 = addArray([1, 2, 3, 4]);\n\n\/\/ Print the results on the page.\nconst printTarget = document.getElementsByClassName(\x27debug__output\x27)[0];\n\nprintTarget.innerText = `sayHelloTo(\x27Jason\x27) =\x3e ${result1}\\n\\n`;\nprintTarget.innerText \x2b= `addArray([1, 2, 3, 4]) =\x3e ${result2}`;\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Import a couple modules for testing.\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { sayHelloTo } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/modules\/mod1\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e addArray \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/modules\/mod2\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Import a logger for easier debugging.\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e debug \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27debug\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e log = debug(\x3cspan class=\x22hljs-string\x22\x3e\x27app:log\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Enable the logger.\x3c\/span\x3e\ndebug.enable(\x3cspan class=\x22hljs-string\x22\x3e\x27*\x27\x3c\/span\x3e);\nlog(\x3cspan class=\x22hljs-string\x22\x3e\x27Logging is enabled!\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Run some functions from our imported modules.\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e result1 = sayHelloTo(\x3cspan class=\x22hljs-string\x22\x3e\x27Jason\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e result2 = addArray([\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e]);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Print the results on the page.\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e printTarget = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementsByClassName(\x3cspan class=\x22hljs-string\x22\x3e\x27debug__output\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n\nprintTarget.innerText = \x3cspan class=\x22hljs-string\x22\x3e`sayHelloTo(\x27Jason\x27) =\x26gt; \x3cspan class=\x22hljs-subst\x22\x3e${result1}\x3c\/span\x3e\\n\\n`\x3c\/span\x3e;\nprintTarget.innerText \x2b= \x3cspan class=\x22hljs-string\x22\x3e`addArray([1, 2, 3, 4]) =\x26gt; \x3cspan class=\x22hljs-subst\x22\x3e${result2}\x3c\/span\x3e`\x3c\/span\x3e;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e到此一切都很好，但是当运行rollup时会得到一个警告：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ .\/node_modules\/.bin\/rollup -c\nTreating \x27debug\x27 as external dependency\nNo name was provided for external module \x27debug\x27 in options.globals – guessing \x27debug\x27\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs delphi\x22\x3e\x3ccode\x3e$ .\/node_modules\/.bin\/rollup -c\nTreating \x3cspan class=\x22hljs-string\x22\x3e\x27debug\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eas\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eexternal\x3c\/span\x3e dependency\nNo \x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e was provided \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eexternal\x3c\/span\x3e module \x3cspan class=\x22hljs-string\x22\x3e\x27debug\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e options.globals – guessing \x3cspan class=\x22hljs-string\x22\x3e\x27debug\x27\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而且如果在查看\x3ccode\x3eindex.html\x3c\/code\x3e，会发现一个\x3ccode\x3eReferenceError\x3c\/code\x3e抛出了：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e默认情况下，三方的Node模块无法在Rollup中正确加载。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e哦，真糟糕。完全无法运行。\x3c\/p\x3e\n\x3cp\x3e因为Node模块使用\x3ca href=\x22http:\/\/wiki.commonjs.org\/wiki\/Modules\/1.1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCommonJS\x3c\/a\x3e，无法与Rollup直接兼容。为解决这个问题，需要添加一组处理Node模块和CommonJS模块的插件。\x3c\/p\x3e\n\x3ch4\x3e安装模块\x3c\/h4\x3e\n\x3cp\x3e围绕这个问题，我们将在Rollup中新增两个插件：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/rollup\/rollup-plugin-node-resolve\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3erollup-plugin-node-resolve\x3c\/a\x3e，运行加载\x3ccode\x3enode_modules\x3c\/code\x3e中的三方模块。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/rollup\/rollup-plugin-commonjs\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3erollup-plugin-commonjs\x3c\/a\x3e，将CommonJS模块转换成ES6，防止他们在Rollup中失效。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e通过下面的命令安装两个插件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install --save-dev rollup-plugin-node-resolve rollup-plugin-commonjs\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs crmsh\x22\x3e\x3ccode\x3enpm install --save-dev rollup-plugin-\x3cspan class=\x22hljs-keyword\x22\x3enode\x3c\/span\x3e\x3cspan class=\x22hljs-title\x22\x3e-resolve\x3c\/span\x3e rollup-plugin-commonjs\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e更新\x3ccode\x3erollup.config.js.\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e然后，引入插件并添加进Rollup配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Rollup plugins\nimport babel from \x27rollup-plugin-babel\x27;\nimport eslint from \x27rollup-plugin-eslint\x27;\nimport resolve from \x27rollup-plugin-node-resolve\x27;\nimport commonjs from \x27rollup-plugin-commonjs\x27;\n\nexport default {\n  entry: \x27src\/scripts\/main.js\x27,\n  dest: \x27build\/js\/main.min.js\x27,\n  format: \x27iife\x27,\n  sourceMap: \x27inline\x27,\n  plugins: [\n    resolve({\n      jsnext: true,\n      main: true,\n      browser: true,\n    }),\n    commonjs(),\n    eslint({\n      exclude: [\n        \x27src\/styles\/**\x27,\n      ]\n    }),\n    babel({\n      exclude: \x27node_modules\/**\x27,\n    }),\n  ],\n};\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gradle\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Rollup plugins\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e babel \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-babel\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e eslint \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-eslint\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e resolve \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-node-resolve\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e commonjs \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-commonjs\x27\x3c\/span\x3e;\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  entry: \x3cspan class=\x22hljs-string\x22\x3e\x27src\/scripts\/main.js\x27\x3c\/span\x3e,\n  dest: \x3cspan class=\x22hljs-string\x22\x3e\x27build\/js\/main.min.js\x27\x3c\/span\x3e,\n  format: \x3cspan class=\x22hljs-string\x22\x3e\x27iife\x27\x3c\/span\x3e,\n  sourceMap: \x3cspan class=\x22hljs-string\x22\x3e\x27inline\x27\x3c\/span\x3e,\n  plugins: [\n    resolve({\n      jsnext: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,\n      main: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,\n      browser: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,\n    }),\n    commonjs(),\n    eslint({\n      \x3cspan class=\x22hljs-keyword\x22\x3eexclude\x3c\/span\x3e: [\n        \x3cspan class=\x22hljs-string\x22\x3e\x27src\/styles\/**\x27\x3c\/span\x3e,\n      ]\n    }),\n    babel({\n      \x3cspan class=\x22hljs-keyword\x22\x3eexclude\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27node_modules\/**\x27\x3c\/span\x3e,\n    }),\n  ],\n};\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e注意: \x3ccode\x3ejsnext\x3c\/code\x3e属性是为了帮助\x3ca href=\x22https:\/\/github.com\/rollup\/rollup\/wiki\/jsnext:main\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eNode模块迁移到ES2015\x3c\/a\x3e的一部分。\x3ccode\x3emain\x3c\/code\x3e和\x3ccode\x3ebrowser\x3c\/code\x3e 属性帮助插件决定哪个文件应该被bundle文件使用。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch4\x3e检查控制台输出\x3c\/h4\x3e\n\x3cp\x3e执行\x3ccode\x3e.\/node_modules\/.bin\/rollup -c\x3c\/code\x3e重新打包，然后再检查浏览器输出：\x3c\/p\x3e\n\x3cp\x3e成功了！日志现在打印出来了。\x3c\/p\x3e\n\x3ch4\x3eSTEP 5: 添加插件替换环境变量\x3c\/h4\x3e\n\x3cp\x3e环境变量使开发流程更强大，让我们有能力做一些事情，比如打开或关闭日志，注入仅在开发环境使用的脚本等等。\x3c\/p\x3e\n\x3cp\x3e那么让Rollup支持这些功能吧。\x3c\/p\x3e\n\x3ch4\x3e在\x3ccode\x3emain.js\x3c\/code\x3e中添加\x3ccode\x3eENV\x3c\/code\x3e变量\x3c\/h4\x3e\n\x3cp\x3e让我们通过一个环境变量控制日志脚本，让日志脚本只能在非生产环境下使用。在\x3ccode\x3esrc\/scripts\/main.js\x3c\/code\x3e中修改\x3ccode\x3elog()\x3c\/code\x3e的初始化方式。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Import a logger for easier debugging.\nimport debug from \x27debug\x27;\nconst log = debug(\x27app:log\x27);\n\n\/\/ The logger should only be disabled if we’re not in production.\nif (ENV !== \x27production\x27) {\n\n  \/\/ Enable the logger.\n  debug.enable(\x27*\x27);\n  log(\x27Logging is enabled!\x27);\n} else {\n  debug.disable();\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gauss\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Import a logger for easier debugging.\x3c\/span\x3e\nimport \x3cspan class=\x22hljs-keyword\x22\x3edebug\x3c\/span\x3e from \x27\x3cspan class=\x22hljs-keyword\x22\x3edebug\x3c\/span\x3e\x27;\nconst \x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3edebug\x3c\/span\x3e(\x27app:\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e\x27);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ The logger should only be disabled if we’re not in production.\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ENV !== \x27production\x27) {\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Enable the logger.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3edebug\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3eenable\x3c\/span\x3e(\x27*\x27);\n  \x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x27Logging is enabled!\x27);\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3edebug\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3edisable\x3c\/span\x3e();\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然而，重新打包(\x3ccode\x3e.\/node_modules\/.bin\/rollup -c\x3c\/code\x3e)后检查浏览器，会看到一个\x3ccode\x3eENV\x3c\/code\x3e的\x3ccode\x3eReferenceError\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e不必惊讶，因为我们没有在任何地方定义它。如果我们尝试\x3ccode\x3eENV=production .\/node_modules\/.bin\/rollup -c\x3c\/code\x3e，还是不会成功。因为那样设置的环境变量只是在Rollup中可用，不是在Rollup打包的bundle中可用。\x3c\/p\x3e\n\x3cp\x3e我们需要使用一个插件将环境变量传入bundle。\x3c\/p\x3e\n\x3ch4\x3e安装模块\x3c\/h4\x3e\n\x3cp\x3e安装\x3ca href=\x22https:\/\/github.com\/rollup\/rollup-plugin-replace\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3erollup-plugin-replace\x3c\/a\x3e插件，它本质上只是做了查找-替换的工作。它能做很多事情，但现在我们只需要让它简单地找到出现的环境变量并将其替换成实际的值。（比如，所有在bundle出现的\x3ccode\x3eENV\x3c\/code\x3e变量都会被替换成\x3ccode\x3e\x22production\x22\x3c\/code\x3e ）。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install --save-dev rollup-plugin-replace\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3enpm install --\x3cspan class=\x22hljs-keyword\x22\x3esave\x3c\/span\x3e-dev rollup-\x3cspan class=\x22hljs-keyword\x22\x3eplugin\x3c\/span\x3e-\x3cspan class=\x22hljs-keyword\x22\x3ereplace\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e更新\x3ccode\x3erollup.config.js\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e在\x3ccode\x3erollup.config.js\x3c\/code\x3e中引入插件并且添加到插件列表中。\x3c\/p\x3e\n\x3cp\x3e配置非常简单：只需添加一个键值对的列表，\x3ccode\x3ekey\x3c\/code\x3e是将被替换的字符串，\x3ccode\x3evalue\x3c\/code\x3e是应该被替换成的值。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Rollup plugins\nimport babel from \x27rollup-plugin-babel\x27;\nimport eslint from \x27rollup-plugin-eslint\x27;\nimport resolve from \x27rollup-plugin-node-resolve\x27;\nimport commonjs from \x27rollup-plugin-commonjs\x27;\nimport replace from \x27rollup-plugin-replace\x27;\n\nexport default {\n  entry: \x27src\/scripts\/main.js\x27,\n  dest: \x27build\/js\/main.min.js\x27,\n  format: \x27iife\x27,\n  sourceMap: \x27inline\x27,\n  plugins: [\n    resolve({\n      jsnext: true,\n      main: true,\n      browser: true,\n    }),\n    commonjs(),\n    eslint({\n      exclude: [\n        \x27src\/styles\/**\x27,\n      ]\n    }),\n    babel({\n      exclude: \x27node_modules\/**\x27,\n    }),\n    replace({\n      exclude: \x27node_modules\/**\x27,\n      ENV: JSON.stringify(process.env.NODE_ENV || \x27development\x27),\n    }),\n  ],\n};\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gradle\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Rollup plugins\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e babel \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-babel\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e eslint \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-eslint\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e resolve \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-node-resolve\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e commonjs \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-commonjs\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e replace \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-replace\x27\x3c\/span\x3e;\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  entry: \x3cspan class=\x22hljs-string\x22\x3e\x27src\/scripts\/main.js\x27\x3c\/span\x3e,\n  dest: \x3cspan class=\x22hljs-string\x22\x3e\x27build\/js\/main.min.js\x27\x3c\/span\x3e,\n  format: \x3cspan class=\x22hljs-string\x22\x3e\x27iife\x27\x3c\/span\x3e,\n  sourceMap: \x3cspan class=\x22hljs-string\x22\x3e\x27inline\x27\x3c\/span\x3e,\n  plugins: [\n    resolve({\n      jsnext: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,\n      main: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,\n      browser: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,\n    }),\n    commonjs(),\n    eslint({\n      \x3cspan class=\x22hljs-keyword\x22\x3eexclude\x3c\/span\x3e: [\n        \x3cspan class=\x22hljs-string\x22\x3e\x27src\/styles\/**\x27\x3c\/span\x3e,\n      ]\n    }),\n    babel({\n      \x3cspan class=\x22hljs-keyword\x22\x3eexclude\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27node_modules\/**\x27\x3c\/span\x3e,\n    }),\n    replace({\n      \x3cspan class=\x22hljs-keyword\x22\x3eexclude\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27node_modules\/**\x27\x3c\/span\x3e,\n      ENV: JSON.stringify(process.env.NODE_ENV || \x3cspan class=\x22hljs-string\x22\x3e\x27development\x27\x3c\/span\x3e),\n    }),\n  ],\n};\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在我们的配置中，将找打所有出现的\x3ccode\x3eENV\x3c\/code\x3e并且替换成\x3ccode\x3eprocess.env.NODE_ENV\x3c\/code\x3e - 在Node应用中最普遍的设置环境变量的方法 - 或者 \x22development\x22中的一个。使用\x3ccode\x3eJSON.stringify()\x3c\/code\x3e确保值被双引号包裹，如果\x3ccode\x3eENV\x3c\/code\x3e没有的话。\x3c\/p\x3e\n\x3cp\x3e为了确保不会和三方代码造成问题，同样设置\x3ccode\x3eexclude\x3c\/code\x3e属性来忽略\x3ccode\x3enode_modules\x3c\/code\x3e目录和其中的全部包。(幸亏\x3ca href=\x22https:\/\/github.com\/jlengstorf\/learn-rollup\/issues\/3\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e@wesleycoder先在这上面踩坑了\x3c\/a\x3e。)\x3c\/p\x3e\n\x3ch4\x3e检查结果\x3c\/h4\x3e\n\x3cp\x3e首先，重新打包然后在浏览器中检查。控制台日志会显示，就像之前一样。很棒 - 这意味着我们的默认值生效了。\x3c\/p\x3e\n\x3cp\x3e为了展示新引入的能力，我们在\x3ccode\x3eproduction\x3c\/code\x3e模式下运行命令：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22NODE_ENV=production .\/node_modules\/.bin\/rollup -c\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ini\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attr\x22\x3eNODE_ENV\x3c\/span\x3e=production .\/node_modules\/.bin\/rollup -c\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e注意: 在Windows上，使用\x3ccode\x3eSET NODE_ENV=production .\/node_modules\/.bin\/rollup -c\x3c\/code\x3e防止在设置环境变量时报错。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e当刷新浏览器后，控制台没有任何日志打出了：\x3c\/p\x3e\n\x3cp\x3e不改变任何代码的情况下，使用一个环境变量禁用了日志插件。\x3c\/p\x3e\n\x3ch4\x3eSTEP 6: 添加UglifyJS压缩减小生成代码体积\x3c\/h4\x3e\n\x3cp\x3e这个教程中最后一步是添加UglifyJS来减小和压缩bundle文件。可以通过移除注释，缩短变量名和其他压缩换行等方式大幅度减少bundle的大小 - 会让文件的可读性变差，但提高了网络间传输的效率。\x3c\/p\x3e\n\x3ch4\x3e安装插件\x3c\/h4\x3e\n\x3cp\x3e我们将使用\x3ca href=\x22https:\/\/github.com\/mishoo\/UglifyJS2\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eUglifyJS\x3c\/a\x3e压缩bundle，通过\x3ca href=\x22https:\/\/github.com\/TrySound\/rollup-plugin-uglify\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3erollup-plugin-uglify\x3c\/a\x3e插件。\x3c\/p\x3e\n\x3cp\x3e通过下面命令安装：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install --save-dev rollup-plugin-uglify\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs q\x22\x3e\x3ccode\x3enpm install --\x3cspan class=\x22hljs-built_in\x22\x3esave\x3c\/span\x3e-\x3cspan class=\x22hljs-built_in\x22\x3edev\x3c\/span\x3e rollup-plugin-uglify\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e更新\x3ccode\x3erollup.config.js\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e然后添加Uglify到Rollup配置。为了开发环境下可读性更好，设置代码丑化仅在生产环境下使用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Rollup plugins\nimport babel from \x27rollup-plugin-babel\x27;\nimport eslint from \x27rollup-plugin-eslint\x27;\nimport resolve from \x27rollup-plugin-node-resolve\x27;\nimport commonjs from \x27rollup-plugin-commonjs\x27;\nimport replace from \x27rollup-plugin-replace\x27;\nimport uglify from \x27rollup-plugin-uglify\x27;\n\nexport default {\n  entry: \x27src\/scripts\/main.js\x27,\n  dest: \x27build\/js\/main.min.js\x27,\n  format: \x27iife\x27,\n  sourceMap: \x27inline\x27,\n  plugins: [\n    resolve({\n      jsnext: true,\n      main: true,\n      browser: true,\n    }),\n    commonjs(),\n    eslint({\n      exclude: [\n        \x27src\/styles\/**\x27,\n      ]\n    }),\n    babel({\n      exclude: \x27node_modules\/**\x27,\n    }),\n    replace({\n      ENV: JSON.stringify(process.env.NODE_ENV || \x27development\x27),\n    }),\n    (process.env.NODE_ENV === \x27production\x27 \x26amp;\x26amp; uglify()),\n  ],\n};\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gradle\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Rollup plugins\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e babel \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-babel\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e eslint \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-eslint\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e resolve \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-node-resolve\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e commonjs \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-commonjs\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e replace \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-replace\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e uglify \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27rollup-plugin-uglify\x27\x3c\/span\x3e;\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  entry: \x3cspan class=\x22hljs-string\x22\x3e\x27src\/scripts\/main.js\x27\x3c\/span\x3e,\n  dest: \x3cspan class=\x22hljs-string\x22\x3e\x27build\/js\/main.min.js\x27\x3c\/span\x3e,\n  format: \x3cspan class=\x22hljs-string\x22\x3e\x27iife\x27\x3c\/span\x3e,\n  sourceMap: \x3cspan class=\x22hljs-string\x22\x3e\x27inline\x27\x3c\/span\x3e,\n  plugins: [\n    resolve({\n      jsnext: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,\n      main: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,\n      browser: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,\n    }),\n    commonjs(),\n    eslint({\n      \x3cspan class=\x22hljs-keyword\x22\x3eexclude\x3c\/span\x3e: [\n        \x3cspan class=\x22hljs-string\x22\x3e\x27src\/styles\/**\x27\x3c\/span\x3e,\n      ]\n    }),\n    babel({\n      \x3cspan class=\x22hljs-keyword\x22\x3eexclude\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27node_modules\/**\x27\x3c\/span\x3e,\n    }),\n    replace({\n      ENV: JSON.stringify(process.env.NODE_ENV || \x3cspan class=\x22hljs-string\x22\x3e\x27development\x27\x3c\/span\x3e),\n    }),\n    (process.env.NODE_ENV === \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e \x26amp;\x26amp; uglify()),\n  ],\n};\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们使用了\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Operators\/Logical_Operators#Short-Circuit_Evaluation\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e短路运算\x3c\/a\x3e，很常用(虽然\x3ca href=\x22http:\/\/stackoverflow.com\/questions\/5049006\/using-s-short-circuiting-as-an-if-statement\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e也有争议\x3c\/a\x3e)的条件性设置值的方法。[注4]\x3c\/p\x3e\n\x3cp\x3e在我们的例子中，只有在\x3ccode\x3eNODE_ENV\x3c\/code\x3e是\x3ccode\x3e\x22production\x22\x3c\/code\x3e时才会加载\x3ccode\x3euglify()\x3c\/code\x3e。\x3c\/p\x3e\n\x3ch4\x3e检查压缩过的bundle\x3c\/h4\x3e\n\x3cp\x3e保存配置文件，让我们在生成环境下运行Rollup：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22NODE_ENV=production .\/node_modules\/.bin\/rollup -c\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ini\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attr\x22\x3eNODE_ENV\x3c\/span\x3e=production .\/node_modules\/.bin\/rollup -c\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e注意: 在Windows上，使用\x3ccode\x3eSET NODE_ENV=production .\/node_modules\/.bin\/rollup -c\x3c\/code\x3e防止在设置环境变量时报错。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e输出内容并不美观，但是更小了。这有\x3ccode\x3ebuild\/js\/main.min.js\x3c\/code\x3e的截屏，看起来像这样：\x3c\/p\x3e\n\x3cp\x3e丑化过的代码确实能更高效地传输。\x3c\/p\x3e\n\x3cp\x3e之前，我们的bundle大约42KB。使用UglifyJS后，减少到大约29KB - 在没做其他优化的情况下节省了超过30%文件大小。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e接下来的内容\x3c\/h2\x3e\n\x3cp\x3e在这个系列的下一节，我们将了解通过Rollup和\x3ca href=\x22https:\/\/github.com\/postcss\/postcss\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePostCSS\x3c\/a\x3e处理样式，并且添加live reloading来实时看见我们的修改。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3eFurther Reading\x3c\/h2\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e扩展阅读\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/nolanlawson.com\/2016\/08\/15\/the-cost-of-small-modules\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eThe cost of small modules\x3c\/a\x3e - 这篇文章让我开始对Rollup感兴趣，因为它展示了一些Rollup相比webpack和Browserify的优势。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/rollupjs.org\/guide\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRollup’s getting started guide\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/rollup\/rollup\/wiki\/Command-Line-Interface\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRollup’s CLI docs\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/rollup\/rollup\/wiki\/Plugins\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eA list of Rollup plugins\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e注1： 这是一个非常难理解的概念，所以没全理解也不要有压力。简单来说，我们希望我们的代码在他们自己的作用域中，防止和其它脚本的冲突。IIFE是一个包括我们的代码在自身作用域的一个[闭包]。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e注2：It’s important to keep in mind, though, that when we’re dealing with such a small example app it doesn’t take much to double a file size. The comparison at this point is ~3KB vs. ~8KB.\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e注3：作为曾经花数小时找bug然后发现拼错一个变量名的人，不需要夸大使用linter带来的效率提升。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e注4：举个例子，使用这种方法来赋默认值时非常常见的。（比如\x3ccode\x3evar foo = maybeThisExists || \x27default\x27;\x3c\/code\x3e）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这篇文章的代码放在GitHub上。你可以\x3ca href=\x22https:\/\/github.com\/jlengstorf\/learn-rollup\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3efork 这个仓库\x3c\/a\x3e进行修改或测试，\x3ca href=\x22https:\/\/github.com\/jlengstorf\/learn-rollup\/issues\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e开issue\x3c\/a\x3e或者报告bug，或者\x3ca href=\x22https:\/\/github.com\/jlengstorf\/learn-rollup\/compare\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e新建pull request\x3c\/a\x3e进行建议或者修改。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/code.lengstorf.com\/learn-rollup-js\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e原文链接\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>[译]教程：如何使用Rollup打包JavaScript</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007543162">https://segmentfault.com/a/1190000007543162</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/tosbjv63d4g/" target="_blank">https://alili.tech/archive/tosbjv63d4g/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>