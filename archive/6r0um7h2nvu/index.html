<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="IE9下的跨域问题小总结"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>IE9下的跨域问题小总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/6r0um7h2nvu/",
				"appid": "1613049289050283", 
				"title": "IE9下的跨域问题小总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-18T02:30:35"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/tp7lcc6onp/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/9f9utygu5ii/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f6r0um7h2nvu%2f&text=IE9%e4%b8%8b%e7%9a%84%e8%b7%a8%e5%9f%9f%e9%97%ae%e9%a2%98%e5%b0%8f%e6%80%bb%e7%bb%93"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f6r0um7h2nvu%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f6r0um7h2nvu%2f&text=IE9%e4%b8%8b%e7%9a%84%e8%b7%a8%e5%9f%9f%e9%97%ae%e9%a2%98%e5%b0%8f%e6%80%bb%e7%bb%93"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f6r0um7h2nvu%2f&title=IE9%e4%b8%8b%e7%9a%84%e8%b7%a8%e5%9f%9f%e9%97%ae%e9%a2%98%e5%b0%8f%e6%80%bb%e7%bb%93"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f6r0um7h2nvu%2f&is_video=false&description=IE9%e4%b8%8b%e7%9a%84%e8%b7%a8%e5%9f%9f%e9%97%ae%e9%a2%98%e5%b0%8f%e6%80%bb%e7%bb%93"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=IE9%e4%b8%8b%e7%9a%84%e8%b7%a8%e5%9f%9f%e9%97%ae%e9%a2%98%e5%b0%8f%e6%80%bb%e7%bb%93&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f6r0um7h2nvu%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f6r0um7h2nvu%2f&title=IE9%e4%b8%8b%e7%9a%84%e8%b7%a8%e5%9f%9f%e9%97%ae%e9%a2%98%e5%b0%8f%e6%80%bb%e7%bb%93"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6r0um7h2nvu%2f&title=IE9%e4%b8%8b%e7%9a%84%e8%b7%a8%e5%9f%9f%e9%97%ae%e9%a2%98%e5%b0%8f%e6%80%bb%e7%bb%93"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6r0um7h2nvu%2f&title=IE9%e4%b8%8b%e7%9a%84%e8%b7%a8%e5%9f%9f%e9%97%ae%e9%a2%98%e5%b0%8f%e6%80%bb%e7%bb%93"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6r0um7h2nvu%2f&title=IE9%e4%b8%8b%e7%9a%84%e8%b7%a8%e5%9f%9f%e9%97%ae%e9%a2%98%e5%b0%8f%e6%80%bb%e7%bb%93"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">IE9下的跨域问题小总结</h1><div class="meta"><div class="postdate"><time datetime="2019-01-18" itemprop="datePublished">2019-01-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e由于浏览器同源策略，凡是发送请求url的协议、域名、端口三者之间任意一与当前页面地址不同即为跨域\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e最近项目要兼容IE9，找了一些资料，实践了一下，现在总结一下，避免以后踩坑。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e普通请求的跨域\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e简单粗暴的解决方案\x3c\/h3\x3e\n\x3cp\x3e第一次碰到这个问题，所以就是上网找找有没有什么好的解决方案。\x3ca href=\x22http:\/\/jingyan.baidu.com\/article\/c33e3f48857933ea15cbb50a.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e最初找到的方案\x3c\/a\x3e是这样的，直接在IE中设置设置受信任的站点，然后允许其可以进行跨域访问，最后在\x3ccode\x3ejQuery\x3c\/code\x3e中设置开启跨域请求。oh，No!这么粗暴，好吧，这也是一个不是办法的办法，如果做的是一个小项目，用户不多，那直接写在用户手册里，让他们自己去配吧。但是，这显然不是一个好的解决方案啊，那只能继续找了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3eXDomainRequest（XDR）解决方案\x3c\/h3\x3e\n\x3cp\x3eok，微软在\x3ccode\x3eIE8\x3c\/code\x3e和\x3ccode\x3eIE9\x3c\/code\x3e下给我们提供了\x3ccode\x3eXDomainRequest\x3c\/code\x3e来进行解决跨域问题，官方的文档可以在 \x3ca href=\x22https:\/\/msdn.microsoft.com\/zh-cn\/library\/dd573303\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里看到\x3c\/a\x3e。当然\x3ccode\x3eGithub\x3c\/code\x3e上也有开源的\x3ccode\x3ejQuery\x3c\/code\x3e插件，\x3ca href=\x22https:\/\/github.com\/gfdev\/javascript-jquery-transport-xdr\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e可以在这里找到\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e\x3ccode\x3eXDR\x3c\/code\x3e的限制：\x3c\/strong\x3e\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3e\x3ccode\x3eXDR\x3c\/code\x3e仅支持\x3ccode\x3eGET\x3c\/code\x3e与\x3ccode\x3ePOST\x3c\/code\x3e这两种请求方式\x3c\/strong\x3e，虽然可以使用上面提交的插件来解决前端部分只要进行简单修改代码就可以提交\x3ccode\x3ePUT\x3c\/code\x3e\/\x3ccode\x3eHEAD\x3c\/code\x3e\/\x3ccode\x3eDELETE\x3c\/code\x3e的请求的问题，但是其请求的发生出去依旧还是将\x3ccode\x3ePUT\x3c\/code\x3e\/\x3ccode\x3eHEAD\x3c\/code\x3e\/\x3ccode\x3eDELETE\x3c\/code\x3e转化为\x3ccode\x3ePOST\x3c\/code\x3e，将\x3ccode\x3eHEAD \x3c\/code\x3e转化为\x3ccode\x3eGET\x3c\/code\x3e请求。当是\x3ccode\x3ePOST\x3c\/code\x3e请求的时候，请求方案会以\x3ccode\x3e__method=原请求\x3c\/code\x3e的方式结构加入到请求体的\x3ccode\x3ebody\x3c\/code\x3e中。当是\x3ccode\x3eHEAD \x3c\/code\x3e请求的时候，请求方案会以\x3ccode\x3e__method=原请求\x3c\/code\x3e的方式结构加入请求url的查询参数中。现在大部分API开发都是按照\x3ccode\x3eRESTful\x3c\/code\x3e规范进行设计的，如果是自己的服务端还好，可以叫服务端的同学添加一个拦截器做一个拦截判断，然后执行对应的方法（ps：我想过去应该是这个样子，不知道服务端的同学会不会磨刀子）。但是如果你调用是网上的API的接口的话，那就爱莫能助了。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3e\x3ccode\x3eXDR不支持自定义的请求头\x3c\/code\x3e\x3c\/strong\x3e，因此如果你的服务端是用过\x3ccode\x3eheader\x3c\/code\x3e中的自定义参数进行做身份验证的话，那也行不通了。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3e请求头的\x3ccode\x3eContent-Type\x3c\/code\x3e只允许设置为\x3ccode\x3etext\/plain\x3c\/code\x3e\x3c\/strong\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3e\x3ccode\x3eXDR\x3c\/code\x3e不允许跨协议的请求\x3c\/strong\x3e，如果你的网页是在\x3ccode\x3eHTTP\x3c\/code\x3e协议下，那么你只能请求\x3ccode\x3eHTTP\x3c\/code\x3e协议下的接口，不能访问\x3ccode\x3eHTTPS \x3c\/code\x3e下的接口。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3e\x3ccode\x3eXDR\x3c\/code\x3e只接受\x3ccode\x3eHTTP\/HTTPS\x3c\/code\x3e 的请求\x3c\/strong\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3e发起请求的时候，不会携带\x3ccode\x3eauthentication\x3c\/code\x3e 或\x3ccode\x3e cookies\x3c\/code\x3e\x3c\/strong\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3eJSONP\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e\x3ccode\x3eJSONP\x3c\/code\x3e的本质是动态的加载\x3ccode\x3e\x26lt;script\x26gt;\x3c\/code\x3e 标签，因此其只支持\x3ccode\x3eGET\x3c\/code\x3e请求而不支持其他类型的\x3ccode\x3eHTTP\x3c\/code\x3e请求。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eJSONP\x3c\/code\x3e 的执行过程大致如下：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cp\x3e客户端设置一个全局的\x3ccode\x3efunction\x3c\/code\x3e，然后使用\x3ccode\x3ecallback=function\x3c\/code\x3e 的方法，将回调的方法传递给服务端。例如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 定义全局函数\nfunction showData (data) {\n  console.log(data)\n}\nvar url = \x26quot;http:\/\/test.com\/jsonp\/query?id=1\x26amp;callback=showData\x26quot; \/\/ 这个就是script标签中的url\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 定义全局函数\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eshowData\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(data)\n}\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e url = \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/test.com\/jsonp\/query?id=1\x26amp;callback=showData\x22\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这个就是script标签中的url\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e服务端在接收到请求的时候，生成一个动态的\x3ccode\x3ejs\x3c\/code\x3e脚本，在该脚本中，调用\x3ccode\x3ecallback\x3c\/code\x3e参数传递进来的\x3ccode\x3efunction\x3c\/code\x3e，将回来返回的\x3ccode\x3ejson\x3c\/code\x3e 数据已参数的形式去传递给该\x3ccode\x3efunction\x3c\/code\x3e，这样，客户端在加载这个\x3ccode\x3ejs\x3c\/code\x3e的时候，就会自动去执行了。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e代理\x3c\/h3\x3e\n\x3cp\x3e其实，跨域的根本问题就在于，你调用的服务端地址\x3ccode\x3eweb地址\x3c\/code\x3e不在同一个域下，那么，我们最容易想到的一个解决方案就是：那我把他们放在一个域下面不就可以了么。因此我们可以在\x3ccode\x3eweb\x3c\/code\x3e工程下 放置一个代理服务器，在\x3ccode\x3eIE10\x3c\/code\x3e以下的浏览器中，我们的网络请求统一走这一个代理接口，由服务器带我们去转发这个\x3ccode\x3eHTTP\x3c\/code\x3e请求，然后再将结果返回给我们。\x3c\/p\x3e\n\x3cp\x3e事实上我们项目中也是采用的这个方案，我们定义了一个接口:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eURL: v0.1\/dispatcher\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e方法: POST\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e请求内容:\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;request_url\x26quot;:\x26quot;http:\/\/test.com\x26quot;, \/\/必填，请求url\n  \x26quot;request_method\x26quot;:\x26quot;POST\x26quot;, \/\/必填，请求方法：GET\/PUT\/PATCH\/POST\/DELETE\n  \x26quot;request_headers\x26quot;:{\n    \x26quot;Content-Type\x26quot;:[\x26quot;application\/json\x26quot;]\n  }, \/\/选填，请求头\n  \x26quot;request_data\x26quot;:{\n    \x26quot;data\x26quot;:{    \n          \/\/请求body\n    }\n  }\n} \/\/选填，请求body\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e{\n  \x3cspan class=\x22hljs-string\x22\x3e\x22request_url\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/test.com\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/必填，请求url\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e\x22request_method\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22POST\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/必填，请求方法：GET\/PUT\/PATCH\/POST\/DELETE\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e\x22request_headers\x22\x3c\/span\x3e:{\n    \x3cspan class=\x22hljs-string\x22\x3e\x22Content-Type\x22\x3c\/span\x3e:[\x3cspan class=\x22hljs-string\x22\x3e\x22application\/json\x22\x3c\/span\x3e]\n  }, \x3cspan class=\x22hljs-comment\x22\x3e\/\/选填，请求头\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e\x22request_data\x22\x3c\/span\x3e:{\n    \x3cspan class=\x22hljs-string\x22\x3e\x22data\x22\x3c\/span\x3e:{    \n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/请求body\x3c\/span\x3e\n    }\n  }\n} \x3cspan class=\x22hljs-comment\x22\x3e\/\/选填，请求body\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e服务端通过客户端传来的这些参数去构造一个\x3ccode\x3eHttpClient\x3c\/code\x3e ,发起请求。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e文件上传的问题\x3c\/h2\x3e\n\x3cp\x3e既然通过上面的代理接口解决了，\x3ccode\x3eIE10\x3c\/code\x3e 一下的跨域请求问题，本想着应该没什么问题了，试了试项目中的文件上传，oh,no!不能运行，看了看我们的文件上传，是通过自己\x3ccode\x3enew FormData()\x3c\/code\x3e的方式去向服务器\x3ccode\x3ePOST\x3c\/code\x3e请求的。然后翻找了一下\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebApi\x3c\/a\x3e, 发现从\x3ccode\x3eIE10\x3c\/code\x3e 开始兼容的，这就......，并且\x3ccode\x3eXMLHttpRequest\x3c\/code\x3e的\x3ccode\x3esend(formData)\x3c\/code\x3e这个方法也是从\x3ccode\x3eIE10\x3c\/code\x3e开始支持的。那没办法了只能寻找其他的办法了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e隐式表单上传\x3c\/h3\x3e\n\x3cp\x3e找到老司机，请教了一下，早期IE都是用使用隐式的\x3ccode\x3eiframe\x3c\/code\x3e中包含一个\x3ccode\x3eform\x3c\/code\x3e表单，然后直接去提交\x3ccode\x3eform\x3c\/code\x3e表单。然后服务完全返回的数据在\x3ccode\x3eiframe\x3c\/code\x3e中，通过\x3ccode\x3ejs\x3c\/code\x3e代码去里面获取iframe中的数据，作为返回值。\x3c\/p\x3e\n\x3cp\x3e然后从老司机那边得到一份插件\x3ca href=\x22http:\/\/pan.baidu.com\/s\/1o8HeP42\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eajaxfileupload\x3c\/a\x3e,还有一个就是自己在\x3ccode\x3eGithub\x3c\/code\x3e上找的一个\x3ca href=\x22https:\/\/github.com\/blueimp\/jQuery-File-Upload\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejQuery-File-Upload\x3c\/a\x3e,现在就来讲讲这两个插件\x3c\/p\x3e\n\x3ch4\x3eajaxfileupload\x3c\/h4\x3e\n\x3cp\x3e\x3cstrong\x3e适用于服务器返回的数据是文本格式\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e这份代码也很简单就200多行，主要就思想就是根据上面说的，使用隐式的\x3ccode\x3eiframe\x3c\/code\x3e嵌套\x3ccode\x3eform\x3c\/code\x3e表单来完成上传操作。但是呢？这个插件只适合在服务器返回数据是文本数据的时候，如果服务器返回的是\x3ccode\x3ejson\x3c\/code\x3e 的数据，\x3ccode\x3eIE10\x3c\/code\x3e一下的浏览器就会自动去执行下载操作，\x3ccode\x3ejs\x3c\/code\x3e代码在执行到下载的时候就中断了，并不会继续往下执行了。所以也不是很适用。如果服务器支持返回数据格式是文本格式的话，这个组件还是挺好用的。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 基本用法如下\n\x3c!-- 隐藏file标签 --\x3e  \n\x3cinput id=\x26quot;fileUpload\x26quot; style=\x26quot;display: none\x26quot; type=\x26quot;file\x26quot; name=\x26quot;file\x26quot;\x3e\n \/\/选择文件之后执行上传  \n    $(\x27#fileUpload\x27).on(\x27change\x27, function() {  \n        $.ajaxFileUpload({  \n            url:\x27http:\/\/test.com\x27,  \n            secureuri:false,  \n            fileElementId:\x27fileToUpload\x27,\/\/file标签的id  \n            dataType: \x27json\x27,\/\/返回数据的类型  \n            data:{name:\x27logan\x27},\/\/一同上传的数据  \n            success: function (data, status) {  \n               console.log(data)\n            },  \n            error: function (data, status, e) {  \n                alert(e);  \n            }  \n        });  \n    });  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 基本用法如下\x3c\/span\x3e\n\x26lt;!-- 隐藏file标签 --\x26gt;  \n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22fileUpload\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22display: none\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n \/\/选择文件之后执行上传  \n    $(\x27#fileUpload\x27).on(\x27change\x27, function() {  \n        $.ajaxFileUpload({  \n            url:\x27http:\/\/test.com\x27,  \n            secureuri:false,  \n            fileElementId:\x27fileToUpload\x27,\/\/file标签的id  \n            dataType: \x27json\x27,\/\/返回数据的类型  \n            data:{name:\x27logan\x27},\/\/一同上传的数据  \n            success: function (data, status) {  \n               console.log(data)\n            },  \n            error: function (data, status, e) {  \n                alert(e);  \n            }  \n        });  \n    });  \x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3ejQuery-File-Upload\x3c\/h4\x3e\n\x3cp\x3e\x3cstrong\x3e适用于服务器返回的数据是JSON格式切支持重定向\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e这个插件呢，对比\x3ccode\x3eajaxfileupload\x3c\/code\x3e他考虑到了这种返回\x3ccode\x3ejson\x3c\/code\x3e的情况，但是它的使用需要服务端进行支持，其主要思想还是使用了隐式的表单上传文件，但是它是通过服务其的重定向来接收数据的，服务器接收到了客户端的请求之后，将返回的数据通过\x3ccode\x3eURLEncode\x3c\/code\x3e之后，拼接在前端\x3ccode\x3eweb\x3c\/code\x3e页面的后面,然后在页面中解析数据，写到\x3ccode\x3ebody\x3c\/code\x3e中，用\x3ccode\x3ejQuery\x3c\/code\x3e去获取这些数据。\x3c\/p\x3e\n\x3cp\x3e具体用法如下：\x3c\/p\x3e\n\x3cp\x3e现在服务器构造一个接受返回数据的页面\x3ccode\x3eresult.html\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!DOCTYPE html\x3e\n\x3chtml lang=\x26quot;en\x26quot;\x3e\n\x3chead\x3e\n    \x3cmeta charset=\x26quot;UTF-8\x26quot;\x3e\n    \x3ctitle\x3eresult\x3c\/title\x3e\n\x3c\/head\x3e\n\x3cbody\x3e\n\x3cscript\x3e\n  var href = window.location.href\n  var search = href.slice(href.indexOf(\x27?\x27) \x2b 1)\n  document.body.innerText=document.body.textContent=decodeURIComponent(search)\n\x3c\/script\x3e\n\x3c\/body\x3e\n\x3c\/html\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3elang\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22en\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22UTF-8\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eresult\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e href = \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.location.href\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e search = href.slice(href.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x27?\x27\x3c\/span\x3e) \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.innerText=\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.textContent=\x3cspan class=\x22hljs-built_in\x22\x3edecodeURIComponent\x3c\/span\x3e(search)\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后自己定义一个上传的组件，我这里是使用\x3ccode\x3eVue\x3c\/code\x3e来包装成一个组件的\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3ctemplate\x3e\n  \x3cdiv class=\x26quot;c-uploader\x26quot;\n       v-tap\n       @click=\x26quot;onTap\x26quot;\x3e\n    \x3cinput\n      type=\x26quot;file\x26quot;\n      ref=\x26quot;file\x26quot;\n      id=\x26quot;fileUploadNormal\x26quot;\n      name=\x26quot;file\x26quot;\n      style=\x26quot;display: none\x26quot;\n      data-sequential-uploads=\x26quot;true\x26quot;\n      :accept=\x26quot;accept\x26quot;\n      multiple=\x26quot;false\x26quot;\/\x3e\n    \x3cslot\x3e\x3c\/slot\x3e\n  \x3c\/div\x3e\n\x3c\/template\x3e\n\x3cscript\x3e\n  import { getMACContent } from \x27..\/..\/utils\/tokens\x27\n  import optionsUtil from \x27..\/..\/utils\/optionsUtil\x27\n  import tap from \x27..\/directives\/tap\x27\n  import \x27..\/libs\/vendor\/jquery.ui.widget\x27\n  import \x27..\/libs\/jquery.iframe-transport\x27\n  import \x27..\/libs\/jquery.fileupload\x27\n  import \x27..\/libs\/cors\/jquery.xdr-transport\x27\n  import g_config from \x27..\/..\/config\/config\x27\n  export default{\n    props: {\n      url: {\n        type: String,\n        required: true\n      },\n      data: {\n        type: Object,\n        default: function () {\n          return {}\n        }\n      },\n      accept: {\n        type: String,\n        default: \x27*\x27\n      },\n      onSuccess: {\n        type: Function,\n        default: function () {\n        }\n      },\n      onError: {\n        type: Function,\n        default: function () {\n        }\n      },\n      checkFile: {\n        type: Function,\n        default: function () {\n          return true\n        }\n      }\n    },\n    data () {\n      return {\n        uploadFile: null,\n        headers: {\n          Authorization: new getMACContent({url: this.url,method: \x27POST\x27})._value.returnMessage\n        }\n      }\n    },\n    methods: {\n      onTap (e) {\n        const fileInputEl = this.$refs.file\n        if (!fileInputEl) {\n          return\n        }\n        \/\/ TODO: trigger tap or touch but not click ?\n        fileInputEl.click()\n        fileInputEl.value = \x27\x27\n      },\n      init () {\n        this.uploadFile = null\n      },\n      startUpload () {\n        const that = this\n        if (this.uploadFile !== null) {\n          if (this.checkFile(this.uploadFile.files[0])) {\n            that.data.request_url = that.url\n            that.data.name = this.uploadFile.files[0].name\n            that.data.redirect = location.protocol\x2b\x27\/\/\x27 \x2b location.host\x2b\x27\/result.html?\x27\n            that.data.authorization = that.headers.Authorization\n            $(\x27#fileUploadNormal\x27).fileupload({\n              url: g_config.dispatch_url \x2b \x27\/v0.1\/dispatcher\/upload\x27,\n              formData: that.data\n            })\n            that.uploadFile.submit() \/\/ 上传文件\n          }\n        } else {\n          const response = {\n            msg: \x27请选择需要上传的文件\x27\n          }\n          this.onError(null, response, null)\n        }\n      }\n    },\n    computed: {},\n    watch: {},\n    components: {\n    },\n    directives: {\n      tap\n    },\n    mounted () {\n      const that = this\n      $(\x27#fileUploadNormal\x27).fileupload({\n        dataType: \x27json\x27, \/\/ 设置返回数据格式\n        multiple: false, \/\/ 只允许选择单文件\n        iframe: true, \/\/ 使用iframe\n        sequentialUploads: true,\n        forceIframeTransport : true, \/\/ 强制使用iframe\n        autoUpload: false, \/\/ 关闭自动上传，否则在文件变化的时候，就会自动upload\n        formData: that.data, \/\/ 定义需要格外上传的数据\n        replaceFileInput: false,\n        add: function (e, data) {\n          that.headers.Authorization = new getMACContent({url: that.url,method: \x27POST\x27})._value.returnMessage\n          that.uploadFile = data \/\/ 记录下数据\n        },\n        done: function (e, data) {\n          const response = data.result\n          const resultData = JSON.parse(response.data)\n          if (response.result.toUpperCase() === \x27SUCCESS\x27) {\n            that.onSuccess(resultData)\n          } else {\n            that.onError(null,resultData, null)\n          }\n        },\n        fail: function (e, data) {\n          that.uploadFile = null\n          that.onError(null,{\n            msg: \x27上传失败\x27\n          }, null)\n        }\n      })\n    }\n  }\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x26lt;template\x26gt;\n  \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22c-uploader\x22\x3c\/span\x3e\n       \x3cspan class=\x22hljs-attr\x22\x3ev-tap\x3c\/span\x3e\n       @\x3cspan class=\x22hljs-attr\x22\x3eclick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22onTap\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3eref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22fileUploadNormal\x22\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22display: none\x22\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3edata-sequential-uploads\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22true\x22\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3e:accept\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22accept\x22\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3emultiple\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22false\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eslot\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eslot\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n\x26lt;script\x26gt;\n  \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { getMACContent } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/..\/utils\/tokens\x27\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e optionsUtil \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/..\/utils\/optionsUtil\x27\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e tap \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/directives\/tap\x27\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/libs\/vendor\/jquery.ui.widget\x27\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/libs\/jquery.iframe-transport\x27\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/libs\/jquery.fileupload\x27\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/libs\/cors\/jquery.xdr-transport\x27\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e g_config \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/..\/config\/config\x27\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-attr\x22\x3eprops\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3erequired\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n      },\n      \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edefault\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {}\n        }\n      },\n      \x3cspan class=\x22hljs-attr\x22\x3eaccept\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edefault\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27*\x27\x3c\/span\x3e\n      },\n      \x3cspan class=\x22hljs-attr\x22\x3eonSuccess\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eFunction\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edefault\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        }\n      },\n      \x3cspan class=\x22hljs-attr\x22\x3eonError\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eFunction\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edefault\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        }\n      },\n      \x3cspan class=\x22hljs-attr\x22\x3echeckFile\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eFunction\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edefault\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n        }\n      }\n    },\n    data () {\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attr\x22\x3euploadFile\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eheaders\x3c\/span\x3e: {\n          \x3cspan class=\x22hljs-attr\x22\x3eAuthorization\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e getMACContent({\x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.url,\x3cspan class=\x22hljs-attr\x22\x3emethod\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e})._value.returnMessage\n        }\n      }\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3emethods\x3c\/span\x3e: {\n      onTap (e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e fileInputEl = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$refs.file\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!fileInputEl) {\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x3cspan class=\x22hljs-doctag\x22\x3eTODO:\x3c\/span\x3e trigger tap or touch but not click ?\x3c\/span\x3e\n        fileInputEl.click()\n        fileInputEl.value = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n      },\n      init () {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.uploadFile = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n      },\n      startUpload () {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e that = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.uploadFile !== \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e) {\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.checkFile(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.uploadFile.files[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e])) {\n            that.data.request_url = that.url\n            that.data.name = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.uploadFile.files[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].name\n            that.data.redirect = location.protocol\x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\/\/\x27\x3c\/span\x3e \x2b location.host\x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\/result.html?\x27\x3c\/span\x3e\n            that.data.authorization = that.headers.Authorization\n            $(\x3cspan class=\x22hljs-string\x22\x3e\x27#fileUploadNormal\x27\x3c\/span\x3e).fileupload({\n              \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: g_config.dispatch_url \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\/v0.1\/dispatcher\/upload\x27\x3c\/span\x3e,\n              \x3cspan class=\x22hljs-attr\x22\x3eformData\x3c\/span\x3e: that.data\n            })\n            that.uploadFile.submit() \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 上传文件\x3c\/span\x3e\n          }\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n          \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e response = {\n            \x3cspan class=\x22hljs-attr\x22\x3emsg\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27请选择需要上传的文件\x27\x3c\/span\x3e\n          }\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.onError(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, response, \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e)\n        }\n      }\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3ecomputed\x3c\/span\x3e: {},\n    \x3cspan class=\x22hljs-attr\x22\x3ewatch\x3c\/span\x3e: {},\n    \x3cspan class=\x22hljs-attr\x22\x3ecomponents\x3c\/span\x3e: {\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3edirectives\x3c\/span\x3e: {\n      tap\n    },\n    mounted () {\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e that = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n      $(\x3cspan class=\x22hljs-string\x22\x3e\x27#fileUploadNormal\x27\x3c\/span\x3e).fileupload({\n        \x3cspan class=\x22hljs-attr\x22\x3edataType\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27json\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置返回数据格式\x3c\/span\x3e\n        multiple: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 只允许选择单文件\x3c\/span\x3e\n        iframe: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 使用iframe\x3c\/span\x3e\n        sequentialUploads: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eforceIframeTransport\x3c\/span\x3e : \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 强制使用iframe\x3c\/span\x3e\n        autoUpload: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 关闭自动上传，否则在文件变化的时候，就会自动upload\x3c\/span\x3e\n        formData: that.data, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 定义需要格外上传的数据\x3c\/span\x3e\n        replaceFileInput: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eadd\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ee, data\x3c\/span\x3e) \x3c\/span\x3e{\n          that.headers.Authorization = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e getMACContent({\x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: that.url,\x3cspan class=\x22hljs-attr\x22\x3emethod\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e})._value.returnMessage\n          that.uploadFile = data \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 记录下数据\x3c\/span\x3e\n        },\n        \x3cspan class=\x22hljs-attr\x22\x3edone\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ee, data\x3c\/span\x3e) \x3c\/span\x3e{\n          \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e response = data.result\n          \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e resultData = \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.parse(response.data)\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (response.result.toUpperCase() === \x3cspan class=\x22hljs-string\x22\x3e\x27SUCCESS\x27\x3c\/span\x3e) {\n            that.onSuccess(resultData)\n          } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            that.onError(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,resultData, \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e)\n          }\n        },\n        \x3cspan class=\x22hljs-attr\x22\x3efail\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ee, data\x3c\/span\x3e) \x3c\/span\x3e{\n          that.uploadFile = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n          that.onError(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,{\n            \x3cspan class=\x22hljs-attr\x22\x3emsg\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27上传失败\x27\x3c\/span\x3e\n          }, \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e)\n        }\n      })\n    }\n  }\n\x26lt;\x3cspan class=\x22hljs-regexp\x22\x3e\/script\x26gt;\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个插件是依赖\x3ccode\x3ejQuery\x3c\/code\x3e的，并且依赖\x3ccode\x3ejQuery-UI \x3c\/code\x3e,还有要注意的是在\x3ccode\x3eIE10\x3c\/code\x3e以下的版本都要引入\x3ccode\x3ejquery.iframe-transport\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e与\x3ccode\x3ejquery.xdr-transport\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e我代码中发送数据的方式是它在\x3ccode\x3eadd\x3c\/code\x3e 方法中返回的\x3ccode\x3edata\x3c\/code\x3e数据，通过该对象去直接上传文件，这时上传的\x3ccode\x3eFormData\x3c\/code\x3e的文件信息中，文件原本是什么类型就是什么类型了，这是我们所期望的。我之前查看官方的文档，还使用过另一种方式\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var jqXHR = $(\x27#fileupload\x27).fileupload(\x27send\x27, {files: filesList})\n    .success(function (result, textStatus, jqXHR) {\/* ... *\/})\n    .error(function (jqXHR, textStatus, errorThrown) {\/* ... *\/})\n    .complete(function (result, textStatus, jqXHR) {\/* ... *\/});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e jqXHR = $(\x3cspan class=\x22hljs-string\x22\x3e\x27#fileupload\x27\x3c\/span\x3e).fileupload(\x3cspan class=\x22hljs-string\x22\x3e\x27send\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-attr\x22\x3efiles\x3c\/span\x3e: filesList})\n    .success(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresult, textStatus, jqXHR\x3c\/span\x3e) \x3c\/span\x3e{\x3cspan class=\x22hljs-comment\x22\x3e\/* ... *\/\x3c\/span\x3e})\n    .error(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ejqXHR, textStatus, errorThrown\x3c\/span\x3e) \x3c\/span\x3e{\x3cspan class=\x22hljs-comment\x22\x3e\/* ... *\/\x3c\/span\x3e})\n    .complete(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresult, textStatus, jqXHR\x3c\/span\x3e) \x3c\/span\x3e{\x3cspan class=\x22hljs-comment\x22\x3e\/* ... *\/\x3c\/span\x3e});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上传的时候使用的是这样的方式，发现\x3ccode\x3eFormData\x3c\/code\x3e中上传文件的类型变为了\x3ccode\x3eContent-Type: application\/octet-stream\x3c\/code\x3e，然后服务器就解析不到数据了。所以还是推荐用它原生的\x3ccode\x3esubmit\x3c\/code\x3e方式去提交数据。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e注意\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e这两个插件的本质还是使用\x3ccode\x3eform\x3c\/code\x3e表单上传文件，因此我们无法添加自定义的\x3ccode\x3eheader\x3c\/code\x3e头，并且如果原来的服务器不支持请求重定向的话怎么办，那就没有办法使用\x3ccode\x3ejQuery-File-Upload\x3c\/code\x3e这个插件了。所以最稳妥的方式，还是在我们本地做了一层代理，由代理去发生真正的请求。\x3c\/p\x3e\n\x3cp\x3e下面给出主要的转发\x3ccode\x3eFormData\x3c\/code\x3e的\x3ccode\x3ejava\x3c\/code\x3e代码\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22public ResponseEntity dispatcherUpload(HttpServletRequest request) throws UnsupportedEncodingException {\n\n    String requestUrl = request.getParameter(\x26quot;request_url\x26quot;);\n    String redirectUrl = request.getParameter(\x26quot;redirect\x26quot;);\n    String fileName = request.getParameter(\x26quot;name\x26quot;);\n\n    if (StringUtils.isEmpty(requestUrl) || StringUtils.isEmpty(redirectUrl))\n      throw new BizException(ErrorCode.INVALID_ARGUMENT);\n\n    HttpClient httpClient = new DefaultHttpClient();\n    HttpPost httpPost = new HttpPost(requestUrl);\n    String auth = request.getParameter(\x26quot;authorization\x26quot;);\n    if (!StringUtils.isEmpty(auth))\n      httpPost.addHeader(\x26quot;Authorization\x26quot;, request.getParameter(\x26quot;authorization\x26quot;).toString());\n    MultipartEntity reqEntity = new MultipartEntity();\n\n    if (!StringUtils.isEmpty(request.getParameter(\x26quot;path\x26quot;))) {\n      StringBody pathBody = new StringBody(request.getParameter(\x26quot;path\x26quot;));\n      reqEntity.addPart(\x26quot;path\x26quot;, pathBody);\n    }\n    if (!StringUtils.isEmpty(request.getParameter(\x26quot;scope\x26quot;))) {\n      StringBody scopeBody = new StringBody(request.getParameter(\x26quot;scope\x26quot;));\n      reqEntity.addPart(\x26quot;scope\x26quot;, scopeBody);\n    }\n    if (!StringUtils.isEmpty(request.getParameter(\x26quot;expireDays\x26quot;))) {\n      StringBody expireDaysBody = new StringBody(request.getParameter(\x26quot;expireDays\x26quot;));\n      reqEntity.addPart(\x26quot;expireDays\x26quot;, expireDaysBody);\n    }\n    if (!StringUtils.isEmpty(fileName)) {\n      StringBody nameBody = new StringBody(fileName);\n      reqEntity.addPart(\x26quot;name\x26quot;, nameBody);\n    }\n\n    MultipartHttpServletRequest multipartHttpServletRequest = (MultipartHttpServletRequest) request;\n    MultiValueMap\x3cString, MultipartFile\x3e multiValueMap = multipartHttpServletRequest.getMultiFileMap();\n    \/\/todo:现在暂时写死，不去遍历map\n    if(!(multiValueMap.containsKey(CS_FILE_KEY) || multiValueMap.containsKey(UC_FILE_KEY)))\n      throw new BizException(ErrorCode.INVALID_ARGUMENT);\n    String fileKey = multiValueMap.containsKey(CS_FILE_KEY) ? CS_FILE_KEY : UC_FILE_KEY;\n    MultipartFile multipartFile = multipartHttpServletRequest.getFile(fileKey); \/\/ 得到文件数据\n    if (!multipartFile.isEmpty()) {\n\n      CommonsMultipartFile commonsMultipartFile = (CommonsMultipartFile) multipartFile;\n      DiskFileItem diskFileItem = (DiskFileItem) commonsMultipartFile.getFileItem();\n      String filePath = diskFileItem.getStoreLocation().getPath().toString();\n\n      File file = null;\n      try {\n        \/\/判断目录是否已存在，如果filename不为空，将其带入创建文件（真实还原文件类型，否则是.tmp临时文件）\n        if (StringUtils.isEmpty(fileName)) {\n          file = new File(filePath);\n        } else {\n          file = new File(filePath, fileName);\n        }\n        if (!file.exists()) {\n          file.mkdirs();\n        }\n        \/\/保存文件\n        multipartFile.transferTo(file);\n        FileBody bin = new FileBody(file);\n        reqEntity.addPart(fileKey, bin);\n        httpPost.setEntity(reqEntity);\n\n        HttpHeaders responseHeader = new HttpHeaders();\n        HttpResponse httpResponse = null;\n        try {\n          httpResponse = httpClient.execute(httpPost);\n        } catch (Exception e) {\n          LOG.error(\x26quot;代理文件上传失败，请求地址：{}，请求内容：{}\x26quot;, requestUrl, null, e);\n          JSONObject failedJson = new JSONObject();\n          failedJson.put(\x26quot;result\x26quot;, \x26quot;FAILURE\x26quot;);\n          failedJson.put(\x26quot;data\x26quot;, e.toString());\n          URI uri = URI.create(redirectUrl \x2b e.toString());\n          responseHeader.setLocation(uri);\n          return new ResponseEntity(responseHeader, HttpStatus.MOVED_TEMPORARILY);\n        }\n        LOG.info(\x26quot;状态码：\x26quot; \x2b httpResponse.getStatusLine().getStatusCode());\n        org.apache.http.HttpEntity httpEntity = httpResponse.getEntity();\n        \/\/判断请求是否成功\n        String responseBody = \x26quot;\x26quot;;\n        String isSuccess = \x26quot;SUCCESS\x26quot;;\n        if (httpResponse.getStatusLine().getStatusCode() \x3e= HttpStatus.OK.value() \x26amp;\x26amp; httpResponse.getStatusLine().getStatusCode() \x3c HttpStatus.BAD_REQUEST.value()) {\n          if (null != httpEntity) {\n\/\/            System.out.println(\x26quot;响应内容:\x26quot; \x2b EntityUtils.toString(httpEntity, ContentType.getOrDefault(httpEntity).getCharset()));\n            responseBody = EntityUtils.toString(httpEntity, ContentType.getOrDefault(httpEntity).getCharset());\n            \/\/处于安全考虑，关闭数据流\n            EntityUtils.consume(httpEntity);\n          }\n        } else {\n          \/\/上传失败（非2XX）\n          isSuccess = \x26quot;FAILURE\x26quot;;\n        }\n        JSONObject ResJson = new JSONObject();\n        ResJson.put(\x26quot;result\x26quot;, isSuccess);\n        ResJson.put(\x26quot;data\x26quot;, responseBody);\n        URI uri = URI.create(redirectUrl \x2b URLEncoder.encode(ResJson.toString(), \x26quot;UTF-8\x26quot;));\n        responseHeader.setLocation(uri);\n        return new ResponseEntity(responseHeader, HttpStatus.MOVED_TEMPORARILY);\n      } catch (IOException e) {\n        throw new BizException(ErrorCode.INTERNAL_SERVER_ERROR, e);\n      } finally {\n        if (file != null) {\n          file.delete();\n        }\n      }\n    }else {\n      throw new BizException(HttpStatus.BAD_REQUEST, \x26quot;PORTAL-APP\/INVALID_ARGUMENT\x26quot;, \x26quot;上传文件为空\x26quot;);\n    }\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22java hljs\x22\x3e\x3ccode class=\x22java\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e ResponseEntity \x3cspan class=\x22hljs-title\x22\x3edispatcherUpload\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(HttpServletRequest request)\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethrows\x3c\/span\x3e UnsupportedEncodingException \x3c\/span\x3e{\n\n    String requestUrl = request.getParameter(\x3cspan class=\x22hljs-string\x22\x3e\x22request_url\x22\x3c\/span\x3e);\n    String redirectUrl = request.getParameter(\x3cspan class=\x22hljs-string\x22\x3e\x22redirect\x22\x3c\/span\x3e);\n    String fileName = request.getParameter(\x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (StringUtils.isEmpty(requestUrl) || StringUtils.isEmpty(redirectUrl))\n      \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e BizException(ErrorCode.INVALID_ARGUMENT);\n\n    HttpClient httpClient = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e DefaultHttpClient();\n    HttpPost httpPost = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e HttpPost(requestUrl);\n    String auth = request.getParameter(\x3cspan class=\x22hljs-string\x22\x3e\x22authorization\x22\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!StringUtils.isEmpty(auth))\n      httpPost.addHeader(\x3cspan class=\x22hljs-string\x22\x3e\x22Authorization\x22\x3c\/span\x3e, request.getParameter(\x3cspan class=\x22hljs-string\x22\x3e\x22authorization\x22\x3c\/span\x3e).toString());\n    MultipartEntity reqEntity = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e MultipartEntity();\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!StringUtils.isEmpty(request.getParameter(\x3cspan class=\x22hljs-string\x22\x3e\x22path\x22\x3c\/span\x3e))) {\n      StringBody pathBody = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e StringBody(request.getParameter(\x3cspan class=\x22hljs-string\x22\x3e\x22path\x22\x3c\/span\x3e));\n      reqEntity.addPart(\x3cspan class=\x22hljs-string\x22\x3e\x22path\x22\x3c\/span\x3e, pathBody);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!StringUtils.isEmpty(request.getParameter(\x3cspan class=\x22hljs-string\x22\x3e\x22scope\x22\x3c\/span\x3e))) {\n      StringBody scopeBody = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e StringBody(request.getParameter(\x3cspan class=\x22hljs-string\x22\x3e\x22scope\x22\x3c\/span\x3e));\n      reqEntity.addPart(\x3cspan class=\x22hljs-string\x22\x3e\x22scope\x22\x3c\/span\x3e, scopeBody);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!StringUtils.isEmpty(request.getParameter(\x3cspan class=\x22hljs-string\x22\x3e\x22expireDays\x22\x3c\/span\x3e))) {\n      StringBody expireDaysBody = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e StringBody(request.getParameter(\x3cspan class=\x22hljs-string\x22\x3e\x22expireDays\x22\x3c\/span\x3e));\n      reqEntity.addPart(\x3cspan class=\x22hljs-string\x22\x3e\x22expireDays\x22\x3c\/span\x3e, expireDaysBody);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!StringUtils.isEmpty(fileName)) {\n      StringBody nameBody = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e StringBody(fileName);\n      reqEntity.addPart(\x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e, nameBody);\n    }\n\n    MultipartHttpServletRequest multipartHttpServletRequest = (MultipartHttpServletRequest) request;\n    MultiValueMap\x26lt;String, MultipartFile\x26gt; multiValueMap = multipartHttpServletRequest.getMultiFileMap();\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/todo:现在暂时写死，不去遍历map\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(!(multiValueMap.containsKey(CS_FILE_KEY) || multiValueMap.containsKey(UC_FILE_KEY)))\n      \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e BizException(ErrorCode.INVALID_ARGUMENT);\n    String fileKey = multiValueMap.containsKey(CS_FILE_KEY) ? CS_FILE_KEY : UC_FILE_KEY;\n    MultipartFile multipartFile = multipartHttpServletRequest.getFile(fileKey); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 得到文件数据\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!multipartFile.isEmpty()) {\n\n      CommonsMultipartFile commonsMultipartFile = (CommonsMultipartFile) multipartFile;\n      DiskFileItem diskFileItem = (DiskFileItem) commonsMultipartFile.getFileItem();\n      String filePath = diskFileItem.getStoreLocation().getPath().toString();\n\n      File file = \x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/判断目录是否已存在，如果filename不为空，将其带入创建文件（真实还原文件类型，否则是.tmp临时文件）\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (StringUtils.isEmpty(fileName)) {\n          file = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e File(filePath);\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n          file = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e File(filePath, fileName);\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!file.exists()) {\n          file.mkdirs();\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/保存文件\x3c\/span\x3e\n        multipartFile.transferTo(file);\n        FileBody bin = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FileBody(file);\n        reqEntity.addPart(fileKey, bin);\n        httpPost.setEntity(reqEntity);\n\n        HttpHeaders responseHeader = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e HttpHeaders();\n        HttpResponse httpResponse = \x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n          httpResponse = httpClient.execute(httpPost);\n        } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (Exception e) {\n          LOG.error(\x3cspan class=\x22hljs-string\x22\x3e\x22代理文件上传失败，请求地址：{}，请求内容：{}\x22\x3c\/span\x3e, requestUrl, \x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e, e);\n          JSONObject failedJson = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e JSONObject();\n          failedJson.put(\x3cspan class=\x22hljs-string\x22\x3e\x22result\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22FAILURE\x22\x3c\/span\x3e);\n          failedJson.put(\x3cspan class=\x22hljs-string\x22\x3e\x22data\x22\x3c\/span\x3e, e.toString());\n          URI uri = URI.create(redirectUrl \x2b e.toString());\n          responseHeader.setLocation(uri);\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ResponseEntity(responseHeader, HttpStatus.MOVED_TEMPORARILY);\n        }\n        LOG.info(\x3cspan class=\x22hljs-string\x22\x3e\x22状态码：\x22\x3c\/span\x3e \x2b httpResponse.getStatusLine().getStatusCode());\n        org.apache.http.HttpEntity httpEntity = httpResponse.getEntity();\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/判断请求是否成功\x3c\/span\x3e\n        String responseBody = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e;\n        String isSuccess = \x3cspan class=\x22hljs-string\x22\x3e\x22SUCCESS\x22\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (httpResponse.getStatusLine().getStatusCode() \x26gt;= HttpStatus.OK.value() \x26amp;\x26amp; httpResponse.getStatusLine().getStatusCode() \x26lt; HttpStatus.BAD_REQUEST.value()) {\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e != httpEntity) {\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/            System.out.println(\x22响应内容:\x22 \x2b EntityUtils.toString(httpEntity, ContentType.getOrDefault(httpEntity).getCharset()));\x3c\/span\x3e\n            responseBody = EntityUtils.toString(httpEntity, ContentType.getOrDefault(httpEntity).getCharset());\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/处于安全考虑，关闭数据流\x3c\/span\x3e\n            EntityUtils.consume(httpEntity);\n          }\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/上传失败（非2XX）\x3c\/span\x3e\n          isSuccess = \x3cspan class=\x22hljs-string\x22\x3e\x22FAILURE\x22\x3c\/span\x3e;\n        }\n        JSONObject ResJson = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e JSONObject();\n        ResJson.put(\x3cspan class=\x22hljs-string\x22\x3e\x22result\x22\x3c\/span\x3e, isSuccess);\n        ResJson.put(\x3cspan class=\x22hljs-string\x22\x3e\x22data\x22\x3c\/span\x3e, responseBody);\n        URI uri = URI.create(redirectUrl \x2b URLEncoder.encode(ResJson.toString(), \x3cspan class=\x22hljs-string\x22\x3e\x22UTF-8\x22\x3c\/span\x3e));\n        responseHeader.setLocation(uri);\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ResponseEntity(responseHeader, HttpStatus.MOVED_TEMPORARILY);\n      } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (IOException e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e BizException(ErrorCode.INTERNAL_SERVER_ERROR, e);\n      } \x3cspan class=\x22hljs-keyword\x22\x3efinally\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (file != \x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e) {\n          file.delete();\n        }\n      }\n    }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e BizException(HttpStatus.BAD_REQUEST, \x3cspan class=\x22hljs-string\x22\x3e\x22PORTAL-APP\/INVALID_ARGUMENT\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22上传文件为空\x22\x3c\/span\x3e);\n    }\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在转发文件的时候，我们做了一层转存，原因在于，我们测试一个服务器的时候，我们直接使用一个缓存的数据，去写到\x3ccode\x3eFormData\x3c\/code\x3e中，那边服务器接收到的文件对象居然是空的，因此我们才做了一层缓存，用一个真实存在的文件去做。\x3c\/p\x3e\n\x3cp\x3e---end---\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>IE9下的跨域问题小总结</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008686327">https://segmentfault.com/a/1190000008686327</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/6r0um7h2nvu/" target="_blank">https://alili.tech/archive/6r0um7h2nvu/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>