<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前端高亮功能实现复盘"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>前端高亮功能实现复盘 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/c37g4uz3oks/",
				"appid": "1613049289050283", 
				"title": "前端高亮功能实现复盘 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-10T02:30:08"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/px48t7obrcg/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/egz069ylqcv/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fc37g4uz3oks%2f&text=%e5%89%8d%e7%ab%af%e9%ab%98%e4%ba%ae%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0%e5%a4%8d%e7%9b%98"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fc37g4uz3oks%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fc37g4uz3oks%2f&text=%e5%89%8d%e7%ab%af%e9%ab%98%e4%ba%ae%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0%e5%a4%8d%e7%9b%98"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fc37g4uz3oks%2f&title=%e5%89%8d%e7%ab%af%e9%ab%98%e4%ba%ae%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0%e5%a4%8d%e7%9b%98"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fc37g4uz3oks%2f&is_video=false&description=%e5%89%8d%e7%ab%af%e9%ab%98%e4%ba%ae%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0%e5%a4%8d%e7%9b%98"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e7%ab%af%e9%ab%98%e4%ba%ae%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0%e5%a4%8d%e7%9b%98&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fc37g4uz3oks%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fc37g4uz3oks%2f&title=%e5%89%8d%e7%ab%af%e9%ab%98%e4%ba%ae%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0%e5%a4%8d%e7%9b%98"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fc37g4uz3oks%2f&title=%e5%89%8d%e7%ab%af%e9%ab%98%e4%ba%ae%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0%e5%a4%8d%e7%9b%98"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fc37g4uz3oks%2f&title=%e5%89%8d%e7%ab%af%e9%ab%98%e4%ba%ae%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0%e5%a4%8d%e7%9b%98"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fc37g4uz3oks%2f&title=%e5%89%8d%e7%ab%af%e9%ab%98%e4%ba%ae%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0%e5%a4%8d%e7%9b%98"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前端高亮功能实现复盘</h1><div class="meta"><div class="postdate"><time datetime="2019-01-10" itemprop="datePublished">2019-01-10</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e前端高亮功能实现复盘\x3c\/h1\x3e\n\x3cp\x3e“高亮”功能，个人觉得没必要再解释什么了。作为一名程序猿，天天都会接触高亮：写代码时的语法高亮；使用搜索引擎时的搜索结果高亮。作为一名前端，如果你做过与搜索相关的功能，那么你很有可能就实现过高亮，本文也主要从前端的角度复盘一下“高亮”功能实现的关键知识点。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009956576?w=857\x26amp;h=526\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009956576?w=857\x26amp;h=526\x22 alt=\x22高亮\x22 title=\x22高亮\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e高亮实现思路\x3c\/h3\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009956577?w=569\x26amp;h=415\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009956577?w=569\x26amp;h=415\x22 alt=\x22高亮原理\x22 title=\x22高亮原理\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e对用户的输入进行分词得到关键词，根据关键词搜索得到搜索结果。再次使用关键词从搜索结果中找到匹配，对匹配加上高亮样式，即完成高亮。细分这个过程，会有以下细节点：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e对用户输入分词得到关键词\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e根据关键词得到搜索结果\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e关键词匹配\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e对匹配使用高亮样式\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e前两步一般在后台完成，后两步才是我们前端的工作，下面通过具体例子来实际演练一下。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e普通文本高亮\x3c\/h3\x3e\n\x3cp\x3e比如我们有这样的文本：“我是中国人，我爱中华人民共和国，中华人民共和国万岁！”，这时我们的关键词是“我”，即要高亮文本中所有的我。代码实现完整如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!DOCTYPE html\x3e\n\x3chtml lang=\x26quot;en\x26quot;\x3e\n\x3chead\x3e\n  \x3cmeta charset=\x26quot;UTF-8\x26quot;\x3e\n  \x3ctitle\x3e普通文本高亮\x3c\/title\x3e\n  \x3cstyle\x3e\n    .keyword-match {\n      color: red;\n    }\n  \x3c\/style\x3e\n\x3c\/head\x3e\n\x3cbody\x3e\n\x3cdiv\x3e\n  原文本：我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x3cbr \/\x3e\n  关键词: 我 \x3cbr \/\x3e\n  结果如下：\x3cbr \/\x3e\x3cbr \/\x3e\n\x3c\/div\x3e\n\x3cdiv id=\x26quot;content\x26quot;\x3e\x3c\/div\x3e\n\n\x3cscript\x3e\n  const content = document.getElementById(\x27content\x27);\n  const text = \x27我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x27;\n  const keyword = \x27我\x27;\n\n  \/\/ 根据关键词，对匹配加上高亮样式\n  let hightlightText = text.replace(new RegExp(`(${keyword})`, \x27g\x27), `\x3cspan class=\x26quot;keyword-match\x26quot;\x3e$1\x3c\/span\x3e`);\n\n  \/\/ 通过innerHTML写入匹配后的内容\n  content.innerHTML = hightlightText;\n\x3c\/script\x3e\n\x3c\/body\x3e\n\x3c\/html\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3elang\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22en\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22UTF-8\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e普通文本高亮\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22css\x22\x3e\n    \x3cspan class=\x22hljs-selector-class\x22\x3e.keyword-match\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-attribute\x22\x3ecolor\x3c\/span\x3e: red;\n    }\n  \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  原文本：我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n  关键词: 我 \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n  结果如下：\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e content = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27content\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e text = \x3cspan class=\x22hljs-string\x22\x3e\x27我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x27\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e keyword = \x3cspan class=\x22hljs-string\x22\x3e\x27我\x27\x3c\/span\x3e;\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据关键词，对匹配加上高亮样式\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e hightlightText = text.replace(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eRegExp\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e`(\x3cspan class=\x22hljs-subst\x22\x3e${keyword}\x3c\/span\x3e)`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27g\x27\x3c\/span\x3e), \x3cspan class=\x22hljs-string\x22\x3e`\x26lt;span class=\x22keyword-match\x22\x26gt;$1\x26lt;\/span\x26gt;`\x3c\/span\x3e);\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 通过innerHTML写入匹配后的内容\x3c\/span\x3e\n  content.innerHTML = hightlightText;\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的demo运行效果如下\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009956578?w=526\x26amp;h=126\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009956578?w=526\x26amp;h=126\x22 alt=\x22普通文本高亮\x22 title=\x22普通文本高亮\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e上面的例子虽然很简单，但已经完整实现了高亮功能，说明了高亮的实现原理。在实际应用中，我们的关键词多半不会是一个简简单单的“我”，而是一个List，下面我们将关键词改成：我，中华。只需稍加修改，就可以实现同时对“我”，“中华”两个关键词高亮\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cbody\x3e\n\x3cdiv\x3e\n  原文本：我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x3cbr \/\x3e\n  关键词: 我，中华 \x3cbr \/\x3e\n  结果如下：\x3cbr \/\x3e\x3cbr \/\x3e\n\x3c\/div\x3e\n\x3cdiv id=\x26quot;content\x26quot;\x3e\x3c\/div\x3e\n\n\x3cscript\x3e\n  const content = document.getElementById(\x27content\x27);\n  const text = \x27我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x27;\n  const keyword = [\x27我\x27, \x27中华\x27]; \/\/ 关键词是一个数组\n\n  \/\/ new RegExp(`(${keyword})` 改成 new RegExp(`(${keyword.join(\x27|\x27)})`\n  let hightlightText = text.replace(new RegExp(`(${keyword.join(\x27|\x27)})`, \x27g\x27), `\x3cspan class=\x26quot;keyword-match\x26quot;\x3e$1\x3c\/span\x3e`);\n\n  \/\/ 通过innerHTML写入匹配后的内容\n  content.innerHTML = hightlightText;\n\x3c\/script\x3e\n\x3c\/body\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  原文本：我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n  关键词: 我，中华 \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n  结果如下：\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e content = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27content\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e text = \x3cspan class=\x22hljs-string\x22\x3e\x27我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x27\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e keyword = [\x3cspan class=\x22hljs-string\x22\x3e\x27我\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27中华\x27\x3c\/span\x3e]; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 关键词是一个数组\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ new RegExp(`(${keyword})` 改成 new RegExp(`(${keyword.join(\x27|\x27)})`\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e hightlightText = text.replace(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eRegExp\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e`(\x3cspan class=\x22hljs-subst\x22\x3e${keyword.join(\x3cspan class=\x22hljs-string\x22\x3e\x27|\x27\x3c\/span\x3e)}\x3c\/span\x3e)`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27g\x27\x3c\/span\x3e), \x3cspan class=\x22hljs-string\x22\x3e`\x26lt;span class=\x22keyword-match\x22\x26gt;$1\x26lt;\/span\x26gt;`\x3c\/span\x3e);\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 通过innerHTML写入匹配后的内容\x3c\/span\x3e\n  content.innerHTML = hightlightText;\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行效果：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009956579?w=502\x26amp;h=123\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009956579?w=502\x26amp;h=123\x22 alt=\x22普通文本高亮\x22 title=\x22普通文本高亮\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e上面的代码似乎已经完美了。但如果我们将关键词改成：我，中华，中华人民共和国。再次运行看结果，会发现“中华人民共和国”这个关键词没有被高亮，而“中华”高亮了，但这并不是我们想要的结果。\x3c\/p\x3e\n\x3cp\x3e注意：\x3cstrong\x3e如果一个关键词包含另一个关键词，要优先高亮长度较长的词才对\x3c\/strong\x3e。要修复这个Bug也很简单，只需要将字数多的关键词放到关键词数组的最前面即可\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cbody\x3e\n\x3cdiv\x3e\n  原文本：我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x3cbr \/\x3e\n  关键词: 我，中华，中华人民共和国 \x3cbr \/\x3e\n  结果如下：\x3cbr \/\x3e\x3cbr \/\x3e\n\x3c\/div\x3e\n\x3cdiv id=\x26quot;content\x26quot;\x3e\x3c\/div\x3e\n\x3cdiv id=\x26quot;content2\x26quot;\x3e\x3c\/div\x3e\n\n\x3cscript\x3e\n  const content = document.getElementById(\x27content\x27);\n  const text = \x27我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x27;\n  const keyword = [\x27我\x27, \x27中华\x27, \x27中华人民共和国\x27]; \/\/ 关键词是一个数组\n\n  let hightlightText = text.replace(new RegExp(`(${keyword.join(\x27|\x27)})`, \x27g\x27), `\x3cspan class=\x26quot;keyword-match\x26quot;\x3e$1\x3c\/span\x3e`);\n\n  \/\/ 通过innerHTML写入匹配后的内容\n  content.innerHTML = hightlightText;\n\x3c\/script\x3e\n\n\x3cscript\x3e\n  const content2 = document.getElementById(\x27content2\x27);\n  const text2 = \x27我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x27;\n  const keyword2 = [\x27中华人民共和国\x27, \x27中华\x27, \x27我\x27]; \/\/ 将字数多的关键词放到前面，保证字数多的关键词优先匹配\n\n  let hightlightText2 = text.replace(new RegExp(`(${keyword2.join(\x27|\x27)})`, \x27g\x27), `\x3cspan class=\x26quot;keyword-match\x26quot;\x3e$1\x3c\/span\x3e`);\n\n  content2.innerHTML = hightlightText2;\n\x3c\/script\x3e\n\x3c\/body\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  原文本：我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n  关键词: 我，中华，中华人民共和国 \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n  结果如下：\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content2\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e content = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27content\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e text = \x3cspan class=\x22hljs-string\x22\x3e\x27我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x27\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e keyword = [\x3cspan class=\x22hljs-string\x22\x3e\x27我\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27中华\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27中华人民共和国\x27\x3c\/span\x3e]; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 关键词是一个数组\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e hightlightText = text.replace(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eRegExp\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e`(\x3cspan class=\x22hljs-subst\x22\x3e${keyword.join(\x3cspan class=\x22hljs-string\x22\x3e\x27|\x27\x3c\/span\x3e)}\x3c\/span\x3e)`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27g\x27\x3c\/span\x3e), \x3cspan class=\x22hljs-string\x22\x3e`\x26lt;span class=\x22keyword-match\x22\x26gt;$1\x26lt;\/span\x26gt;`\x3c\/span\x3e);\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 通过innerHTML写入匹配后的内容\x3c\/span\x3e\n  content.innerHTML = hightlightText;\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e content2 = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27content2\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e text2 = \x3cspan class=\x22hljs-string\x22\x3e\x27我是中国人，我爱中华人民共和国，中华人民共和国万岁！\x27\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e keyword2 = [\x3cspan class=\x22hljs-string\x22\x3e\x27中华人民共和国\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27中华\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27我\x27\x3c\/span\x3e]; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将字数多的关键词放到前面，保证字数多的关键词优先匹配\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e hightlightText2 = text.replace(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eRegExp\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e`(\x3cspan class=\x22hljs-subst\x22\x3e${keyword2.join(\x3cspan class=\x22hljs-string\x22\x3e\x27|\x27\x3c\/span\x3e)}\x3c\/span\x3e)`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27g\x27\x3c\/span\x3e), \x3cspan class=\x22hljs-string\x22\x3e`\x26lt;span class=\x22keyword-match\x22\x26gt;$1\x26lt;\/span\x26gt;`\x3c\/span\x3e);\n\n  content2.innerHTML = hightlightText2;\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e效果如下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009956580?w=496\x26amp;h=153\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009956580?w=496\x26amp;h=153\x22 alt=\x22匹配优先级问题\x22 title=\x22匹配优先级问题\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e富文本高亮\x3c\/h3\x3e\n\x3cp\x3e说完了普通文本的高亮，我们来说说富文本的高亮。所谓富文本，即待高亮的字符串不再是单独的文本，而是html代码。如果你需要富文本编辑器，可以考虑百度的UEditor，富文本编辑器生成的代码就是可以直接插入到页面的html串。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 普通文本\n我是中国人，我爱中华人民共和国，中华人民共和国万岁！\n\n\/\/ 富文本,即html串\n\x3cdiv\x3e我是\x3cspan style=\x26quot;font-size: 20px; font-weight: bold; background-color: cyan;\x26quot;\x3e中国人\x3c\/span\x3e，我爱中华人民共和国，中华人民共和国万岁！\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 普通文本\x3c\/span\x3e\n我是中国人，我爱中华人民共和国，中华人民共和国万岁！\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 富文本,即html串\x3c\/span\x3e\n\x3cspan class=\x22hljs-params\x22\x3e\x26lt;div\x26gt;\x3c\/span\x3e我是\x3cspan class=\x22hljs-params\x22\x3e\x26lt;span style=\x22font-size: \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3epx; font-weight: bold; background-color: cyan;\x22\x26gt;\x3c\/span\x3e中国人\x3cspan class=\x22hljs-params\x22\x3e\x26lt;\/span\x26gt;\x3c\/span\x3e，我爱中华人民共和国，中华人民共和国万岁！\x3cspan class=\x22hljs-params\x22\x3e\x26lt;\/div\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cbody\x3e\n富文本高亮\n\x3cbr \/\x3e\n\x3cbr \/\x3e\n\n\x3ch3\x3e未高亮\x3c\/h3\x3e\n\x3cdiv id=\x26quot;text\x26quot;\x3e\n  \x3cdiv style=\x26quot;font-style: italic;\x26quot;\x3e我是\x3cspan style=\x26quot;font-size: 20px; font-weight: bold; background-color: cyan;\x26quot;\x3e中国人\x3c\/span\x3e，我爱中华人民共和国，中华人民共和国万岁！\x3c\/div\x3e\n\x3c\/div\x3e\n\n\x3cbr \/\x3e\n\x3ch3\x3e高亮效果\x3c\/h3\x3e\n\x3cdiv id=\x26quot;content\x26quot;\x3e\x3c\/div\x3e\n\n\x3cscript\x3e\n  const content = document.getElementById(\x27content\x27);\n  const text = document.getElementById(\x27text\x27).innerHTML; \/\/ 富文本串\n  const keyword = [\x27中华人民共和国\x27, \x27中华\x27, \x27我\x27];\n\n  let hightlightText = text.replace(new RegExp(`(${keyword.join(\x27|\x27)})`, \x27g\x27), `\x3cspan class=\x26quot;keyword-match\x26quot;\x3e$1\x3c\/span\x3e`);\n\n  content.innerHTML = hightlightText;\n\x3c\/script\x3e\n\n\x3c\/body\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n富文本高亮\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e未高亮\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22font-style: italic;\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e我是\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22font-size: 20px; font-weight: bold; background-color: cyan;\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e中国人\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e，我爱中华人民共和国，中华人民共和国万岁！\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e高亮效果\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e content = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27content\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e text = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27text\x27\x3c\/span\x3e).innerHTML; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 富文本串\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e keyword = [\x3cspan class=\x22hljs-string\x22\x3e\x27中华人民共和国\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27中华\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27我\x27\x3c\/span\x3e];\n\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e hightlightText = text.replace(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eRegExp\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e`(\x3cspan class=\x22hljs-subst\x22\x3e${keyword.join(\x3cspan class=\x22hljs-string\x22\x3e\x27|\x27\x3c\/span\x3e)}\x3c\/span\x3e)`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27g\x27\x3c\/span\x3e), \x3cspan class=\x22hljs-string\x22\x3e`\x26lt;span class=\x22keyword-match\x22\x26gt;$1\x26lt;\/span\x26gt;`\x3c\/span\x3e);\n\n  content.innerHTML = hightlightText;\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009956581?w=533\x26amp;h=270\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009956581?w=533\x26amp;h=270\x22 alt=\x22富文本高亮\x22 title=\x22富文本高亮\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这里的高亮实现直接使用了前面普通文本高亮，似乎也能正常工作。但前提是这个富文本串太简单了。我们现在考虑这样一种情况，如果富文本串中的元素属性具有完全匹配关键词的内容，会发生什么呢？\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 待高亮富文本串\n\x3cdiv style=\x26quot;font-style: italic;\x26quot; data-attr=\x26quot;中华人民共和国\x26quot;\x3e我是\x3cspan style=\x26quot;font-size: 20px; font-weight: bold; background-color: cyan;\x26quot;\x3e中国人\x3c\/span\x3e，我爱中华人民共和国，中华人民共和国万岁！\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 待高亮富文本串\x3c\/span\x3e\n\x26lt;\x3cspan class=\x22hljs-selector-tag\x22\x3ediv\x3c\/span\x3e style=\x3cspan class=\x22hljs-string\x22\x3e\x22font-style: italic;\x22\x3c\/span\x3e data-attr=\x3cspan class=\x22hljs-string\x22\x3e\x22中华人民共和国\x22\x3c\/span\x3e\x26gt;我是\x26lt;\x3cspan class=\x22hljs-selector-tag\x22\x3espan\x3c\/span\x3e style=\x3cspan class=\x22hljs-string\x22\x3e\x22font-size: 20px; font-weight: bold; background-color: cyan;\x22\x3c\/span\x3e\x26gt;中国人\x26lt;\/span\x26gt;，我爱中华人民共和国，中华人民共和国万岁！\x26lt;\/div\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e对于上面的字符串，直接使用前面的高亮逻辑，得到的字符串是：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv style=\x26quot;font-style: italic;\x26quot; data-attr=\x26quot;\x3cspan class=\x26quot;keyword-match\x26quot;\x3e中华人民共和国\x3c\/span\x3e\x26quot;\x3e\x3cspan class=\x26quot;keyword-match\x26quot;\x3e我\x3c\/span\x3e是\x3cspan style=\x26quot;font-size: 20px; font-weight: bold; background-color: cyan;\x26quot;\x3e中国人\x3c\/span\x3e，\x3cspan class=\x26quot;keyword-match\x26quot;\x3e我\x3c\/span\x3e爱\x3cspan class=\x26quot;keyword-match\x26quot;\x3e中华人民共和国\x3c\/span\x3e，\x3cspan class=\x26quot;keyword-match\x26quot;\x3e中华人民共和国\x3c\/span\x3e万岁！\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22font-style: italic;\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edata-attr\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;span class=\x22\x3c\/span\x3e\x3cspan class=\x22hljs-attr\x22\x3ekeyword-match\x3c\/span\x3e\x22\x26gt;\x3c\/span\x3e中华人民共和国\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x22\x26gt;\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22keyword-match\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e我\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e是\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22font-size: 20px; font-weight: bold; background-color: cyan;\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e中国人\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e，\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22keyword-match\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e我\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e爱\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22keyword-match\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e中华人民共和国\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e，\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22keyword-match\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e中华人民共和国\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e万岁！\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e显然，第一个div属性中的“中华人民共和国”不应该被匹配到。如果直接匹配会破坏原来的富文本串，使之不再是一个有效的html串。这是富文本高亮的最大难题，那这个难题怎么解决呢？\x3c\/p\x3e\n\x3cp\x3e当然，第一反应可能就是改正则。但根据个人经验，\x3cstrong\x3e对于一个模式内包含自己时，正则几乎无能为力\x3c\/strong\x3e。比如下面我们常见的字符串结构：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 这是常见的less语法。现在如果要求使用正则将最未的选择器名称加上“$”，大家可以试一下，能否做到\n\/\/ 原串\n@media (max-width: 600px) {\n  .header {\n    .hd {\n      width: 100px;\n    }\n\n    .bd {\n      background-color: #fff;\n    }\n  }\n}\n\n\/\/ 要求结果\n@media (max-width: 600px) {\n  .header {\n    .hd$ { \/\/ 加上$\n      width: 100px;\n    }\n\n    .bd$ {\n      background-color: #fff;\n    }\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这是常见的less语法。现在如果要求使用正则将最未的选择器名称加上“$”，大家可以试一下，能否做到\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 原串\x3c\/span\x3e\n@media (\x3cspan class=\x22hljs-attribute\x22\x3emax-width\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e600px\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-selector-class\x22\x3e.header\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-selector-class\x22\x3e.hd\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e100px\x3c\/span\x3e;\n    }\n\n    \x3cspan class=\x22hljs-selector-class\x22\x3e.bd\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-attribute\x22\x3ebackground-color\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e#fff\x3c\/span\x3e;\n    }\n  }\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 要求结果\x3c\/span\x3e\n@media (\x3cspan class=\x22hljs-attribute\x22\x3emax-width\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e600px\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-selector-class\x22\x3e.header\x3c\/span\x3e {\n    .hd$ { \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 加上$\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e100px\x3c\/span\x3e;\n    }\n\n    .bd$ {\n      \x3cspan class=\x22hljs-attribute\x22\x3ebackground-color\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e#fff\x3c\/span\x3e;\n    }\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e对于富文本串，它也可能是模式自包含的字符串类型，比如\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 这是一个标准得不能再标准的html串了\n\x3cdiv data-html=\x26quot;\x3cdiv\x3ehello world!\x3c\/div\x3e\x26quot;\x3ehello world!\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs axapta\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这是一个标准得不能再标准的html串了\x3c\/span\x3e\n\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e data-html=\x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;div\x26gt;hello world!\x26lt;\/div\x26gt;\x22\x3c\/span\x3e\x26gt;hello world!\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果要使用正则去匹配上面字符串的hello内容，这个正则应该怎么写？先提醒一下，真正的富文本串要比这复杂太多太多,真实的用户输入也比这复杂太多太多。我当时做富文本高亮时，遇到这个问题也是一时找不到办法。某天，突然灵光一闪，不要硬碰硬啊，曲线救国嘛(这其实应该早就想到，只是走入正则的死胡同了)：如果能够先把富文本串中的html标签去掉，剩下的不就是普通文本了吗？匹配普通文本简直是不要太简单了哦。匹配完成后，再把去掉的html还原，就完成高亮匹配了。不过这里有几个难题：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e如何去掉html标签。别笑，这真心难，不信你试下\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e占位符一定要够特殊，不能在关键词匹配时被破坏\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e如何还原html串\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009956582?w=561\x26amp;h=103\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009956582?w=561\x26amp;h=103\x22 alt=\x22富文本高亮原理\x22 title=\x22富文本高亮原理\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e根据上面的思路，完成了新一版的高亮逻辑，代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22富文本高亮，关键词：[\x27中华人民共和国\x27, \x27中华\x27, \x27我\x27];\n\x3cbr \/\x3e\n\n\x3ch3\x3e未高亮\x3c\/h3\x3e\n\x3cdiv id=\x26quot;text\x26quot;\x3e\n  \x3cdiv style=\x26quot;font-style: italic;\x26quot; data-attr=\x26quot;中华人民共和国\x26quot;\x3e我是\x3cspan style=\x26quot;font-size: 20px; font-weight: bold; background-color: cyan;\x26quot;\x3e中国人\x3c\/span\x3e，我爱中华人民共和国，中华人民共和国万岁！\x3c\/div\x3e\n\x3c\/div\x3e\n\x3ch3\x3e高亮效果\x3c\/h3\x3e\n\x3cdiv id=\x26quot;content\x26quot;\x3e\x3c\/div\x3e\n\n\x3cscript\x3e\n  const content = document.getElementById(\x27content\x27);\n  const text = document.getElementById(\x27text\x27).innerHTML; \/\/ 富文本串\n  const keyword = [\x27中华人民共和国\x27, \x27中华\x27, \x27我\x27];\n\n  let hightlightText = hightlightKeyword(text, keyword.join(\x27|\x27));\n\n  content.innerHTML = hightlightText;\n\n  \/**\n   * 高亮\n   * @param input - 待高亮的富文本串\n   * @param keyword - 由关键词生成的匹配串，格式 \x27xxxx|xxx|x\x27\n   * @returns {string}\n   *\/\n  function hightlightKeyword(input, keyword) {\n    let store = {\n      length: 0\n    };\n\n    try {\n      return input\n          .replace(\/^\\s\x2b\/, \x27 \x27) \/\/ 去掉多余的空白\n\n          \/\/ 去掉Html标签，并使用特殊占位符占位，方便后面还原\n          .replace(\/(\x3c\\w\x2b[^\x3e]*?\x3e)|(\x3c\\\/\\w\x2b[^\x3e]*?\x3e)\/g, function(match) {\n            var key = \x27\\t\x27 \x2b store.length\x2b\x2b; \/\/ 注意这里使用了\\t\n\n            store[key] = match;\n            return key;\n          })\n\n          \/\/ 关键词高亮\n          .replace(new RegExp(\x27(\x27 \x2b keyword \x2b \x27)\x27, \x27gi\x27), \x27\x3cspan class=\x26quot;keyword-match\x26quot;\x3e\x27 \x2b \x27$1\x27 \x2b \x27\x3c\/span\x3e\x27)\n\n          \/\/ html标签还原\n          .replace(\/\\t\\d\x2b\/g, function(match) {\n            return store[match] || \x27\x27;\n          });\n    } catch (e) {\n      return input;\n    }\n  }\n\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e富文本高亮，关键词：[\x3cspan class=\x22hljs-string\x22\x3e\x27中华人民共和国\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27中华\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27我\x27\x3c\/span\x3e];\n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e未高亮\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22font-style: italic;\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edata-attr\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22中华人民共和国\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e我是\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22font-size: 20px; font-weight: bold; background-color: cyan;\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e中国人\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e，我爱中华人民共和国，中华人民共和国万岁！\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e高亮效果\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e content = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27content\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e text = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27text\x27\x3c\/span\x3e).innerHTML; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 富文本串\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e keyword = [\x3cspan class=\x22hljs-string\x22\x3e\x27中华人民共和国\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27中华\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27我\x27\x3c\/span\x3e];\n\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e hightlightText = hightlightKeyword(text, keyword.join(\x3cspan class=\x22hljs-string\x22\x3e\x27|\x27\x3c\/span\x3e));\n\n  content.innerHTML = hightlightText;\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * 高亮\n   * @param input - 待高亮的富文本串\n   * @param keyword - 由关键词生成的匹配串，格式 \x27xxxx|xxx|x\x27\n   * @returns {string}\n   *\/\x3c\/span\x3e\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ehightlightKeyword\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3einput, keyword\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e store = {\n      \x3cspan class=\x22hljs-attr\x22\x3elength\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n    };\n\n    \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e input\n          .replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/^\\s\x2b\/\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27 \x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 去掉多余的空白\x3c\/span\x3e\n\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 去掉Html标签，并使用特殊占位符占位，方便后面还原\x3c\/span\x3e\n          .replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/(\x26lt;\\w\x2b[^\x26gt;]*?\x26gt;)|(\x26lt;\\\/\\w\x2b[^\x26gt;]*?\x26gt;)\/g\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ematch\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e key = \x3cspan class=\x22hljs-string\x22\x3e\x27\\t\x27\x3c\/span\x3e \x2b store.length\x2b\x2b; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 注意这里使用了\\t\x3c\/span\x3e\n\n            store[key] = match;\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e key;\n          })\n\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 关键词高亮\x3c\/span\x3e\n          .replace(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eRegExp\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27(\x27\x3c\/span\x3e \x2b keyword \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27)\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27gi\x27\x3c\/span\x3e), \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;span class=\x22keyword-match\x22\x26gt;\x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27$1\x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/span\x26gt;\x27\x3c\/span\x3e)\n\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ html标签还原\x3c\/span\x3e\n          .replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\t\\d\x2b\/g\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ematch\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e store[match] || \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n          });\n    } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e input;\n    }\n  }\n\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的hightlightKeyword函数已经能够满足大多数情况下富文本高亮,博主曾经负责的一个项目，使用这个高亮逻辑安全运行1年多，也没出现大问题。但其实，上面的高亮逻辑还是有bug，对于一些十分特殊的富文本串还是存在问题，比如下面的富文本串\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv\x3e\n    \x3cdiv data-html=\x26quot;\x3cdiv\x3ehello world!\x3c\/div\x3e\x26quot;\x3e\n      hello world!\n      \x3cdiv data-html=\x26quot;\x3cdiv\x3ehello world!\x3c\/div\x3e\x26quot;\x3ehello world!\x3c\/div\x3e\n    \x3c\/div\x3e\n\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs applescript\x22\x3e\x3ccode\x3e\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n    \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e data-html=\x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;div\x26gt;hello world!\x26lt;\/div\x26gt;\x22\x3c\/span\x3e\x26gt;\n      hello world!\n      \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e data-html=\x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;div\x26gt;hello world!\x26lt;\/div\x26gt;\x22\x3c\/span\x3e\x26gt;hello world!\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n    \x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e经过多次尝试，碰壁，最后决定借用浏览器来将html转成DOM，通过DOM操作来完成高亮。下面是高亮终极版本\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cbody\x3e\n富文本高亮，关键词：[\x27中华人民共和国\x27, \x27中华\x27, \x27我\x27];\n\x3cbr \/\x3e\n\n\x3ch3\x3e未高亮\x3c\/h3\x3e\n\x3cdiv id=\x26quot;text\x26quot;\x3e\n  \x3cdiv data-html=\x26quot;\x3cdiv\x3ehello world!\x3c\/div\x3e\x26quot;\x3ehello world!\x3c\/div\x3e\n  \x3cdiv\x3e\n    \x3cdiv data-html=\x26quot;\x3cdiv\x3ehello world!\x3c\/div\x3e\x26quot;\x3e\n      hello world!\n      \x3cdiv data-html=\x26quot;\x3cdiv\x3ehello world!\x3c\/div\x3e\x26quot;\x3ehello world!\x3c\/div\x3e\n    \x3c\/div\x3e\n  \x3c\/div\x3e\n  \x3cdiv style=\x26quot;font-style: italic;\x26quot; data-attr=\x26quot;中华人民共和国\x26quot;\x3e\n    我是\n    \x3cspan style=\x26quot;font-size: 20px; font-weight: bold; background-color: cyan;\x26quot;\x3e中国人\x3c\/span\x3e\n    ，我爱中华人民共和国，中华人民共和国万岁！\n  \x3c\/div\x3e\n\x3c\/div\x3e\n\n\x3ch3\x3e高亮效果\x3c\/h3\x3e\n\x3cdiv id=\x26quot;content\x26quot;\x3e\x3c\/div\x3e\n\n\x3cscript\x3e\n  const content = document.getElementById(\x27content\x27);\n  const text = document.getElementById(\x27text\x27).innerHTML; \/\/ 富文本串\n  const keyword = [\x27中华人民共和国\x27, \x27hello\x27, \x27中华\x27, \x27我\x27];\n\n  let hightlightText = hightlightKeyword(text, keyword.join(\x27|\x27));\n\n  content.innerHTML = hightlightText;\n\n  \/**\n   * 借助浏览器完成高亮。\n   * 深度优先遍历所有的节点，对文本节点进行高亮\n   *\n   * @param input - 待高亮的富文本串\n   * @param keyword - 由关键词生成的匹配串，格式 \x27xxxx|xxx|x\x27\n   * @returns {string}\n   *\/\n\n  function hightlightKeyword(html, keyword) {\n    \/\/ 复制一个节点去进行遍历操作\n    let wrap = document.createElement(\x27div\x27);\n\n    wrap.innerHTML = html;\n\n    return DFSTraverseAndHightlight(wrap);\n\n    function DFSTraverseAndHightlight (node) {\n      const rootNodes = node.childNodes;\n      const childNodes = Array.from(rootNodes);\n\n      for(let i = 0, len = childNodes.length; i \x3c len; i\x2b\x2b) {\n        const node = childNodes[i];\n\n        \/\/ 文本节点，要进行高亮\n        if (node.nodeType === 3) {\n          let span = document.createElement(\x27span\x27);\n          let a = span.innerHTML = node.nodeValue.replace(new RegExp(`(${keyword})`, \x27g\x27), `\x3cspan class=\x26quot;keyword-match\x26quot;\x3e$1\x3c\/span\x3e`);\n          console.log(node.nodeValue);\n          node.parentNode.insertBefore(span, node);\n          node.parentNode.removeChild(node);\n        }\n\n        \/\/文本节点不会有childNodes属性，如果有子节点，继续遍历\n        if (node.childNodes.length) {\n          DFSTraverseAndHightlight(node);\n        }\n      }\n\n      return node.innerHTML;\n    }\n  }\n\n\x3c\/script\x3e\n\x3c\/body\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x26lt;body\x26gt;\n富文本高亮，关键词：[\x3cspan class=\x22hljs-string\x22\x3e\x27中华人民共和国\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27中华\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27我\x27\x3c\/span\x3e];\n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e未高亮\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edata-html\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;div\x26gt;hello world!\x26lt;\/div\x26gt;\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3ehello world!\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edata-html\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;div\x26gt;hello world!\x26lt;\/div\x26gt;\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      hello world!\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edata-html\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;div\x26gt;hello world!\x26lt;\/div\x26gt;\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3ehello world!\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22font-style: italic;\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edata-attr\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22中华人民共和国\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    我是\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22font-size: 20px; font-weight: bold; background-color: cyan;\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e中国人\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    ，我爱中华人民共和国，中华人民共和国万岁！\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e高亮效果\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e content = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27content\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e text = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27text\x27\x3c\/span\x3e).innerHTML; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 富文本串\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e keyword = [\x3cspan class=\x22hljs-string\x22\x3e\x27中华人民共和国\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27hello\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27中华\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27我\x27\x3c\/span\x3e];\n\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e hightlightText = hightlightKeyword(text, keyword.join(\x3cspan class=\x22hljs-string\x22\x3e\x27|\x27\x3c\/span\x3e));\n\n  content.innerHTML = hightlightText;\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * 借助浏览器完成高亮。\n   * 深度优先遍历所有的节点，对文本节点进行高亮\n   *\n   * @param input - 待高亮的富文本串\n   * @param keyword - 由关键词生成的匹配串，格式 \x27xxxx|xxx|x\x27\n   * @returns {string}\n   *\/\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ehightlightKeyword\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ehtml, keyword\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 复制一个节点去进行遍历操作\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e wrap = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e);\n\n    wrap.innerHTML = html;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e DFSTraverseAndHightlight(wrap);\n\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eDFSTraverseAndHightlight\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3enode\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e rootNodes = node.childNodes;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e childNodes = \x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.from(rootNodes);\n\n      \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, len = childNodes.length; i \x26lt; len; i\x2b\x2b) {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e node = childNodes[i];\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 文本节点，要进行高亮\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (node.nodeType === \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e) {\n          \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e span = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e);\n          \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e a = span.innerHTML = node.nodeValue.replace(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eRegExp\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e`(\x3cspan class=\x22hljs-subst\x22\x3e${keyword}\x3c\/span\x3e)`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27g\x27\x3c\/span\x3e), \x3cspan class=\x22hljs-string\x22\x3e`\x26lt;span class=\x22keyword-match\x22\x26gt;$1\x26lt;\/span\x26gt;`\x3c\/span\x3e);\n          \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(node.nodeValue);\n          node.parentNode.insertBefore(span, node);\n          node.parentNode.removeChild(node);\n        }\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/文本节点不会有childNodes属性，如果有子节点，继续遍历\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (node.childNodes.length) {\n          DFSTraverseAndHightlight(node);\n        }\n      }\n\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e node.innerHTML;\n    }\n  }\n\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e简单的分词实现\x3c\/h3\x3e\n\x3cp\x3e文章最开始说了，分词逻辑一般是后台通过专门的库来完成的。但其实，前端也可以自己实现一个简单的分词，只不过会产生许多无意义的词而已,思路大家一看就明白了\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 简单，粗暴分词\nfunction splitWord(word) {\n  var len = word.length,\n    splitWordList = word.split(\x27\x27); \/\/ 一字分组\n\n\n  \/\/ 分词\n  for(var i = 2; i \x3c= len; i\x2b\x2b) {\n    for (var j = 0; j \x2b i \x3c= len; j\x2b\x2b) {\n        splitWordList.push(word.slice(j, j\x2bi));\n    }\n  }\n\n  \/\/ 必须把长度最长的放到最前面，否则会造成匹配不全的情况\n  return splitWordList.reverse();\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 简单，粗暴分词\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esplitWord\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(word)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e len = word.length,\n    splitWordList = word.split(\x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 一字分组\x3c\/span\x3e\n\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 分词\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e; i \x26lt;= len; i\x2b\x2b) {\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e j = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; j \x2b i \x26lt;= len; j\x2b\x2b) {\n        splitWordList.push(word.slice(j, j\x2bi));\n    }\n  }\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 必须把长度最长的放到最前面，否则会造成匹配不全的情况\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e splitWordList.reverse();\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行效果\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009956583?w=659\x26amp;h=240\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009956583?w=659\x26amp;h=240\x22 alt=\x22简单分词\x22 title=\x22简单分词\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e小结\x3c\/h3\x3e\n\x3cp\x3e本文主要从前端的角度，介绍了如何实现高亮功能，包括普通文本高亮和富文本高亮。关键的知识点是：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e利用new RegExp(\x3ccode\x3e(${keyword})\x3c\/code\x3e, \x27g\x27)方式动态创建正则\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e利用str.replace(regexp, \x3ccode\x3e\x26lt;span class=\x22keyword-match\x22\x26gt;$1\x26lt;\/span\x26gt;\x3c\/code\x3e)为匹配加上高亮样式\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e最长的关键词一定要优先匹配，否则会造成匹配不全的情况\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e富文本匹配，用正则很难做到100%精确。但如果有浏览器环境，可以借助浏览器先将富文本串转换成DOM，通过DOM操作来实现一个更精确的富文本高亮\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e前端也可以自己实现分词，只不过会产生大量无意义词组而已\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e原文地址：\x3ca href=\x22http:\/\/www.u3xyz.com\/#\/detail\/22\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.u3xyz.com\/#\/detail\/22\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>前端高亮功能实现复盘</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009956571">https://segmentfault.com/a/1190000009956571</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/c37g4uz3oks/" target="_blank">https://alili.tech/archive/c37g4uz3oks/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>