<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="读Zepto源码之Event模块"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>读Zepto源码之Event模块 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/tkdm30w17sc/",
				"appid": "1613049289050283", 
				"title": "读Zepto源码之Event模块 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-08T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/ysd9q5bf50f/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/1jf1udvvivv/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2ftkdm30w17sc%2f&text=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bEvent%e6%a8%a1%e5%9d%97"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2ftkdm30w17sc%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2ftkdm30w17sc%2f&text=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bEvent%e6%a8%a1%e5%9d%97"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2ftkdm30w17sc%2f&title=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bEvent%e6%a8%a1%e5%9d%97"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2ftkdm30w17sc%2f&is_video=false&description=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bEvent%e6%a8%a1%e5%9d%97"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bEvent%e6%a8%a1%e5%9d%97&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2ftkdm30w17sc%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2ftkdm30w17sc%2f&title=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bEvent%e6%a8%a1%e5%9d%97"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftkdm30w17sc%2f&title=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bEvent%e6%a8%a1%e5%9d%97"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftkdm30w17sc%2f&title=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bEvent%e6%a8%a1%e5%9d%97"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftkdm30w17sc%2f&title=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bEvent%e6%a8%a1%e5%9d%97"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">读Zepto源码之Event模块</h1><div class="meta"><div class="postdate"><time datetime="2019-01-08" itemprop="datePublished">2019-01-08</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3eEvent 模块是 Zepto 必备的模块之一，由于对 Event Api 不太熟，Event 对象也比较复杂，所以乍一看 Event 模块的源码，有点懵，细看下去，其实也不太复杂。\x3c\/p\x3e\n\x3cp\x3e读Zepto源码系列文章已经放到了github上，欢迎star: \x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereading-zepto\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e源码版本\x3c\/h2\x3e\n\x3cp\x3e本文阅读的源码为 \x3ca href=\x22https:\/\/github.com\/madrobby\/zepto\/tree\/v1.2.0\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ezepto1.2.0\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e准备知识\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3efocus\/blur 的事件模拟\x3c\/h3\x3e\n\x3cp\x3e为什么要对 \x3ccode\x3efocus\x3c\/code\x3e 和 \x3ccode\x3eblur\x3c\/code\x3e 事件进行模拟呢？从 MDN 中可以看到， \x3ccode\x3efocus\x3c\/code\x3e 事件和 \x3ccode\x3eblur\x3c\/code\x3e 事件并不支持事件冒泡。不支持事件冒泡带来的直接后果是不能进行事件委托，所以需要对 \x3ccode\x3efocus\x3c\/code\x3e 和 \x3ccode\x3eblur\x3c\/code\x3e 事件进行模拟。\x3c\/p\x3e\n\x3cp\x3e除了 \x3ccode\x3efocus\x3c\/code\x3e 事件和 \x3ccode\x3eblur\x3c\/code\x3e 事件外，现代浏览器还支持 \x3ccode\x3efocusin\x3c\/code\x3e 事件和 \x3ccode\x3efocusout\x3c\/code\x3e 事件，他们和 \x3ccode\x3efocus\x3c\/code\x3e 事件及 \x3ccode\x3eblur\x3c\/code\x3e 事件的最主要区别是支持事件冒泡。因此可以用 \x3ccode\x3efocusin\x3c\/code\x3e 和模拟 \x3ccode\x3efocus\x3c\/code\x3e 事件的冒泡行为，用 \x3ccode\x3efocusout\x3c\/code\x3e 事件来模拟 \x3ccode\x3eblur\x3c\/code\x3e 事件的冒泡行为。\x3c\/p\x3e\n\x3cp\x3e我们可以通过以下代码来确定这四个事件的执行顺序：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cinput id=\x26quot;test\x26quot; type=\x26quot;text\x26quot; \/\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22test\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\x22\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const target = document.getElementById(\x27test\x27)\ntarget.addEventListener(\x27focusin\x27, () =\x3e {console.log(\x27focusin\x27)})\ntarget.addEventListener(\x27focus\x27, () =\x3e {console.log(\x27focus\x27)})\ntarget.addEventListener(\x27blur\x27, () =\x3e {console.log(\x27blur\x27)})\ntarget.addEventListener(\x27focusout\x27, () =\x3e {console.log(\x27focusout\x27)})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e target = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e)\ntarget.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27focusin\x27\x3c\/span\x3e, () =\x26gt; {\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27focusin\x27\x3c\/span\x3e)})\ntarget.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27focus\x27\x3c\/span\x3e, () =\x26gt; {\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27focus\x27\x3c\/span\x3e)})\ntarget.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27blur\x27\x3c\/span\x3e, () =\x26gt; {\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27blur\x27\x3c\/span\x3e)})\ntarget.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27focusout\x27\x3c\/span\x3e, () =\x26gt; {\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27focusout\x27\x3c\/span\x3e)})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在 \x3ccode\x3echrome59\x3c\/code\x3e下， \x3ccode\x3einput\x3c\/code\x3e 聚焦和失焦时，控制台会打印出如下结果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x27focus\x27\n\x27focusin\x27\n\x27blur\x27\n\x27focusout\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27focus\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e\x27focusin\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e\x27blur\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e\x27focusout\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看到，在此浏览器中，事件的执行顺序应该是 \x3ccode\x3efocus \x26gt; focusin \x26gt; blur \x26gt; focusout\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e关于这几个事件更详细的描述，可以查看：《\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000003942014\x22\x3e说说focus \/focusin \/focusout \/blur 事件\x3c\/a\x3e》\x3c\/p\x3e\n\x3cp\x3e关于事件的执行顺序，我测试的结果与文章所说的有点不太一样。感兴趣的可以点击这个链接测试下\x3ca href=\x22http:\/\/jsbin.com\/nizugazamo\/edit?html,js,console,output\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/jsbin.com\/nizugazamo\/edit?html,js,console,output\x3c\/a\x3e。不过我觉得执行顺序可以不必细究，可以将 \x3ccode\x3efocusin\x3c\/code\x3e 作为 \x3ccode\x3efocus\x3c\/code\x3e 事件的冒泡版本。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3emouseenter\/mouseleave 的事件模拟\x3c\/h3\x3e\n\x3cp\x3e跟 \x3ccode\x3efocus\x3c\/code\x3e 和 \x3ccode\x3eblur\x3c\/code\x3e 一样，\x3ccode\x3emouseenter\x3c\/code\x3e 和 \x3ccode\x3emouseleave\x3c\/code\x3e 也不支持事件的冒泡， 但是 \x3ccode\x3emouseover\x3c\/code\x3e 和 \x3ccode\x3emouseout\x3c\/code\x3e 支持事件冒泡，因此，这两个事件的冒泡处理也可以分别用 \x3ccode\x3emouseover\x3c\/code\x3e 和 \x3ccode\x3emouseout\x3c\/code\x3e 来模拟。\x3c\/p\x3e\n\x3cp\x3e在鼠标事件的 \x3ccode\x3eevent\x3c\/code\x3e 对象中，有一个 \x3ccode\x3erelatedTarget\x3c\/code\x3e 的属性，从 \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/MouseEvent\/relatedTarget\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMDN:MouseEvent.relatedTarget\x3c\/a\x3e 文档中，可以看到，\x3ccode\x3emouseover\x3c\/code\x3e 的 \x3ccode\x3erelatedTarget\x3c\/code\x3e 指向的是移到目标节点上时所离开的节点（ \x3ccode\x3eexited from\x3c\/code\x3e ），\x3ccode\x3emouseout\x3c\/code\x3e 的 \x3ccode\x3erelatedTarget\x3c\/code\x3e 所指向的是离开所在的节点后所进入的节点（ \x3ccode\x3e entered to\x3c\/code\x3e ）。\x3c\/p\x3e\n\x3cp\x3e另外 \x3ccode\x3emouseover\x3c\/code\x3e 事件会随着鼠标的移动不断触发，但是 \x3ccode\x3emouseenter\x3c\/code\x3e 事件只会在进入节点的那一刻触发一次。如果鼠标已经在目标节点上，那 \x3ccode\x3emouseover\x3c\/code\x3e 事件触发时的 \x3ccode\x3erelatedTarget\x3c\/code\x3e 为当前节点。\x3c\/p\x3e\n\x3cp\x3e因此，要模拟 \x3ccode\x3emouseenter\x3c\/code\x3e 或 \x3ccode\x3emouseleave\x3c\/code\x3e 事件，只需要确定触发 \x3ccode\x3emouseover\x3c\/code\x3e 或 \x3ccode\x3emouseout\x3c\/code\x3e 事件上的 \x3ccode\x3erelatedTarget\x3c\/code\x3e 不存在，或者 \x3ccode\x3erelatedTarget\x3c\/code\x3e 不为当前节点，并且不为当前节点的子节点，避免子节点事件冒泡的影响。\x3c\/p\x3e\n\x3cp\x3e关于 \x3ccode\x3emouseenter\x3c\/code\x3e 和 \x3ccode\x3emouseleave\x3c\/code\x3e 的模拟， \x3ca href=\x22https:\/\/github.com\/qianlongo\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e谦龙\x3c\/a\x3e 有篇文章《\x3ca href=\x22https:\/\/juejin.im\/post\/5935773fa0bb9f0058edbd61\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emouseenter与mouseover为何这般纠缠不清？\x3c\/a\x3e》写得很清楚，建议读一下。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3eEvent 模块的核心\x3c\/h2\x3e\n\x3cp\x3e将 \x3ccode\x3eEvent\x3c\/code\x3e 模块简化后如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22;(function($){})(Zepto)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e;(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e$\x3c\/span\x3e)\x3c\/span\x3e{})(Zepto)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其实就是向闭包中传入 \x3ccode\x3eZepto\x3c\/code\x3e 对象，然后对 \x3ccode\x3eZepto\x3c\/code\x3e 对象做一些扩展。\x3c\/p\x3e\n\x3cp\x3e在 \x3ccode\x3eEvent\x3c\/code\x3e 模块中，主要做了如下几件事：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e提供简洁的API\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e统一不同浏览器的 \x3ccode\x3eevent\x3c\/code\x3e 对象\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e事件句柄缓存池，方便手动触发事件和解绑事件。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e事件委托\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e内部方法\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3ezid\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var _zid = 1\nfunction zid(element) {\n  return element._zid || (element._zid = _zid\x2b\x2b)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _zid = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ezid\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eelement\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e element._zid || (element._zid = _zid\x2b\x2b)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e获取参数 \x3ccode\x3eelement\x3c\/code\x3e 对象的 \x3ccode\x3e_zid\x3c\/code\x3e 属性，如果属性不存在，则全局变量 \x3ccode\x3e_zid\x3c\/code\x3e 增加 \x3ccode\x3e1\x3c\/code\x3e ，作为 \x3ccode\x3eelement\x3c\/code\x3e 的 \x3ccode\x3e_zid\x3c\/code\x3e 的属性值返回。这个方法用来标记已经绑定过事件的元素，方便查找。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3eparse\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function parse(event) {\n  var parts = (\x27\x27 \x2b event).split(\x27.\x27)\n  return {e: parts[0], ns: parts.slice(1).sort().join(\x27 \x27)}\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eparse\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e parts = (\x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e \x2b event).split(\x3cspan class=\x22hljs-string\x22\x3e\x27.\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\x3cspan class=\x22hljs-attr\x22\x3ee\x3c\/span\x3e: parts[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e], \x3cspan class=\x22hljs-attr\x22\x3ens\x3c\/span\x3e: parts.slice(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e).sort().join(\x3cspan class=\x22hljs-string\x22\x3e\x27 \x27\x3c\/span\x3e)}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在 \x3ccode\x3ezepto\x3c\/code\x3e 中，支持事件的命名空间，可以用 \x3ccode\x3eeventType.ns1.ns2...\x3c\/code\x3e 的形式来给事件添加一个或多个命名空间。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eparse\x3c\/code\x3e 函数用来分解事件名和命名空间。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e\x27\x27 \x2b event\x3c\/code\x3e 是将 \x3ccode\x3eevent\x3c\/code\x3e 变成字符串，再以 \x3ccode\x3e.\x3c\/code\x3e 分割成数组。\x3c\/p\x3e\n\x3cp\x3e返回的对象中，\x3ccode\x3ee\x3c\/code\x3e 为事件名， \x3ccode\x3ens\x3c\/code\x3e 为排序后，以空格相连的命名空间字符串，形如 \x3ccode\x3ens1 ns2 ns3 ...\x3c\/code\x3e 的形式。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3ematcherFor\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function matcherFor(ns) {\n  return new RegExp(\x27(?:^| )\x27 \x2b ns.replace(\x27 \x27, \x27 .* ?\x27) \x2b \x27(?: |$)\x27)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ematcherFor\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ens\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eRegExp\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27(?:^| )\x27\x3c\/span\x3e \x2b ns.replace(\x3cspan class=\x22hljs-string\x22\x3e\x27 \x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27 .* ?\x27\x3c\/span\x3e) \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27(?: |$)\x27\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e生成匹配命名空间的表达式，例如，传进来的参数 \x3ccode\x3ens\x3c\/code\x3e 为 \x3ccode\x3ens1 ns2 ns3\x3c\/code\x3e ，最终生成的正则为 \x3ccode\x3e\/(?:^| )ns1.* ?ns2.* ?ns3(?: |$)\/\x3c\/code\x3e。至于有什么用，下面马上讲到。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3efindHandlers，查找缓存的句柄\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22handlers = {}\nfunction findHandlers(element, event, fn, selector) {\n  event = parse(event)\n  if (event.ns) var matcher = matcherFor(event.ns)\n  return (handlers[zid(element)] || []).filter(function(handler) {\n    return handler\n      \x26amp;\x26amp; (!event.e  || handler.e == event.e)\n      \x26amp;\x26amp; (!event.ns || matcher.test(handler.ns))\n      \x26amp;\x26amp; (!fn       || zid(handler.fn) === zid(fn))\n      \x26amp;\x26amp; (!selector || handler.sel == selector)\n  })\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ehandlers = {}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efindHandlers\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eelement, event, fn, selector\x3c\/span\x3e) \x3c\/span\x3e{\n  event = parse(event)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.ns) \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e matcher = matcherFor(event.ns)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (handlers[zid(element)] || []).filter(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ehandler\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e handler\n      \x26amp;\x26amp; (!event.e  || handler.e == event.e)\n      \x26amp;\x26amp; (!event.ns || matcher.test(handler.ns))\n      \x26amp;\x26amp; (!fn       || zid(handler.fn) === zid(fn))\n      \x26amp;\x26amp; (!selector || handler.sel == selector)\n  })\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e查找元素对应的事件句柄。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22event = parse(event)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eevent = parse(event)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e调用 \x3ccode\x3eparse\x3c\/code\x3e 函数，分隔出 \x3ccode\x3eevent\x3c\/code\x3e 参数的事件名和命名空间。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (event.ns) var matcher = matcherFor(event.ns)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.ns) \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e matcher = matcherFor(event.ns)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果命名空间存在，则生成匹配该命名空间的正则表达式 \x3ccode\x3ematcher\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22return (handlers[zid(element)] || []).filter(function(handler) {\n    ...\n  })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (handlers[zid(element)] || []).filter(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ehandler\x3c\/span\x3e) \x3c\/span\x3e{\n    ...\n  })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e返回的其实是 \x3ccode\x3ehandlers[zid(element)]\x3c\/code\x3e 中符合条件的句柄函数。 \x3ccode\x3ehandlers\x3c\/code\x3e 是缓存的句柄容器，用 \x3ccode\x3eelement\x3c\/code\x3e 的 \x3ccode\x3e_zid\x3c\/code\x3e 属性值作为 \x3ccode\x3ekey\x3c\/code\x3e 。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22return handler  \/\/ 条件1\n     \x26amp;\x26amp; (!event.e  || handler.e == event.e) \/\/ 条件2\n     \x26amp;\x26amp; (!event.ns || matcher.test(handler.ns)) \/\/ 条件3\n     \x26amp;\x26amp; (!fn       || zid(handler.fn) === zid(fn)) \/\/ 条件4\n     \x26amp;\x26amp; (!selector || handler.sel == selector) \/\/ 条件5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e handler  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 条件1\x3c\/span\x3e\n     \x26amp;\x26amp; (!event.e  || handler.e == event.e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 条件2\x3c\/span\x3e\n     \x26amp;\x26amp; (!event.ns || matcher.test(handler.ns)) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 条件3\x3c\/span\x3e\n     \x26amp;\x26amp; (!fn       || zid(handler.fn) === zid(fn)) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 条件4\x3c\/span\x3e\n     \x26amp;\x26amp; (!selector || handler.sel == selector) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 条件5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e返回的句柄必须满足5个条件：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e句柄必须存在\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e如果 \x3ccode\x3eevent.e\x3c\/code\x3e 存在，则句柄的事件名必须与 \x3ccode\x3eevent\x3c\/code\x3e 的事件名一致\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e如果命名空间存在，则句柄的命名空间必须要与事件的命名空间匹配（ \x3ccode\x3ematcherFor\x3c\/code\x3e 的作用 ）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e如果指定匹配的事件句柄为 \x3ccode\x3efn\x3c\/code\x3e ，则当前句柄 \x3ccode\x3ehandler\x3c\/code\x3e 的 \x3ccode\x3e_zid\x3c\/code\x3e 必须与指定的句柄 \x3ccode\x3efn\x3c\/code\x3e 相一致\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e如果指定选择器 \x3ccode\x3eselector\x3c\/code\x3e ，则当前句柄中的选择器必须与指定的选择器一致\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e从上面的比较可以看到，缓存的句柄对象的形式如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  fn: \x27\x27, \/\/ 函数\n  e: \x27\x27, \/\/ 事件名\n  ns: \x27\x27, \/\/ 命名空间\n  sel: \x27\x27,  \/\/ 选择器\n  \/\/ 除此之外，其实还有\n  i: \x27\x27, \/\/ 函数索引\n  del: \x27\x27, \/\/ 委托函数\n  proxy: \x27\x27, \/\/ 代理函数\n  \/\/ 后面这几个属性会讲到\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3efn\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 函数\x3c\/span\x3e\n  e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 事件名\x3c\/span\x3e\n  ns: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 命名空间\x3c\/span\x3e\n  sel: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 选择器\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 除此之外，其实还有\x3c\/span\x3e\n  i: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 函数索引\x3c\/span\x3e\n  del: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 委托函数\x3c\/span\x3e\n  proxy: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 代理函数\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 后面这几个属性会讲到\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3erealEvent，返回对应的冒泡事件\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22focusinSupported = \x27onfocusin\x27 in window,\nfocus = { focus: \x27focusin\x27, blur: \x27focusout\x27 },\nhover = { mouseenter: \x27mouseover\x27, mouseleave: \x27mouseout\x27 }\nfunction realEvent(type) {\n  return hover[type] || (focusinSupported \x26amp;\x26amp; focus[type]) || type\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3efocusinSupported = \x3cspan class=\x22hljs-string\x22\x3e\x27onfocusin\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e,\nfocus = { \x3cspan class=\x22hljs-attr\x22\x3efocus\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27focusin\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3eblur\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27focusout\x27\x3c\/span\x3e },\nhover = { \x3cspan class=\x22hljs-attr\x22\x3emouseenter\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27mouseover\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3emouseleave\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27mouseout\x27\x3c\/span\x3e }\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erealEvent\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etype\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e hover[type] || (focusinSupported \x26amp;\x26amp; focus[type]) || type\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个函数其实是将 \x3ccode\x3efocus\/blur\x3c\/code\x3e 转换成 \x3ccode\x3efocusin\/focusout\x3c\/code\x3e ，将 \x3ccode\x3emouseenter\/mouseleave\x3c\/code\x3e 转换成 \x3ccode\x3emouseover\/mouseout\x3c\/code\x3e 事件。\x3c\/p\x3e\n\x3cp\x3e由于 \x3ccode\x3efocusin\/focusout\x3c\/code\x3e 事件浏览器支持程度还不是很好，因此要对浏览器支持做一个检测，如果浏览器支持，则返回，否则，返回原事件名。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3ecompatible，修正event对象\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22returnTrue = function(){return true},\nreturnFalse = function(){return false},\neventMethods = {\n  preventDefault: \x27isDefaultPrevented\x27,\n  stopImmediatePropagation: \x27isImmediatePropagationStopped\x27,\n  stopPropagation: \x27isPropagationStopped\x27\n}\n\nfunction compatible(event, source) {\n  if (source || !event.isDefaultPrevented) {\n    source || (source = event)\n\n    $.each(eventMethods, function(name, predicate) {\n      var sourceMethod = source[name]\n      event[name] = function(){\n        this[predicate] = returnTrue\n        return sourceMethod \x26amp;\x26amp; sourceMethod.apply(source, arguments)\n      }\n      event[predicate] = returnFalse\n    })\n\n    try {\n      event.timeStamp || (event.timeStamp = Date.now())\n    } catch (ignored) { }\n\n    if (source.defaultPrevented !== undefined ? source.defaultPrevented :\n        \x27returnValue\x27 in source ? source.returnValue === false :\n        source.getPreventDefault \x26amp;\x26amp; source.getPreventDefault())\n      event.isDefaultPrevented = returnTrue\n      }\n  return event\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ereturnTrue = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e},\nreturnFalse = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e},\neventMethods = {\n  \x3cspan class=\x22hljs-attr\x22\x3epreventDefault\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27isDefaultPrevented\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3estopImmediatePropagation\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27isImmediatePropagationStopped\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3estopPropagation\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27isPropagationStopped\x27\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecompatible\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent, source\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (source || !event.isDefaultPrevented) {\n    source || (source = event)\n\n    $.each(eventMethods, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ename, predicate\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sourceMethod = source[name]\n      event[name] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e[predicate] = returnTrue\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sourceMethod \x26amp;\x26amp; sourceMethod.apply(source, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)\n      }\n      event[predicate] = returnFalse\n    })\n\n    \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n      event.timeStamp || (event.timeStamp = \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e.now())\n    } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (ignored) { }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (source.defaultPrevented !== \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e ? source.defaultPrevented :\n        \x3cspan class=\x22hljs-string\x22\x3e\x27returnValue\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e source ? source.returnValue === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e :\n        source.getPreventDefault \x26amp;\x26amp; source.getPreventDefault())\n      event.isDefaultPrevented = returnTrue\n      }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e event\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3ecompatible\x3c\/code\x3e 函数用来修正 \x3ccode\x3eevent\x3c\/code\x3e 对象的浏览器差异，向 \x3ccode\x3eevent\x3c\/code\x3e 对象中添加了 \x3ccode\x3eisDefaultPrevented\x3c\/code\x3e、\x3ccode\x3eisImmediatePropagationStopped\x3c\/code\x3e、\x3ccode\x3eisPropagationStopped\x3c\/code\x3e 几个方法，对不支持 \x3ccode\x3etimeStamp\x3c\/code\x3e 的浏览器，向 \x3ccode\x3eevent\x3c\/code\x3e 对象中添加 \x3ccode\x3etimeStamp\x3c\/code\x3e 属性。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (source || !event.isDefaultPrevented) {\n  source || (source = event)\n\n  $.each(eventMethods, function(name, predicate) {\n    var sourceMethod = source[name]\n    event[name] = function(){\n      this[predicate] = returnTrue\n      return sourceMethod \x26amp;\x26amp; sourceMethod.apply(source, arguments)\n    }\n    event[predicate] = returnFalse\n  })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (source || !event.isDefaultPrevented) {\n  source || (source = event)\n\n  $.each(eventMethods, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ename, predicate\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sourceMethod = source[name]\n    event[name] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e[predicate] = returnTrue\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sourceMethod \x26amp;\x26amp; sourceMethod.apply(source, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)\n    }\n    event[predicate] = returnFalse\n  })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e判断条件是，原事件对象存在，或者事件 \x3ccode\x3eevent\x3c\/code\x3e 的 \x3ccode\x3eisDefaultPrevented\x3c\/code\x3e 不存在时成立。\x3c\/p\x3e\n\x3cp\x3e如果 \x3ccode\x3esource\x3c\/code\x3e 不存在，则将 \x3ccode\x3eevent\x3c\/code\x3e 赋值给 \x3ccode\x3esource\x3c\/code\x3e， 作为原事件对象。\x3c\/p\x3e\n\x3cp\x3e遍历 \x3ccode\x3eeventMethods\x3c\/code\x3e ，获得原事件对象的对应方法名 \x3ccode\x3esourceMethod\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22event[name] = function(){\n  this[predicate] = returnTrue\n  return sourceMethod \x26amp;\x26amp; sourceMethod.apply(source, arguments)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eevent[name] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e[predicate] = returnTrue\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sourceMethod \x26amp;\x26amp; sourceMethod.apply(source, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e改写 \x3ccode\x3eevent\x3c\/code\x3e 对象相应的方法，如果执行对应的方法时，先将事件中方法所对应的新方法赋值为 \x3ccode\x3ereturnTrue\x3c\/code\x3e 函数 ，例如执行 \x3ccode\x3epreventDefault\x3c\/code\x3e 方法时， \x3ccode\x3eisDefaultPrevented\x3c\/code\x3e 方法的返回值为 \x3ccode\x3etrue\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22event[predicate] = returnFalse\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eevent[predicate] = returnFalse\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这是将新添加的属性，初始化为 \x3ccode\x3ereturnFalse\x3c\/code\x3e 方法\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22try {\n  event.timeStamp || (event.timeStamp = Date.now())\n} catch (ignored) { }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n  event.timeStamp || (event.timeStamp = \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e.now())\n} \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (ignored) { }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这段向不支持 \x3ccode\x3etimeStamp\x3c\/code\x3e 属性的浏览器中添加 \x3ccode\x3etimeStamp\x3c\/code\x3e 属性。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (source.defaultPrevented !== undefined ? source.defaultPrevented :\n    \x27returnValue\x27 in source ? source.returnValue === false :\n    source.getPreventDefault \x26amp;\x26amp; source.getPreventDefault())\n  event.isDefaultPrevented = returnTrue\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (source.defaultPrevented !== \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e ? source.defaultPrevented :\n    \x3cspan class=\x22hljs-string\x22\x3e\x27returnValue\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e source ? source.returnValue === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e :\n    source.getPreventDefault \x26amp;\x26amp; source.getPreventDefault())\n  event.isDefaultPrevented = returnTrue\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这是对浏览器 \x3ccode\x3epreventDefault\x3c\/code\x3e 不同实现的兼容。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22source.defaultPrevented !== undefined ? source.defaultPrevented : \x27三元表达式\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3esource.defaultPrevented !== \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e ? source.defaultPrevented : \x3cspan class=\x22hljs-string\x22\x3e\x27三元表达式\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果浏览器支持 \x3ccode\x3edefaultPrevented\x3c\/code\x3e， 则返回 \x3ccode\x3edefaultPrevented\x3c\/code\x3e 的值\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x27returnValue\x27 in source ? source.returnValue === false : \x27后一个判断\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27returnValue\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e source ? source.returnValue === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27后一个判断\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3ereturnValue\x3c\/code\x3e 默认为 \x3ccode\x3etrue\x3c\/code\x3e，如果阻止了浏览器的默认行为， \x3ccode\x3ereturnValue\x3c\/code\x3e 会变为 \x3ccode\x3efalse\x3c\/code\x3e 。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22source.getPreventDefault \x26amp;\x26amp; source.getPreventDefault()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3esource.getPreventDefault \x26amp;\x26amp; source.getPreventDefault()\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果浏览器支持 \x3ccode\x3egetPreventDefault\x3c\/code\x3e 方法，则调用 \x3ccode\x3egetPreventDefault()\x3c\/code\x3e 方法获取是否阻止浏览器的默认行为。\x3c\/p\x3e\n\x3cp\x3e判断为 \x3ccode\x3etrue\x3c\/code\x3e 的时候，将 \x3ccode\x3eisDefaultPrevented\x3c\/code\x3e 设置为 \x3ccode\x3ereturnTrue\x3c\/code\x3e 方法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3ecreateProxy，创建代理对象\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ignoreProperties = \/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)\/,\nfunction createProxy(event) {\n  var key, proxy = { originalEvent: event }\n  for (key in event)\n    if (!ignoreProperties.test(key) \x26amp;\x26amp; event[key] !== undefined) proxy[key] = event[key]\n\n    return compatible(proxy, event)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eignoreProperties = \x3cspan class=\x22hljs-regexp\x22\x3e\/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)\/\x3c\/span\x3e,\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecreateProxy\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e key, proxy = { \x3cspan class=\x22hljs-attr\x22\x3eoriginalEvent\x3c\/span\x3e: event }\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (key \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e event)\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!ignoreProperties.test(key) \x26amp;\x26amp; event[key] !== \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e) proxy[key] = event[key]\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e compatible(proxy, event)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3ezepto\x3c\/code\x3e 中，事件触发的时候，返回给我们的 \x3ccode\x3eevent\x3c\/code\x3e 都不是原生的 \x3ccode\x3eevent\x3c\/code\x3e 对象，都是代理对象，这个就是代理对象的创建方法。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eignoreProperties\x3c\/code\x3e 用来排除 \x3ccode\x3eA-Z\x3c\/code\x3e 开头，即所有大写字母开头的属性，还有以\x3ccode\x3ereturnValue\x3c\/code\x3e 结尾，\x3ccode\x3elayerX\/layerY\x3c\/code\x3e ，\x3ccode\x3ewebkitMovementX\/webkitMovementY\x3c\/code\x3e 结尾的非标准属性。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22for (key in event)\n  if (!ignoreProperties.test(key) \x26amp;\x26amp; event[key] !== undefined) proxy[key] = event[key]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (key \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e event)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!ignoreProperties.test(key) \x26amp;\x26amp; event[key] !== \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e) proxy[key] = event[key]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e遍历原生事件对象，排除掉不需要的属性和值为 \x3ccode\x3eundefined\x3c\/code\x3e 的属性，将属性和值复制到代理对象上。\x3c\/p\x3e\n\x3cp\x3e最终返回的是修正后的代理对象\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3eeventCapture\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function eventCapture(handler, captureSetting) {\n  return handler.del \x26amp;\x26amp;\n    (!focusinSupported \x26amp;\x26amp; (handler.e in focus)) ||\n    !!captureSetting\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eeventCapture\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ehandler, captureSetting\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e handler.del \x26amp;\x26amp;\n    (!focusinSupported \x26amp;\x26amp; (handler.e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e focus)) ||\n    !!captureSetting\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e返回 \x3ccode\x3etrue\x3c\/code\x3e 表示在捕获阶段执行事件句柄，否则在冒泡阶段执行。\x3c\/p\x3e\n\x3cp\x3e如果存在事件代理，并且事件为 \x3ccode\x3efocus\/blur\x3c\/code\x3e 事件，在浏览器不支持 \x3ccode\x3efocusin\/focusout\x3c\/code\x3e 事件时，设置为 \x3ccode\x3etrue\x3c\/code\x3e ， 在捕获阶段处理事件，间接达到冒泡的目的。\x3c\/p\x3e\n\x3cp\x3e否则作用自定义的 \x3ccode\x3ecaptureSetting\x3c\/code\x3e 设置事件执行的时机。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3eadd，Event 模块的核心方法\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function add(element, events, fn, data, selector, delegator, capture){\n  var id = zid(element), set = (handlers[id] || (handlers[id] = []))\n  events.split(\/\\s\/).forEach(function(event){\n    if (event == \x27ready\x27) return $(document).ready(fn)\n    var handler   = parse(event)\n    handler.fn    = fn\n    handler.sel   = selector\n    \/\/ emulate mouseenter, mouseleave\n    if (handler.e in hover) fn = function(e){\n      var related = e.relatedTarget\n      if (!related || (related !== this \x26amp;\x26amp; !$.contains(this, related)))\n        return handler.fn.apply(this, arguments)\n        }\n    handler.del   = delegator\n    var callback  = delegator || fn\n    handler.proxy = function(e){\n      e = compatible(e)\n      if (e.isImmediatePropagationStopped()) return\n      e.data = data\n      var result = callback.apply(element, e._args == undefined ? [e] : [e].concat(e._args))\n      if (result === false) e.preventDefault(), e.stopPropagation()\n      return result\n    }\n    handler.i = set.length\n    set.push(handler)\n    if (\x27addEventListener\x27 in element)\n      element.addEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))\n      })\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eelement, events, fn, data, selector, delegator, capture\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e id = zid(element), set = (handlers[id] || (handlers[id] = []))\n  events.split(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\s\/\x3c\/span\x3e).forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event == \x3cspan class=\x22hljs-string\x22\x3e\x27ready\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e).ready(fn)\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e handler   = parse(event)\n    handler.fn    = fn\n    handler.sel   = selector\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ emulate mouseenter, mouseleave\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (handler.e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e hover) fn = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e related = e.relatedTarget\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!related || (related !== \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e \x26amp;\x26amp; !$.contains(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, related)))\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e handler.fn.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)\n        }\n    handler.del   = delegator\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e callback  = delegator || fn\n    handler.proxy = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n      e = compatible(e)\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e.isImmediatePropagationStopped()) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n      e.data = data\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e result = callback.apply(element, e._args == \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e ? [e] : [e].concat(e._args))\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (result === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e) e.preventDefault(), e.stopPropagation()\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e result\n    }\n    handler.i = set.length\n    set.push(handler)\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27addEventListener\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e element)\n      element.addEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))\n      })\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eadd\x3c\/code\x3e 方法是向元素添加事件及事件响应，参数比较多，先来看看各参数的含义：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22element \/\/ 事件绑定的元素\nevents \/\/ 需要绑定的事件列表\nfn \/\/ 事件执行时的句柄\ndata \/\/ 事件执行时，传递给事件对象的数据\nselector \/\/ 事件绑定元素的选择器\ndelegator \/\/ 事件委托函数 \ncapture \/\/ 那个阶段执行事件句柄\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eelement \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 事件绑定的元素\x3c\/span\x3e\nevents \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 需要绑定的事件列表\x3c\/span\x3e\nfn \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 事件执行时的句柄\x3c\/span\x3e\ndata \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 事件执行时，传递给事件对象的数据\x3c\/span\x3e\nselector \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 事件绑定元素的选择器\x3c\/span\x3e\ndelegator \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 事件委托函数 \x3c\/span\x3e\ncapture \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 那个阶段执行事件句柄\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var id = zid(element), set = (handlers[id] || (handlers[id] = []))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e id = zid(element), set = (handlers[id] || (handlers[id] = []))\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e获取或设置 \x3ccode\x3eid\x3c\/code\x3e ， \x3ccode\x3eset\x3c\/code\x3e 为事件句柄容器。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22events.split(\/\\s\/).forEach(function(event){})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eevents.split(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\s\/\x3c\/span\x3e).forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e)\x3c\/span\x3e{})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e对每个事件进行处理\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (event == \x27ready\x27) return $(document).ready(fn)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event == \x3cspan class=\x22hljs-string\x22\x3e\x27ready\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e).ready(fn)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果为 \x3ccode\x3eready\x3c\/code\x3e 事件，则调用 \x3ccode\x3eready\x3c\/code\x3e 方法，中止后续的执行\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var handler   = parse(event)\nhandler.fn    = fn\nhandler.sel   = selector\n\/\/ emulate mouseenter, mouseleave\nif (handler.e in hover) fn = function(e){\n  var related = e.relatedTarget\n  if (!related || (related !== this \x26amp;\x26amp; !$.contains(this, related)))\n    return handler.fn.apply(this, arguments)\n    }\nhandler.del   = delegator\nvar callback  = delegator || fn\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e handler   = parse(event)\nhandler.fn    = fn\nhandler.sel   = selector\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ emulate mouseenter, mouseleave\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (handler.e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e hover) fn = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e related = e.relatedTarget\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!related || (related !== \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e \x26amp;\x26amp; !$.contains(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, related)))\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e handler.fn.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)\n    }\nhandler.del   = delegator\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e callback  = delegator || fn\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这段代码是设置 \x3ccode\x3ehandler\x3c\/code\x3e 上的一些属性，缓存起来。\x3c\/p\x3e\n\x3cp\x3e这里主要看对 \x3ccode\x3emouseenter\x3c\/code\x3e 和 \x3ccode\x3emouseleave\x3c\/code\x3e 事件的模拟，具体的原理上面已经说过，只有在条件成立的时候才会执行事件句柄。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22handler.proxy = function(e){\n  e = compatible(e)\n  if (e.isImmediatePropagationStopped()) return\n  e.data = data\n  var result = callback.apply(element, e._args == undefined ? [e] : [e].concat(e._args))\n  if (result === false) e.preventDefault(), e.stopPropagation()\n  return result\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ehandler.proxy = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  e = compatible(e)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e.isImmediatePropagationStopped()) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  e.data = data\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e result = callback.apply(element, e._args == \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e ? [e] : [e].concat(e._args))\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (result === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e) e.preventDefault(), e.stopPropagation()\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e result\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e事件句柄的代理函数。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ee\x3c\/code\x3e 为事件执行时的原生 \x3ccode\x3eevent\x3c\/code\x3e 对象，因此先调用 \x3ccode\x3ecompatible\x3c\/code\x3e 对 \x3ccode\x3ee\x3c\/code\x3e 进行修正。\x3c\/p\x3e\n\x3cp\x3e调用 \x3ccode\x3eisImmediatePropagationStopped\x3c\/code\x3e 方法，看是否已经执行过 \x3ccode\x3estopImmediatePropagation\x3c\/code\x3e 方法，如果已经执行，则中止后续程序的执行。\x3c\/p\x3e\n\x3cp\x3e再扩展 \x3ccode\x3ee\x3c\/code\x3e 对象，将 \x3ccode\x3edata\x3c\/code\x3e 存到 \x3ccode\x3ee\x3c\/code\x3e 的 \x3ccode\x3edata\x3c\/code\x3e 属性上。\x3c\/p\x3e\n\x3cp\x3e执行事件句柄，将 \x3ccode\x3ee\x3c\/code\x3e 对象作为句柄的第一个参数。\x3c\/p\x3e\n\x3cp\x3e如果执行完毕后，显式返回 \x3ccode\x3efalse\x3c\/code\x3e，则阻止浏览器的默认行为和事件冒泡。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22set.push(handler)\nif (\x27addEventListener\x27 in element)\n  element.addEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eset.push(handler)\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27addEventListener\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e element)\n  element.addEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e将句柄存入句柄容器\x3c\/p\x3e\n\x3cp\x3e调用元素的 \x3ccode\x3eaddEventListener\x3c\/code\x3e 方法，添加事件，事件的回调函数用的是句柄的代理函数，\x3ccode\x3eeventCapture(handler, capture)\x3c\/code\x3e 来用指定是否在捕获阶段执行。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader15\x22\x3eremove，删除事件\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function remove(element, events, fn, selector, capture){\n  var id = zid(element)\n  ;(events || \x27\x27).split(\/\\s\/).forEach(function(event){\n    findHandlers(element, event, fn, selector).forEach(function(handler){\n      delete handlers[id][handler.i]\n      if (\x27removeEventListener\x27 in element)\n        element.removeEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))\n        })\n  })\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eremove\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eelement, events, fn, selector, capture\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e id = zid(element)\n  ;(events || \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e).split(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\s\/\x3c\/span\x3e).forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e)\x3c\/span\x3e{\n    findHandlers(element, event, fn, selector).forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ehandler\x3c\/span\x3e)\x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3edelete\x3c\/span\x3e handlers[id][handler.i]\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27removeEventListener\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e element)\n        element.removeEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))\n        })\n  })\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e首先获取指定元素的 \x3ccode\x3e_zid\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22;(events || \x27\x27).split(\/\\s\/).forEach(function(event){})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e;(events || \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e).split(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\s\/\x3c\/span\x3e).forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e)\x3c\/span\x3e{})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e遍历需要删除的 \x3ccode\x3eevents\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22findHandlers(element, event, fn, selector).forEach(function(handler){})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3efindHandlers(element, event, fn, selector).forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ehandler\x3c\/span\x3e)\x3c\/span\x3e{})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e调用 \x3ccode\x3efindHandlers\x3c\/code\x3e 方法，查找 \x3ccode\x3eevent\x3c\/code\x3e 下需要删除的事件句柄\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22delete handlers[id][handler.i]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3edelete\x3c\/span\x3e handlers[id][handler.i]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e删除句柄容器中对应的事件，在 \x3ccode\x3eadd\x3c\/code\x3e 函数中的句柄对象中的 \x3ccode\x3ei\x3c\/code\x3e 属性就用在这里了，方便查找需要删除的句柄。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22element.removeEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eelement.removeEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e调用 \x3ccode\x3eremoveEventListener\x3c\/code\x3e 方法，删除对应的事件。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader16\x22\x3e工具函数\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader17\x22\x3e$.event\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.event = { add: add, remove: remove }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e$.event = { \x3cspan class=\x22hljs-attr\x22\x3eadd\x3c\/span\x3e: add, \x3cspan class=\x22hljs-attr\x22\x3eremove\x3c\/span\x3e: remove }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e将 \x3ccode\x3eadd\x3c\/code\x3e 方法和 \x3ccode\x3eremove\x3c\/code\x3e 方法暴露出去，应该是方便第三方插件做扩展\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader18\x22\x3e$.proxy\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.proxy = function(fn, context) {\n  var args = (2 in arguments) \x26amp;\x26amp; slice.call(arguments, 2)\n  if (isFunction(fn)) {\n    var proxyFn = function(){ return fn.apply(context, args ? args.concat(slice.call(arguments)) : arguments) }\n    proxyFn._zid = zid(fn)\n    return proxyFn\n  } else if (isString(context)) {\n    if (args) {\n      args.unshift(fn[context], fn)\n      return $.proxy.apply(null, args)\n    } else {\n      return $.proxy(fn[context], fn)\n    }\n  } else {\n    throw new TypeError(\x26quot;expected function\x26quot;)\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.proxy = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3efn, context\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e args = (\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e) \x26amp;\x26amp; slice.call(\x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (isFunction(fn)) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e proxyFn = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fn.apply(context, args ? args.concat(slice.call(\x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)) : \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e) }\n    proxyFn._zid = zid(fn)\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e proxyFn\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (isString(context)) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (args) {\n      args.unshift(fn[context], fn)\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $.proxy.apply(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, args)\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $.proxy(fn[context], fn)\n    }\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eTypeError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22expected function\x22\x3c\/span\x3e)\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代理函数，作用有点像 JS 中的 \x3ccode\x3ebind\x3c\/code\x3e 方法，返回的是一个代理后改变执行上下文的函数。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var args = (2 in arguments) \x26amp;\x26amp; slice.call(arguments, 2)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e args = (\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e) \x26amp;\x26amp; slice.call(\x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果提供超过3个参数，则去除前两个参数，将后面的参数作为执行函数 \x3ccode\x3efn\x3c\/code\x3e 的参数。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (isFunction(fn)) {\n  var proxyFn = function(){ return fn.apply(context, args ? args.concat(slice.call(arguments)) : arguments) }\n  proxyFn._zid = zid(fn)\n  return proxyFn\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (isFunction(fn)) {\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e proxyFn = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fn.apply(context, args ? args.concat(slice.call(\x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)) : \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e) }\n  proxyFn._zid = zid(fn)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e proxyFn\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eproxy\x3c\/code\x3e 的执行函数有两种传递方式，一是在第一个参数直接传入，二是第一个参数为上下文对象，执行函数也在上下文对象中一起传入。\x3c\/p\x3e\n\x3cp\x3e这里判断 \x3ccode\x3efn\x3c\/code\x3e 是否为函数，即第一种传参方式，调用 \x3ccode\x3efn\x3c\/code\x3e 函数的 \x3ccode\x3eapply\x3c\/code\x3e 方法，将上下文对象 \x3ccode\x3econtext\x3c\/code\x3e 作为 \x3ccode\x3eapply\x3c\/code\x3e 的第一个参数，如果 \x3ccode\x3eargs\x3c\/code\x3e 存在，则与 \x3ccode\x3efn\x3c\/code\x3e 的参数合并。\x3c\/p\x3e\n\x3cp\x3e给代理后的函数加上 \x3ccode\x3e_zid\x3c\/code\x3e 属性，方便函数的查找。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22else if (isString(context)) {\n  if (args) {\n    args.unshift(fn[context], fn)\n    return $.proxy.apply(null, args)\n  } else {\n    return $.proxy(fn[context], fn)\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (isString(context)) {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (args) {\n    args.unshift(fn[context], fn)\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $.proxy.apply(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, args)\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $.proxy(fn[context], fn)\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果函数已经包含在上下文对象中，即第一个参数 \x3ccode\x3efn\x3c\/code\x3e 为对象，第二个参数 \x3ccode\x3econtext\x3c\/code\x3e 为字符串，用来指定执行函数的在上下文对象中的属性名。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (args) {\n  args.unshift(fn[context], fn)\n  return $.proxy.apply(null, args)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (args) {\n  args.unshift(fn[context], fn)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $.proxy.apply(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, args)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果参数存在时，将 \x3ccode\x3efn[context]\x3c\/code\x3e ，也即执行函数和 \x3ccode\x3efn\x3c\/code\x3e ，也即上下文对象放入 \x3ccode\x3eargs\x3c\/code\x3e 数组的开头，这样就将参数修正成跟第一种传参方式一样，再调用 \x3ccode\x3e$.proxy\x3c\/code\x3e 函数。这里调用 \x3ccode\x3eapply\x3c\/code\x3e 方法，是因为不知道参数有多少个，调用 \x3ccode\x3eapply\x3c\/code\x3e 可以以数组的形式传入。\x3c\/p\x3e\n\x3cp\x3e如果 \x3ccode\x3eargs\x3c\/code\x3e 不存在时，确定的参数项只有两个，因此可以直接调用 \x3ccode\x3e$.proxy\x3c\/code\x3e 方法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader19\x22\x3e$.Event\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22specialEvents={},\nspecialEvents.click = specialEvents.mousedown = specialEvents.mouseup = specialEvents.mousemove = \x27MouseEvents\x27\n\n$.Event = function(type, props) {\n  if (!isString(type)) props = type, type = props.type\n  var event = document.createEvent(specialEvents[type] || \x27Events\x27), bubbles = true\n  if (props) for (var name in props) (name == \x27bubbles\x27) ? (bubbles = !!props[name]) : (event[name] = props[name])\n  event.initEvent(type, bubbles, true)\n  return compatible(event)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3especialEvents={},\nspecialEvents.click = specialEvents.mousedown = specialEvents.mouseup = specialEvents.mousemove = \x3cspan class=\x22hljs-string\x22\x3e\x27MouseEvents\x27\x3c\/span\x3e\n\n$.Event = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etype, props\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isString(type)) props = type, type = props.type\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e event = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createEvent(specialEvents[type] || \x3cspan class=\x22hljs-string\x22\x3e\x27Events\x27\x3c\/span\x3e), bubbles = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (props) \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e name \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e props) (name == \x3cspan class=\x22hljs-string\x22\x3e\x27bubbles\x27\x3c\/span\x3e) ? (bubbles = !!props[name]) : (event[name] = props[name])\n  event.initEvent(type, bubbles, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e compatible(event)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3especialEvents\x3c\/code\x3e 是将鼠标事件修正为 \x3ccode\x3eMouseEvents\x3c\/code\x3e ，这应该是处理浏览器的兼容问题，可能有些浏览器中，这些事件的事件类型并不是 \x3ccode\x3eMouseEvents\x3c\/code\x3e 。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e$.Event\x3c\/code\x3e 方法用来手动创建特定类型的事件。\x3c\/p\x3e\n\x3cp\x3e参数 \x3ccode\x3etype\x3c\/code\x3e 可以为字符串，也可以为 \x3ccode\x3eevent\x3c\/code\x3e 对象。\x3ccode\x3eprops\x3c\/code\x3e 为扩展 \x3ccode\x3eevent\x3c\/code\x3e 对象的对象。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (!isString(type)) props = type, type = props.type\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isString(type)) props = type, type = props.type\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果不是字符串，也即是 \x3ccode\x3eevent\x3c\/code\x3e 对象时，将 \x3ccode\x3etype\x3c\/code\x3e 赋给 \x3ccode\x3eprops\x3c\/code\x3e ，\x3ccode\x3etype\x3c\/code\x3e 为当前 \x3ccode\x3eevent\x3c\/code\x3e 对象中的 \x3ccode\x3etype\x3c\/code\x3e 属性值。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var event = document.createEvent(specialEvents[type] || \x27Events\x27), bubbles = true\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e event = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createEvent(specialEvents[type] || \x3cspan class=\x22hljs-string\x22\x3e\x27Events\x27\x3c\/span\x3e), bubbles = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e调用 \x3ccode\x3ecreateEvent\x3c\/code\x3e 方法，创建对应类型的 \x3ccode\x3eevent\x3c\/code\x3e 事件，并将事件冒泡默认设置为 \x3ccode\x3etrue\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (props) for (var name in props) (name == \x27bubbles\x27) ? (bubbles = !!props[name]) : (event[name] = props[name])\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (props) \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e name \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e props) (name == \x3cspan class=\x22hljs-string\x22\x3e\x27bubbles\x27\x3c\/span\x3e) ? (bubbles = !!props[name]) : (event[name] = props[name])\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e遍历 \x3ccode\x3eprops\x3c\/code\x3e 属性，如果有指定 \x3ccode\x3ebubbles\x3c\/code\x3e ，则采用指定的冒泡行为，其他属性复制到 \x3ccode\x3eevent\x3c\/code\x3e 对象上，实现对 \x3ccode\x3eevent\x3c\/code\x3e 对象的扩展。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22event.initEvent(type, bubbles, true)\nreturn compatible(event)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eevent.initEvent(type, bubbles, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e compatible(event)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e初始化新创建的事件，并将修正后的事件对象返回。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader20\x22\x3e方法\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader21\x22\x3e.on()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.fn.on = function(event, selector, data, callback, one){\n  var autoRemove, delegator, $this = this\n  if (event \x26amp;\x26amp; !isString(event)) {\n    $.each(event, function(type, fn){\n      $this.on(type, selector, data, fn, one)\n    })\n    return $this\n  }\n\n  if (!isString(selector) \x26amp;\x26amp; !isFunction(callback) \x26amp;\x26amp; callback !== false)\n    callback = data, data = selector, selector = undefined\n    if (callback === undefined || data === false)\n      callback = data, data = undefined\n\n      if (callback === false) callback = returnFalse\n\n      return $this.each(function(_, element){\n        if (one) autoRemove = function(e){\n          remove(element, e.type, callback)\n          return callback.apply(this, arguments)\n        }\n\n        if (selector) delegator = function(e){\n          var evt, match = $(e.target).closest(selector, element).get(0)\n          if (match \x26amp;\x26amp; match !== element) {\n            evt = $.extend(createProxy(e), {currentTarget: match, liveFired: element})\n            return (autoRemove || callback).apply(match, [evt].concat(slice.call(arguments, 1)))\n          }\n        }\n\n        add(element, event, callback, data, selector, delegator || autoRemove)\n      })\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.fn.on = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent, selector, data, callback, one\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e autoRemove, delegator, $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event \x26amp;\x26amp; !isString(event)) {\n    $.each(event, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etype, fn\x3c\/span\x3e)\x3c\/span\x3e{\n      $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.on(type, selector, data, fn, one)\n    })\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isString(selector) \x26amp;\x26amp; !isFunction(callback) \x26amp;\x26amp; callback !== \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n    callback = data, data = selector, selector = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (callback === \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e || data === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n      callback = data, data = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (callback === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e) callback = returnFalse\n\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.each(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e_, element\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (one) autoRemove = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n          remove(element, e.type, callback)\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e callback.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (selector) delegator = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n          \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e evt, match = $(e.target).closest(selector, element).get(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (match \x26amp;\x26amp; match !== element) {\n            evt = $.extend(createProxy(e), {\x3cspan class=\x22hljs-attr\x22\x3ecurrentTarget\x3c\/span\x3e: match, \x3cspan class=\x22hljs-attr\x22\x3eliveFired\x3c\/span\x3e: element})\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (autoRemove || callback).apply(match, [evt].concat(slice.call(\x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)))\n          }\n        }\n\n        add(element, event, callback, data, selector, delegator || autoRemove)\n      })\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eon\x3c\/code\x3e 方法来用给元素绑定事件，最终调用的是 \x3ccode\x3eadd\x3c\/code\x3e 方法，前面的一大段逻辑主要是修正参数。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var autoRemove, delegator, $this = this\nif (event \x26amp;\x26amp; !isString(event)) {\n  $.each(event, function(type, fn){\n    $this.on(type, selector, data, fn, one)\n  })\n  return $this\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e autoRemove, delegator, $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event \x26amp;\x26amp; !isString(event)) {\n  $.each(event, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etype, fn\x3c\/span\x3e)\x3c\/span\x3e{\n    $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.on(type, selector, data, fn, one)\n  })\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eautoRemove\x3c\/code\x3e 表示在执行完事件响应后，自动解绑的函数。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eevent\x3c\/code\x3e 可以为字符串或者对象，当为对象时，对象的属性为事件类型，属性值为句柄。\x3c\/p\x3e\n\x3cp\x3e这段是处理 \x3ccode\x3eevent\x3c\/code\x3e 为对象时的情况，遍历对象，得到事件类型和句柄，然后再次调用 \x3ccode\x3eon\x3c\/code\x3e 方法，继续修正后续的参数。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (!isString(selector) \x26amp;\x26amp; !isFunction(callback) \x26amp;\x26amp; callback !== false)\n  callback = data, data = selector, selector = undefined\nif (callback === undefined || data === false)\n  callback = data, data = undefined\n\nif (callback === false) callback = returnFalse\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isString(selector) \x26amp;\x26amp; !isFunction(callback) \x26amp;\x26amp; callback !== \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n  callback = data, data = selector, selector = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (callback === \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e || data === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n  callback = data, data = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (callback === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e) callback = returnFalse\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e先来分析第一个 \x3ccode\x3eif\x3c\/code\x3e ，\x3ccode\x3eselector\x3c\/code\x3e 不为 \x3ccode\x3estring\x3c\/code\x3e ，\x3ccode\x3ecallback\x3c\/code\x3e 不为函数，并且 \x3ccode\x3ecallback\x3c\/code\x3e 不为 \x3ccode\x3efalse\x3c\/code\x3e 时的情况。\x3c\/p\x3e\n\x3cp\x3e这里可以确定 \x3ccode\x3eselector\x3c\/code\x3e 并没有传递，因为 \x3ccode\x3eselector\x3c\/code\x3e 不是必传的参数。\x3c\/p\x3e\n\x3cp\x3e因此这里将 \x3ccode\x3edata\x3c\/code\x3e 赋给 \x3ccode\x3ecallback\x3c\/code\x3e，\x3ccode\x3eselector\x3c\/code\x3e  赋给 \x3ccode\x3edata\x3c\/code\x3e ，将 \x3ccode\x3eselector\x3c\/code\x3e 设置为 \x3ccode\x3eundefined\x3c\/code\x3e ，因为 \x3ccode\x3eselector\x3c\/code\x3e 没有传递，因此相应参数的位置都前移了一位。\x3c\/p\x3e\n\x3cp\x3e再来看第二个 \x3ccode\x3eif\x3c\/code\x3e ，如果 \x3ccode\x3ecallback\x3c\/code\x3e（ 原来的 \x3ccode\x3edata\x3c\/code\x3e ） 为 \x3ccode\x3eundefined\x3c\/code\x3e ， \x3ccode\x3edata\x3c\/code\x3e 为 \x3ccode\x3efalse\x3c\/code\x3e 时，表示 \x3ccode\x3eselector\x3c\/code\x3e 没有传递，并且 \x3ccode\x3edata\x3c\/code\x3e 也没有传递，因此将 \x3ccode\x3edata\x3c\/code\x3e 赋给 \x3ccode\x3ecallback\x3c\/code\x3e ，将 \x3ccode\x3edata\x3c\/code\x3e 设置为 \x3ccode\x3eundefined\x3c\/code\x3e ，即将参数再前移一位。\x3c\/p\x3e\n\x3cp\x3e第三个 \x3ccode\x3eif\x3c\/code\x3e ，如果 \x3ccode\x3ecallback === false\x3c\/code\x3e ，用 \x3ccode\x3ereturnFalse\x3c\/code\x3e 函数代替，如果不用 \x3ccode\x3ereturnFalse\x3c\/code\x3e 代替，会报错。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22return $this.each(function(_, element){\n  add(element, event, callback, data, selector, delegator || autoRemove)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.each(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e_, element\x3c\/span\x3e)\x3c\/span\x3e{\n  add(element, event, callback, data, selector, delegator || autoRemove)\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看到，这里是遍历元素集合，为每个元素都调用 \x3ccode\x3eadd\x3c\/code\x3e 方法，绑定事件。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (one) autoRemove = function(e){\n  remove(element, e.type, callback)\n  return callback.apply(this, arguments)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (one) autoRemove = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  remove(element, e.type, callback)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e callback.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果只调用一次，设置 \x3ccode\x3eautoRemove\x3c\/code\x3e 为一个函数，这个函数在句柄执行前，调用 \x3ccode\x3eremove\x3c\/code\x3e 方法，将绑定在元素上对应事件解绑。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (selector) delegator = function(e){\n  var evt, match = $(e.target).closest(selector, element).get(0)\n  if (match \x26amp;\x26amp; match !== element) {\n    evt = $.extend(createProxy(e), {currentTarget: match, liveFired: element})\n    return (autoRemove || callback).apply(match, [evt].concat(slice.call(arguments, 1)))\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (selector) delegator = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e evt, match = $(e.target).closest(selector, element).get(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (match \x26amp;\x26amp; match !== element) {\n    evt = $.extend(createProxy(e), {\x3cspan class=\x22hljs-attr\x22\x3ecurrentTarget\x3c\/span\x3e: match, \x3cspan class=\x22hljs-attr\x22\x3eliveFired\x3c\/span\x3e: element})\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (autoRemove || callback).apply(match, [evt].concat(slice.call(\x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)))\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果 \x3ccode\x3eselector\x3c\/code\x3e 存在，表示需要做事件代理。\x3c\/p\x3e\n\x3cp\x3e调用 \x3ccode\x3eclosest\x3c\/code\x3e 方法，从事件的目标元素 \x3ccode\x3ee.target\x3c\/code\x3e 开始向上查找，返回第一个匹配 \x3ccode\x3eselector\x3c\/code\x3e 的元素。关于 \x3ccode\x3eclosest\x3c\/code\x3e 方法，见《\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E9%9B%86%E5%90%88%E5%85%83%E7%B4%A0%E6%9F%A5%E6%89%BE.md#closest\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之集合元素查找\x3c\/a\x3e》分析。\x3c\/p\x3e\n\x3cp\x3e如果 \x3ccode\x3ematch\x3c\/code\x3e 存在，并且 \x3ccode\x3ematch\x3c\/code\x3e 不为当前元素，则调用 \x3ccode\x3ecreateProxy\x3c\/code\x3e 方法，为当前事件对象创建代理对象，再调用 \x3ccode\x3e$.extend\x3c\/code\x3e 方法，为代理对象扩展 \x3ccode\x3ecurrentTarget\x3c\/code\x3e 和 \x3ccode\x3eliveFired\x3c\/code\x3e 属性，将代理元素和触发事件的元素保存到事件对象中。\x3c\/p\x3e\n\x3cp\x3e最后执行句柄函数，以代理元素 \x3ccode\x3ematch\x3c\/code\x3e 作为句柄的上下文，用代理后的 \x3ccode\x3eevent\x3c\/code\x3e 对象 \x3ccode\x3eevt\x3c\/code\x3e 替换掉原句柄函数的第一个参数。\x3c\/p\x3e\n\x3cp\x3e将该函数赋给 \x3ccode\x3edelegator\x3c\/code\x3e ，作为代理函数传递给 \x3ccode\x3eadd\x3c\/code\x3e 方法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader22\x22\x3e.off()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.fn.off = function(event, selector, callback){\n  var $this = this\n  if (event \x26amp;\x26amp; !isString(event)) {\n    $.each(event, function(type, fn){\n      $this.off(type, selector, fn)\n    })\n    return $this\n  }\n\n  if (!isString(selector) \x26amp;\x26amp; !isFunction(callback) \x26amp;\x26amp; callback !== false)\n    callback = selector, selector = undefined\n\n    if (callback === false) callback = returnFalse\n\n    return $this.each(function(){\n      remove(this, event, callback, selector)\n    })\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.fn.off = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent, selector, callback\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event \x26amp;\x26amp; !isString(event)) {\n    $.each(event, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etype, fn\x3c\/span\x3e)\x3c\/span\x3e{\n      $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.off(type, selector, fn)\n    })\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isString(selector) \x26amp;\x26amp; !isFunction(callback) \x26amp;\x26amp; callback !== \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n    callback = selector, selector = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (callback === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e) callback = returnFalse\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.each(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n      remove(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, event, callback, selector)\n    })\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e解绑事件\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (event \x26amp;\x26amp; !isString(event)) {\n  $.each(event, function(type, fn){\n    $this.off(type, selector, fn)\n  })\n  return $this\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event \x26amp;\x26amp; !isString(event)) {\n  $.each(event, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etype, fn\x3c\/span\x3e)\x3c\/span\x3e{\n    $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.off(type, selector, fn)\n  })\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这段逻辑与 \x3ccode\x3eon\x3c\/code\x3e 方法中的相似，修正参数，不再细说。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (!isString(selector) \x26amp;\x26amp; !isFunction(callback) \x26amp;\x26amp; callback !== false)\n  callback = selector, selector = undefined\nif (callback === false) callback = returnFalse\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isString(selector) \x26amp;\x26amp; !isFunction(callback) \x26amp;\x26amp; callback !== \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n  callback = selector, selector = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (callback === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e) callback = returnFalse\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e第一个 \x3ccode\x3eif\x3c\/code\x3e 是处理 \x3ccode\x3eselector\x3c\/code\x3e 参数没有传递的情况的， \x3ccode\x3eselector\x3c\/code\x3e 位置传递的其实是 \x3ccode\x3ecallback\x3c\/code\x3e 。\x3c\/p\x3e\n\x3cp\x3e第二个 \x3ccode\x3eif\x3c\/code\x3e 是判断如果 \x3ccode\x3ecallback\x3c\/code\x3e 为 \x3ccode\x3efalse\x3c\/code\x3e ，将 \x3ccode\x3ecallback\x3c\/code\x3e 赋值为 \x3ccode\x3ereturnFalse\x3c\/code\x3e 函数。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22return $this.each(function(){\n  remove(this, event, callback, selector)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.each(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  remove(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, event, callback, selector)\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后遍历所有元素，调用 \x3ccode\x3eremove\x3c\/code\x3e 函数，为每个元素解绑事件。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader23\x22\x3e.bind()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.fn.bind = function(event, data, callback){\n  return this.on(event, data, callback)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.fn.bind = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent, data, callback\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.on(event, data, callback)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3ebind\x3c\/code\x3e 方法内部调用的其实是 \x3ccode\x3eon\x3c\/code\x3e 方法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader24\x22\x3e.unbind()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.fn.unbind = function(event, callback){\n  return this.off(event, callback)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.fn.unbind = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent, callback\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.off(event, callback)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eunbind\x3c\/code\x3e 方法内部调用的是 \x3ccode\x3eoff\x3c\/code\x3e 方法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader25\x22\x3e.one()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.fn.one = function(event, selector, data, callback){\n  return this.on(event, selector, data, callback, 1)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.fn.one = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent, selector, data, callback\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.on(event, selector, data, callback, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eone\x3c\/code\x3e 方法内部调用的也是 \x3ccode\x3eon\x3c\/code\x3e 方法，只不过默认传递了 \x3ccode\x3eone\x3c\/code\x3e 参数为 \x3ccode\x3e1\x3c\/code\x3e ，表示绑定的事件只执行一下。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader26\x22\x3e.delegate()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.fn.delegate = function(selector, event, callback){\n  return this.on(event, selector, callback)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.fn.delegate = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eselector, event, callback\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.on(event, selector, callback)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e事件委托，也是调用 \x3ccode\x3eon\x3c\/code\x3e 方法，只是 \x3ccode\x3eselector\x3c\/code\x3e 一定要传递。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader27\x22\x3e.undelegate()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.fn.undelegate = function(selector, event, callback){\n  return this.off(event, selector, callback)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.fn.undelegate = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eselector, event, callback\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.off(event, selector, callback)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e取消事件委托，内部调用的是 \x3ccode\x3eoff\x3c\/code\x3e 方法，\x3ccode\x3eselector\x3c\/code\x3e 必须要传递。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader28\x22\x3e.live()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.fn.live = function(event, callback){\n  $(document.body).delegate(this.selector, event, callback)\n  return this\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.fn.live = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent, callback\x3c\/span\x3e)\x3c\/span\x3e{\n  $(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body).delegate(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.selector, event, callback)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e动态创建的节点也可以响应事件。其实事件绑定在 \x3ccode\x3ebody\x3c\/code\x3e 上，然后委托到当前节点上。内部调用的是 \x3ccode\x3edelegate\x3c\/code\x3e 方法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader29\x22\x3e.die()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.fn.die = function(event, callback){\n  $(document.body).undelegate(this.selector, event, callback)\n  return this\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.fn.die = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent, callback\x3c\/span\x3e)\x3c\/span\x3e{\n  $(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body).undelegate(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.selector, event, callback)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e将由 \x3ccode\x3elive\x3c\/code\x3e 绑定在 \x3ccode\x3ebody\x3c\/code\x3e 上的事件销毁，内部调用的是 \x3ccode\x3eundelegate\x3c\/code\x3e 方法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader30\x22\x3e.triggerHandler()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.fn.triggerHandler = function(event, args){\n  var e, result\n  this.each(function(i, element){\n    e = createProxy(isString(event) ? $.Event(event) : event)\n    e._args = args\n    e.target = element\n    $.each(findHandlers(element, event.type || event), function(i, handler){\n      result = handler.proxy(e)\n      if (e.isImmediatePropagationStopped()) return false\n        })\n  })\n  return result\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.fn.triggerHandler = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent, args\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e e, result\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.each(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ei, element\x3c\/span\x3e)\x3c\/span\x3e{\n    e = createProxy(isString(event) ? $.Event(event) : event)\n    e._args = args\n    e.target = element\n    $.each(findHandlers(element, event.type || event), \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ei, handler\x3c\/span\x3e)\x3c\/span\x3e{\n      result = handler.proxy(e)\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e.isImmediatePropagationStopped()) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n        })\n  })\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e result\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e直接触发事件回调函数。\x3c\/p\x3e\n\x3cp\x3e参数 \x3ccode\x3eevent\x3c\/code\x3e 可以为事件类型字符串，也可以为 \x3ccode\x3eevent\x3c\/code\x3e 对象。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22e = createProxy(isString(event) ? $.Event(event) : event)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3ee = createProxy(isString(event) ? $.Event(event) : event)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果 \x3ccode\x3eevent\x3c\/code\x3e 为字符串时，则调用 \x3ccode\x3e$.Event\x3c\/code\x3e 工具函数来初始化一个事件对象，再调用 \x3ccode\x3ecreateProxy\x3c\/code\x3e 来创建一个 \x3ccode\x3eevent\x3c\/code\x3e 代理对象。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.each(findHandlers(element, event.type || event), function(i, handler){\n  result = handler.proxy(e)\n  if (e.isImmediatePropagationStopped()) return false\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.each(findHandlers(element, event.type || event), \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ei, handler\x3c\/span\x3e)\x3c\/span\x3e{\n  result = handler.proxy(e)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e.isImmediatePropagationStopped()) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e调用 \x3ccode\x3efindHandlers\x3c\/code\x3e 方法来找出事件的所有句柄，调用 \x3ccode\x3eproxy\x3c\/code\x3e 方法，即真正绑定到事件上的回调函数（参见 \x3ccode\x3eadd\x3c\/code\x3e 的解释），拿到方法返回的结果 \x3ccode\x3eresult\x3c\/code\x3e ，并查看 \x3ccode\x3eisImmediatePropagationStopped\x3c\/code\x3e 返回的结果是否为 \x3ccode\x3etrue\x3c\/code\x3e ，如果是，立刻中止后续执行。\x3c\/p\x3e\n\x3cp\x3e如果返回的结果 \x3ccode\x3eresult\x3c\/code\x3e 为 \x3ccode\x3efalse\x3c\/code\x3e ，也立刻中止后续执行。\x3c\/p\x3e\n\x3cp\x3e由于 \x3ccode\x3etriggerHandler\x3c\/code\x3e 直接触发回调函数，所以事件不会冒泡。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader31\x22\x3e.trigger()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.fn.trigger = function(event, args){\n  event = (isString(event) || $.isPlainObject(event)) ? $.Event(event) : compatible(event)\n  event._args = args\n  return this.each(function(){\n    \/\/ handle focus(), blur() by calling them directly\n    if (event.type in focus \x26amp;\x26amp; typeof this[event.type] == \x26quot;function\x26quot;) this[event.type]()\n    \/\/ items in the collection might not be DOM elements\n    else if (\x27dispatchEvent\x27 in this) this.dispatchEvent(event)\n    else $(this).triggerHandler(event, args)\n      })\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$.fn.trigger = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent, args\x3c\/span\x3e)\x3c\/span\x3e{\n  event = (isString(event) || $.isPlainObject(event)) ? $.Event(event) : compatible(event)\n  event._args = args\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.each(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ handle focus(), blur() by calling them directly\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.type \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e focus \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e[event.type] == \x3cspan class=\x22hljs-string\x22\x3e\x22function\x22\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e[event.type]()\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ items in the collection might not be DOM elements\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27dispatchEvent\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dispatchEvent(event)\n    \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e $(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e).triggerHandler(event, args)\n      })\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e手动触发事件。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22event = (isString(event) || $.isPlainObject(event)) ? $.Event(event) : compatible(event)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eevent = (isString(event) || $.isPlainObject(event)) ? $.Event(event) : compatible(event)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eevent\x3c\/code\x3e 可以传递事件类型，对象和 \x3ccode\x3eevent\x3c\/code\x3e 对象。\x3c\/p\x3e\n\x3cp\x3e如果传递的是字符串或者纯粹对象，则先调用 \x3ccode\x3e$.Event\x3c\/code\x3e 方法来初始化事件，否则调用 \x3ccode\x3ecompatible\x3c\/code\x3e 方法来修正 \x3ccode\x3eevent\x3c\/code\x3e 对象，由于 \x3ccode\x3e$.Event\x3c\/code\x3e 方法在内部其实已经调用过 \x3ccode\x3ecompatible\x3c\/code\x3e 方法修正 \x3ccode\x3eevent\x3c\/code\x3e 对象了的，所以外部不需要再调用一次。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (event.type in focus \x26amp;\x26amp; typeof this[event.type] == \x26quot;function\x26quot;) this[event.type]()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.type \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e focus \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e[event.type] == \x3cspan class=\x22hljs-string\x22\x3e\x22function\x22\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e[event.type]()\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果是 \x3ccode\x3efocus\/blur\x3c\/code\x3e 方法，则直接调用 \x3ccode\x3ethis.focus()\x3c\/code\x3e  或 \x3ccode\x3ethis.blur()\x3c\/code\x3e 方法，这两个方法是浏览器原生支持的。\x3c\/p\x3e\n\x3cp\x3e如果 \x3ccode\x3ethis\x3c\/code\x3e 为 \x3ccode\x3eDOM\x3c\/code\x3e 元素，即存在 \x3ccode\x3edispatchEvent\x3c\/code\x3e 方法，则用 \x3ccode\x3edispatchEvent\x3c\/code\x3e 来触发事件，关于 \x3ccode\x3edispatchEvent\x3c\/code\x3e ，可以参考 \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/EventTarget\/dispatchEvent\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMDN: EventTarget.dispatchEvent()\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e否则，直接调用 \x3ccode\x3etriggerHandler\x3c\/code\x3e 方法来触发事件的回调函数。\x3c\/p\x3e\n\x3cp\x3e由于 \x3ccode\x3etrigger\x3c\/code\x3e 是通过触发事件来执行事件句柄的，因此事件会冒泡。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader32\x22\x3e系列文章\x3c\/h2\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E4%BB%A3%E7%A0%81%E7%BB%93%E6%9E%84.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之代码结构\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E5%86%85%E9%83%A8%E6%96%B9%E6%B3%95.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读 Zepto 源码之内部方法\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/a4d6ad99c57047beae2b652b4d2cbb380599a524\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之工具函数\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E7%A5%9E%E5%A5%87%E7%9A%84%24.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之神奇的$\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之集合操作\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E9%9B%86%E5%90%88%E5%85%83%E7%B4%A0%E6%9F%A5%E6%89%BE.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之集合元素查找\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E6%93%8D%E4%BD%9CDOM.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之操作DOM\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E6%A0%B7%E5%BC%8F%E6%93%8D%E4%BD%9C.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之样式操作\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之属性操作\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader33\x22\x3e参考\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/juejin.im\/post\/5935773fa0bb9f0058edbd61\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emouseenter与mouseover为何这般纠缠不清？\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/juejin.im\/post\/5936f13b2f301e0058796482\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e向zepto.js学习如何手动(trigger)触发DOM事件\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/juejin.im\/post\/5939956b5c497d006b690fee\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e谁说你只是 \x22会用\x22jQuery?\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/mominger\/p\/4384692.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eZepto源码分析-event模块\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/blog.csdn.net\/u013055396\/article\/details\/74907136\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ezepto源码之event.js\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000003942014\x22\x3e说说focus \/focusin \/focusout \/blur 事件\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/Events\/mouseenter\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMDN:mouseenter\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca\x3eMDN:mouseleave\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/MouseEvent\/relatedTarget\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMDN:MouseEvent.relatedTarget\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/Events\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMDN:Event reference\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/Document\/createEvent\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMDN:Document.createEvent()\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/EventTarget\/dispatchEvent\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMDN:EventTarget.dispatchEvent()\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/Event\/stopImmediatePropagation\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMDN:event.stopImmediatePropagation\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader34\x22\x3eLicense\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/creativecommons.org\/licenses\/by-nc-nd\/4.0\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009502046\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009502046\x22 alt=\x22License: CC BY-NC-ND 4.0\x22 title=\x22License: CC BY-NC-ND 4.0\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e最后，所有文章都会同步发送到微信公众号上，欢迎关注,欢迎提意见：  \x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009735938?w=430\x26amp;h=430\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009735938?w=430\x26amp;h=430\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e作者：对角另一面\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>读Zepto源码之Event模块</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010228427">https://segmentfault.com/a/1190000010228427</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/tkdm30w17sc/" target="_blank">https://alili.tech/archive/tkdm30w17sc/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>