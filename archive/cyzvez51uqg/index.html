<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="改造你的网站，变身 PWA"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>改造你的网站，变身 PWA | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/cyzvez51uqg/",
				"appid": "1613049289050283", 
				"title": "改造你的网站，变身 PWA | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-17T02:30:25"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/1ofo5slgkfy/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/c3ej954y6u9/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fcyzvez51uqg%2f&text=%e6%94%b9%e9%80%a0%e4%bd%a0%e7%9a%84%e7%bd%91%e7%ab%99%ef%bc%8c%e5%8f%98%e8%ba%ab%20PWA"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fcyzvez51uqg%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fcyzvez51uqg%2f&text=%e6%94%b9%e9%80%a0%e4%bd%a0%e7%9a%84%e7%bd%91%e7%ab%99%ef%bc%8c%e5%8f%98%e8%ba%ab%20PWA"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fcyzvez51uqg%2f&title=%e6%94%b9%e9%80%a0%e4%bd%a0%e7%9a%84%e7%bd%91%e7%ab%99%ef%bc%8c%e5%8f%98%e8%ba%ab%20PWA"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fcyzvez51uqg%2f&is_video=false&description=%e6%94%b9%e9%80%a0%e4%bd%a0%e7%9a%84%e7%bd%91%e7%ab%99%ef%bc%8c%e5%8f%98%e8%ba%ab%20PWA"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e6%94%b9%e9%80%a0%e4%bd%a0%e7%9a%84%e7%bd%91%e7%ab%99%ef%bc%8c%e5%8f%98%e8%ba%ab%20PWA&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fcyzvez51uqg%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fcyzvez51uqg%2f&title=%e6%94%b9%e9%80%a0%e4%bd%a0%e7%9a%84%e7%bd%91%e7%ab%99%ef%bc%8c%e5%8f%98%e8%ba%ab%20PWA"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fcyzvez51uqg%2f&title=%e6%94%b9%e9%80%a0%e4%bd%a0%e7%9a%84%e7%bd%91%e7%ab%99%ef%bc%8c%e5%8f%98%e8%ba%ab%20PWA"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fcyzvez51uqg%2f&title=%e6%94%b9%e9%80%a0%e4%bd%a0%e7%9a%84%e7%bd%91%e7%ab%99%ef%bc%8c%e5%8f%98%e8%ba%ab%20PWA"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fcyzvez51uqg%2f&title=%e6%94%b9%e9%80%a0%e4%bd%a0%e7%9a%84%e7%bd%91%e7%ab%99%ef%bc%8c%e5%8f%98%e8%ba%ab%20PWA"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">改造你的网站，变身 PWA</h1><div class="meta"><div class="postdate"><time datetime="2019-01-17" itemprop="datePublished">2019-01-17</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008880640?w=900\x26amp;h=500\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008880640?w=900\x26amp;h=500\x22 alt=\x22pwa\x22 title=\x22pwa\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e最近有很多关于 Progressive Web Apps（PWAs）的消息，很多人都在问这是不是（移动）web 的未来。我不想陷入native app 和 PWA 的纷争，但是有一件事是确定的 --- PWA极大的提升了移动端表现，改善了用户体验。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e好消息是开发一个 PWA 并不难。事实上，我们可以将现存的网站进行改进，使之成为PWA。这也是我这篇文章要讲的 -- 当你读完这篇文章，你可以将你的网站改进，让他看起来就像是一个 native web app。他可以离线工作并且拥有自己的主屏图标。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3eProgressive Web Apps 是什么？\x3c\/h2\x3e\n\x3cp\x3eProgressive Web Apps (下文以“PWAs”代指) 是一个令人兴奋的前端技术的革新。PWAs综合了一系列技术使你的 web app表现得就像是 native mobile app。相比于纯 web 解决方案和纯 native 解决方案，PWAs对于开发者和用户有以下优点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e你只需要基于开放的 W3C 标准的 web 开发技术来开发一个app。不需要多客户端开发。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e用户可以在安装前就体验你的 app。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e不需要通过 AppStore 下载 app。app 会自动升级不需要用户升级。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e用户会受到‘安装’的提示，点击安装会增加一个图标到用户首屏。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e被打开时，PWA 会展示一个有吸引力的闪屏。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3echrome 提供了可选选项，可以使 PWA 得到全屏体验。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e必要的文件会被本地缓存，因此会比标准的web app 响应更快（也许也会比native app响应快）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e安装及其轻量 -- 或许会有几百 kb 的缓存数据。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e网站的数据传输必须是 https 连接。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ePWAs 可以离线工作，并且在网络恢复时可以同步最新数据。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e现在还处在 PWA 的早期，但已经有 \x3ca href=\x22https:\/\/developers.google.com\/web\/showcase\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e很多成功案例\x3c\/a\x3e 。\x3c\/p\x3e\n\x3cp\x3ePWA 技术目前被 Firefox，Chrome 和其他基于Blink内核的浏览器支持。微软正在努力在Edge浏览器上实现。Apple没有动作 although there are \x3ca href=\x22https:\/\/trac.webkit.org\/wiki\/FiveYearPlanFall2015\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3epromising comments in the WebKit five-year plan\x3c\/a\x3e。幸运的是，浏览器支持对于 PWA 似乎不太重要...\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3ePWAs 是渐进增强的\x3c\/h3\x3e\n\x3cp\x3e你的app仍然可以运行在不支持 PWA 技术的浏览器里。用户不能离线访问，不过其他功能都像原来一样没有影响。综合利弊得失，没有理由不把你的 app 改进为 PWA。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e不只是 Apps\x3c\/h3\x3e\n\x3cp\x3eGoogle 引领了 \x3ca href=\x22https:\/\/developers.google.com\/web\/progressive-web-apps\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePWA 的一系列动作\x3c\/a\x3e，所以大多数教程都在说如何从零开始构建一个基于 Chrome，native-looking mobile app。然而并不是只有特殊的单页应用可以PWA化，也不需要一定遵循 material interface design guidelines。大多数网站都可以在数小时内实现 PWA 化。这包括你的 WordPress站点或者静态站点。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e示例代码\x3c\/h2\x3e\n\x3cp\x3e示例代码可以在\x3ca href=\x22https:\/\/github.com\/sitepoint-editors\/pwa-retrofit\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/sitepoint-editors\/pwa-retrofit\x3c\/a\x3e找到。\x3c\/p\x3e\n\x3cp\x3e代码提供了一个简单的四个页面的网站。其中包含一些图片，一个样式表和一个main javascript 文件。这个网站可以运行在所有现代浏览器上（IE10\x2b）。如果浏览器支持 PWA 技术，当离线时用户可以浏览他们之前看过的页面。\x3c\/p\x3e\n\x3cp\x3e运行代码前，确保 Node.js 已经安装，然后再命令行里启动服务：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22node .\/server.js [port]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs crmsh\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3enode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e.\/server\x3c\/span\x3e.js [port]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3e[port]\x3c\/code\x3e是可配置的，默认为 8888。打开 Chrome 或者其他基于Blink内核的浏览器，比如 Opera 或者 Vivaldi，然后输入链接 \x3ca href=\x22http:\/\/localhost:8888\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/localhost:8888\/\x3c\/a\x3e（或者你指定的某个端口）。你也可以打开开发者工具看一下各个console信息。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008880641?w=628\x26amp;h=641\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008880641?w=628\x26amp;h=641\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e浏览主页，或者其他页面，然后用以下任一方法使页面离线：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e按下 Cmd\/Ctrl \x2b C ，停止 node 服务器，或者\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e在开发者工具的 \x3cem\x3eNetwork\x3c\/em\x3e 或者 \x3cem\x3eApplication - Service Workers\x3c\/em\x3e 栏里点击 \x3cem\x3eoffline\x3c\/em\x3e 选项。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e重新浏览任意之前浏览过的页面，它们仍然可以浏览到。浏览一个之前没有看过的页面，你会看到一个专门的离线页面，标识“you’re offline”，还有一个你可以浏览的页面列表：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008880642?w=492\x26amp;h=431\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008880642?w=492\x26amp;h=431\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e连接手机\x3c\/h3\x3e\n\x3cp\x3e你也可以通过 USB 连接你的安卓手机来预览示例网页。在开发者工具中打开 \x3cem\x3eRemote devices\x3c\/em\x3e 菜单。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008880643?w=700\x26amp;h=533\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008880643?w=700\x26amp;h=533\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e在左边选择 \x3cem\x3eSettings\x3c\/em\x3e ，点击 \x3cem\x3eAdd Rule\x3c\/em\x3e 输入 8888 端口。你可以在你的手机上打开Chrome，打开 \x3ca href=\x22http:\/\/localhost:8888\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/localhost:8888\/\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e你可以点击浏览器菜单里的 “Add to Home screen”。浏览几个页面，浏览器会提醒你去安装。这两种方式都可以创建一个新的图标在你的主屏上。浏览几个页面后关掉Chrome，断开设备连接。你依然可以打开 \x3cem\x3ePWA Website\x3c\/em\x3e app -- 你会看到一个启动页，并且可以离线访问之前你访问过的页面。\x3c\/p\x3e\n\x3cp\x3e将你的网站改进为一个 Progressive Web App 总共有三个必要步骤：\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3e第一步：开启 HTTPS\x3c\/h1\x3e\n\x3cp\x3e由于一些显而易见的原因，PWAs 需要 HTTPS 连接。\x3c\/p\x3e\n\x3cp\x3eHTTPS 在示例代码中并不是必须的，因为 Chrome 允许使用 localhost 或者任何 127.x.x.x 的地址来测试。你也可以在 HTTP 连接下测试你的 PWA，你需要使用 Chrome ，并且输入以下命令行参数：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e--user-data-dir\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e--unsafety-treat-insecure-origin-as-secure\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader6\x22\x3e第二步：创建一个 Web App Manifest\x3c\/h1\x3e\n\x3cp\x3emanifest 文件提供了一些我们网站的信息，例如 name，description 和需要在主屏使用的图标的图片，启动屏的图片等。\x3c\/p\x3e\n\x3cp\x3emanifest文件是一个 JSON 格式的文件，位于你项目的根目录。它必须用\x3ccode\x3eContent-Type: application\/manifest\x2bjson\x3c\/code\x3e 或者 \x3ccode\x3eContent-Type: application\/json \x3c\/code\x3e这样的 HTTP 头来请求。这个文件可以被命名为任何名字，在示例代码中他被命名为 \x3ccode\x3e\/manifest.json\x3c\/code\x3e:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;name\x26quot;              : \x26quot;PWA Website\x26quot;,\n  \x26quot;short_name\x26quot;        : \x26quot;PWA\x26quot;,\n  \x26quot;description\x26quot;       : \x26quot;An example PWA website\x26quot;,\n  \x26quot;start_url\x26quot;         : \x26quot;\/\x26quot;,\n  \x26quot;display\x26quot;           : \x26quot;standalone\x26quot;,\n  \x26quot;orientation\x26quot;       : \x26quot;any\x26quot;,\n  \x26quot;background_color\x26quot;  : \x26quot;#ACE\x26quot;,\n  \x26quot;theme_color\x26quot;       : \x26quot;#ACE\x26quot;,\n  \x26quot;icons\x26quot;: [\n    {\n      \x26quot;src\x26quot;           : \x26quot;\/images\/logo\/logo072.png\x26quot;,\n      \x26quot;sizes\x26quot;         : \x26quot;72x72\x26quot;,\n      \x26quot;type\x26quot;          : \x26quot;image\/png\x26quot;\n    },\n    {\n      \x26quot;src\x26quot;           : \x26quot;\/images\/logo\/logo152.png\x26quot;,\n      \x26quot;sizes\x26quot;         : \x26quot;152x152\x26quot;,\n      \x26quot;type\x26quot;          : \x26quot;image\/png\x26quot;\n    },\n    {\n      \x26quot;src\x26quot;           : \x26quot;\/images\/logo\/logo192.png\x26quot;,\n      \x26quot;sizes\x26quot;         : \x26quot;192x192\x26quot;,\n      \x26quot;type\x26quot;          : \x26quot;image\/png\x26quot;\n    },\n    {\n      \x26quot;src\x26quot;           : \x26quot;\/images\/logo\/logo256.png\x26quot;,\n      \x26quot;sizes\x26quot;         : \x26quot;256x256\x26quot;,\n      \x26quot;type\x26quot;          : \x26quot;image\/png\x26quot;\n    },\n    {\n      \x26quot;src\x26quot;           : \x26quot;\/images\/logo\/logo512.png\x26quot;,\n      \x26quot;sizes\x26quot;         : \x26quot;512x512\x26quot;,\n      \x26quot;type\x26quot;          : \x26quot;image\/png\x26quot;\n    }\n  ]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e{\n  \x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e              : \x3cspan class=\x22hljs-string\x22\x3e\x22PWA Website\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22short_name\x22\x3c\/span\x3e        : \x3cspan class=\x22hljs-string\x22\x3e\x22PWA\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22description\x22\x3c\/span\x3e       : \x3cspan class=\x22hljs-string\x22\x3e\x22An example PWA website\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22start_url\x22\x3c\/span\x3e         : \x3cspan class=\x22hljs-string\x22\x3e\x22\/\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22display\x22\x3c\/span\x3e           : \x3cspan class=\x22hljs-string\x22\x3e\x22standalone\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22orientation\x22\x3c\/span\x3e       : \x3cspan class=\x22hljs-string\x22\x3e\x22any\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22background_color\x22\x3c\/span\x3e  : \x3cspan class=\x22hljs-string\x22\x3e\x22#ACE\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22theme_color\x22\x3c\/span\x3e       : \x3cspan class=\x22hljs-string\x22\x3e\x22#ACE\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22icons\x22\x3c\/span\x3e: [\n    {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e           : \x3cspan class=\x22hljs-string\x22\x3e\x22\/images\/logo\/logo072.png\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22sizes\x22\x3c\/span\x3e         : \x3cspan class=\x22hljs-string\x22\x3e\x2272x72\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e          : \x3cspan class=\x22hljs-string\x22\x3e\x22image\/png\x22\x3c\/span\x3e\n    },\n    {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e           : \x3cspan class=\x22hljs-string\x22\x3e\x22\/images\/logo\/logo152.png\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22sizes\x22\x3c\/span\x3e         : \x3cspan class=\x22hljs-string\x22\x3e\x22152x152\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e          : \x3cspan class=\x22hljs-string\x22\x3e\x22image\/png\x22\x3c\/span\x3e\n    },\n    {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e           : \x3cspan class=\x22hljs-string\x22\x3e\x22\/images\/logo\/logo192.png\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22sizes\x22\x3c\/span\x3e         : \x3cspan class=\x22hljs-string\x22\x3e\x22192x192\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e          : \x3cspan class=\x22hljs-string\x22\x3e\x22image\/png\x22\x3c\/span\x3e\n    },\n    {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e           : \x3cspan class=\x22hljs-string\x22\x3e\x22\/images\/logo\/logo256.png\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22sizes\x22\x3c\/span\x3e         : \x3cspan class=\x22hljs-string\x22\x3e\x22256x256\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e          : \x3cspan class=\x22hljs-string\x22\x3e\x22image\/png\x22\x3c\/span\x3e\n    },\n    {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e           : \x3cspan class=\x22hljs-string\x22\x3e\x22\/images\/logo\/logo512.png\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22sizes\x22\x3c\/span\x3e         : \x3cspan class=\x22hljs-string\x22\x3e\x22512x512\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e          : \x3cspan class=\x22hljs-string\x22\x3e\x22image\/png\x22\x3c\/span\x3e\n    }\n  ]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在页面的\x3ccode\x3e\x26lt;head\x26gt;\x3c\/code\x3e中引入：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3clink rel=\x26quot;manifest\x26quot; href=\x26quot;\/manifest.json\x26quot;\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elink\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erel\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22manifest\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/manifest.json\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3emanifest 中主要属性有：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3cem\x3ename\x3c\/em\x3e —— 网页显示给用户的完整名称\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cem\x3eshort_name\x3c\/em\x3e —— 当空间不足以显示全名时的网站缩写名称\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cem\x3edescription\x3c\/em\x3e —— 关于网站的详细描述\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cem\x3estart_url\x3c\/em\x3e —— 网页的初始 相对 URL（比如 \x3ccode\x3e\/\x3c\/code\x3e）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cem\x3escope\x3c\/em\x3e —— 导航范围。比如，\x3ccode\x3e\/app\/\x3c\/code\x3e的scope就限制 app 在这个文件夹里。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cem\x3ebackground-color\x3c\/em\x3e —— 启动屏和浏览器的背景颜色\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cem\x3etheme_color\x3c\/em\x3e —— 网站的主题颜色，一般都与背景颜色相同，它可以影响网站的显示\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cem\x3eorientation\x3c\/em\x3e —— 首选的显示方向：\x3ccode\x3eany\x3c\/code\x3e, \x3ccode\x3enatural\x3c\/code\x3e, \x3ccode\x3elandscape\x3c\/code\x3e, \x3ccode\x3elandscape-primary\x3c\/code\x3e, \x3ccode\x3elandscape-secondary\x3c\/code\x3e, \x3ccode\x3eportrait\x3c\/code\x3e, \x3ccode\x3eportrait-primary\x3c\/code\x3e, 和 \x3ccode\x3eportrait-secondary\x3c\/code\x3e。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cem\x3edisplay\x3c\/em\x3e —— 首选的显示方式：\x3ccode\x3efullscreen\x3c\/code\x3e, \x3ccode\x3estandalone\x3c\/code\x3e(看起来像是native app)，\x3ccode\x3eminimal-ui\x3c\/code\x3e(有简化的浏览器控制选项) 和 \x3ccode\x3ebrowser\x3c\/code\x3e(常规的浏览器 tab)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cem\x3eicons\x3c\/em\x3e —— 定义了 \x3ccode\x3esrc\x3c\/code\x3e URL, \x3ccode\x3esizes\x3c\/code\x3e和\x3ccode\x3etype\x3c\/code\x3e的图片对象数组。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3eMDN提供了完整的manifest属性列表:\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/Manifest\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWeb App Manifest properties\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e在开发者工具中的 \x3cem\x3eApplication\x3c\/em\x3e tab 左边有 \x3cem\x3eManifest\x3c\/em\x3e 选项，你可以验证你的 manifest JSON 文件，并提供了 “Add to homescreen”。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008880644?w=700\x26amp;h=533\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008880644?w=700\x26amp;h=533\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader7\x22\x3e第三步：创建一个 Service Worker\x3c\/h1\x3e\n\x3cp\x3eService Worker 是拦截和响应你的网络请求的编程接口。这是一个位于你根目录的一个单独的 javascript 文件。\x3c\/p\x3e\n\x3cp\x3e你的 js 文件（在示例代码中是 \x3ccode\x3e\/js\/main.js\x3c\/code\x3e）可以检查是否支持 Service Worker，并且注册：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (\x27serviceWorker\x27 in navigator) {\n\n  \/\/ register service worker\n  navigator.serviceWorker.register(\x27\/service-worker.js\x27);\n\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27serviceWorker\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e navigator) {\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ register service worker\x3c\/span\x3e\n  navigator.serviceWorker.register(\x3cspan class=\x22hljs-string\x22\x3e\x27\/service-worker.js\x27\x3c\/span\x3e);\n\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果你不需要离线功能，可以简单的创建一个空的 \x3ccode\x3e\/service-worker.js\x3c\/code\x3e文件 —— 用户会被提示安装你的 app。\x3c\/p\x3e\n\x3cp\x3eService Worker 很复杂，你可以修改示例代码来达到自己的目的。这是一个标准的 web worker，浏览器用一个单独的线程来下载和执行它。它没有调用 DOM 和其他页面 api 的能力，但他可以拦截网络请求，包括页面切换，静态资源下载，ajax请求所引起的网络请求。\x3c\/p\x3e\n\x3cp\x3e这就是需要 HTTPS 的最主要的原因。想象一下第三方代码可以拦截来自其他网站的 service worker， 将是一个灾难。\x3c\/p\x3e\n\x3cp\x3eservice worker 主要有三个事件： \x3cstrong\x3einstall\x3c\/strong\x3e，\x3cstrong\x3eactivate\x3c\/strong\x3e 和 \x3cstrong\x3efetch\x3c\/strong\x3e。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3eInstall 事件\x3c\/h2\x3e\n\x3cp\x3e这个事件在app被安装时触发。它经常用来缓存必要的文件。缓存通过 \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/Cache\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCache API\x3c\/a\x3e来实现。\x3c\/p\x3e\n\x3cp\x3e首先，我们来构造几个变量：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e缓存名称（\x3ccode\x3eCACHE\x3c\/code\x3e）和版本号（\x3ccode\x3eversion\x3c\/code\x3e）。你的应用可以有多个缓存但是只能引用一个。我们设置了版本号，这样当我们有重大更新时，我们可以更新缓存，而忽略旧的缓存。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e一个离线页面的URL（\x3ccode\x3eofflineURL\x3c\/code\x3e）。当离线时用户试图访问之前未缓存的页面时，这个页面会呈现给用户。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e一个拥有离线功能的页面必要文件的数组（\x3ccode\x3einstallFilesEssential\x3c\/code\x3e）。这个数组应该包含静态资源，比如 CSS 和 JavaScript 文件，但我也把主页面（\x3ccode\x3e\/\x3c\/code\x3e）和图标文件写进去了。如果主页面可以多个URL访问，你应该把他们都写进去，比如\x3ccode\x3e\/\x3c\/code\x3e和\x3ccode\x3e\/index.html\x3c\/code\x3e。注意，\x3ccode\x3eofflineURL\x3c\/code\x3e也要被写入这个数组。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e可选的，描述文件数组（\x3ccode\x3einstallFilesDesirable\x3c\/code\x3e）。这些文件都很会被下载，但如果下载失败不会中止安装。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ configuration\nconst\n  version = \x271.0.0\x27,\n  CACHE = version \x2b \x27::PWAsite\x27,\n  offlineURL = \x27\/offline\/\x27,\n  installFilesEssential = [\n    \x27\/\x27,\n    \x27\/manifest.json\x27,\n    \x27\/css\/styles.css\x27,\n    \x27\/js\/main.js\x27,\n    \x27\/js\/offlinepage.js\x27,\n    \x27\/images\/logo\/logo152.png\x27\n  ].concat(offlineURL),\n  installFilesDesirable = [\n    \x27\/favicon.ico\x27,\n    \x27\/images\/logo\/logo016.png\x27,\n    \x27\/images\/hero\/power-pv.jpg\x27,\n    \x27\/images\/hero\/power-lo.jpg\x27,\n    \x27\/images\/hero\/power-hi.jpg\x27\n  ];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22JavaScript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ configuration\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e\n  version = \x3cspan class=\x22hljs-string\x22\x3e\x271.0.0\x27\x3c\/span\x3e,\n  CACHE = version \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27::PWAsite\x27\x3c\/span\x3e,\n  offlineURL = \x3cspan class=\x22hljs-string\x22\x3e\x27\/offline\/\x27\x3c\/span\x3e,\n  installFilesEssential = [\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/manifest.json\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/css\/styles.css\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/js\/main.js\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/js\/offlinepage.js\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/images\/logo\/logo152.png\x27\x3c\/span\x3e\n  ].concat(offlineURL),\n  installFilesDesirable = [\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/favicon.ico\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/images\/logo\/logo016.png\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/images\/hero\/power-pv.jpg\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/images\/hero\/power-lo.jpg\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/images\/hero\/power-hi.jpg\x27\x3c\/span\x3e\n  ];\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3einstallStaticFiles()\x3c\/code\x3e方法添加文件到缓存，这个方法用到了基于 promise的 \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/Cache\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCache API\x3c\/a\x3e。当必要的文件都被缓存后才会生成返回值。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ install static assets\nfunction installStaticFiles() {\n\n  return caches.open(CACHE)\n    .then(cache =\x3e {\n\n      \/\/ cache desirable files\n      cache.addAll(installFilesDesirable);\n\n      \/\/ cache essential files\n      return cache.addAll(installFilesEssential);\n\n    });\n\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ install static assets\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3einstallStaticFiles\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e caches.open(CACHE)\n    .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ecache\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ cache desirable files\x3c\/span\x3e\n      cache.addAll(installFilesDesirable);\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ cache essential files\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e cache.addAll(installFilesEssential);\n\n    });\n\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后，我们添加\x3ccode\x3einstall\x3c\/code\x3e的事件监听函数。 \x3ccode\x3ewaitUntil\x3c\/code\x3e方法确保所有代码执行完毕后，service worker 才会执行 install。执行 \x3ccode\x3einstallStaticFiles()\x3c\/code\x3e方法，然后执行 \x3ccode\x3eself.skipWaiting()\x3c\/code\x3e方法使service worker进入 active状态。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ application installation\nself.addEventListener(\x27install\x27, event =\x3e {\n\n  console.log(\x27service worker: install\x27);\n\n  \/\/ cache core files\n  event.waitUntil(\n    installStaticFiles()\n    .then(() =\x3e self.skipWaiting())\n  );\n\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ application installation\x3c\/span\x3e\nself.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27install\x27\x3c\/span\x3e, event =\x26gt; {\n\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27service worker: install\x27\x3c\/span\x3e);\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ cache core files\x3c\/span\x3e\n  event.waitUntil(\n    installStaticFiles()\n    .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e self.skipWaiting())\n  );\n\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3eActivate 事件\x3c\/h2\x3e\n\x3cp\x3e当 install完成后， service worker 进入active状态，这个事件立刻执行。你可能不需要实现这个事件监听，但是示例代码在这里删除老旧的无用缓存文件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ clear old caches\nfunction clearOldCaches() {\n\n  return caches.keys()\n    .then(keylist =\x3e {\n\n      return Promise.all(\n        keylist\n          .filter(key =\x3e key !== CACHE)\n          .map(key =\x3e caches.delete(key))\n      );\n\n    });\n\n}\n\n\/\/ application activated\nself.addEventListener(\x27activate\x27, event =\x3e {\n\n  console.log(\x27service worker: activate\x27);\n\n    \/\/ delete old caches\n  event.waitUntil(\n    clearOldCaches()\n    .then(() =\x3e self.clients.claim())\n    );\n\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ clear old caches\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eclearOldCaches\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e caches.keys()\n    .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ekeylist\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.all(\n        keylist\n          .filter(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ekey\x3c\/span\x3e =\x26gt;\x3c\/span\x3e key !== CACHE)\n          .map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ekey\x3c\/span\x3e =\x26gt;\x3c\/span\x3e caches.delete(key))\n      );\n\n    });\n\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ application activated\x3c\/span\x3e\nself.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27activate\x27\x3c\/span\x3e, event =\x26gt; {\n\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27service worker: activate\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ delete old caches\x3c\/span\x3e\n  event.waitUntil(\n    clearOldCaches()\n    .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e self.clients.claim())\n    );\n\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e注意，最后的\x3ccode\x3eself.clients.claim()\x3c\/code\x3e方法设置本身为active的service worker。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3eFetch 事件\x3c\/h2\x3e\n\x3cp\x3e当有网络请求时这个事件被触发。它调用\x3ccode\x3erespondWith()\x3c\/code\x3e方法来劫持 GET 请求并返回：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e缓存中的一个静态资源。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e如果 #1 失败了，就用 \x3ca href=\x22https:\/\/developer.mozilla.org\/en\/docs\/Web\/API\/Fetch_API\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFetch API\x3c\/a\x3e（这与 service worker 的fetch 事件没关系）去网络请求这个资源。然后将这个资源加入缓存。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e如果 #1 和 #2 都失败了，那就返回一个适当的值。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ application fetch network data\nself.addEventListener(\x27fetch\x27, event =\x3e {\n\n  \/\/ abandon non-GET requests\n  if (event.request.method !== \x27GET\x27) return;\n\n  let url = event.request.url;\n\n  event.respondWith(\n\n    caches.open(CACHE)\n      .then(cache =\x3e {\n\n        return cache.match(event.request)\n          .then(response =\x3e {\n\n            if (response) {\n              \/\/ return cached file\n              console.log(\x27cache fetch: \x27 \x2b url);\n              return response;\n            }\n\n            \/\/ make network request\n            return fetch(event.request)\n              .then(newreq =\x3e {\n\n                console.log(\x27network fetch: \x27 \x2b url);\n                if (newreq.ok) cache.put(event.request, newreq.clone());\n                return newreq;\n\n              })\n              \/\/ app is offline\n              .catch(() =\x3e offlineAsset(url));\n\n          });\n\n      })\n\n  );\n\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ application fetch network data\x3c\/span\x3e\nself.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27fetch\x27\x3c\/span\x3e, event =\x26gt; {\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ abandon non-GET requests\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.request.method !== \x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e url = event.request.url;\n\n  event.respondWith(\n\n    caches.open(CACHE)\n      .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ecache\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e cache.match(event.request)\n          .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eresponse\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (response) {\n              \x3cspan class=\x22hljs-comment\x22\x3e\/\/ return cached file\x3c\/span\x3e\n              \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27cache fetch: \x27\x3c\/span\x3e \x2b url);\n              \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e response;\n            }\n\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ make network request\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fetch(event.request)\n              .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3enewreq\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n\n                \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27network fetch: \x27\x3c\/span\x3e \x2b url);\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (newreq.ok) cache.put(event.request, newreq.clone());\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e newreq;\n\n              })\n              \x3cspan class=\x22hljs-comment\x22\x3e\/\/ app is offline\x3c\/span\x3e\n              .catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e offlineAsset(url));\n\n          });\n\n      })\n\n  );\n\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后这个\x3ccode\x3eofflineAsset(url)\x3c\/code\x3e方法通过几个辅助函数返回一个适当的值：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ is image URL?\nlet iExt = [\x27png\x27, \x27jpg\x27, \x27jpeg\x27, \x27gif\x27, \x27webp\x27, \x27bmp\x27].map(f =\x3e \x27.\x27 \x2b f);\nfunction isImage(url) {\n\n  return iExt.reduce((ret, ext) =\x3e ret || url.endsWith(ext), false);\n\n}\n\n\n\/\/ return offline asset\nfunction offlineAsset(url) {\n\n  if (isImage(url)) {\n\n    \/\/ return image\n    return new Response(\n      \x27\x3csvg role=\x26quot;img\x26quot; viewBox=\x26quot;0 0 400 300\x26quot; xmlns=\x26quot;http:\/\/www.w3.org\/2000\/svg\x26quot;\x3e\x3ctitle\x3eoffline\x3c\/title\x3e\x3cpath d=\x26quot;M0 0h400v300H0z\x26quot; fill=\x26quot;#eee\x26quot; \/\x3e\x3ctext x=\x26quot;200\x26quot; y=\x26quot;150\x26quot; text-anchor=\x26quot;middle\x26quot; dominant-baseline=\x26quot;middle\x26quot; font-family=\x26quot;sans-serif\x26quot; font-size=\x26quot;50\x26quot; fill=\x26quot;#ccc\x26quot;\x3eoffline\x3c\/text\x3e\x3c\/svg\x3e\x27,\n      { headers: {\n        \x27Content-Type\x27: \x27image\/svg\x2bxml\x27,\n        \x27Cache-Control\x27: \x27no-store\x27\n      \x22}}\x22\n    );\n\n  }\n  else {\n\n    \/\/ return page\n    return caches.match(offlineURL);\n\n  }\n\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ is image URL?\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e iExt = [\x3cspan class=\x22hljs-string\x22\x3e\x27png\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27jpg\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27jpeg\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27gif\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27webp\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27bmp\x27\x3c\/span\x3e].map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ef\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\x27\x3c\/span\x3e \x2b f);\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisImage\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) \x3c\/span\x3e{\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e iExt.reduce(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eret, ext\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e ret || url.endsWith(ext), \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n\n}\n\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ return offline asset\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eofflineAsset\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) \x3c\/span\x3e{\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (isImage(url)) {\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ return image\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Response(\n      \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;svg role=\x22img\x22 viewBox=\x220 0 400 300\x22 xmlns=\x22http:\/\/www.w3.org\/2000\/svg\x22\x26gt;\x26lt;title\x26gt;offline\x26lt;\/title\x26gt;\x26lt;path d=\x22M0 0h400v300H0z\x22 fill=\x22#eee\x22 \/\x26gt;\x26lt;text x=\x22200\x22 y=\x22150\x22 text-anchor=\x22middle\x22 dominant-baseline=\x22middle\x22 font-family=\x22sans-serif\x22 font-size=\x2250\x22 fill=\x22#ccc\x22\x26gt;offline\x26lt;\/text\x26gt;\x26lt;\/svg\x26gt;\x27\x3c\/span\x3e,\n      { \x3cspan class=\x22hljs-attr\x22\x3eheaders\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-string\x22\x3e\x27Content-Type\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27image\/svg\x2bxml\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x27Cache-Control\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27no-store\x27\x3c\/span\x3e\n      \x22}}\x22\n    );\n\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ return page\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e caches.match(offlineURL);\n\n  }\n\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eofflineAsset()\x3c\/code\x3e方法检查是否是一个图片请求，如果是，那么返回一个带有 “offline” 字样的 SVG。如果不是，返回 \x3ccode\x3eofflineURL\x3c\/code\x3e 页面。\x3c\/p\x3e\n\x3cp\x3e开发者工具提供了查看 Service Worker 相关信息的选项：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008880645?w=700\x26amp;h=533\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008880645?w=700\x26amp;h=533\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e在开发者工具的 \x3cem\x3eCache Storage\x3c\/em\x3e 选项列出了所有当前域内的缓存和所包含的静态文件。当缓存更新的时候，你可以点击左下角的刷新按钮来更新缓存：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008880646?w=700\x26amp;h=533\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008880646?w=700\x26amp;h=533\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e不出意料， \x3cem\x3eClear storage\x3c\/em\x3e 选项可以删除你的 service worker 和缓存：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008880647?w=700\x26amp;h=533\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008880647?w=700\x26amp;h=533\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader11\x22\x3e再来一步 - 第四步：创建一个可用的离线页面\x3c\/h1\x3e\n\x3cp\x3e离线页面可以是一个静态页面，来说明当前用户请求不可用。然而，我们也可以在这个页面上列出可以访问的页面链接。\x3c\/p\x3e\n\x3cp\x3e在\x3ccode\x3emain.js\x3c\/code\x3e中我们可以使用 Cache API 。然而API 使用promises，在不支持的浏览器中会引起所有javascript运行阻塞。为了避免这种情况，我们在加载另一个 \x3ccode\x3e\/js\/offlinepage.js\x3c\/code\x3e 文件之前必须检查离线文件列表和是否支持 Cache API 。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ load script to populate offline page list\nif (document.getElementById(\x27cachedpagelist\x27) \x26amp;\x26amp; \x27caches\x27 in window) {\n  var scr = document.createElement(\x27script\x27);\n  scr.src = \x27\/js\/offlinepage.js\x27;\n  scr.async = 1;\n  document.head.appendChild(scr);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ load script to populate offline page list\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27cachedpagelist\x27\x3c\/span\x3e) \x26amp;\x26amp; \x3cspan class=\x22hljs-string\x22\x3e\x27caches\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e scr = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27script\x27\x3c\/span\x3e);\n  scr.src = \x3cspan class=\x22hljs-string\x22\x3e\x27\/js\/offlinepage.js\x27\x3c\/span\x3e;\n  scr.async = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.head.appendChild(scr);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3e\/js\/offlinepage.js\x3c\/code\x3e  locates the most recent cache by version name, 取到所有 URL的key的列表，移除所有无用 URL，排序所有的列表并且把他们加到 ID 为\x3ccode\x3ecachedpagelist\x3c\/code\x3e的 DOM 节点中：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ cache name\nconst\n  CACHE = \x27::PWAsite\x27,\n  offlineURL = \x27\/offline\/\x27,\n  list = document.getElementById(\x27cachedpagelist\x27);\n\n\/\/ fetch all caches\nwindow.caches.keys()\n  .then(cacheList =\x3e {\n\n    \/\/ find caches by and order by most recent\n    cacheList = cacheList\n      .filter(cName =\x3e cName.includes(CACHE))\n      .sort((a, b) =\x3e a - b);\n\n    \/\/ open first cache\n    caches.open(cacheList[0])\n      .then(cache =\x3e {\n\n        \/\/ fetch cached pages\n        cache.keys()\n          .then(reqList =\x3e {\n\n            let frag = document.createDocumentFragment();\n\n            reqList\n              .map(req =\x3e req.url)\n              .filter(req =\x3e (req.endsWith(\x27\/\x27) || req.endsWith(\x27.html\x27)) \x26amp;\x26amp; !req.endsWith(offlineURL))\n              .sort()\n              .forEach(req =\x3e {\n                let\n                  li = document.createElement(\x27li\x27),\n                  a = li.appendChild(document.createElement(\x27a\x27));\n                  a.setAttribute(\x27href\x27, req);\n                  a.textContent = a.pathname;\n                  frag.appendChild(li);\n              });\n\n            if (list) list.appendChild(frag);\n\n          });\n\n      })\n\n  });\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ cache name\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e\n  CACHE = \x3cspan class=\x22hljs-string\x22\x3e\x27::PWAsite\x27\x3c\/span\x3e,\n  offlineURL = \x3cspan class=\x22hljs-string\x22\x3e\x27\/offline\/\x27\x3c\/span\x3e,\n  list = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27cachedpagelist\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ fetch all caches\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.caches.keys()\n  .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ecacheList\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ find caches by and order by most recent\x3c\/span\x3e\n    cacheList = cacheList\n      .filter(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ecName\x3c\/span\x3e =\x26gt;\x3c\/span\x3e cName.includes(CACHE))\n      .sort(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, b\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e a - b);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ open first cache\x3c\/span\x3e\n    caches.open(cacheList[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e])\n      .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ecache\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ fetch cached pages\x3c\/span\x3e\n        cache.keys()\n          .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ereqList\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e frag = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createDocumentFragment();\n\n            reqList\n              .map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ereq\x3c\/span\x3e =\x26gt;\x3c\/span\x3e req.url)\n              .filter(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ereq\x3c\/span\x3e =\x26gt;\x3c\/span\x3e (req.endsWith(\x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e) || req.endsWith(\x3cspan class=\x22hljs-string\x22\x3e\x27.html\x27\x3c\/span\x3e)) \x26amp;\x26amp; !req.endsWith(offlineURL))\n              .sort()\n              .forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ereq\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n                \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e\n                  li = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e),\n                  a = li.appendChild(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e));\n                  a.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x27href\x27\x3c\/span\x3e, req);\n                  a.textContent = a.pathname;\n                  frag.appendChild(li);\n              });\n\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (list) list.appendChild(frag);\n\n          });\n\n      })\n\n  });\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader12\x22\x3e开发工具\x3c\/h1\x3e\n\x3cp\x3e如果你觉得 javascript 调试困难，那么 service worker 也不会很好。Chrome的开发者工具的 \x3cem\x3eApplication\x3c\/em\x3e 提供了一系列调试工具。\x3c\/p\x3e\n\x3cp\x3e你应该打开 \x3cem\x3e隐身窗口\x3c\/em\x3e 来测试你的 app，这样在你关闭这个窗口之后缓存文件就不会保存下来。\x3c\/p\x3e\n\x3cp\x3e最后，\x3ca href=\x22https:\/\/chrome.google.com\/webstore\/detail\/lighthouse\/blipmdconlkpinefehnmjammfjpmpbjk\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eLighthouse extension for Chrome\x3c\/a\x3e 提供了很多改进 PWA 的有用信息。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader13\x22\x3ePWA 陷阱\x3c\/h1\x3e\n\x3cp\x3e有几点需要注意：\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader14\x22\x3eURL 隐藏\x3c\/h2\x3e\n\x3cp\x3e我们的示例代码隐藏了 URL 栏，我不推荐这种做法，除非你有一个单 url 应用，比如一个游戏。对于多数网站，manifest 选项 \x3ccode\x3edisplay: minimal-ui\x3c\/code\x3e 或者 \x3ccode\x3edisplay: browser\x3c\/code\x3e是最好的选择。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader15\x22\x3e缓存太多\x3c\/h2\x3e\n\x3cp\x3e你可以缓存你网站的所有页面和所有静态文件。这对于一个小网站是可行的，但这对于上千个页面的大型网站实际吗？没有人会对你网站的所有内容都感兴趣，而设备的内存容量将是一个限制。即使你像示例代码一样只缓存访问过的页面和文件，缓存大小也会增长的很快。\x3c\/p\x3e\n\x3cp\x3e也许你需要注意：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e只缓存重要的页面，类似主页，和最近的文章。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e不要缓存图片，视频和其他大型文件\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e经常删除旧的缓存文件\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e提供一个缓存按钮给用户，让用户决定是否缓存\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader16\x22\x3e缓存刷新\x3c\/h2\x3e\n\x3cp\x3e在示例代码中，用户在请求网络前先检查该文件是否缓存。如果缓存，就使用缓存文件。这在离线情况下很棒，但也意味着在联网情况下，用户得到的可能不是最新数据。\x3c\/p\x3e\n\x3cp\x3e静态文件，类似于图片和视频等，不会经常改变的资源，做长时间缓存没有很大的问题。你可以在HTTP 头里设置 \x3ccode\x3eCache-Control\x3c\/code\x3e 来缓存文件使其缓存时间为一年（31,536,000 seconds）：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Cache-Control: max-age=31536000\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lasso\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eCache\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e-Control\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3emax\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e-age\x3c\/span\x3e=\x3cspan class=\x22hljs-number\x22\x3e31536000\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e页面，CSS和 script 文件会经常变化，所以你应该改设置一个很短的缓存时间比如 24 小时，并在联网时与服务端文件进行验证：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Cache-Control: must-revalidate, max-age=86400\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lasso\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eCache\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e-Control\x3c\/span\x3e: must\x3cspan class=\x22hljs-params\x22\x3e-revalidate\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3emax\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e-age\x3c\/span\x3e=\x3cspan class=\x22hljs-number\x22\x3e86400\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e译自 \x3ca href=\x22https:\/\/www.sitepoint.com\/retrofit-your-website-as-a-progressive-web-app\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRetrofit Your Website as a Progressive Web App\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>改造你的网站，变身 PWA</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008880637">https://segmentfault.com/a/1190000008880637</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/cyzvez51uqg/" target="_blank">https://alili.tech/archive/cyzvez51uqg/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>