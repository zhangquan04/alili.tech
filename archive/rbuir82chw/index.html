<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="如何打造一个令人愉悦的前端开发环境（四）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>如何打造一个令人愉悦的前端开发环境（四） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/rbuir82chw/",
				"appid": "1613049289050283", 
				"title": "如何打造一个令人愉悦的前端开发环境（四） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-01T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/vvnrq7e89cq/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/yxoqi8usq1c/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2frbuir82chw%2f&text=%e5%a6%82%e4%bd%95%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e4%bb%a4%e4%ba%ba%e6%84%89%e6%82%a6%e7%9a%84%e5%89%8d%e7%ab%af%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%ef%bc%88%e5%9b%9b%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2frbuir82chw%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2frbuir82chw%2f&text=%e5%a6%82%e4%bd%95%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e4%bb%a4%e4%ba%ba%e6%84%89%e6%82%a6%e7%9a%84%e5%89%8d%e7%ab%af%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%ef%bc%88%e5%9b%9b%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2frbuir82chw%2f&title=%e5%a6%82%e4%bd%95%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e4%bb%a4%e4%ba%ba%e6%84%89%e6%82%a6%e7%9a%84%e5%89%8d%e7%ab%af%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%ef%bc%88%e5%9b%9b%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2frbuir82chw%2f&is_video=false&description=%e5%a6%82%e4%bd%95%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e4%bb%a4%e4%ba%ba%e6%84%89%e6%82%a6%e7%9a%84%e5%89%8d%e7%ab%af%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%ef%bc%88%e5%9b%9b%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%a6%82%e4%bd%95%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e4%bb%a4%e4%ba%ba%e6%84%89%e6%82%a6%e7%9a%84%e5%89%8d%e7%ab%af%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%ef%bc%88%e5%9b%9b%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2frbuir82chw%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2frbuir82chw%2f&title=%e5%a6%82%e4%bd%95%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e4%bb%a4%e4%ba%ba%e6%84%89%e6%82%a6%e7%9a%84%e5%89%8d%e7%ab%af%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%ef%bc%88%e5%9b%9b%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frbuir82chw%2f&title=%e5%a6%82%e4%bd%95%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e4%bb%a4%e4%ba%ba%e6%84%89%e6%82%a6%e7%9a%84%e5%89%8d%e7%ab%af%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%ef%bc%88%e5%9b%9b%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frbuir82chw%2f&title=%e5%a6%82%e4%bd%95%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e4%bb%a4%e4%ba%ba%e6%84%89%e6%82%a6%e7%9a%84%e5%89%8d%e7%ab%af%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%ef%bc%88%e5%9b%9b%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frbuir82chw%2f&title=%e5%a6%82%e4%bd%95%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e4%bb%a4%e4%ba%ba%e6%84%89%e6%82%a6%e7%9a%84%e5%89%8d%e7%ab%af%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%ef%bc%88%e5%9b%9b%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">如何打造一个令人愉悦的前端开发环境（四）</h1><div class="meta"><div class="postdate"><time datetime="2019-02-01" itemprop="datePublished">2019-02-01</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3ca href=\x22http:\/\/www.jianshu.com\/p\/469ad98ad1da\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e原文链接\x3c\/a\x3e\x3cbr\x3e此文是我同事写的，搭建Express结合Webpack。以下是正文，后面我会附上我的解读\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3eExpress 结合 Webpack 实现HMR\x3c\/h1\x3e\n\x3cp\x3e本篇文件主要讲结合 Webpack 和 Express 实现前后端热更新开发，如果你还不太了解webpack推荐阅读\x3cbr\x3e\x3ca href=\x22http:\/\/webpack.github.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack 官网文档\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3eWhat\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e什么是 webpack dev server\x3c\/h3\x3e\n\x3cp\x3eWebpack dev server 是一个轻量的node.js express服务器，实现了 webpack 编译代码实时输出更新。在前后端分离的前端项目开发中经常用到。不过这篇文章应该不会讲到它。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3ewebpack dev middleware\x3c\/h3\x3e\n\x3cp\x3eWebpack dev middleware 是 WebPack 的一个中间件。它用于在 Express 中分发需要通过 WebPack 编译的文件。单独使用它就可以完成代码的热重载（hot reloading）功能。\x3c\/p\x3e\n\x3cp\x3e特性：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e不会在硬盘中写入文件，完全基于内存实现。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e如果使用 watch 模式监听代码修改，Webpack 会自动编译，如果在 Webpack 编译过程中请求文件，Webpack dev middleware 会延迟请求，直到编译完成之后再开始发送编译完成的文件。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3ewebpack hot middleware\x3c\/h3\x3e\n\x3cp\x3eWebpack hot middleware 它通过订阅 Webpack 的编译更新，之后通过执行 webpack 的 HMR api 将这些代码模块的更新推送给浏览器端。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3eHMR\x3c\/h2\x3e\n\x3cp\x3eHMR 即 Hot Module Replacement 是 Webpack 一个重要的功能。它可以使我们不用通过手动地刷新浏览器页面实现将我们的更新代码实时应用到当前页面中。\x3c\/p\x3e\n\x3cp\x3eHMR 的实现原理是在我们的开发中的应用代码中加入了 HMR Runtime，它是 HMR 的客户端（浏览器端 client）用于和开发服务器通信，接收更新的模块。服务端工作就是前面提到的 Webpack hot middleware 的，它会在代码更新编译完成之后通过以 json 格式输出给HMR Runtime 就会更具 json 中描述来动态更新相应的代码。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007372651\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007372651\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3eHow\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3ewebpack 配置\x3c\/h3\x3e\n\x3cp\x3e先来在webpack配置文件中引入\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var webpack = require(\x27webpack\x27);\nvar HotMiddleWareConfig = \x27webpack-hot-middleware\/client?path=\/__webpack_hmr\x26amp;timeout=20000\x27\n\nmodule.exports = {\n    context: __dirname,\n    entry: [\n        \/\/ 添加一个和HotMiddleWare通信的客户端             \n        HotMiddleWareConfig,\n        \/\/ 添加web应用入口文件 \n        \x27.\/client.js\x27\n    ],\n    output: {\n        path: __dirname,\n        publicPath: \x27\/\x27,\n        filename: \x27bundle.js\x27\n    },\n    devtool: \x27#source-map\x27,\n    plugins: [\n        new webpack.optimize.OccurenceOrderPlugin(),\n        \/\/ 在 webpack 插件中引入 webpack.HotModuleReplacementPlugin \n        new webpack.HotModuleReplacementPlugin(),\n        new webpack.NoErrorsPlugin()\n    ],\n};\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e webpack = require(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e HotMiddleWareConfig = \x3cspan class=\x22hljs-string\x22\x3e\x27webpack-hot-middleware\/client?path=\/__webpack_hmr\x26amp;timeout=20000\x27\x3c\/span\x3e\n\nmodule.exports = {\n    context: \x3cspan class=\x22hljs-type\x22\x3e__dirname\x3c\/span\x3e,\n    entry: \x3cspan class=\x22hljs-type\x22\x3e\x3c\/span\x3e[\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加一个和HotMiddleWare通信的客户端             \x3c\/span\x3e\n        HotMiddleWareConfig,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加web应用入口文件 \x3c\/span\x3e\n        \x3cspan class=\x22hljs-string\x22\x3e\x27.\/client.js\x27\x3c\/span\x3e\n    ],\n    output: \x3cspan class=\x22hljs-type\x22\x3e\x3c\/span\x3e{\n        path: \x3cspan class=\x22hljs-type\x22\x3e__dirname\x3c\/span\x3e,\n        publicPath: \x3cspan class=\x22hljs-type\x22\x3e\x3c\/span\x3e\x27\/\x3cspan class=\x22hljs-string\x22\x3e\x27,\n        filename: \x27\x3c\/span\x3ebundle.js\x3cspan class=\x22hljs-string\x22\x3e\x27\n    },\n    devtool: \x27\x3c\/span\x3e\x3cspan class=\x22hljs-meta\x22\x3e#source-map\x27,\x3c\/span\x3e\n    plugins: \x3cspan class=\x22hljs-type\x22\x3e\x3c\/span\x3e[\n        \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3ewebpack\x3c\/span\x3e.optimize.OccurenceOrderPlugin(),\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在 webpack 插件中引入 webpack.HotModuleReplacementPlugin \x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3ewebpack\x3c\/span\x3e.HotModuleReplacementPlugin(),\n        \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3ewebpack\x3c\/span\x3e.NoErrorsPlugin()\n    ],\n};\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/glenjamin\/webpack-hot-middleware\/blob\/master\/example\/webpack.config.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack-hot-middleware example webpack.config.js\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e在我们的开发环境中是这样配置的。getEntries 是自动根据我们规则获取到入口文件并加上 webpack hot middle 配置。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var webpack = require(\x27webpack\x27);\nvar path = require(\x27path\x27)\nvar merge = require(\x27webpack-merge\x27)\nvar baseConfig = require(\x27.\/webpack.base\x27)\nvar getEntries = require(\x27.\/getEntries\x27)\n\nvar publicPath = \x27http:\/\/0.0.0.0:7799\/dist\/\x27;\nvar hotMiddlewareScript = \x27webpack-hot-middleware\/client?reload=true\x27;\n\nvar assetsInsert = require(\x27.\/assetsInsert\x27)\n\nmodule.exports = merge(baseConfig, {\n  entry: getEntries(hotMiddlewareScript),\n  devtool: \x27#eval-source-map\x27,\n  output: {\n    filename: \x27.\/[name].[hash].js\x27,\n    path: path.resolve(\x27.\/public\/dist\x27),\n    publicPath: publicPath\n  },\n  plugins: [\n    new webpack.DefinePlugin({\n      \x27process.env\x27: {\n        NODE_ENV: \x27\x26quot;development\x26quot;\x27\n      }\n    }),\n    new webpack.optimize.OccurenceOrderPlugin(),\n    new webpack.HotModuleReplacementPlugin(),\n    new webpack.NoErrorsPlugin(),\n    new assetsInsert()\n  ]\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e webpack = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e path = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27path\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e merge = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack-merge\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e baseConfig = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/webpack.base\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e getEntries = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/getEntries\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e publicPath = \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/0.0.0.0:7799\/dist\/\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e hotMiddlewareScript = \x3cspan class=\x22hljs-string\x22\x3e\x27webpack-hot-middleware\/client?reload=true\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e assetsInsert = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/assetsInsert\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = merge(baseConfig, {\n  \x3cspan class=\x22hljs-attr\x22\x3eentry\x3c\/span\x3e: getEntries(hotMiddlewareScript),\n  \x3cspan class=\x22hljs-attr\x22\x3edevtool\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27#eval-source-map\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eoutput\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/[name].[hash].js\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: path.resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/public\/dist\x27\x3c\/span\x3e),\n    \x3cspan class=\x22hljs-attr\x22\x3epublicPath\x3c\/span\x3e: publicPath\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: [\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.DefinePlugin({\n      \x3cspan class=\x22hljs-string\x22\x3e\x27process.env\x27\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3eNODE_ENV\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x22development\x22\x27\x3c\/span\x3e\n      }\n    }),\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.OccurenceOrderPlugin(),\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.HotModuleReplacementPlugin(),\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.NoErrorsPlugin(),\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e assetsInsert()\n  ]\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3eExpress 中的配置\x3c\/h3\x3e\n\x3cp\x3e在 Express 的配置主要就4个步骤：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e引入 webpack 的配置文件和 生成 webpack 的编译器\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e将编译器连接至 webpack dev middleware\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e将编译器连接至 webpack hot middleware\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e定义 express 配置\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var http = require(\x27http\x27);\n\nvar express = require(\x27express\x27);\n\nvar app = express();\n\napp.use(require(\x27morgan\x27)(\x27short\x27));\n\n\/\/ ************************************\n\/\/ This is the real meat of the example\n\/\/ ************************************\n(function() {\n  \/\/ Step 1: 引入 webpack 的配置文件和 生成 webpack 的编译器\n  var webpack = require(\x27webpack\x27);\n  var webpackConfig = require(process.env.WEBPACK_CONFIG ? process.env.WEBPACK_CONFIG : \x27.\/webpack.config\x27);\n  var compiler = webpack(webpackConfig);\n  \/\/ Step 2: 将编译器挂载给 webpack dev middleware\n  app.use(require(\x26quot;webpack-dev-middleware\x26quot;)(compiler, {\n    noInfo: true, publicPath: webpackConfig.output.publicPath\n  }));\n\n  \/\/ Step 3: 将编译器挂载给 webpack hot middleware\n  app.use(require(\x26quot;webpack-hot-middleware\x26quot;)(compiler, {\n    log: console.log, path: \x27\/__webpack_hmr\x27, heartbeat: 10 * 1000\n  }));\n})();\n\n\/\/ 定义 express 配置\n\napp.get(\x26quot;\/\x26quot;, function(req, res) {\n  res.sendFile(__dirname \x2b \x27\/index.html\x27);\n});\napp.get(\x26quot;\/multientry\x26quot;, function(req, res) {\n  res.sendFile(__dirname \x2b \x27\/index-multientry.html\x27);\n});\n\nif (require.main === module) {\n  var server = http.createServer(app);\n  server.listen(process.env.PORT || 1616, function() {\n    console.log(\x26quot;Listening on %j\x26quot;, server.address());\n  });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e http = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27http\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27express\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\n\napp.use(\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27morgan\x27\x3c\/span\x3e)(\x3cspan class=\x22hljs-string\x22\x3e\x27short\x27\x3c\/span\x3e));\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ************************************\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ This is the real meat of the example\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ************************************\x3c\/span\x3e\n(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Step 1: 引入 webpack 的配置文件和 生成 webpack 的编译器\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e webpack = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e webpackConfig = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(process.env.WEBPACK_CONFIG ? process.env.WEBPACK_CONFIG : \x3cspan class=\x22hljs-string\x22\x3e\x27.\/webpack.config\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e compiler = webpack(webpackConfig);\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Step 2: 将编译器挂载给 webpack dev middleware\x3c\/span\x3e\n  app.use(\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22webpack-dev-middleware\x22\x3c\/span\x3e)(compiler, {\n    \x3cspan class=\x22hljs-attr\x22\x3enoInfo\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3epublicPath\x3c\/span\x3e: webpackConfig.output.publicPath\n  }));\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Step 3: 将编译器挂载给 webpack hot middleware\x3c\/span\x3e\n  app.use(\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22webpack-hot-middleware\x22\x3c\/span\x3e)(compiler, {\n    \x3cspan class=\x22hljs-attr\x22\x3elog\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log, \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/__webpack_hmr\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3eheartbeat\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e\n  }));\n})();\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 定义 express 配置\x3c\/span\x3e\n\napp.get(\x3cspan class=\x22hljs-string\x22\x3e\x22\/\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n  res.sendFile(__dirname \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\/index.html\x27\x3c\/span\x3e);\n});\napp.get(\x3cspan class=\x22hljs-string\x22\x3e\x22\/multientry\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n  res.sendFile(__dirname \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\/index-multientry.html\x27\x3c\/span\x3e);\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e.main === \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e server = http.createServer(app);\n  server.listen(process.env.PORT || \x3cspan class=\x22hljs-number\x22\x3e1616\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22Listening on %j\x22\x3c\/span\x3e, server.address());\n  });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/glenjamin\/webpack-hot-middleware\/blob\/master\/example\/server.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack-hot-middleware example server.js\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e区分开发和生产环境\x3c\/h3\x3e\n\x3cp\x3e要注意的是一定要在定义 express router 前定义 webpack 相关的中间件。还有一点是这里server.js 只是开发环境中使用，在生成环境中我们就不需要再用到它们了。所以在我们实际的使用中需要通过定义环境变量来区分开发和生产环境\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var NODE_ENV = process.env.NODE_ENV || \x27production\x27;\nvar isDev = NODE_ENV === \x27development\x27;\n\nif (isDev) {\n    var webpack = require(\x27webpack\x27),\n        webpackDevMiddleware = require(\x27webpack-dev-middleware\x27),\n        webpackHotMiddleware = require(\x27webpack-hot-middleware\x27),\n        webpackDevConfig = require(\x27.\/build\/webpack.config.js\x27);\n\n    var compiler = webpack(webpackDevConfig);\n\n    app.use(webpackDevMiddleware(compiler, {\n        publicPath: webpackDevConfig.output.publicPath,\n        noInfo: true,\n        stats: {\n            colors: true\n        }\n    }));\n\n    app.use(webpackHotMiddleware(compiler));\n\n    routerConfig(app, {\n        dirPath: __dirname \x2b \x27\/server\/routes\/\x27,\n        map: {\n            \x27index\x27: \x27\/\x27,\n            \x27api\x27: \x27\/api\/*\x27,\n            \x27proxy\x27: \x27\/proxy\/*\x27\n        }\n    });\n\n    var reload = require(\x27reload\x27);\n    var http = require(\x27http\x27);\n\n    var server = http.createServer(app);\n    reload(server, app);\n\n    app.use(express.static(path.join(__dirname, \x27public\x27)));\n\n    server.listen(port, function() {\n        console.log(\x27App (dev) is now running on port \x27 \x2b port \x2b \x27!\x27);\n    });\n} else {\n    routerConfig(app, {\n        dirPath: __dirname \x2b \x27\/server\/routes\/\x27,\n        map: {\n            \x27index\x27: \x27\/\x27,\n            \x27api\x27: \x27\/api\/*\x27,\n            \x27proxy\x27: \x27\/proxy\/*\x27\n        }\n    });\n    app.use(express.static(path.join(__dirname, \x27public\x27)));\n\n    app.listen(port, function() {\n        console.log(\x27App (dev) is now running on port \x27 \x2b port \x2b \x27!\x27);\n    });\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e NODE_ENV = process.env.NODE_ENV || \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e isDev = NODE_ENV === \x3cspan class=\x22hljs-string\x22\x3e\x27development\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (isDev) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e webpack = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack\x27\x3c\/span\x3e),\n        webpackDevMiddleware = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack-dev-middleware\x27\x3c\/span\x3e),\n        webpackHotMiddleware = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack-hot-middleware\x27\x3c\/span\x3e),\n        webpackDevConfig = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/build\/webpack.config.js\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e compiler = webpack(webpackDevConfig);\n\n    app.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(webpackDevMiddleware(compiler, {\n        publicPath: webpackDevConfig.output.publicPath,\n        noInfo: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,\n        stats: {\n            colors: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e\n        }\n    }));\n\n    app.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(webpackHotMiddleware(compiler));\n\n    routerConfig(app, {\n        dirPath: __dirname \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\/server\/routes\/\x27\x3c\/span\x3e,\n        map: {\n            \x3cspan class=\x22hljs-string\x22\x3e\x27index\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-string\x22\x3e\x27api\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/*\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-string\x22\x3e\x27proxy\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/proxy\/*\x27\x3c\/span\x3e\n        }\n    });\n\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e reload = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27reload\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e http = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27http\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e server = http.createServer(app);\n    reload(server, app);\n\n    app.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(express.\x3cspan class=\x22hljs-keyword\x22\x3estatic\x3c\/span\x3e(path.join(__dirname, \x3cspan class=\x22hljs-string\x22\x3e\x27public\x27\x3c\/span\x3e)));\n\n    server.listen(port, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n        console.log(\x3cspan class=\x22hljs-string\x22\x3e\x27App (dev) is now running on port \x27\x3c\/span\x3e \x2b port \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27!\x27\x3c\/span\x3e);\n    });\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    routerConfig(app, {\n        dirPath: __dirname \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\/server\/routes\/\x27\x3c\/span\x3e,\n        map: {\n            \x3cspan class=\x22hljs-string\x22\x3e\x27index\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-string\x22\x3e\x27api\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/*\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-string\x22\x3e\x27proxy\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/proxy\/*\x27\x3c\/span\x3e\n        }\n    });\n    app.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(express.\x3cspan class=\x22hljs-keyword\x22\x3estatic\x3c\/span\x3e(path.join(__dirname, \x3cspan class=\x22hljs-string\x22\x3e\x27public\x27\x3c\/span\x3e)));\n\n    app.listen(port, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n        console.log(\x3cspan class=\x22hljs-string\x22\x3e\x27App (dev) is now running on port \x27\x3c\/span\x3e \x2b port \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27!\x27\x3c\/span\x3e);\n    });\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3esupervisor\x3c\/h3\x3e\n\x3cp\x3e以上在前端我们实现了前端文件的热更新，但是我们在修改服务端文件的时候，并不会使Node自动重启，所以我们使用 supervisor 来作为监听文件修改事件来自动重启 Node服务。\x3cbr\x3esupervisor 需要 全局安装\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  npm install supervisor -g\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cmake\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e  npm \x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e supervisor -g\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e安装完成之后我们就可以在命令行中使用\x3cbr\x3e我们在 package.json 的 scripts 中写好常用的命令，之后只用 npm run xxx 即可使用\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;scripts\x26quot;: {\n    \x26quot;dev\x26quot;: \x26quot;export NODE_ENV=development \x26amp;\x26amp; supervisor -w server,app.js app\x26quot;,\n    \x26quot;build\x26quot;: \x26quot;node build\/build.js\x26quot;,\n    \x26quot;start\x26quot;: \x26quot;node app\x26quot;\n  },\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-string\x22\x3e\x22dev\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22export NODE_ENV=development \x26amp;\x26amp; supervisor -w server,app.js app\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22build\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22node build\/build.js\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22start\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22node app\x22\x3c\/span\x3e\n  },\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/petruisfan\/node-supervisor\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3enode-supervisor\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22supervisor [options] \x3cprogram\x3e\n\nsupervisor -w server,app.js app\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3esupervisor [options] \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3eprogram\x3c\/span\x3e\x26gt;\n\nsupervisor -w server,\x3cspan class=\x22hljs-keyword\x22\x3eapp\x3c\/span\x3e.js \x3cspan class=\x22hljs-keyword\x22\x3eapp\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e-w 就是一个 options 配置项，它用于监听指定目录或者文件的变更，可以使用，\x3cbr\x3e分隔，监听多个目录或者文件，这就是监听了 server 目录和根目录的 app.js 到变更之后就会重启我们的 Express 入口文件 app。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader11\x22\x3e我自己的解读\x3c\/h1\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e首先解释下他原文代码几个难以解释的点：\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3egetEntries 这个是我们自己的载入入口文件的统一方法，具体内容其实我前面的文章提到过，就是规定好了的，文件夹目录下的main.js就是我们的入口文件，其他全部忽略，原因也说过，这里再说一次，规定死了，简单，方便，利于合作。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evar publicPath = \x27\x3ca href=\x22http:\/\/0.0.0.0:7799\/dist\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/0.0.0.0:7799\/dist\/\x3c\/a\x3e\x27; 这里publicPath和大家平时配置Webpack的publicPath 不太一样的原因，是需要Express能够认出绝对地址来，因为你项目是Express大于Webpack的。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3erouterConfig 这个方法是我们自己的一个方法，内容前面文章提到过，就是我写的一个用来加载所有路由的方法，免得重复写各种引用。\x3ca href=\x22https:\/\/www.npmjs.com\/package\/express-auto-router\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3enpm地址\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eexport NODE_ENV=development 注意这里，windows的环境可能会失败，可以替换成 cross-env NODE_ENV=development\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3e其次说下这么做的原因\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e前面文章也提到了，我司目前前端的整体架构是使用Node做中间层,那么问题就是Node渲染层会高于Webpack层，而且很多时候，不一定使用SPA的方式，要兼容这个架构，所以才需要这些配置。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e这个配置也很好解决了我们开发中的几个痛点，一个Node自动重新，一个文件热更新，结合起来，基本不需要自己不停的手动刷新浏览器，而且能保存当前状态，这点很关键，能节省不少时间，提升开发效率。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e当然也有痛点，例如要多一个模板文件，而且文件目录要根据规范来，要不是不会渲染的。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3e最后记得这是一个连续的文章系列，只看这里你不一定能配置成功！！！！\x3c\/h3\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>如何打造一个令人愉悦的前端开发环境（四）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007372648">https://segmentfault.com/a/1190000007372648</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/rbuir82chw/" target="_blank">https://alili.tech/archive/rbuir82chw/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>