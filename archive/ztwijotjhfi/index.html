<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="使用dva&#43;antd快速构建单页面应用"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>使用dva&#43;antd快速构建单页面应用 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/ztwijotjhfi/",
				"appid": "1613049289050283", 
				"title": "使用dva&#43;antd快速构建单页面应用 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-18T02:30:34"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/r6vmztglv6t/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/zvf1d8yq4t/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fztwijotjhfi%2f&text=%e4%bd%bf%e7%94%a8dva%2bantd%e5%bf%ab%e9%80%9f%e6%9e%84%e5%bb%ba%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fztwijotjhfi%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fztwijotjhfi%2f&text=%e4%bd%bf%e7%94%a8dva%2bantd%e5%bf%ab%e9%80%9f%e6%9e%84%e5%bb%ba%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fztwijotjhfi%2f&title=%e4%bd%bf%e7%94%a8dva%2bantd%e5%bf%ab%e9%80%9f%e6%9e%84%e5%bb%ba%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fztwijotjhfi%2f&is_video=false&description=%e4%bd%bf%e7%94%a8dva%2bantd%e5%bf%ab%e9%80%9f%e6%9e%84%e5%bb%ba%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%bf%e7%94%a8dva%2bantd%e5%bf%ab%e9%80%9f%e6%9e%84%e5%bb%ba%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fztwijotjhfi%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fztwijotjhfi%2f&title=%e4%bd%bf%e7%94%a8dva%2bantd%e5%bf%ab%e9%80%9f%e6%9e%84%e5%bb%ba%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fztwijotjhfi%2f&title=%e4%bd%bf%e7%94%a8dva%2bantd%e5%bf%ab%e9%80%9f%e6%9e%84%e5%bb%ba%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fztwijotjhfi%2f&title=%e4%bd%bf%e7%94%a8dva%2bantd%e5%bf%ab%e9%80%9f%e6%9e%84%e5%bb%ba%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fztwijotjhfi%2f&title=%e4%bd%bf%e7%94%a8dva%2bantd%e5%bf%ab%e9%80%9f%e6%9e%84%e5%bb%ba%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">使用dva&#43;antd快速构建单页面应用</h1><div class="meta"><div class="postdate"><time datetime="2019-01-18" itemprop="datePublished">2019-01-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e项目结构及使用工具集\x3c\/h2\x3e\n\x3cp\x3e原文地址: \x3ca href=\x22http:\/\/www.mh611.com\/blog\/2017\/03\/23\/build-app-with-dva-antd\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e个人博客\x3c\/a\x3e或\x3ca href=\x22http:\/\/joescott.coding.me\/blog\/2017\/03\/23\/build-app-with-dva-antd\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejoescott.coding.me\/blog\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22`project\n   |----- src    项目源代码\n   |----- dist   项目编译目标\n   |----- .roadhogrc 路霸运行配置文件\n   |----- lumen_api RESTful api代码目录\n   |----- mock   模拟数据服务目录\n\n\n`src\n  |---  index.js      入口js文件\n  |---  index.html    项目入口html文件\n  |---  router.js     路由文件\n  |---  routes        子路由目录， 下面每个子路由使用一个单独的文件夹\n  |---  components    组件目录，这里特指公共组件\n  |---  models        model目录\n  |---  services      服务目录\n  |---  utils         工具包目录\n  |---  constants.js  常量文件，这个文件其实可放入utils目录，然后统一暴露出去\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs 1c\x22\x3e\x3ccode\x3e`project\n   \x3cspan class=\x22hljs-string\x22\x3e|----- src    项目源代码\x3c\/span\x3e\n   \x3cspan class=\x22hljs-string\x22\x3e|----- dist   项目编译目标\x3c\/span\x3e\n   \x3cspan class=\x22hljs-string\x22\x3e|----- .roadhogrc 路霸运行配置文件\x3c\/span\x3e\n   \x3cspan class=\x22hljs-string\x22\x3e|----- lumen_api RESTful api代码目录\x3c\/span\x3e\n   \x3cspan class=\x22hljs-string\x22\x3e|----- mock   模拟数据服务目录\x3c\/span\x3e\n\n\n`src\n  \x3cspan class=\x22hljs-string\x22\x3e|---  index.js      入口js文件\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e|---  index.html    项目入口html文件\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e|---  router.js     路由文件\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e|---  routes        子路由目录， 下面每个子路由使用一个单独的文件夹\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e|---  components    组件目录，这里特指公共组件\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e|---  models        model目录\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e|---  services      服务目录\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e|---  utils         工具包目录\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e|---  constants.js  常量文件，这个文件其实可放入utils目录，然后统一暴露出去\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e以上是项目中的总体目录结构。 下面详细介绍几个重要部分的结构。\x3c\/p\x3e\n\x3cp\x3e此应用是当入口应用，入口在src\/index.js， 配置在.roadhogrc中，当然roadhog还支持多入口模式，这里不涉及。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e组件系统\x3c\/h2\x3e\n\x3cp\x3e项目中组件分为两大类, 容器组件和呈现组件。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e容器组件\x3c\/h3\x3e\n\x3cp\x3e容器组件对应于每个独立的route页面。每个容器组件都维护一个相关的state, 所有的state改变都由容器最终执行。容器组件负责向其子组件(呈现组件)分配属性(props)。\x3c\/p\x3e\n\x3cp\x3e该项目中，所有子组件仅作呈现组件，没有state, 只有从父级组件传递下来的props。state由容器组件统一管理，然后分发到子组件中。\x3c\/p\x3e\n\x3cp\x3e容器组件在该项目中以路由组件的形式存在，存放在src\/routes下面对应的子目录中。每个容器组件使用的子组件(非共享的)都在路由组件目录中存放。而使用到的公共组件则存放在components目录下面。例如公共组件提供数据表的包装，下拉操作控件包装等等，在多个容器组件的子组件中会用到。都被抽离到components目录中。\x3c\/p\x3e\n\x3cp\x3e容器组件的范本如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ routes\/users\/index.js\nimport React, { PropTypes } from \x27react\x27\nimport { RouterRedux } from \x27dva\/router\x27\nimport { connect } from \x27dva\x27\nfunction Users({ location, dispatch, users, loading }) {\n}\nUsers.propTypes = {\n  menus: PropTypes.object,\n  \/\/ ...\n}\nfunction mapStateToProps(state) {\n  return {\n    users: state.users,\n    loading: state.loading.models.users,\n  }\n}\nexport default connect(mapStateToProps)(Users)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ routes\/users\/index.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React, { PropTypes } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { RouterRedux } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27dva\/router\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { connect } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27dva\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eUsers\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e{ location, dispatch, users, loading }\x3c\/span\x3e) \x3c\/span\x3e{\n}\nUsers.propTypes = {\n  \x3cspan class=\x22hljs-attr\x22\x3emenus\x3c\/span\x3e: PropTypes.object,\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emapStateToProps\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3estate\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3eusers\x3c\/span\x3e: state.users,\n    \x3cspan class=\x22hljs-attr\x22\x3eloading\x3c\/span\x3e: state.loading.models.users,\n  }\n}\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e connect(mapStateToProps)(Users)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e创建一个类Users, 接收一些参数，用于类自己使用，后面会通过connect将state联系给这些参数。\x3cbr\x3e设置类的propTypes, 编译的时候会对属性进行检查，发现类型错误，编译失败。确保项目质量。\x3c\/p\x3e\n\x3cp\x3e将state和类的属性联系起来， 通过connect方法来实现导出组件\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e呈现组件\x3c\/h3\x3e\n\x3cp\x3e项目中的呈现组件根据共享特性，分别存放于routers目录和components目录中。它们是无state组件，只从父组件获取到props。比如容器组件向呈现组件传入state相关的部分属性和相应的操作方法给呈现组件的props, 一级级递归传下去。 而子组件的交互产生改变state的操作，则由子组件沿原路上传回给容器组件，最终由容器组件的具体方法来触发state的同步，以及UI的更新。\x3c\/p\x3e\n\x3cp\x3e呈现组件的范本如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import React, { PropTypes } from \x27react\x27\n\/\/ ...\nfunction XView ({\n  prop1,\n  prop2,\n  prop3,\n  \/\/ ...\n}) =\x3e {\n  \/\/ create XView propOpts\n  const propOpts = {\n    p1,\n    p2,\n    \/\/ ...\n  }\n  return (\n    \x3cdiv {...propOpts}\x3e\n     \x3cdiv\x3esomething to render\x3c\/div\x3e\n    \x3c\/div\x3e\n  )\n}\nXView.propTypes = {\n  \/\/ ...\n}\nexport default XView\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React, { PropTypes } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eXView\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e{\n  prop1,\n  prop2,\n  prop3,\n  \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e ...\n}\x3c\/span\x3e) =\x26gt; \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ create XView propOpts\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e propOpts = {\n    p1,\n    p2,\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e {\x3cspan class=\x22hljs-attr\x22\x3e...propOpts\x3c\/span\x3e}\x26gt;\x3c\/span\x3e\n     \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3esomething to render\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n  )\n}\nXView.propTypes = {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e XView\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e呈现组件和容器组件相比，就是没有使用connect进行state到prop建立联系。这很正常，因为呈现组件是无状态的的，它只有属性，从父层传下来的属性而已。\x3c\/p\x3e\n\x3cp\x3e有了这样的呈现组件，那么就可以直接在父层调用:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cXView {...props}\x3e\n\x3c\/XView\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dust\x22\x3e\x3ccode\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eXView\x3c\/span\x3e \x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-template-variable\x22\x3e{...props}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eXView\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eXView调用的时候，属性props会作为XView类构造函数的输入。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e模型系统\x3c\/h2\x3e\n\x3cp\x3e该应用的模型model按业务维度设计。模型设计有两种实现方式:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e按数据维度设计: 抽离数据和相关操作的方法。 只关心数据本身，至于使用数据模型的组件所遇到的状态管理则与模型无关，而是作为组件自身的state来维护。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e按照业务维度设计: 将数据和使用数据强关联组件中的状态抽象成model的方法。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e该应用使用后者。\x3c\/p\x3e\n\x3cp\x3e模型位于src\/models, 每个独立的route都对应一个model, 每个model包含如下属性:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3enamespace: 模型的命名空间，这个是必须的，而且在同一个应用中每个模型的该属性是唯一的。使用可读性较强的词语作namespace, 比如users, categories, menus之类的。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3estate: 与具体route相关的所有状态数据结构存放在该属性中。比如数据列表，当前操作项，弹出层的显隐状态等等都可以保存在该属性中。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3esubscriptions: 该属性是dva的8个核心概念之一。 该属性存放从源获取数据的设置。 比如当pathname和给定的名称匹配的时候，执行什么操作之类的设置。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eeffects: 该属性存放的是异步操作的一些方法。从词语字面意思理解来说，是副作用，就是请求非幂等性的。比如异步获取数据列表、异步更新、异步插入、异步删除等等操作。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ereducers: 该属性存放的是对state的合并方法。基本上就是将新的state值合并到原来的state中, 以达到state的同步。reducer的含义就是多个合并返回一个的意思。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e除了上面的几个属性外，需要另外注意几个方法的使用:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eselect: 从state中查找所需的子state属性。该方法参数为state, 返回一个子state对象。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eput: 创建一条effect信息, 指示middleware发起一个action到Store. put({type: ‘xxxx’, payload: {\x22}}\x22)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ecall: 创建一条effect信息，指示middleware使用args作为fn的参数执行，例如call(services.create, payload)\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e基本的model范本如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ models\/users.js\nexport default {\n  namespace: \x27users\x27,\n  state: {},\n  subscriptions: {},\n  effects: {},\n  reducers: {}\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ models\/users.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-selector-tag\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3enamespace\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27users\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attribute\x22\x3estate\x3c\/span\x3e: {},\n  \x3cspan class=\x22hljs-attribute\x22\x3esubscriptions\x3c\/span\x3e: {},\n  \x3cspan class=\x22hljs-attribute\x22\x3eeffects\x3c\/span\x3e: {},\n  \x3cspan class=\x22hljs-attribute\x22\x3ereducers\x3c\/span\x3e: {}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e服务(services)\x3c\/h2\x3e\n\x3cp\x3e有了上面的两个部分，基本的静态交互已经就绪，就剩下和真正的或模拟的API交互了，这部分抽离为services, 即services提供异步数据获取。\x3cbr\x3e每个services对应一个route的操作集合，比如query查询列表，update更新记录，create新增记录，delete删除记录。\x3c\/p\x3e\n\x3cp\x3e这个层面的设计，相对比较简单，直接在utils中包装一个request类，提供fetch或ajax功能，然后services中直接将请求参数传入相应方法即可。返回请求的结果Promise。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3emock服务\x3c\/h3\x3e\n\x3cp\x3eroadhog使用json作为运行时配置，它提供了代理的配置，简单配置如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \x26quot;proxy\x26quot;: {\n    \x26quot;\/api\x26quot;: {\n      \x26quot;target\x26quot;: \x26quot;http:\/\/localhost:3004\/\x26quot;,\n\/\/      \x26quot;target\x26quot;: \x26quot;http:\/\/192.168.200.30:8099\/api\x26quot;,\n      \x26quot;changeOrigin\x26quot;: true,\n      \x26quot;pathRewrite\x26quot;: { \x26quot;^\/api\x26quot; : \x26quot;\x26quot; }\n    }\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-string\x22\x3e\x22proxy\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-string\x22\x3e\x22\/api\x22\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22target\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/localhost:3004\/\x22\x3c\/span\x3e,\n\/\/      \x3cspan class=\x22hljs-string\x22\x3e\x22target\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/192.168.200.30:8099\/api\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22changeOrigin\x22\x3c\/span\x3e: true,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22pathRewrite\x22\x3c\/span\x3e: { \x3cspan class=\x22hljs-string\x22\x3e\x22^\/api\x22\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e }\n    }\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e比如使用json-server\x2bmockjs实现的mock服务，启动端口号为3004， 那么使用target指向3004端口，那么请求\/api\/xxx的时候就进入json-server提供的mock服务。\x3c\/p\x3e\n\x3cp\x3e另外如果和api服务连调的话，同样可以将target指向真实api服务的base url。 例如上面注释掉的那行。\x3c\/p\x3e\n\x3cp\x3e而在正式打包上线后，就不走proxy, 免配置修改，直接生效。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3eAPI设计\x3c\/h3\x3e\n\x3cp\x3eAPI采用lumen微框架实现的restful api, 这块的不作过多介绍，如有兴趣自行搜索lumen官网查看, 或参照lumen_api中的代码来查看。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e整个设计下来， 开发流畅性非常不错。 开发体验也非常好。 暂时该项目不支持less, 对图片的处理也稍逊色，后续待解决。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3eroadhog源码分析\x3c\/h2\x3e\n\x3cp\x3eroadhog是对webpack功能作的一个封装，roadhog会读取自己的配置信息，然后转换为webpack的配置对象，最终调用webpack作项目打包。下面对roadhog源码作简单分析。\x3c\/p\x3e\n\x3cp\x3eroadhog提供了三个命令:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eroadhog build: 构建production bundle\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eroadhog server: 启动开发环境\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eroadhog test: 启动测试\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22result = spawn.sync(\n  \x27node\x27,\n  [require.resolve(`..\/lib\/${script}`)].concat(args),\n  { stdio: \x27inherit\x27 }\n);\nprocess.exit(result.status);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs awk\x22\x3e\x3ccode\x3eresult = spawn.sync(\n  \x3cspan class=\x22hljs-string\x22\x3e\x27node\x27\x3c\/span\x3e,\n  [require.resolve(`..\x3cspan class=\x22hljs-regexp\x22\x3e\/lib\/\x3c\/span\x3e\x3cspan class=\x22hljs-variable\x22\x3e${script}\x3c\/span\x3e`)].concat(args),\n  { stdio: \x3cspan class=\x22hljs-string\x22\x3e\x27inherit\x27\x3c\/span\x3e }\n);\nprocess.\x3cspan class=\x22hljs-keyword\x22\x3eexit\x3c\/span\x3e(result.status);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面代码中的script的值为build, server或test, 而args是roadhog命令后面的option选项。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Options:\n  --debug            Build without compress           [boolean] [default: false]\n  --watch, -w        Watch file changes and rebuild   [boolean] [default: false]\n  --output-path, -o  Specify output path                [string] [default: null]\n  --analyze          Visualize and analyze your Webpack bundle.\n                                                      [boolean] [default: false]\n  -h                 Show help                                         [boolean]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs n1ql\x22\x3e\x3ccode\x3eOptions:\n  --debug            \x3cspan class=\x22hljs-keyword\x22\x3eBuild\x3c\/span\x3e without compress           [\x3cspan class=\x22hljs-keyword\x22\x3eboolean\x3c\/span\x3e] [default: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e]\n  --watch, -w        Watch file changes \x3cspan class=\x22hljs-keyword\x22\x3eand\x3c\/span\x3e rebuild   [\x3cspan class=\x22hljs-keyword\x22\x3eboolean\x3c\/span\x3e] [default: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e]\n  --output-\x3cspan class=\x22hljs-keyword\x22\x3epath\x3c\/span\x3e, -o  Specify output \x3cspan class=\x22hljs-keyword\x22\x3epath\x3c\/span\x3e                [\x3cspan class=\x22hljs-keyword\x22\x3estring\x3c\/span\x3e] [default: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e]\n  --\x3cspan class=\x22hljs-keyword\x22\x3eanalyze\x3c\/span\x3e          Visualize \x3cspan class=\x22hljs-keyword\x22\x3eand\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eanalyze\x3c\/span\x3e your Webpack bundle.\n                                                      [\x3cspan class=\x22hljs-keyword\x22\x3eboolean\x3c\/span\x3e] [default: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e]\n  -h                 \x3cspan class=\x22hljs-keyword\x22\x3eShow\x3c\/span\x3e help                                         [\x3cspan class=\x22hljs-keyword\x22\x3eboolean\x3c\/span\x3e]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eroadhog源码中还有一个异步post上报功能， 上报给阿里你当前的平台信息，git用户信息等。 不知道这个具体用于干啥的。 ^-^。\x3cbr\x3eroadhog xxx实际上是调用lib\/xxx.js执行具体任务。\x3c\/p\x3e\n\x3cp\x3e我们下面先看看build.js的逻辑。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3eroadhog build\x3c\/h3\x3e\n\x3cp\x3ebuild.js代码骨架如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var _extends = Object.assign || function (target) {\n  \/\/ Object.assign polyfill\n}\nexports.build = build;\nprocess.env.NODE_ENV = \x27production\x27;\nvar argv = require(\x27yargs\x27).usage()\n  .option()\n  .option()\n\/\/ ...\nfunction build(argv) {\n  \/\/ the body of the build\n}\nif (require.main === module) {\n  build(_extends({}, argv, { cwd: process.cwd() }));\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _extends = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.assign || \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3etarget\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Object.assign polyfill\x3c\/span\x3e\n}\nexports.build = build;\nprocess.env.NODE_ENV = \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e argv = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27yargs\x27\x3c\/span\x3e).usage()\n  .option()\n  .option()\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebuild\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eargv\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ the body of the build\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e.main === \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e) {\n  build(_extends({}, argv, { \x3cspan class=\x22hljs-attr\x22\x3ecwd\x3c\/span\x3e: process.cwd() }));\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e注意这里require.main === module判断模块是否为应用的主模块，类似于python的if \x3cstrong\x3ename\x3c\/strong\x3e == “__main__“。\x3c\/p\x3e\n\x3cp\x3e也就是说roadhog build实际上就是调用了build.js暴露出去的build方法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3eargv分析\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3edebug: 布尔类型值，表示是否使用压缩模式构建\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ewatch: 短选项名w, 表示观察文件的改动，然后重新构建\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eoutput-path: 别名o, 表示构建的目标地址， 默认为.\/dist目录。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eanalyze: 可视化并分析你的webpack打包\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eh: 显示帮助信息\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3ebuild函数分析\x3c\/h3\x3e\n\x3cp\x3epath(lib\/config\/path.js)\x3c\/p\x3e\n\x3cp\x3e该文件根据build.js当前工作目录，获取应用程序几个重要的相关文件或文件夹的绝对路径：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eappBuild: dist目录的绝对路径\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eappPublic: public目录的绝对路径\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eappPackageJson: package.json文件的绝对路径\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eappSrc: src源代码目录的绝对路径\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eappNodeModules: node_modules目录的绝对路径\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eownNodeModules: roadhog自身的node_modules的绝对路径\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eresolveApp: 该函数接收一个相对路径，返回该目录相对应用程序目录的绝对路径\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eappDirectory: 应用程序所在目录的绝对路径\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3egetConfig(lib\/utils\/getConfig.js)\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e该方法根据环境获取应用程序当前目录下面的真实配置文件的内容:realGetConfig(‘.roadhogrc’, env, pkg, paths)。\x3c\/p\x3e\n\x3cp\x3e默认使用.roadhogrc配置文件，env为当前环境模式，pkg为package.json文件内容，paths是上面的path相关的路径信息。\x3c\/p\x3e\n\x3cp\x3eroadhog默认配置文件使用json格式的配置，允许在文件中使用注释:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22return (0, _parseJsonPretty2.default)((0, _stripJsonComments2.default)((0, _fs.readFileSync)(rcConfig, \x27utf-8\x27)), \x27.\/roadhogrc\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lisp\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3ereturn (\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, _parseJsonPretty2.default)((\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, _stripJsonComments2.default)((\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, _fs.readFileSync)(\x3cspan class=\x22hljs-name\x22\x3ercConfig\x3c\/span\x3e, \x27utf-8\x27)), \x27.\/roadhogrc\x27)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e另外如果不使用.roadhogrc这种配置文件，还可以使用.roadhogrc.js文件，使用纯js来实现配置。返回一个配置对象就可以了。\x3c\/p\x3e\n\x3cp\x3e使用.js配置文件可以允许在配置中使用js变量和方法。灵活度还是蛮高的。\x3c\/p\x3e\n\x3cp\x3e如果两者都没有，roadhog依然可以正常使用，自定义配置对象为空对象而已。\x3c\/p\x3e\n\x3cp\x3e另外配置文件中可以使用package.json中的包名称(name)和版本信息(version)。 分别使用$npm_package_name变量和$npm_package_version变量。\x3c\/p\x3e\n\x3cp\x3e另外如果是test环境模式，可以注册babel。这块通过lib\/utils\/registerBabel.js代码中实现的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22require(\x27babel-register\x27)({\n  only: ...\n  presets: ...\n  plugins: ...\n  babelrc: ...\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lasso\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27babel-register\x27\x3c\/span\x3e)({\n  only: \x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e\n  presets: \x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e\n  plugins: \x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e\n  babelrc: \x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eroadhog配置转webpack配置\x3c\/p\x3e\n\x3cp\x3e在获取了roadhog配置之后，就会将roadhog的配置转换成webpack的配置对象，毕竟底层使用的是webpack来打包的。\x3cbr\x3eroadhog将命令选项(argv), 应用构建目录(appBuild), 自有配置(.roadhogrc内容)和应用程序的路径信息合并到默认的webpack.config.prod.js中。\x3c\/p\x3e\n\x3cp\x3ewebpack.config.prod.js返回一个函数，该函数返回合并后的webpack对象。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ lib\/config\/webpack.config.prod.js\nexport default function(args, appBuild, config, paths) {\n  return {\n    bail: true,\n    entry: xxxx\n    \/\/ ...\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ lib\/config\/webpack.config.prod.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eargs, appBuild, config, paths\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3ebail\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eentry\x3c\/span\x3e: xxxx\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eroadhog除了提供默认的webpack配置，还支持用户自定义webpack配置覆盖roadhog默认配置， 在项目根目录下面建立webpack.config.js文件，该文件的模版如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export default function (config, env) {\n  const newConfig = {};\n  \/\/ merge or override\n  return newConfig;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3eexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3c\/span\x3e(config, env) {\n  const \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eConfig\x3c\/span\x3e = {};\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ merge or override\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eConfig\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接收的config为roadhog合并默认配置后的配置对象， env是环境模式。\x3c\/p\x3e\n\x3cp\x3e也就是说完全可以利用所有webpack的功能来实现。\x3c\/p\x3e\n\x3ch4\x3e构建过程\x3c\/h4\x3e\n\x3cp\x3e在构建之前，先递归读取构建目录中之前所有的.js文件和.css文件，记录原始文件尺寸, 并清理原来的构建目录中的文件。 然后将这些尺寸信息传入构建过程，进行真实构建。\x3c\/p\x3e\n\x3cp\x3erealBuild\x3c\/p\x3e\n\x3cp\x3e真实构建函数实现非常简单，代码如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function realBuild(previousSizeMap, resolve, argv) {\n  if (argv.debug) {\n    console.log(\x27不压缩的方式构建\x27);\n  } else {\n    console.log(\x27优化的方式构建\x27);\n  }\n  var compiler = (0, _webpack2.default)(config);\n  var done = doneHandler.bind(null, previousSizeMap, argv, resolve);\n  if (argv.watch) {\n    compiler.watch(200, done);\n  } else {\n    compiler.run(done);\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erealBuild\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3epreviousSizeMap, resolve, argv\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (argv.debug) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27不压缩的方式构建\x27\x3c\/span\x3e);\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27优化的方式构建\x27\x3c\/span\x3e);\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e compiler = (\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, _webpack2.default)(config);\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e done = doneHandler.bind(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, previousSizeMap, argv, resolve);\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (argv.watch) {\n    compiler.watch(\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e, done);\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    compiler.run(done);\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e到目前为止，roadhog的打包构建功能已经完全解读完了。归根结底就是webpack打包。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader13\x22\x3e参考连接\x3c\/h1\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/walkerqiao\/dva-antd-demos\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e项目代码\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/dvajs\/dva-docs\/blob\/master\/v1\/zh-cn\/tutorial\/04-\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e组件设计方法\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/leonshi.com\/redux-saga-in-chinese\/docs\/api\/index.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRedux-saga中文文档\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005128101\x22\x3eES6开发中的兼容性考虑\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>使用dva+antd快速构建单页面应用</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008819650">https://segmentfault.com/a/1190000008819650</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/ztwijotjhfi/" target="_blank">https://alili.tech/archive/ztwijotjhfi/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>