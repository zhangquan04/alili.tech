<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="webpack打包分析与性能优化"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>webpack打包分析与性能优化 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/qd7id14s35o/",
				"appid": "1613049289050283", 
				"title": "webpack打包分析与性能优化 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-26T02:30:18"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/ay271br5ujb/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/d390c506fsg/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fqd7id14s35o%2f&text=webpack%e6%89%93%e5%8c%85%e5%88%86%e6%9e%90%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fqd7id14s35o%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fqd7id14s35o%2f&text=webpack%e6%89%93%e5%8c%85%e5%88%86%e6%9e%90%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fqd7id14s35o%2f&title=webpack%e6%89%93%e5%8c%85%e5%88%86%e6%9e%90%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fqd7id14s35o%2f&is_video=false&description=webpack%e6%89%93%e5%8c%85%e5%88%86%e6%9e%90%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=webpack%e6%89%93%e5%8c%85%e5%88%86%e6%9e%90%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fqd7id14s35o%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fqd7id14s35o%2f&title=webpack%e6%89%93%e5%8c%85%e5%88%86%e6%9e%90%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqd7id14s35o%2f&title=webpack%e6%89%93%e5%8c%85%e5%88%86%e6%9e%90%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqd7id14s35o%2f&title=webpack%e6%89%93%e5%8c%85%e5%88%86%e6%9e%90%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqd7id14s35o%2f&title=webpack%e6%89%93%e5%8c%85%e5%88%86%e6%9e%90%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">webpack打包分析与性能优化</h1><div class="meta"><div class="postdate"><time datetime="2019-01-26" itemprop="datePublished">2019-01-26</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch3 id=\x22articleHeader0\x22\x3ewebpack打包分析与性能优化\x3c\/h3\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e背景\x3c\/h3\x3e\n\x3cp\x3e在去年年末参与的一个项目中，项目技术栈使用\x3ccode\x3ereact\x2bes6\x2bant-design\x2bwebpack\x2bbabel\x3c\/code\x3e，生产环境全量构建将近三分钟，项目业务模块多达数百个，项目依赖数千个，并且该项目协同前后端开发人员较多，提高webpack 构建效率，成为了改善团队开发效率的关键之一。\x3c\/p\x3e\n\x3cp\x3e下面我将在项目中遇到的问题和技术方案沉淀出来与大家做个分享\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e从项目自身出发\x3c\/h3\x3e\n\x3cp\x3e我们的项目是将js分离，不同页面加载不同的js。然而分析webpack打包过程并针对性提出优化方案是一个比较繁琐的过程，首先我们需要知道webpack 打包的流程，从而找出时间消耗比较长的步骤，进而逐步进行优化。\x3c\/p\x3e\n\x3cp\x3e在优化前，我们需要找出性能瓶颈在哪，代码组织是否合理，优化相关配置，从而提升webpack构建速度。\x3c\/p\x3e\n\x3cp\x3e1.使用yarn而不是npm\x3c\/p\x3e\n\x3cp\x3e由于项目使用npm安装包，容易导致在多关联依赖关系中，很可能某个库在指定依赖时没有指定版本号，进而导致不同设备上拉到的package版本不一。yarn不管安装顺序如何，相同的依赖关系将以相同的方式安装在任何机器上。当关联依赖中包括对某个软件包的重复引用，在实际安装时将尽量避免重复的创建。yarn不仅可以缓存它安装过的包，而且安装速度快，使用yarn无疑可以很大程度改善工作流和工作效率\x3c\/p\x3e\n\x3cp\x3e2.删除没有使用的依赖\x3c\/p\x3e\n\x3cp\x3e很多时候，我们由于项目人员变动比较大，参与项目的人也比较多，在分析项目时，我发现了一些问题，诸如：有些文件引入进来的库没有被使用到也没有及时删除，例如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import a from \x27abc\x27;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clean\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e a \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27abc\x27\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在业务中并没有使用到\x3ccode\x3ea\x3c\/code\x3e  模块，但webpack 会针对该\x3ccode\x3eimport\x3c\/code\x3e 进行打包一遍，这无疑造成了性能的浪费。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3ewebpack打包分析\x3c\/h3\x3e\n\x3cp\x3e1.打包过程分析\x3c\/p\x3e\n\x3cp\x3e我们知道，webpack 在打包过程中会针对不同的资源类型使用不同的loader处理，然后将所有静态资源整合到一个bundle里，以实现所有静态资源的加载。webpack最初的主要目的是在浏览器端复用符合CommonJS规范的代码模块，而CommonJS模块每次修改都需要重新构建(rebuild)后才能在浏览器端使用。\x3c\/p\x3e\n\x3cp\x3e那么， webpack是如何进行资源的打包的呢？总结如下：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e对于单入口文件，每个入口文件把自己所依赖的资源全部打包到一起，即使一个资源循环加载的话，也只会打包一份\x3c\/li\x3e\n\x3cli\x3e对于多入口文件的情况，分别独立执行单个入口的情况，每个入口文件各不相干\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我们的项目使用的就是多入口文件。在入口文件中，webpack会对每个资源文件进行配置一个id，即使多次加载，它的id也是一样的，因此只会打包一次。\x3c\/p\x3e\n\x3cp\x3e实例如下：\x3cbr\x3emain.js引用了chunk1、chunk2,chunk1又引用了chunk2，打包后：bundle.js:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 ...省略webpack生成代码\n\/************************************************************************\/\n\/******\/ ([\n\/* 0 *\/\n\/***\/ function(module, exports, __webpack_require__) {\n\n    __webpack_require__(1);\/\/webpack分配的id\n    __webpack_require__(2);\n\n\/***\/ },\n\/* 1 *\/\n\/***\/ function(module, exports, __webpack_require__) {\n    \/\/chunk1.js文件\n    __webpack_require__(2);\n    var chunk1=1;\n    exports.chunk1=chunk1;\n\n\/***\/ },\n\/* 2 *\/\n\/***\/ function(module, exports) {\n    \/\/chunk2.js文件\n    var chunk2=1;\n    exports.chunk2=chunk2;\n\n\/***\/ }\n\/******\/ ]);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e ...省略webpack生成代码\n\x3cspan class=\x22hljs-comment\x22\x3e\/************************************************************************\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/******\/\x3c\/span\x3e ([\n\x3cspan class=\x22hljs-comment\x22\x3e\/* 0 *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/***\/\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emodule, exports, __webpack_require__\x3c\/span\x3e) \x3c\/span\x3e{\n\n    __webpack_require__(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\x3cspan class=\x22hljs-comment\x22\x3e\/\/webpack分配的id\x3c\/span\x3e\n    __webpack_require__(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/***\/\x3c\/span\x3e },\n\x3cspan class=\x22hljs-comment\x22\x3e\/* 1 *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/***\/\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emodule, exports, __webpack_require__\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/chunk1.js文件\x3c\/span\x3e\n    __webpack_require__(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e chunk1=\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n    exports.chunk1=chunk1;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/***\/\x3c\/span\x3e },\n\x3cspan class=\x22hljs-comment\x22\x3e\/* 2 *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/***\/\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emodule, exports\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/chunk2.js文件\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e chunk2=\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n    exports.chunk2=chunk2;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/***\/\x3c\/span\x3e }\n\x3cspan class=\x22hljs-comment\x22\x3e\/******\/\x3c\/span\x3e ]);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.如何定位webpack打包速度慢的原因\x3c\/p\x3e\n\x3cp\x3e我们首先需要定位webpack打包速度慢的原因，才能因地制宜采取合适的方案。我么可以在终端中输入：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ webpack --profile --json \x3e stats.json\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e$ webpack --profile --json \x26gt; stats.json\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后将输出的json文件到如下两个网站进行分析\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/webpack\/analyse\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/webpack\/an...\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/alexkuz.github.io\/webpack-chart\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/alexkuz.github.io\/webp...\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这两个网站可以将构建后的组成用可视化的方式呈现出来，可以让你清楚的看到模块的组成部分，以及在项目中可能存在的多版本引用的问题，对于分析项目依赖有很大的帮助\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e优化方案与思路\x3c\/h3\x3e\n\x3cp\x3e针对webpack构建大规模应用的优化往往比较复杂，我们需要抽丝剥茧，从性能提升点着手，可能没有一套通用的方案，但大体上的思路是通用的，核心思路可能包括但不限于如下：\x3c\/p\x3e\n\x3cp\x3e1）：拆包，限制构建范围，减少资源搜索时间，无关资源不要参与构建\x3c\/p\x3e\n\x3cp\x3e2）：使用增量构建而不是全量构建\x3c\/p\x3e\n\x3cp\x3e3）：从webpack存在的不足出发，优化不足，提升效率\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3ewebpack打包优化\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e1.减小打包文件体积\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3ewebpack\x2breact的项目打包出来的文件经常动则几百kb甚至上兆，究其原因有：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eimport css文件的时候，会直接作为模块一并打包到js文件中\x3c\/li\x3e\n\x3cli\x3e所有js模块 \x2b 依赖都会打包到一个文件\x3c\/li\x3e\n\x3cli\x3eReact、ReactDOM文件过大\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e针对第一种情况，我们可以使用 \x3ccode\x3eextract-text-webpack-plugin\x3c\/code\x3e，但缺点是会产生更长时间的编译，也没有HMR，还会增加额外的HTTP请求。对于css文件不是很大的情况最好还是不要使用该插件。\x3c\/p\x3e\n\x3cp\x3e针对第二种情况，我们可以通过提取公共代码块，这也是比较普遍的做法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 new webpack.optimize.CommonsChunkPlugin(\x27common.js\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.CommonsChunkPlugin(\x3cspan class=\x22hljs-string\x22\x3e\x27common.js\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过这种方法，我们可以有效减少不同入口文件之间重叠的代码，对于非单页应用来说非常重要。\x3c\/p\x3e\n\x3cp\x3e针对第三种情况，我们可以把React、ReactDOM缓存起来：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    entry: {\n        vendor: [\x27react\x27, \x27react-dom\x27]\n    },\n    new webpack.optimize.CommonsChunkPlugin(\x27vendor\x27,\x27common.js\x27),\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    entry: {\n        \x3cspan class=\x22hljs-attr\x22\x3evendor\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27react-dom\x27\x3c\/span\x3e]\n    },\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.CommonsChunkPlugin(\x3cspan class=\x22hljs-string\x22\x3e\x27vendor\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27common.js\x27\x3c\/span\x3e),\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们在开发环境使用react的开发版本，这里包含很多注释，警告等等，部署线上的时候可以通过 \x3ccode\x3ewebpack.DefinePlugin \x3c\/code\x3e来切换生产版本。\x3c\/p\x3e\n\x3cp\x3e当然，我们还可以将React 直接放到CDN上，以此来减少体积。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2.代码压缩\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3ewebpack提供的UglifyJS插件由于采用单线程压缩，速度很慢 ,\x3cbr\x3e\x3ccode\x3ewebpack-parallel-uglify-plugin\x3c\/code\x3e插件可以并行运行UglifyJS插件，这可以有效减少构建时间，当然，该插件应用于生产环境而非开发环境，配置如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var ParallelUglifyPlugin = require(\x27webpack-parallel-uglify-plugin\x27);\nnew ParallelUglifyPlugin({\n   cacheDir: \x27.cache\/\x27,\n   uglifyJS:{\n     output: {\n       comments: false\n     },\n     compress: {\n       warnings: false\n     }\n   }\n })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ParallelUglifyPlugin = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack-parallel-uglify-plugin\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ParallelUglifyPlugin({\n   \x3cspan class=\x22hljs-attr\x22\x3ecacheDir\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.cache\/\x27\x3c\/span\x3e,\n   \x3cspan class=\x22hljs-attr\x22\x3euglifyJS\x3c\/span\x3e:{\n     \x3cspan class=\x22hljs-attr\x22\x3eoutput\x3c\/span\x3e: {\n       \x3cspan class=\x22hljs-attr\x22\x3ecomments\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n     },\n     \x3cspan class=\x22hljs-attr\x22\x3ecompress\x3c\/span\x3e: {\n       \x3cspan class=\x22hljs-attr\x22\x3ewarnings\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n     }\n   }\n })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e3.happypack\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/amireh\/happypack\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehappypack\x3c\/a\x3e 的原理是让loader可以多进程去处理文件，原理如图示：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008377198?w=800\x26amp;h=486\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008377198?w=800\x26amp;h=486\x22 alt=\x22happypack\x22 title=\x22happypack\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e此外，happypack同时还利用缓存来使得rebuild 更快\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var HappyPack = require(\x27happypack\x27),\n  os = require(\x27os\x27),\n  happyThreadPool = HappyPack.ThreadPool({ size: os.cpus().length });\n\nmodules: {\n    loaders: [\n      {\n        test: \/\\.js|jsx$\/,\n        loader: \x27HappyPack\/loader?id=jsHappy\x27,\n        exclude: \/node_modules\/\n      }\n    ]\n}\n\nplugins: [\n    new HappyPack({\n      id: \x27jsHappy\x27,\n      cache: true,\n      threadPool: happyThreadPool,\n      loaders: [{\n        path: \x27babel\x27,\n        query: {\n          cacheDirectory: \x27.webpack_cache\x27,\n          presets: [\n            \x27es2015\x27,\n            \x27react\x27\n          ]\n        }\n      }]\n    }),\n    \/\/如果有单独提取css文件的话\n    new HappyPack({\n      id: \x27lessHappy\x27,\n      loaders: [\x27style\x27,\x27css\x27,\x27less\x27]\n    })\n  ]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e HappyPack = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27happypack\x27\x3c\/span\x3e),\n  os = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27os\x27\x3c\/span\x3e),\n  happyThreadPool = HappyPack.ThreadPool({ \x3cspan class=\x22hljs-attr\x22\x3esize\x3c\/span\x3e: os.cpus().length });\n\nmodules: {\n    \x3cspan class=\x22hljs-attr\x22\x3eloaders\x3c\/span\x3e: [\n      {\n        \x3cspan class=\x22hljs-attr\x22\x3etest\x3c\/span\x3e: \x3cspan class=\x22hljs-regexp\x22\x3e\/\\.js|jsx$\/\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eloader\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27HappyPack\/loader?id=jsHappy\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eexclude\x3c\/span\x3e: \x3cspan class=\x22hljs-regexp\x22\x3e\/node_modules\/\x3c\/span\x3e\n      }\n    ]\n}\n\nplugins: [\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e HappyPack({\n      \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27jsHappy\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3ecache\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3ethreadPool\x3c\/span\x3e: happyThreadPool,\n      \x3cspan class=\x22hljs-attr\x22\x3eloaders\x3c\/span\x3e: [{\n        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27babel\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3equery\x3c\/span\x3e: {\n          \x3cspan class=\x22hljs-attr\x22\x3ecacheDirectory\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.webpack_cache\x27\x3c\/span\x3e,\n          \x3cspan class=\x22hljs-attr\x22\x3epresets\x3c\/span\x3e: [\n            \x3cspan class=\x22hljs-string\x22\x3e\x27es2015\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e\n          ]\n        }\n      }]\n    }),\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果有单独提取css文件的话\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e HappyPack({\n      \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27lessHappy\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3eloaders\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27style\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27css\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27less\x27\x3c\/span\x3e]\n    })\n  ]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e4.缓存与增量构建\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e由于项目中主要使用的是react.js和es6，结合webpack的babel-loader加载器进行编译，每次重新构建都需要重新编译一次，我们可以针对这个进行增量构建，而不需要每次都全量构建。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ebabel-loader\x3c\/code\x3e可以缓存处理过的模块，对于没有修改过的文件不会再重新编译，\x3ccode\x3ecacheDirectory\x3c\/code\x3e有着2倍以上的速度提升，这对于rebuild 有着非常大的性能提升。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var node_modules = path.resolve(__dirname, \x27node_modules\x27);\nvar pathToReact = path.resolve(node_modules, \x27react\/react\x27);\nvar pathToReactDOM = path.resolve(node_modules,\x27react-dom\/index\x27);\n\n{\n        test: \/\\.js|jsx$\/,\n        include: path.join(__dirname, \x27src\x27),\n        exclude: \/node_modules\/,\n        loaders: [\x27react-hot\x27,\x27babel-loader?cacheDirectory\x27],\n        noParse: [pathToReact,pathToReactDOM]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e node_modules = path.resolve(__dirname, \x3cspan class=\x22hljs-string\x22\x3e\x27node_modules\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pathToReact = path.resolve(node_modules, \x3cspan class=\x22hljs-string\x22\x3e\x27react\/react\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pathToReactDOM = path.resolve(node_modules,\x3cspan class=\x22hljs-string\x22\x3e\x27react-dom\/index\x27\x3c\/span\x3e);\n\n{\n        \x3cspan class=\x22hljs-attr\x22\x3etest\x3c\/span\x3e: \x3cspan class=\x22hljs-regexp\x22\x3e\/\\.js|jsx$\/\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3einclude\x3c\/span\x3e: path.join(__dirname, \x3cspan class=\x22hljs-string\x22\x3e\x27src\x27\x3c\/span\x3e),\n        \x3cspan class=\x22hljs-attr\x22\x3eexclude\x3c\/span\x3e: \x3cspan class=\x22hljs-regexp\x22\x3e\/node_modules\/\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eloaders\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27react-hot\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27babel-loader?cacheDirectory\x27\x3c\/span\x3e],\n        \x3cspan class=\x22hljs-attr\x22\x3enoParse\x3c\/span\x3e: [pathToReact,pathToReactDOM]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3ebabel-loader\x3c\/code\x3e让除了\x3ccode\x3enode_modules\x3c\/code\x3e目录下的js文件都支持es6语法，注意\x3ccode\x3e exclude: \/node_modules\/\x3c\/code\x3e很重要，否则 babel 可能会把\x3ccode\x3enode_modules\x3c\/code\x3e中所有模块都用 babel 编译一遍!\x3cbr\x3e当然，你还需要一个像这样的\x3ccode\x3e.babelrc\x3c\/code\x3e文件，配置如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;presets\x26quot;: [\x26quot;es2015\x26quot;, \x26quot;stage-0\x26quot;, \x26quot;react\x26quot;],\n  \x26quot;plugins\x26quot;: [\x26quot;transform-runtime\x26quot;]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e{\n  \x3cspan class=\x22hljs-string\x22\x3e\x22presets\x22\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22es2015\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22stage-0\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22react\x22\x3c\/span\x3e],\n  \x3cspan class=\x22hljs-string\x22\x3e\x22plugins\x22\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22transform-runtime\x22\x3c\/span\x3e]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这是一劳永逸的做法，何乐而不为呢？除此之外，我们还可以使用webpack自带的cache，以缓存生成的模块和chunks以提高多个增量构建的性能。\x3c\/p\x3e\n\x3cp\x3e在webpack的整个构建过程中，有多个地方提供了缓存的机会，如果我们打开了这些缓存，会大大加速我们的构建\x3c\/p\x3e\n\x3cp\x3e而针对增量构建 ，我们一般使用:\x3c\/p\x3e\n\x3cp\x3ewebpack-dev-server或webpack-dev-middleware，这里我们使用\x3ccode\x3ewebpack-dev-middleware\x3c\/code\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22webpackDevMiddleware(compiler, {\n                    publicPath: webpackConfig.output.publicPath,\n                    stats: {\n                      chunks: false,\n                      colors: true\n                    },\n                    debug: true,\n                    hot: true,\n                    lazy: false,\n                    historyApiFallback: true,\n                    poll: true\n                })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ewebpackDevMiddleware(compiler, {\n                    \x3cspan class=\x22hljs-attr\x22\x3epublicPath\x3c\/span\x3e: webpackConfig.output.publicPath,\n                    \x3cspan class=\x22hljs-attr\x22\x3estats\x3c\/span\x3e: {\n                      \x3cspan class=\x22hljs-attr\x22\x3echunks\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n                      \x3cspan class=\x22hljs-attr\x22\x3ecolors\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n                    },\n                    \x3cspan class=\x22hljs-attr\x22\x3edebug\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n                    \x3cspan class=\x22hljs-attr\x22\x3ehot\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n                    \x3cspan class=\x22hljs-attr\x22\x3elazy\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n                    \x3cspan class=\x22hljs-attr\x22\x3ehistoryApiFallback\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n                    \x3cspan class=\x22hljs-attr\x22\x3epoll\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n                })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过设置\x3ccode\x3echunks:false\x3c\/code\x3e，可以将控制台输出的代码块信息关闭\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e5.减少构建搜索或编译路径\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e为了加快webpack打包时对资源的搜索速度，有很多的做法：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3eResolove.root VS Resolove.moduledirectories\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e大多数路径应该使用\x3ccode\x3e resolve.root\x3c\/code\x3e，只对嵌套的路径使用 \x3ccode\x3eResolove.moduledirectories\x3c\/code\x3e，这可以获得显著的性能提升\x3c\/p\x3e\n\x3cp\x3e原因是\x3ccode\x3eResolove.moduledirectories\x3c\/code\x3e是取相对路径，所以比起\x3ccode\x3e resolve.root\x3c\/code\x3e会多parse很多路径：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22resolve: {\n    root: path.resolve(__dirname,\x27src\x27),\n    modulesDirectories: [\x27node_modules\x27]\n  },\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eresolve: {\n    \x3cspan class=\x22hljs-attr\x22\x3eroot\x3c\/span\x3e: path.resolve(__dirname,\x3cspan class=\x22hljs-string\x22\x3e\x27src\x27\x3c\/span\x3e),\n    \x3cspan class=\x22hljs-attr\x22\x3emodulesDirectories\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27node_modules\x27\x3c\/span\x3e]\n  },\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3eDLL \x26amp; DllReference\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e针对第三方NPM包，这些包我们并不会修改它，但仍然每次都要在build的过程消耗构建性能，我们可以通过DllPlugin来前置这些包的构建，具体实例：\x3ca href=\x22https:\/\/github.com\/webpack\/webpack\/tree\/master\/examples\/dll\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/webpack\/we...\x3c\/a\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3ealias和noPase\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e\x3ccode\x3eresolve.alias \x3c\/code\x3e是webpack 的一个配置项，它的作用是把用户的一个请求重定向到另一个路径。 比如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22resolve: {  \/\/ 显示指出依赖查找路径\n    alias: {\n        comps: \x27src\/pages\/components\x27\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eresolve: {  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 显示指出依赖查找路径\x3c\/span\x3e\n    alias: {\n        \x3cspan class=\x22hljs-attr\x22\x3ecomps\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27src\/pages\/components\x27\x3c\/span\x3e\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样我们在要打包的脚本中的使用 \x3ccode\x3erequire(\x27comps\/Loading.jsx\x27);\x3c\/code\x3e其实就等价于\x3ccode\x3erequire(\x27src\/pages\/components\/Loading.jsx\x27)\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3ewebpack 默认会去寻找所有 resolve.root 下的模块，但是有些目录我们是可以明确告知 webpack 不要管这里，从而减轻 webpack 的工作量。这时会用到\x3ccode\x3emodule.noParse\x3c\/code\x3e 参数\x3c\/p\x3e\n\x3cp\x3e在项目中合理使用 alias 和 noParse 可以有效提升效率，虽然不是很明显\x3c\/p\x3e\n\x3cp\x3e以上配置均由本人给出，仅供参考（有些插件的官方文档给的不是那么明晰）\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e6.其他\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e开启devtool: \x22#inline-source-map\x22会增加编译时间\x3c\/li\x3e\n\x3cli\x3ecss-loader 0.15.0\x2b 使webpack加载变得缓慢\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/css-loader 0.16.0\nHash: 8d3652a9b4988c8ad221\nVersion: webpack 1.11.0\nTime: 51612ms\n\n\/\/以下是css-loader 0.14.5\nHash: bd471e6f4aa10b195feb\nVersion: webpack 1.11.0\nTime: 6121ms\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs subunit\x22\x3e\x3ccode\x3e\/\/css-loader 0.16.0\nHash: 8d3652a9b4988c8ad221\nVersion: webpack 1.11.0\n\x3cspan class=\x22hljs-keyword\x22\x3eTime:\x3c\/span\x3e 51612ms\n\n\/\/以下是css-loader 0.14.5\nHash: bd471e6f4aa10b195feb\nVersion: webpack 1.11.0\n\x3cspan class=\x22hljs-keyword\x22\x3eTime:\x3c\/span\x3e 6121ms\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\n\x3cli\x3e对于ant-design模块，使用\x3ccode\x3ebabel-plugin-import\x3c\/code\x3e插件来按需加载模块\x3c\/li\x3e\n\x3cli\x3eDedupePlugin插件可以在打包的时候删除重复或者相似的文件，实际测试中应该是文件级别的重复的文件\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e结尾\x3c\/h3\x3e\n\x3cp\x3e虽然上面的做法减少了文件体积，加快了编译速度，整体构建(initial build)从最初的三分多钟到一分钟，rebuild十多秒，优化效果明显。但对于Webpack \x2b React项目来说，性能优化方面远不止于此，还有很多的优化空间，比如服务端渲染，首屏优化，异步加载模块，按需加载，代码分割等等\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>webpack打包分析与性能优化</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008377195">https://segmentfault.com/a/1190000008377195</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/qd7id14s35o/" target="_blank">https://alili.tech/archive/qd7id14s35o/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>