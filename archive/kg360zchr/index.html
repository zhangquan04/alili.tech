<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="原生JS数据绑定"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>原生JS数据绑定 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/kg360zchr/",
				"appid": "1613049289050283", 
				"title": "原生JS数据绑定 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-24T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/tet7qxtzsaq/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/sulna3u7o4/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fkg360zchr%2f&text=%e5%8e%9f%e7%94%9fJS%e6%95%b0%e6%8d%ae%e7%bb%91%e5%ae%9a"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fkg360zchr%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fkg360zchr%2f&text=%e5%8e%9f%e7%94%9fJS%e6%95%b0%e6%8d%ae%e7%bb%91%e5%ae%9a"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fkg360zchr%2f&title=%e5%8e%9f%e7%94%9fJS%e6%95%b0%e6%8d%ae%e7%bb%91%e5%ae%9a"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fkg360zchr%2f&is_video=false&description=%e5%8e%9f%e7%94%9fJS%e6%95%b0%e6%8d%ae%e7%bb%91%e5%ae%9a"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%8e%9f%e7%94%9fJS%e6%95%b0%e6%8d%ae%e7%bb%91%e5%ae%9a&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fkg360zchr%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fkg360zchr%2f&title=%e5%8e%9f%e7%94%9fJS%e6%95%b0%e6%8d%ae%e7%bb%91%e5%ae%9a"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkg360zchr%2f&title=%e5%8e%9f%e7%94%9fJS%e6%95%b0%e6%8d%ae%e7%bb%91%e5%ae%9a"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkg360zchr%2f&title=%e5%8e%9f%e7%94%9fJS%e6%95%b0%e6%8d%ae%e7%bb%91%e5%ae%9a"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkg360zchr%2f&title=%e5%8e%9f%e7%94%9fJS%e6%95%b0%e6%8d%ae%e7%bb%91%e5%ae%9a"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">原生JS数据绑定</h1><div class="meta"><div class="postdate"><time datetime="2019-01-24" itemprop="datePublished">2019-01-24</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3ch2\x3e原生JS数据绑定\x3c\/h2\x3e\n\x3cp\x3e双向数据绑定是非常重要的特性 —— 将JS模型与HTML视图对应，能减少模板编译时间同时提高用户体验。我们将学习在不使用框架的情况下，使用原生JS实现双向绑定 —— 一种为Object.observe\x3cem\x3e（译注：现已废弃，作者写博客时为14年11月）\x3c\/em\x3e，另一种为覆盖get \/ set。PS: 第二种更好，详情请参阅底部的TL;DR\x3cem\x3e（译注：too long；don\x27t read. 直译为“太长，不想看”，意译为“简单粗暴来吧”）\x3c\/em\x3e。\x3c\/p\x3e\n\x3ch3\x3e1: Object.observe 和 DOM.onChange\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3eObject.observe()\x3c\/code\x3e是\x3ca href=\x22http:\/\/www.html5rocks.com\/en\/tutorials\/es7\/observe\/\x22\x3e一种新特性\x3c\/a\x3e，其在ES7中实现，但在最新的Chrome中已可用 —— 允许对JS对象进行响应式更新。简单说就是 —— 只要对象（的属性）发生变化就调用回调函数。\x3c\/p\x3e\n\x3cp\x3e一般用法为：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs dockerfile\x22\x3elog = console.log\n\x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e = {}\nObject.observe(\x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e, function(changes){    \n    changes.forEach(function(change) {\n        \x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e.fullName = \x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e.firstName \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22 \x22\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e.lastName;         \n    });\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e.firstName = \x3cspan class=\x22hljs-string\x22\x3e\x27Bill\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e.lastName = \x3cspan class=\x22hljs-string\x22\x3e\x27Clinton\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e.fullName \/\/ \x3cspan class=\x22hljs-string\x22\x3e\x27Bill Clinton\x27\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这很方便，且能实现响应式编程 —— 保证所有内容都是最新的。\x3c\/p\x3e\n\x3cp\x3e如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/\x26lt;input id=\x22foo\x22\x26gt;\x3c\/span\x3e\nuser = {};\ndiv = $(\x3cspan class=\x22hljs-string\x22\x3e\x22#foo\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.observe(user, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3echanges\x3c\/span\x3e)\x3c\/span\x3e{    \n    changes.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3echange\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e fullName = (user.firstName || \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e) \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22 \x22\x3c\/span\x3e \x2b (user.lastName || \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e);         \n        div.text(fullName);\n    });\n});\n\nuser.firstName = \x3cspan class=\x22hljs-string\x22\x3e\x27Bill\x27\x3c\/span\x3e;\nuser.lastName = \x3cspan class=\x22hljs-string\x22\x3e\x27Clinton\x27\x3c\/span\x3e;\n\ndiv.text() \x3cspan class=\x22hljs-comment\x22\x3e\/\/Bill Clinton\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3cem\x3e\x3ca href=\x22http:\/\/jsfiddle.net\/v2bw6658\/\x22\x3eJSFiddle\x3c\/a\x3e\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e如上，我们自己实现了模型到数据的绑定！封装一下\x3cem\x3e（译注：此处原文为\x3ccode\x3eLet’s DRY ourselves with a helper function.\x3c\/code\x3e DRY即 don\x27t repeat yourself）\x3c\/em\x3e：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/\x26lt;input id=\x22foo\x22\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebindObjPropToDomElem\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj, property, domElem\x3c\/span\x3e) \x3c\/span\x3e{ \n  \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.observe(obj, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3echanges\x3c\/span\x3e)\x3c\/span\x3e{    \n    changes.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3echange\x3c\/span\x3e) \x3c\/span\x3e{\n      $(domElem).text(obj[property]);        \n    });\n  });  \n}\n\nuser = {};\nbindObjPropToDomElem(user,\x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e,$(\x3cspan class=\x22hljs-string\x22\x3e\x22#foo\x22\x3c\/span\x3e));\nuser.name = \x3cspan class=\x22hljs-string\x22\x3e\x27William\x27\x3c\/span\x3e\n$(\x3cspan class=\x22hljs-string\x22\x3e\x22#foo\x22\x3c\/span\x3e).text() \x3cspan class=\x22hljs-comment\x22\x3e\/\/\x27William\x27\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3cem\x3e\x3ca href=\x22http:\/\/jsfiddle.net\/v2bw6658\/2\/\x22\x3eJSFiddle\x3c\/a\x3e\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e换一种方式 —— 将DOM元素与JS值绑定起来。简单的方法是使用\x3ca href=\x22http:\/\/api.jquery.com\/change\/\x22\x3ejQuery.change\x3c\/a\x3e\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/\x26lt;input id=\x22foo\x22\x26gt;\x3c\/span\x3e\n$(\x3cspan class=\x22hljs-string\x22\x3e\x22#foo\x22\x3c\/span\x3e).val(\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebindDomElemToObjProp\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edomElem, obj, propertyName\x3c\/span\x3e) \x3c\/span\x3e{  \n  $(domElem).change(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    obj[propertyName] = $(domElem).val();\n    alert(\x3cspan class=\x22hljs-string\x22\x3e\x22user.name is now \x22\x3c\/span\x3e\x2buser.name);\n  });\n}\n\nuser = {}\nbindDomElemToObjProp($(\x3cspan class=\x22hljs-string\x22\x3e\x22#foo\x22\x3c\/span\x3e), user, \x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/enter \x27obama\x27 into input\x3c\/span\x3e\nuser.name \x3cspan class=\x22hljs-comment\x22\x3e\/\/Obama. \x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3cem\x3e\x3ca href=\x22http:\/\/jsfiddle.net\/v2bw6658\/4\/\x22\x3eJSFiddle\x3c\/a\x3e\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e简直不要太方便，在实际开发时，可以将两者结合，通过函数来创建一个双向数据绑定：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs qml\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebindObjPropToDomElem\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj, property, domElem\x3c\/span\x3e) \x3c\/span\x3e{ \n  \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.observe(obj, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3echanges\x3c\/span\x3e)\x3c\/span\x3e{    \n    changes.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3echange\x3c\/span\x3e) \x3c\/span\x3e{\n      $(domElem).text(obj[\x3cspan class=\x22hljs-keyword\x22\x3eproperty\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e])\x3c\/span\x3e;        \n    });\n  });  \n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebindDomElemToObjProp\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj, propertyName, domElem\x3c\/span\x3e) \x3c\/span\x3e{  \n  $(domElem).change(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    obj[propertyName] = $(domElem).val();\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22obj is\x22\x3c\/span\x3e, obj);\n  });\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebindModelView\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj, property, domElem\x3c\/span\x3e) \x3c\/span\x3e{  \n  bindObjPropToDomElem(obj, \x3cspan class=\x22hljs-keyword\x22\x3eproperty\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x3c\/span\x3e, domElem)\n  bindDomElemToObjProp(obj, propertyName, domElem)\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e注意：在双向绑定时，需正确进行DOM操作，因为不同的DOM元素（input，div，textarea，select）有不同的取值方式（text，val）。同时注意：双向数据绑定并不是必须的 —— “输出型”元素一般不需要视图到模型的绑定，而“输入型”元素一般不需要模型到视图的绑定。\x3c\/p\x3e\n\x3cp\x3e下面为第二种方式：\x3c\/p\x3e\n\x3ch3\x3e2: 深入\x27get\x27和\x27set\x27属性\x3c\/h3\x3e\n\x3cp\x3e上面的解决方法并不完美。比如直接的修改并不会自动触发jQuery的“change”事件 —— 例如，直接通过代码对DOM进行修改，比如以下代码不起作用：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3e$(\x3cspan class=\x22hljs-string\x22\x3e\x22#foo\x22\x3c\/span\x3e).val(\x3cspan class=\x22hljs-string\x22\x3e\x27Putin\x27\x3c\/span\x3e)\nuser\x3cspan class=\x22hljs-selector-class\x22\x3e.name\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/still Obama. Oops. \x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在，我们来用一种更激进的方式实现 —— 重写getter和setter。因为我们不仅要监测变化，我们将重写JS最底层的功能，即get\/setting变量的能力，所以不那么“安全”。后面我们将会看到，这种元编程的方式有多强大。\x3c\/p\x3e\n\x3cp\x3e那么，如果我们可以重写get和set对象值的方法会怎么样呢？这也是数据绑定的实质。\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Object\/defineProperty\x22\x3e用 \x3ccode\x3eObject.defineProperty()\x3c\/code\x3e 即可实现\x3c\/a\x3e.\x3c\/p\x3e\n\x3cp\x3e其实，以前就有\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Object\/__defineGetter__\x22\x3e已废弃且非标准实现方式\x3c\/a\x3e，但通过\x3ccode\x3eObject.defineProperty\x3c\/code\x3e的实现方式更好（最重要的是标准），如下所示：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs actionscript\x22\x3euser = {}\nnameValue = \x3cspan class=\x22hljs-string\x22\x3e\x27Joe\x27\x3c\/span\x3e;\nObject.defineProperty(user, \x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e, {\n  \x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e nameValue }, \n  \x3cspan class=\x22hljs-keyword\x22\x3eset\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(newValue)\x3c\/span\x3e \x3c\/span\x3e{ nameValue = newValue; },\n  configurable: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/to enable redefining the property later\x3c\/span\x3e\n});\n\nuser.name \x3cspan class=\x22hljs-comment\x22\x3e\/\/Joe \x3c\/span\x3e\nuser.name = \x3cspan class=\x22hljs-string\x22\x3e\x27Bob\x27\x3c\/span\x3e\nuser.name \x3cspan class=\x22hljs-comment\x22\x3e\/\/Bob\x3c\/span\x3e\nnameValue \x3cspan class=\x22hljs-comment\x22\x3e\/\/Bob\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在\x3ccode\x3euser.name\x3c\/code\x3e是\x3ccode\x3enameValue\x3c\/code\x3e的别名。但可做的不仅仅是创建新的变量名 - 我们可以通过它来保证模型和视图的一致。如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/\x26lt;input id=\x22foo\x22\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.defineProperty(user, \x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e, {\n  \x3cspan class=\x22hljs-attr\x22\x3eget\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22foo\x22\x3c\/span\x3e).value }, \n  \x3cspan class=\x22hljs-attr\x22\x3eset\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enewValue\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22foo\x22\x3c\/span\x3e).value = newValue; },\n  \x3cspan class=\x22hljs-attr\x22\x3econfigurable\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/to enable redefining the property later\x3c\/span\x3e\n});\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3ccode\x3euser.name\x3c\/code\x3e现在绑定到\x3ccode\x3e#foo\x3c\/code\x3e元素。这种底层的方式非常简洁 —— 通过定义（或扩展）变量属性的get \/ set实现。由于实现非常简洁，因此可以根据情况轻松扩展\/修改代码 —— 仅绑定或扩展get \/ set中的一个，比如绑定其他数据类型。\x3c\/p\x3e\n\x3cp\x3e可封装如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs qml\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebindModelInput\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj, property, domElem\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.defineProperty(obj, \x3cspan class=\x22hljs-keyword\x22\x3eproperty\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x3c\/span\x3e, {\n    \x3cspan class=\x22hljs-attribute\x22\x3eget\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e domElem.value; }, \n    \x3cspan class=\x22hljs-attribute\x22\x3eset\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enewValue\x3c\/span\x3e) \x3c\/span\x3e{ domElem.value = newValue; },\n    \x3cspan class=\x22hljs-attribute\x22\x3econfigurable\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  });\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e使用：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs dockerfile\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e = {};\ninputElem = document.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22foo\x22\x3c\/span\x3e);\nbindModelInput(\x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e,inputElem);\n\n\x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e.name = \x3cspan class=\x22hljs-string\x22\x3e\x22Joe\x22\x3c\/span\x3e;\nalert(\x3cspan class=\x22hljs-string\x22\x3e\x22input value is now \x22\x3c\/span\x3e\x2binputElem.value) \/\/input is now \x3cspan class=\x22hljs-string\x22\x3e\x27Joe\x27\x3c\/span\x3e;\n\ninputElem.value = \x3cspan class=\x22hljs-string\x22\x3e\x27Bob\x27\x3c\/span\x3e;\nalert(\x3cspan class=\x22hljs-string\x22\x3e\x22user.name is now \x22\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e.name) \/\/model is now \x3cspan class=\x22hljs-string\x22\x3e\x27Bob\x27\x3c\/span\x3e;\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3cem\x3e\x3ca href=\x22http:\/\/jsfiddle.net\/v2bw6658\/6\/\x22\x3eJSFiddle\x3c\/a\x3e\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e注意：上面的\x3ccode\x3edomElem.value\x3c\/code\x3e只对\x3ccode\x3einput\x3c\/code\x3e元素有效。（可在\x3ccode\x3ebindModelInput\x3c\/code\x3e中扩展，对不同的DOM类型使用对应的方法来设置它的值）。\x3c\/p\x3e\n\x3cp\x3e思考：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/kangax.github.io\/compat-table\/es5\/#Object.defineProperty\x22\x3e\x3ccode\x3eDefineProperty\x3c\/code\x3e浏览器兼容性\x3c\/a\x3e良好 。\x3c\/li\x3e\n\x3cli\x3e注意：上面的实现中，在某些场景下，\x3ccode\x3e视图\x3c\/code\x3e可认为是符合\x3ccode\x3eSPOT (single point of truth )\x3c\/code\x3e原则的，但该原则常常被忽视（因为双向数据绑定也就意味着等价）。然而，深究下去可能就会发现问题了，在实际开发中也会遇到。 —— 比如，当删除DOM元素时，关联的模型会自动注销么？答案是不会。\x3ccode\x3ebindModelInput\x3c\/code\x3e函数在\x3ccode\x3edomElem\x3c\/code\x3e元素上创建了一个闭包，使DOM元素常驻在内存中 —— 并保持模型与模型的绑定关系 —— 即使DOM元素被移除。即使视图被移除了，但模型依旧存在。反之一样 —— 若模型被移除了，视图依然能够正常显示。在某些刷新视图和模型无效的情况下，理解这些内部原理就能找到原因了。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cem\x3e（译注：\x3ccode\x3eSPOT\x3c\/code\x3e简单翻译为“单点原则”，即引起变化最好的是由单一入口引起的，而不是由多个入口引起的，比如一个函数，其返回结果最好仅由参数决定，这样输入和输出才能一致，而不会由于其他变化导致用一个输入会出现不同的输出）\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e这种自己实现的数据绑定方法与Knockout或Angular等框架的数据绑定相比，有一些优点，例如：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e理解：一旦掌握数据绑定的源码，不仅理解更深入，而且也能对其进行扩展和修改。\x3c\/li\x3e\n\x3cli\x3e性能：不要将所有东西都绑定在一起，只绑定所需的，避免监测过多对象\x3c\/li\x3e\n\x3cli\x3e避免锁定：若所用的框架不支持数据绑定，则自行实现的数据绑定更强大\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e缺点是由于不是\x3ccode\x3e真正的\x3c\/code\x3e绑定（没有\x3ccode\x3e脏检查\x3c\/code\x3e），有些情况会失败 —— 视图更新时不会\x3ccode\x3e触发\x3c\/code\x3e模型中的数据，所以当试着\x3ccode\x3e同步\x3c\/code\x3e视图中的两个DOM元素时将会失败。也就是说，将两个元素绑定到同一个模型上时，只有更新模型，则两个元素才会被正确更新。可以通过自定义一个更新函数来实现：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/\x26lt;input id=\x27input1\x27\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/\x26lt;input id=\x27input2\x27\x26gt;\x3c\/span\x3e\ninput1 = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27input1\x27\x3c\/span\x3e)\ninput2 = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27input2\x27\x3c\/span\x3e)\nuser = {}\n\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.defineProperty(user, \x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e, {\n  \x3cspan class=\x22hljs-attr\x22\x3eget\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e input1.value; }, \n  \x3cspan class=\x22hljs-attr\x22\x3eset\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enewValue\x3c\/span\x3e) \x3c\/span\x3e{ input1.value = newValue; input2.value = newValue; },\n  \x3cspan class=\x22hljs-attr\x22\x3econfigurable\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n});\ninput1.onchange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ user.name = user.name } \x3cspan class=\x22hljs-comment\x22\x3e\/\/sync both inputs.\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3eTL;DR：\x3c\/h3\x3e\n\x3cp\x3e当需要使用原生JS创建模型和视图的双向数据绑定时，如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs qml\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebindModelInput\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj, property, domElem\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.defineProperty(obj, \x3cspan class=\x22hljs-keyword\x22\x3eproperty\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x3c\/span\x3e, {\n    \x3cspan class=\x22hljs-attribute\x22\x3eget\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e domElem.value; }, \n    \x3cspan class=\x22hljs-attribute\x22\x3eset\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enewValue\x3c\/span\x3e) \x3c\/span\x3e{ domElem.value = newValue; },\n    \x3cspan class=\x22hljs-attribute\x22\x3econfigurable\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  });\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/\x26lt;input id=\x22foo\x22\x26gt;\x3c\/span\x3e\nuser = {}\nbindModelInput(user,\x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27foo\x27\x3c\/span\x3e)); \x3cspan class=\x22hljs-comment\x22\x3e\/\/hey presto, we now have two-way data binding.\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e感谢阅读，本文也发布在 \x3ca href=\x22http:\/\/javascriptweekly.com\/issues\/207\x22\x3eJavaScript Weekly\x3c\/a\x3e, 可在\x3ca href=\x22http:\/\/redd.it\/2manfb\x22\x3ereddit\x3c\/a\x3e回复我\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>原生JS数据绑定</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/native-javascript-data-binding">https://www.zcfy.cc/article/native-javascript-data-binding</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/kg360zchr/" target="_blank">https://alili.tech/archive/kg360zchr/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>