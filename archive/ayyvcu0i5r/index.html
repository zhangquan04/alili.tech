<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="什么是作用域和执行上下文"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>什么是作用域和执行上下文 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/ayyvcu0i5r/",
				"appid": "1613049289050283", 
				"title": "什么是作用域和执行上下文 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-14T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/swqrs2gdi9/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/3314y817hb8/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fayyvcu0i5r%2f&text=%e4%bb%80%e4%b9%88%e6%98%af%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fayyvcu0i5r%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fayyvcu0i5r%2f&text=%e4%bb%80%e4%b9%88%e6%98%af%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fayyvcu0i5r%2f&title=%e4%bb%80%e4%b9%88%e6%98%af%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fayyvcu0i5r%2f&is_video=false&description=%e4%bb%80%e4%b9%88%e6%98%af%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bb%80%e4%b9%88%e6%98%af%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fayyvcu0i5r%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fayyvcu0i5r%2f&title=%e4%bb%80%e4%b9%88%e6%98%af%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fayyvcu0i5r%2f&title=%e4%bb%80%e4%b9%88%e6%98%af%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fayyvcu0i5r%2f&title=%e4%bb%80%e4%b9%88%e6%98%af%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fayyvcu0i5r%2f&title=%e4%bb%80%e4%b9%88%e6%98%af%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">什么是作用域和执行上下文</h1><div class="meta"><div class="postdate"><time datetime="2019-01-14" itemprop="datePublished">2019-01-14</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e说到 Javascript 中的作用域，通常一同出现的还有一个执行上下文（execution context）的概念，以前我在网上搜索相关的内容总是理不清这两者的关系。似乎函数，作用域，执行上下文这三者天生就是纠缠在一起的。为了获得一手的资料我翻看了 ES6 规范，把他们到底是什么梳理了一下：\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e作用域\x3c\/h3\x3e\n\x3cp\x3e首先我们来说下作用域，简单来说作用域就是一个区域，包含了其中变量，常量，函数等等定义信息和赋值信息，以及这个区域内代码书写的结构信息。作用域可以嵌套。我们通常知道 js 中函数的定义可以产生作用域，下面我们用具体代码来示例下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVN7gz?w=555\x26amp;h=356\x22 src=\x22https:\/\/static.alili.tech\/img\/bVN7gz?w=555\x26amp;h=356\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e全局作用域（global scope）里面定义了两个变量，一个函数。walk 函数生成的作用域里面定义了一个变量，两个函数。innerFunc 和 anotherInnerFunc 这两个函数生成的作用域里面分别定义了一个变量。在规范中作用域更官方的叫法是\x3cstrong\x3e词法环境（Lexical Environments）\x3c\/strong\x3e。什么意思？就是作用域包含哪些内容取决于你代码怎么写，你把定义 go 变量写在了 walk 函数里面，那么 go 变量就属于 walk 函数作用域。\x3c\/p\x3e\n\x3cp\x3e作用域其实由两部分组成：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e记录作用域内变量信息（我们假设变量，常量，函数等统称为变量）和代码结构信息的东西，称之为 Environment Record。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e一个引用 \x3ccode\x3e__outer__\x3c\/code\x3e，这个引用指向当前作用域的父作用域。拿上面代码为例。innerFunc 的函数作用域有一个引用指向 walk 函数作用域，walk 函数作用域有一个引用指向全局作用域。全局作用域的 \x3ccode\x3e__outer__\x3c\/code\x3e 为 null。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch5\x3e变量查找（ResolveBinding）：\x3c\/h5\x3e\n\x3cp\x3e规范中定义了查找一个变量的过程：先查看当前作用域里面的 Environment Record 是否有此变量的信息，如果找到了，则返回当前作用域内的这个变量。如果没有查找到，则顺着 \x3ccode\x3e__outer__\x3c\/code\x3e 到父作用域里面的 Environment Record 查找，以此递归。所以我们通常所说的函数内同名变量遮蔽全局变量就是这么回事。不过如果你在变量查找的时候指定某个作用域中的 Environment Record，那么也是可以的，譬如：\x3ccode\x3ewindow.name\x3c\/code\x3e 【其实 window 对象就是全局作用域的 Environment Record 对象，但是普通函数作用域的 Environment Record 对象是获取不到的】。\x3c\/p\x3e\n\x3ch5\x3e生成作用域的语法：\x3c\/h5\x3e\n\x3col\x3e\x3cli\x3e\x3cp\x3e函数声明\x3c\/p\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function f() {\n  var inner = \x27inner\x27;\n  console.log( inner );\n}\nf(); \/\/ inner;\nconsole.log( inner ); \/\/ Uncaught ReferenceError: inner is not defined\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ef\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e inner = \x3cspan class=\x22hljs-string\x22\x3e\x27inner\x27\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( inner );\n}\nf(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ inner;\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( inner ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Uncaught ReferenceError: inner is not defined\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3col\x3e\x3cli\x3e\x3cp\x3ecatch 语句\x3c\/p\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22try {\n  throw new Error( \x27customized error\x27 );\n} catch( err ) {\n  var iamnoterror = \x27not error\x27;\n  console.log( iamnoterror ); \/\/ not error\n  console.log( err ); \/\/ Error: customized error\n}\nconsole.log( iamnoterror ); \/\/ not error\nconsole.log( err ); \/\/ Uncaught ReferenceError: e is not defined\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e( \x3cspan class=\x22hljs-string\x22\x3e\x27customized error\x27\x3c\/span\x3e );\n} \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e( err ) {\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e iamnoterror = \x3cspan class=\x22hljs-string\x22\x3e\x27not error\x27\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( iamnoterror ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ not error\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( err ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Error: customized error\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( iamnoterror ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ not error\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( err ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Uncaught ReferenceError: e is not defined\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里特别指出的是 catch 语句生成的作用域只会框住参数部分的变量（err），使其不能在外面访问。对于 catch 语句体里面声明的变量并不起作用。我们看规范里面怎么说：\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3eFor each element argName of the BoundNames of CatchParameter, do\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e\x3cp\x3ePerform catchEnv.CreateMutableBinding(argName).\x3c\/p\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3ecatchEvn 就是 catch 语句生成的作用域，但是这个作用域只保存参数列表中的变量（CreateMutableBinding(argName)）。\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e\x3cp\x3e语句块\x3c\/p\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if ( true ) {\n  let bv = \x27bv\x27;\n  const B_C = \x27BC\x27;\n  let blockFunc = function() {}\n  function notBlockFunc() {}\n\n  console.log( bv ); \/\/ bv\n  console.log( B_C ); \/\/ BC\n  console.log( notBlockFunc ); \/\/ function notBlockFunc() {}\n  console.log( blockFunc ); \/\/ function () {}\n  \n}\nconsole.log( bv ); \/\/ Uncaught ReferenceError: bv is not defined\nconsole.log( B_C ); \/\/ Uncaught ReferenceError: B_C is not defined\nconsole.log( notBlockFunc ); \/\/ function notBlockFunc() {}\nconsole.log( blockFunc ); \/\/ ReferenceError: blockFunc is not defined\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ( \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e ) {\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e bv = \x3cspan class=\x22hljs-string\x22\x3e\x27bv\x27\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e B_C = \x3cspan class=\x22hljs-string\x22\x3e\x27BC\x27\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e blockFunc = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{}\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3enotBlockFunc\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{}\n\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( bv ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ bv\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( B_C ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ BC\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( notBlockFunc ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ function notBlockFunc() {}\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( blockFunc ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ function () {}\x3c\/span\x3e\n  \n}\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( bv ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Uncaught ReferenceError: bv is not defined\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( B_C ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Uncaught ReferenceError: B_C is not defined\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( notBlockFunc ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ function notBlockFunc() {}\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log( blockFunc ); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ReferenceError: blockFunc is not defined\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e语句块 \x3ccode\x3e{}\x3c\/code\x3e 会生成一个新的作用域，但是这个作用域只绑定块级变量，常量等，即 let，const 声明的属于块级作用域，而 var 声明的还是属于块级作用域的父作用域。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e执行上下文\x3c\/h3\x3e\n\x3cp\x3e接下来我们说下执行上下文（execution context），执行上下文是用于跟踪代码的运行情况，其特征如下：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e一段代码块对应一个执行上下文，被封装成函数的代码被视作一段代码块，或者“全局作用域”也被视作一段代码块。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e当程序运行，进入到某段代码块时，一个新的执行上下文被创建，并被放入一个 stack 中。当程序运行到这段代码块结尾后，对应的执行上下文被弹出 stack。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e当程序在某段代码块中运行到某个点需要转到了另一个代码块时（调用了另一个函数），那么当前的可执行上下文的状态会被置为挂起，然后生成一个新的可执行上下文放入 stack 的顶部。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3estack 最顶部的可执行上下文被称为 running execution context。当顶部的可执行上下文被弹出后，上一个挂起的可执行上下文继续执行。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e我们用代码来示例下（从 outer 调用到 level1 调用，再逐层返回）：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVN7gC?w=1317\x26amp;h=272\x22 src=\x22https:\/\/static.alili.tech\/img\/bVN7gC?w=1317\x26amp;h=272\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e执行上下文对象的内部属性：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e[[code evaluation]]\x3c\/code\x3e：当前代码块执行的状态：prerform，suspend，resume。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e[[Function]]\x3c\/code\x3e：如果当前执行上下文对应的是一个函数，那么这个属性就保存的这个函数对象。如果对应的是全局环境（可以是一个 script 或者 module），属性值是 null。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e[[Real]]\x3c\/code\x3e：类似与沙箱的概念？（我还没有看懂，不过不太影响此篇的内容）。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e如果程序执行到某个点抛出异常了，那么我们可以用这个记录执行上下文的 stack 来追踪到底哪里出错了，可以看到整个调用栈，此时内部属性 \x3ccode\x3e[[Function]]\x3c\/code\x3e 就起到作用了：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVN7gL?w=445\x26amp;h=255\x22 src=\x22https:\/\/static.alili.tech\/img\/bVN7gL?w=445\x26amp;h=255\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e作用域和执行上下文的关系\x3c\/h3\x3e\n\x3cp\x3e其实大家看下作用域和执行上下文各自的职责，你会发现他们几乎是没有啥交集的。那么为啥通常两者会被同时提到呢？因为在一个函数被执行时，创建的执行上下文对象除了保存了些代码执行的信息，还会把当前的作用域保存在执行上下文中。所以它们的关系只是存储关系。\x3c\/p\x3e\n\x3ch5\x3e再谈变量查找（ResolveBinding）：\x3c\/h5\x3e\n\x3cp\x3e结合作用域和执行上下文，我们再来看下变量查找的过程。其实第一步不是到作用域里面找 Environment Record，而是先从当前的执行上下文中找保存的作用域（对象），然后再是通过作用域链向上查找变量。而且同一个执行上下文保存的作用域（对象）是可变的，当代码在同一个执行上下文中执行的时候，如果碰到有必要生成一个新作用域的时候，这个新的作用域会被添加到作用域链的头部，然后执行上下文就保存的作用域对象就更新成这个新的作用域。等这个新的作用域生命周期完成后，作用域链又会恢复到之前的状况，然后执行上下文保存的作用域也会恢复成之前的。示例： \x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVN7gS?w=1134\x26amp;h=803\x22 src=\x22https:\/\/static.alili.tech\/img\/bVN7gS?w=1134\x26amp;h=803\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3ethis\x3c\/h3\x3e\n\x3cp\x3e稍微提下，我看到网上有把执行上下文等同于 this 的文章，其实 this 的值是通过当前执行上下文中保存的作用域（对象）来获取到的，\x3ca href=\x22http:\/\/www.ecma-international.org\/ecma-262\/6.0\/#sec-resolvethisbinding\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e规范\x3c\/a\x3e如下。\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3eResolveThisBinding ( )\x3cbr\x3eThe abstract operation ResolveThisBinding determines the binding of the keyword this using the LexicalEnvironment of the running execution context. ResolveThisBinding performs the following steps:\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3eLet envRec be GetThisEnvironment( ).\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eReturn envRec.GetThisBinding().\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e我接下来会要总结函数作为普通函数和作为构造函数被调用时的区别，那个时候应该会对 this 有更深入的解释。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>什么是作用域和执行上下文</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009522006">https://segmentfault.com/a/1190000009522006</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/ayyvcu0i5r/" target="_blank">https://alili.tech/archive/ayyvcu0i5r/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>