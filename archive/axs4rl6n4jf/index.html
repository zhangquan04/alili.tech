<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Webpack实战 - 使用动态 entry 改善调试体验"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Webpack实战 - 使用动态 entry 改善调试体验 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/axs4rl6n4jf/",
				"appid": "1613049289050283", 
				"title": "Webpack实战 - 使用动态 entry 改善调试体验 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-28T02:30:09"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/jx520605u4l/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/msx73unnlto/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2faxs4rl6n4jf%2f&text=Webpack%e5%ae%9e%e6%88%98%20-%20%e4%bd%bf%e7%94%a8%e5%8a%a8%e6%80%81%20entry%20%e6%94%b9%e5%96%84%e8%b0%83%e8%af%95%e4%bd%93%e9%aa%8c"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2faxs4rl6n4jf%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2faxs4rl6n4jf%2f&text=Webpack%e5%ae%9e%e6%88%98%20-%20%e4%bd%bf%e7%94%a8%e5%8a%a8%e6%80%81%20entry%20%e6%94%b9%e5%96%84%e8%b0%83%e8%af%95%e4%bd%93%e9%aa%8c"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2faxs4rl6n4jf%2f&title=Webpack%e5%ae%9e%e6%88%98%20-%20%e4%bd%bf%e7%94%a8%e5%8a%a8%e6%80%81%20entry%20%e6%94%b9%e5%96%84%e8%b0%83%e8%af%95%e4%bd%93%e9%aa%8c"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2faxs4rl6n4jf%2f&is_video=false&description=Webpack%e5%ae%9e%e6%88%98%20-%20%e4%bd%bf%e7%94%a8%e5%8a%a8%e6%80%81%20entry%20%e6%94%b9%e5%96%84%e8%b0%83%e8%af%95%e4%bd%93%e9%aa%8c"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Webpack%e5%ae%9e%e6%88%98%20-%20%e4%bd%bf%e7%94%a8%e5%8a%a8%e6%80%81%20entry%20%e6%94%b9%e5%96%84%e8%b0%83%e8%af%95%e4%bd%93%e9%aa%8c&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2faxs4rl6n4jf%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2faxs4rl6n4jf%2f&title=Webpack%e5%ae%9e%e6%88%98%20-%20%e4%bd%bf%e7%94%a8%e5%8a%a8%e6%80%81%20entry%20%e6%94%b9%e5%96%84%e8%b0%83%e8%af%95%e4%bd%93%e9%aa%8c"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2faxs4rl6n4jf%2f&title=Webpack%e5%ae%9e%e6%88%98%20-%20%e4%bd%bf%e7%94%a8%e5%8a%a8%e6%80%81%20entry%20%e6%94%b9%e5%96%84%e8%b0%83%e8%af%95%e4%bd%93%e9%aa%8c"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2faxs4rl6n4jf%2f&title=Webpack%e5%ae%9e%e6%88%98%20-%20%e4%bd%bf%e7%94%a8%e5%8a%a8%e6%80%81%20entry%20%e6%94%b9%e5%96%84%e8%b0%83%e8%af%95%e4%bd%93%e9%aa%8c"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2faxs4rl6n4jf%2f&title=Webpack%e5%ae%9e%e6%88%98%20-%20%e4%bd%bf%e7%94%a8%e5%8a%a8%e6%80%81%20entry%20%e6%94%b9%e5%96%84%e8%b0%83%e8%af%95%e4%bd%93%e9%aa%8c"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Webpack实战 - 使用动态 entry 改善调试体验</h1><div class="meta"><div class="postdate"><time datetime="2019-01-28" itemprop="datePublished">2019-01-28</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e本文相关代码已经存放在 \x3ca href=\x22https:\/\/github.com\/boycgit\/demos\/blob\/master\/dynamic-entry\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3edynamic-entry\x3c\/a\x3e，可自行下载使用\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e0. 多入口 (复习)\x3c\/h2\x3e\n\x3cp\x3ewebpack 的优势不言而喻，因此在实际应用中我们也常常使用它调试 \x3cstrong\x3e多入口\x3c\/strong\x3e 应用，所谓 \x3cstrong\x3e多入口\x3c\/strong\x3e 是指多个HTML页面会使用多个入口文件，在官方教程 \x3ca href=\x22https:\/\/webpack.github.io\/docs\/multiple-entry-points.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMULTIPLE ENTRY POINTS\x3c\/a\x3e 介绍了如何配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n    entry: {\n        a: \x26quot;.\/a\x26quot;,\n        b: \x26quot;.\/b\x26quot;,\n        c: [\x26quot;.\/c\x26quot;, \x26quot;.\/d\x26quot;]\n    },\n    output: {\n        path: path.join(__dirname, \x26quot;dist\x26quot;),\n        filename: \x26quot;[name].entry.js\x26quot;\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e{\n    \x3cspan class=\x22hljs-attr\x22\x3eentry\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22.\/a\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22.\/b\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3ec\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22.\/c\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22.\/d\x22\x3c\/span\x3e]\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3eoutput\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: path.join(__dirname, \x3cspan class=\x22hljs-string\x22\x3e\x22dist\x22\x3c\/span\x3e),\n        \x3cspan class=\x22hljs-attr\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22[name].entry.js\x22\x3c\/span\x3e\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里指定了 3 个入口文件，打包之后分别会在 \x3cstrong\x3edist\x3c\/strong\x3e 文件夹中生成 3 个打包之后的 js 文件：\x3cstrong\x3ea.entry.js\x3c\/strong\x3e、\x3cstrong\x3eb.entry.js\x3c\/strong\x3e、\x3cstrong\x3ec.entry.js\x3c\/strong\x3e，可被至少 3 个不同的 HTML 页面直接引用；\x3c\/p\x3e\n\x3cp\x3e上述是最基本的使用，实际中还可以使用 \x3ca href=\x22https:\/\/github.com\/webpack\/webpack\/tree\/master\/examples\/multiple-commons-chunks\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emultiple-commons-chunks\x3c\/a\x3e 等提高打包的速度、性能；\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e1. 动态 entry 的场景\x3c\/h2\x3e\n\x3cp\x3e像上面那样直接应用 Webpack 的多入口功能，在普通的工程项目中并不存在什么问题，还简单高效；\x3c\/p\x3e\n\x3cp\x3e然而如果你使用 Webpack 构建较大型的页面系统，遂着业务的扩大，入口的数量会逐渐增多，\x3cstrong\x3e纵使每个入口文件都很小，在调试的时候等所有的入口文件都 ready 所耗费的时间也是非常巨大的，让用户等待太久显然很不友好\x3c\/strong\x3e；\x3c\/p\x3e\n\x3cp\x3e用户等待时间随着模块数量而线性增加（见下图）：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/gw.alicdn.com\/tps\/TB1nxJpPXXXXXbJaXXXXXXXXXXX-1462-158.png\x22 src=\x22https:\/\/static.alili.techhttps:\/\/gw.alicdn.com\/tps\/TB1nxJpPXXXXXbJaXXXXXXXXXXX-1462-158.png\x22 alt=\x22等待时间随着模块数量的增加而线性增加\x22 title=\x22等待时间随着模块数量的增加而线性增加\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e假设业务模块有100个，而当前自己仅仅需要调试 A 模块，如果使用默认的多模块入口方式，用户 \x3cstrong\x3e必须等这100个模块启动之后才能调试 A 模块\x3c\/strong\x3e，很明显这会让用户抓狂；\x3c\/p\x3e\n\x3cp\x3e比较合理的做法是，无论当前用户模块目录下有多少个模块，默认都只其构建一个模块，当用户想要调试另外一个模块的时候，再动态添加一个 entry 到 webpack 系统中，\x3cstrong\x3e这就减少了用户等待的时间，提高了调试时的用户体验\x3c\/strong\x3e；\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/gw.alicdn.com\/tps\/TB1u30sPXXXXXbIaXXXXXXXXXXX-1462-235.png\x22 src=\x22https:\/\/static.alili.techhttps:\/\/gw.alicdn.com\/tps\/TB1u30sPXXXXXbIaXXXXXXXXXXX-1462-235.png\x22 alt=\x22使用动态entry\x22 title=\x22使用动态entry\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e2. 实现动态 entry 的原理\x3c\/h2\x3e\n\x3cp\x3e目前业界并没有现成的动态 entry 方案，需要自己分析 webpack 源码找到解决方案；（如果不清楚 webpack 流程的，可以参考 @七珏 同学的 \x3ca href=\x22http:\/\/taobaofed.org\/blog\/2016\/09\/09\/webpack-flow\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e细说webpack之流程篇\x3c\/a\x3e）\x3c\/p\x3e\n\x3cp\x3e2.1、先分析 webpack 源码中处理单入口的 entry 情况，在 \x3ccode\x3eWebpackOptionsApply.js\x3c\/code\x3e 有：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/img.alicdn.com\/tps\/TB1rxSxOpXXXXb4XXXXXXXXXXXX-957-109.png\x22 src=\x22https:\/\/static.alili.techhttps:\/\/img.alicdn.com\/tps\/TB1rxSxOpXXXXb4XXXXXXXXXXXX-957-109.png\x22 alt=\x22WebpackOptionsApply\x22 title=\x22WebpackOptionsApply\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e这里首先是加载 \x3cstrong\x3eEntryOptionPlugin.js\x3c\/strong\x3e 然后触发添加 entry 入口\x3c\/li\x3e\n\x3cli\x3e然后触发 \x3cstrong\x3eentry-option\x3c\/strong\x3e 事件节点，将 \x3ccode\x3econtext\x3c\/code\x3e 和 \x3ccode\x3eentry\x3c\/code\x3e 作为参数传入\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e2.2、 继续看 \x3cstrong\x3eEntryOptionPlugin.js\x3c\/strong\x3e 文件，在 \x3cstrong\x3eentry-option\x3c\/strong\x3e 事件节点中调用 \x3ccode\x3eSingleEntryPlugin\x3c\/code\x3e 构造函数构建单入口模块：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/img.alicdn.com\/tps\/TB1ga9iOpXXXXa6aXXXXXXXXXXX-604-357.png\x22 src=\x22https:\/\/static.alili.techhttps:\/\/img.alicdn.com\/tps\/TB1ga9iOpXXXXa6aXXXXXXXXXXX-604-357.png\x22 alt=\x22构建单入口模块\x22 title=\x22构建单入口模块\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3e我们可以依样画葫芦，利用官方的 \x3ccode\x3eSingleEntryPlugin\x3c\/code\x3e 的对象来完成动态添加入口的功能。\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e我们像平常那样创建单入口文件配置文件\x3c\/li\x3e\n\x3cli\x3e依据 \x3ccode\x3ewebpack(config)\x3c\/code\x3e 获取 \x3cstrong\x3ecompiler\x3c\/strong\x3e 实例；\x3c\/li\x3e\n\x3cli\x3e然后调用 \x3ccode\x3ecompiler.apply(new SingleEntryPlugin(process.cwd(),...);\x3c\/code\x3e 新增一个构建入口\x3c\/li\x3e\n\x3cli\x3e通知 webpack 让新入口生效\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e3. 示例\x3c\/h2\x3e\n\x3cblockquote\x3e本节的代码放在仓库 \x3ca href=\x22https:\/\/github.com\/boycgit\/dynamic-entry\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3edynamic-entry\x3c\/a\x3e 中，可以到下载获取\x3c\/blockquote\x3e\n\x3cp\x3e这里我们以 express 框架为例，讲解如何实现动态 entry ；具体操作步骤如下：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e下载 dynamic-entry 代码：\x3ccode\x3egit clone https:\/\/github.com\/boycgit\/dynamic-entry\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3ecd dynamic-entry \x26amp;\x26amp; npm install \x26amp;\x26amp; node server.js\x3c\/code\x3e\x3c\/li\x3e\n\x3cli\x3e启动 web 服务（可访问 \x3ca href=\x22http:\/\/localhost\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/localhost\x3c\/a\x3e:3000 ），默认只会构建一个 \x3cstrong\x3esrc\/index1.js\x3c\/strong\x3e\n\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22http:\/\/ww3.sinaimg.cn\/large\/006tNbRwgw1fa0ocmyu8pj30ez0340sx.jpg\x22 src=\x22https:\/\/static.alili.techhttp:\/\/ww3.sinaimg.cn\/large\/006tNbRwgw1fa0ocmyu8pj30ez0340sx.jpg\x22 alt=\x22默认构建单个\x22 title=\x22默认构建单个\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e然后访问 \x3ccode\x3ehttp:\/\/localhost:3000\/add\x3c\/code\x3e，再去看命令行，你会发现现在会构建 \x3cstrong\x3esrc\/index1.js\x3c\/strong\x3e 和 \x3cstrong\x3esrc\/index2.js\x3c\/strong\x3e 这两个文件，这就是所谓的动态 entry\x3c\/li\x3e\x3c\/ol\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22http:\/\/ww4.sinaimg.cn\/large\/006tNbRwgw1fa0odz4c2dj30f0041t92.jpg\x22 src=\x22https:\/\/static.alili.techhttp:\/\/ww4.sinaimg.cn\/large\/006tNbRwgw1fa0odz4c2dj30f0041t92.jpg\x22 alt=\x22动态entry\x22 title=\x22动态entry\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e简要分析一下源码，在 \x3cstrong\x3eserver.js\x3c\/strong\x3e 中：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22...\nvar SingleEntryPlugin = require(\x27webpack\/lib\/SingleEntryPlugin\x27);\nvar webpackDevMiddleware = require(\x27webpack-dev-middleware\x27);\n\n...\n\nvar webpackDevMiddlewareInstance = webpackDevMiddleware(compiler, webpackDevMiddlewareParam);\napp.use(webpackDevMiddlewareInstance); \/\/ 应用针对 express 框架的 webpack 调试中间件\n\n...\n\nvar once = true;\n\/\/ 新增入口\napp.get(\x27\/add\x27, function(req, res) {\n  \/\/ 应用单入口插件\n  console.log(\x27apply SingleEntryPlugin\x27);\n  compiler.apply(new SingleEntryPlugin(process.cwd(), \x27.\/src\/index2.js\x27,\x27index2\x27));\n  once \x26amp;\x26amp; webpackDevMiddlewareInstance.invalidate(); \/\/ 强制重新构建一次，不用调用多次，后续的触发由webpack自己 hot reload\n  once = false; \/\/ 置 once 就是 false\n  res.send(\x27already apply SingleEntryPlugin\x27);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lasso\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e SingleEntryPlugin = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack\/lib\/SingleEntryPlugin\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e webpackDevMiddleware = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack-dev-middleware\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e webpackDevMiddlewareInstance = webpackDevMiddleware(compiler, webpackDevMiddlewareParam);\napp.use(webpackDevMiddlewareInstance); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 应用针对 express 框架的 webpack 调试中间件\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e once = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 新增入口\x3c\/span\x3e\napp.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/add\x27\x3c\/span\x3e, function(req, res) {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 应用单入口插件\x3c\/span\x3e\n  console.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27apply SingleEntryPlugin\x27\x3c\/span\x3e);\n  compiler.apply(\x3cspan class=\x22hljs-literal\x22\x3enew\x3c\/span\x3e SingleEntryPlugin(process.cwd(), \x3cspan class=\x22hljs-string\x22\x3e\x27.\/src\/index2.js\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27index2\x27\x3c\/span\x3e));\n  once \x26amp;\x26amp; webpackDevMiddlewareInstance.invalidate(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 强制重新构建一次，不用调用多次，后续的触发由webpack自己 hot reload\x3c\/span\x3e\n  once = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 置 once 就是 false\x3c\/span\x3e\n  res.send(\x3cspan class=\x22hljs-string\x22\x3e\x27already apply SingleEntryPlugin\x27\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\n\x3cli\x3e这里用到了 \x3ca href=\x22https:\/\/github.com\/webpack\/webpack-dev-middleware\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack-dev-middleware\x3c\/a\x3e 模块，是 webpack 调试用的 express 中间件，它提供调试时候将构建的文件输出到文件系统，可以让用户访问获取；\x3c\/li\x3e\n\x3cli\x3e注册 \x3ccode\x3e\/add\x3c\/code\x3e 路由，当用户访问此页面的时候会调用 \x3ccode\x3ecompiler.apply\x3c\/code\x3e \x3cstrong\x3e新增一个构建入口\x3c\/strong\x3e\n\x3c\/li\x3e\n\x3cli\x3e调用 \x3ccode\x3ewebpackDevMiddlewareInstance.invalidate()\x3c\/code\x3e \x3cstrong\x3e强制 webpack 重新构建一次\x3c\/strong\x3e，这个方法只需要调用1次（因此这儿由 \x3ccode\x3eonce\x3c\/code\x3e 变量进行控制），后续的触发由webpack自己 hot reload\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e从上面的过程可见，动态 entry 实施的过程是借鉴 webpack 自身的 \x3cstrong\x3eSingleEntryPlugin\x3c\/strong\x3e 插件进行的，在可靠性方面有很大的保障；其余的代码则是借用现有的 express 中间件获取所需要的 \x3ccode\x3ecompiler\x3c\/code\x3e 等对象协助此过程；\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e4. 总结\x3c\/h2\x3e\n\x3cp\x3e目前动态 entry 之后已经运用在若干个内部构建器中，在应用动态 entry 之后，明显地改善了用户体验；\x3c\/p\x3e\n\x3cp\x3e此篇文章希望能给有类似场景的同学提供帮助；\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e5. 参考文章\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/webpack.github.io\/docs\/multiple-entry-points.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMULTIPLE ENTRY POINTS\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/taobaofed.org\/blog\/2016\/09\/09\/webpack-flow\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e细说webpack之流程篇\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/lihuanghe.github.io\/2016\/05\/30\/webpack-source-analyse.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack 源码解析\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Webpack实战 - 使用动态 entry 改善调试体验</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008055046">https://segmentfault.com/a/1190000008055046</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/axs4rl6n4jf/" target="_blank">https://alili.tech/archive/axs4rl6n4jf/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>