<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="一步一步搭建一个图片上传网站（后台服务器用nodejs）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>一步一步搭建一个图片上传网站（后台服务器用nodejs） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/gzau4cf1qps/",
				"appid": "1613049289050283", 
				"title": "一步一步搭建一个图片上传网站（后台服务器用nodejs） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-15T02:30:12"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/mhhjvmk85z/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/xixnynrf2r/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fgzau4cf1qps%2f&text=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e6%90%ad%e5%bb%ba%e4%b8%80%e4%b8%aa%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e7%bd%91%e7%ab%99%ef%bc%88%e5%90%8e%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%94%a8nodejs%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fgzau4cf1qps%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fgzau4cf1qps%2f&text=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e6%90%ad%e5%bb%ba%e4%b8%80%e4%b8%aa%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e7%bd%91%e7%ab%99%ef%bc%88%e5%90%8e%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%94%a8nodejs%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fgzau4cf1qps%2f&title=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e6%90%ad%e5%bb%ba%e4%b8%80%e4%b8%aa%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e7%bd%91%e7%ab%99%ef%bc%88%e5%90%8e%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%94%a8nodejs%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fgzau4cf1qps%2f&is_video=false&description=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e6%90%ad%e5%bb%ba%e4%b8%80%e4%b8%aa%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e7%bd%91%e7%ab%99%ef%bc%88%e5%90%8e%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%94%a8nodejs%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e6%90%ad%e5%bb%ba%e4%b8%80%e4%b8%aa%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e7%bd%91%e7%ab%99%ef%bc%88%e5%90%8e%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%94%a8nodejs%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fgzau4cf1qps%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fgzau4cf1qps%2f&title=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e6%90%ad%e5%bb%ba%e4%b8%80%e4%b8%aa%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e7%bd%91%e7%ab%99%ef%bc%88%e5%90%8e%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%94%a8nodejs%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fgzau4cf1qps%2f&title=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e6%90%ad%e5%bb%ba%e4%b8%80%e4%b8%aa%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e7%bd%91%e7%ab%99%ef%bc%88%e5%90%8e%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%94%a8nodejs%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fgzau4cf1qps%2f&title=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e6%90%ad%e5%bb%ba%e4%b8%80%e4%b8%aa%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e7%bd%91%e7%ab%99%ef%bc%88%e5%90%8e%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%94%a8nodejs%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fgzau4cf1qps%2f&title=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e6%90%ad%e5%bb%ba%e4%b8%80%e4%b8%aa%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e7%bd%91%e7%ab%99%ef%bc%88%e5%90%8e%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%94%a8nodejs%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">一步一步搭建一个图片上传网站（后台服务器用nodejs）</h1><div class="meta"><div class="postdate"><time datetime="2019-01-15" itemprop="datePublished">2019-01-15</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e前几天看了腾讯云社区的一个文件上传的文章\x3ca href=\x22https:\/\/www.qcloud.com\/community\/article\/985614?fromSource=gwzcw.114038.114038.114038\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e文件上传那些事儿\x3c\/a\x3e，大体上讲了以下h5中图片上传的几个核心原理，但是没有后端接受的服务器代码，没法做测试。也没有具体的一个实例都是一些基本的原理片段，并且ui界面也不好看，我就准备给那篇文章作为补充做一个图片上传网站。\x3cbr\x3e效果如图：\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVNfBp?w=425\x26amp;h=207\x22 src=\x22https:\/\/static.alili.tech\/img\/bVNfBp?w=425\x26amp;h=207\x22 alt=\x22效果1\x22 title=\x22效果1\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVNfBu?w=984\x26amp;h=314\x22 src=\x22https:\/\/static.alili.tech\/img\/bVNfBu?w=984\x26amp;h=314\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e点击上传后，会把文件放到后台一个uploads文件夹下面，如果上传成功，那么页面会 弹出一个上传成功的提示框，如果上传失败，会弹出一个失败的提示框，如果网速比较慢，会显示出上传过程中的进度条。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3e开发准备\x3c\/h1\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e用普通的表单提交方法实现文件上传。\x3c\/h2\x3e\n\x3cp\x3e1.编写前端代码\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cform action=\x26quot;uploadimg\x26quot; method=\x26quot;POST\x26quot; enctype=\x26quot;multipart\/form-data\x26quot;\x3e\n        \x3cinput type=\x26quot;file\x26quot; name=\x26quot;imgfile\x26quot; multiple\x3e\n        \x3cinput type=\x26quot;submit\x26quot; value=\x26quot;提交\x26quot;\x3e\n    \x3c\/form\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs accesslog\x22\x3e\x3ccode\x3e\x26lt;form action=\x3cspan class=\x22hljs-string\x22\x3e\x22uploadimg\x22\x3c\/span\x3e method=\x3cspan class=\x22hljs-string\x22\x3e\x22\x3cspan class=\x22hljs-keyword\x22\x3ePOST\x3c\/span\x3e\x22\x3c\/span\x3e enctype=\x3cspan class=\x22hljs-string\x22\x3e\x22multipart\/form-data\x22\x3c\/span\x3e\x26gt;\n        \x26lt;input type=\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e name=\x3cspan class=\x22hljs-string\x22\x3e\x22imgfile\x22\x3c\/span\x3e multiple\x26gt;\n        \x26lt;input type=\x3cspan class=\x22hljs-string\x22\x3e\x22submit\x22\x3c\/span\x3e value=\x3cspan class=\x22hljs-string\x22\x3e\x22提交\x22\x3c\/span\x3e\x26gt;\n    \x26lt;\/form\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e设置action为提交地址，\x3ccode\x3eenctype=\x22multipart\/form-data\x22\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e设置提交文件表单域名为\x3ccode\x3eimgfile\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e2.编写后端测试用代码\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e这里我们采用了express框架，需要先安装这个框架，然后使用静态中间件指定放置我们js css html 文件的目录\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var app = express();\napp.use(express.static(\x27dist\x27))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\napp.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(express.\x3cspan class=\x22hljs-keyword\x22\x3estatic\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27dist\x27\x3c\/span\x3e))\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e下载处理上传文件的插件\x3ccode\x3emulter\x3c\/code\x3e\x3cbr\x3e在readme.md文件中有基本的使用方法，我们复制过来代码实例稍微改改就可以使用了。把文件上传路径指定到uploads,然后用当前日期和文件名命名上传过来的文件。这个imgfile域名必须严格和前端表单文件域名对应起来。\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e完整代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;use strict\x26quot;;\nexports.__esModule = true;\nvar express = require(\x26quot;express\x26quot;);\nvar multer = require(\x26quot;multer\x26quot;);\nvar storage = multer.diskStorage({\n    destination: function(req, file, cb) {\n        cb(null, \x27.\/uploads\x27);\n    },\n    filename: function(req, file, cb) {\n        cb(null, `${Date.now()}-${file.originalname}`)\n    }\n})\nvar upload = multer({ storage: storage });\nvar app = express();\napp.use(express.static(\x27dist\x27));\n\/\/var cpUpload = upload.fields([{ name: \x27imgfile\x27, maxCount: 12 }])\napp.post(\x27\/uploadimg\x27, upload.array(\x27imgfile\x27, 40), function(req, res, next) {\n    var files = req.files\n    console.log(files)\n    if (!files[0]) {\n        res.send(\x27error\x27);\n    } else {\n        res.send(\x27success\x27);\n    }\n\n\n\n    console.log(files);\n})\n\nvar server = app.listen(9999, \x27localhost\x27, function() {\n    console.log(\x27server is running at port 9999...\x27);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x22use strict\x22\x3c\/span\x3e;\nexports.__esModule = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22express\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e multer = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22multer\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e storage = multer.diskStorage({\n    \x3cspan class=\x22hljs-attr\x22\x3edestination\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, file, cb\x3c\/span\x3e) \x3c\/span\x3e{\n        cb(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.\/uploads\x27\x3c\/span\x3e);\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, file, cb\x3c\/span\x3e) \x3c\/span\x3e{\n        cb(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`\x3cspan class=\x22hljs-subst\x22\x3e${\x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e.now()}\x3c\/span\x3e-\x3cspan class=\x22hljs-subst\x22\x3e${file.originalname}\x3c\/span\x3e`\x3c\/span\x3e)\n    }\n})\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e upload = multer({ \x3cspan class=\x22hljs-attr\x22\x3estorage\x3c\/span\x3e: storage });\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\napp.use(express.static(\x3cspan class=\x22hljs-string\x22\x3e\x27dist\x27\x3c\/span\x3e));\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/var cpUpload = upload.fields([{ name: \x27imgfile\x27, maxCount: 12 }])\x3c\/span\x3e\napp.post(\x3cspan class=\x22hljs-string\x22\x3e\x27\/uploadimg\x27\x3c\/span\x3e, upload.array(\x3cspan class=\x22hljs-string\x22\x3e\x27imgfile\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e40\x3c\/span\x3e), \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res, next\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e files = req.files\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(files)\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!files[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]) {\n        res.send(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e);\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        res.send(\x3cspan class=\x22hljs-string\x22\x3e\x27success\x27\x3c\/span\x3e);\n    }\n\n\n\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(files);\n})\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e server = app.listen(\x3cspan class=\x22hljs-number\x22\x3e9999\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27localhost\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27server is running at port 9999...\x27\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样选择文件，点击提交按钮后文件就被上传到了服务器uploads文件夹下\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e用H5和ajax技术实现无刷新文件上传\x3c\/h2\x3e\n\x3cp\x3e1.改造原来的选择文件按钮，让它变成一个可爱的小图标，点击后选择文件。\x3cbr\x3e这个过于简单就不放代码了，具体思路是把一个a标签放上背景图片，把上传文件\x3ccode\x3einput type=\x22file\x22\x3c\/code\x3e大小设置成a标签一样大，并且放置到a标签上面，opacity设置成0透明的。点击a实际上是点击了\x3ccode\x3einput type=\x22file\x22\x3c\/code\x3e\x3cbr\x3e2.选取文件后生成缩略图，这个基本思路是监听\x3ccode\x3einput type=\x22file\x22\x3c\/code\x3e的onchange事件，如果选了文件就利用FileReader生成一个图片data:url添加到div.preview里面动态生成的img上，给div.preview设置成flex布局就可以灵活放置预览图了。\x3cbr\x3ehtml\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    \x3cdiv class=\x26quot;wrap\x26quot;\x3e\n\n        \x3ca href=\x26quot;\x26quot; class=\x26quot;selectImg\x26quot; title=\x26quot;上传图片\x26quot;\x3e\x3c\/a\x3e\n        \x3cinput type=\x26quot;file\x26quot; multiple id=\x26quot;file\x26quot;\x3e\n        \x3cinput type=\x26quot;button\x26quot; value=\x26quot;上传\x26quot; id=\x26quot;upload\x26quot;\x3e\n        \x3cdiv class=\x26quot;preview\x26quot;\x3e\x3c\/div\x3e\n        \x3cdiv class=\x26quot;progress\x26quot;\x3e\n            \x3cprogress max=\x26quot;100\x26quot; value=\x26quot;1\x26quot; item-width=\x26quot;100\x26quot; id=\x26quot;progress\x26quot;\x3e\x3c\/progress\x3e\n        \x3c\/div\x3e\n    \x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs applescript\x22\x3e\x3ccode\x3e    \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22wrap\x22\x3c\/span\x3e\x26gt;\n\n        \x26lt;a href=\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22selectImg\x22\x3c\/span\x3e title=\x3cspan class=\x22hljs-string\x22\x3e\x22上传图片\x22\x3c\/span\x3e\x26gt;\x26lt;\/a\x26gt;\n        \x26lt;input type=\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e multiple \x3cspan class=\x22hljs-built_in\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e\x26gt;\n        \x26lt;input type=\x3cspan class=\x22hljs-string\x22\x3e\x22button\x22\x3c\/span\x3e value=\x3cspan class=\x22hljs-string\x22\x3e\x22上传\x22\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22upload\x22\x3c\/span\x3e\x26gt;\n        \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22preview\x22\x3c\/span\x3e\x26gt;\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n        \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22progress\x22\x3c\/span\x3e\x26gt;\n            \x26lt;progress max=\x3cspan class=\x22hljs-string\x22\x3e\x22100\x22\x3c\/span\x3e value=\x3cspan class=\x22hljs-string\x22\x3e\x221\x22\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eitem\x3c\/span\x3e-width=\x3cspan class=\x22hljs-string\x22\x3e\x22100\x22\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22progress\x22\x3c\/span\x3e\x26gt;\x26lt;\/progress\x26gt;\n        \x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n    \x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ejs\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22   fileinput.onchange = () =\x3e {\n            \/\/console.log(\x27dddd\x27)\n            var files = fileinput.files\n            let imgDOMArray = new Array(files.length)\n            let reader = []\n            let thumbPic = []\n            progressDOM = document.getElementById(\x27progress-img\x27)\n            for (let i = 0; i \x3c files.length; i\x2b\x2b) {\n                reader[i] = new FileReader()\n                thumbPic[i] = document.createElement(\x27div\x27)\n                imgDOMArray[i] = document.createElement(\x27img\x27)\n                imgDOMArray[i].file = files[i]\n                thumbPic[i].className = \x27thumbPic\x27\n                thumbPic[i].appendChild(imgDOMArray[i])\n                previewDOM.appendChild(thumbPic[i])\n                reader[i].readAsDataURL(files[i])\n                reader[i].onload = (img =\x3e {\n\n                    return e =\x3eimg.src = e.target.result\n                    \n                })(imgDOMArray[i])\n\n            }\n        }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e   fileinput.onchange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/console.log(\x27dddd\x27)\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e files = fileinput.files\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e imgDOMArray = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e(files.length)\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e reader = []\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e thumbPic = []\n            progressDOM = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27progress-img\x27\x3c\/span\x3e)\n            \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; files.length; i\x2b\x2b) {\n                reader[i] = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FileReader()\n                thumbPic[i] = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e)\n                imgDOMArray[i] = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27img\x27\x3c\/span\x3e)\n                imgDOMArray[i].file = files[i]\n                thumbPic[i].className = \x3cspan class=\x22hljs-string\x22\x3e\x27thumbPic\x27\x3c\/span\x3e\n                thumbPic[i].appendChild(imgDOMArray[i])\n                previewDOM.appendChild(thumbPic[i])\n                reader[i].readAsDataURL(files[i])\n                reader[i].onload = (\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eimg\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e =\x26gt;\x3c\/span\x3eimg.src = e.target.result\n                    \n                })(imgDOMArray[i])\n\n            }\n        }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e3.点击上传按钮上传图片\x3cbr\x3e这个基本思路就是利用Formdata模拟表单，然后用ajax发送文件到服务器\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22        var aUpload = document.querySelector(\x27.selectImg\x27)\n        var button = document.querySelector(\x27#upload\x27)\n        var fileinput = document.getElementById(\x27file\x27)\n        button.onclick = uploadFile\n         function uploadFile() {\n            \/\/  console.log(\x27ddd\x27)\n            var xhr = new XMLHttpRequest()\n            var formdata = new FormData()\n\n            var files = fileinput.files\n            if (!files[0]) {\n                alert(\x27请先选择图片，再上传！\x27)\n                return\n            }\n\n            var progress = document.querySelector(\x27progress\x27)\n            for (let i = 0; i \x3c files.length; i\x2b\x2b) {\n                formdata.append(\x27imgfile\x27, files[i], files[i].name)\n            }\n            xhr.open(\x27POST\x27, \x27\/uploadimg\x27)\n            xhr.onload = () =\x3e {\n                if (xhr.status === 200 \x26amp;\x26amp; xhr.responseText === \x27success\x27) {\n                    previewDOM.innerHTML = \x27\x27\n                    xhr = null\n                    alert(\x27图片上传成功！\x27)\n                }\n            }\n            xhr.send(formdata)\n            xhr.upload.onprogress = e =\x3e {\n                if (e.lengthComputable) {\n                    var progressWrap = document.querySelector(\x27.progress\x27)\n                    progressWrap.style.display = \x26quot;flex\x26quot;\n                    var percentComplete = e.loaded \/ e.total * 100\n                    progress.value = percentComplete\n\n                    if (percentComplete \x3e= 100) {\n                        progress.value = 0\n                        progressWrap.style.display = \x26quot;none\x26quot;\n                    }\n                }\n            }\n\n        }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e aUpload = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.selectImg\x27\x3c\/span\x3e)\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e button = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27#upload\x27\x3c\/span\x3e)\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e fileinput = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27file\x27\x3c\/span\x3e)\n        button.onclick = uploadFile\n         \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3euploadFile\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/  console.log(\x27ddd\x27)\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest()\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e formdata = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FormData()\n\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e files = fileinput.files\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!files[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]) {\n                alert(\x3cspan class=\x22hljs-string\x22\x3e\x27请先选择图片，再上传！\x27\x3c\/span\x3e)\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n            }\n\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e progress = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27progress\x27\x3c\/span\x3e)\n            \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; files.length; i\x2b\x2b) {\n                formdata.append(\x3cspan class=\x22hljs-string\x22\x3e\x27imgfile\x27\x3c\/span\x3e, files[i], files[i].name)\n            }\n            xhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/uploadimg\x27\x3c\/span\x3e)\n            xhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (xhr.status === \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e \x26amp;\x26amp; xhr.responseText === \x3cspan class=\x22hljs-string\x22\x3e\x27success\x27\x3c\/span\x3e) {\n                    previewDOM.innerHTML = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n                    xhr = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n                    alert(\x3cspan class=\x22hljs-string\x22\x3e\x27图片上传成功！\x27\x3c\/span\x3e)\n                }\n            }\n            xhr.send(formdata)\n            xhr.upload.onprogress = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e.lengthComputable) {\n                    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e progressWrap = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.progress\x27\x3c\/span\x3e)\n                    progressWrap.style.display = \x3cspan class=\x22hljs-string\x22\x3e\x22flex\x22\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e percentComplete = e.loaded \/ e.total * \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e\n                    progress.value = percentComplete\n\n                    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (percentComplete \x26gt;= \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e) {\n                        progress.value = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n                        progressWrap.style.display = \x3cspan class=\x22hljs-string\x22\x3e\x22none\x22\x3c\/span\x3e\n                    }\n                }\n            }\n\n        }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其中利用了xhr.upload.onprogress监听数据上传事件，并且动态设置h5进度条的value显示上传进度。如果上传完成，隐藏进度条。\x3cbr\x3e如果服务器返回的是success，就弹出上传图片成功。否则弹出上传图片失败。\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3e\x3cstrong\x3e总结\x3c\/strong\x3e\x3cbr\x3e前端利用了FileReader 的readAsDataUrl显示缩略图，利用H5 progress标签和监听xhr.upload.onprogress显示进度条。利用FormData模拟表单数据，用ajax技术提交到服务器。\x3cbr\x3e后端利用express建立服务器，利用static中间件指定js css html 文件路径。用multer模块实现了解析存储通过\x3ccode\x3einput typle=\x22file\x22\x3c\/code\x3e提交的数据。\x3cbr\x3e利用这个前端ajax和后端nodejs技术，我们基本上就可以做出一个图片上传存储的基本网站核心。如果数据量比较大我们就可以采用数据库存储索引搜索，不过这已经跟前端没啥关系就不展开讲了。\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/liyu2012\/fileupload\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e获取代码\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>一步一步搭建一个图片上传网站（后台服务器用nodejs）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009316054">https://segmentfault.com/a/1190000009316054</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/gzau4cf1qps/" target="_blank">https://alili.tech/archive/gzau4cf1qps/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>