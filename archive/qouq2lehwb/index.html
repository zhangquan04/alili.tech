<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="一个 PHPer 第一次用 Koa2 写 Node.js 的心路历程"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>一个 PHPer 第一次用 Koa2 写 Node.js 的心路历程 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/qouq2lehwb/",
				"appid": "1613049289050283", 
				"title": "一个 PHPer 第一次用 Koa2 写 Node.js 的心路历程 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-12T02:30:25"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/6g8jaf4lsr9/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/i010qmbp6i/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fqouq2lehwb%2f&text=%e4%b8%80%e4%b8%aa%20PHPer%20%e7%ac%ac%e4%b8%80%e6%ac%a1%e7%94%a8%20Koa2%20%e5%86%99%20Node.js%20%e7%9a%84%e5%bf%83%e8%b7%af%e5%8e%86%e7%a8%8b"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fqouq2lehwb%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fqouq2lehwb%2f&text=%e4%b8%80%e4%b8%aa%20PHPer%20%e7%ac%ac%e4%b8%80%e6%ac%a1%e7%94%a8%20Koa2%20%e5%86%99%20Node.js%20%e7%9a%84%e5%bf%83%e8%b7%af%e5%8e%86%e7%a8%8b"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fqouq2lehwb%2f&title=%e4%b8%80%e4%b8%aa%20PHPer%20%e7%ac%ac%e4%b8%80%e6%ac%a1%e7%94%a8%20Koa2%20%e5%86%99%20Node.js%20%e7%9a%84%e5%bf%83%e8%b7%af%e5%8e%86%e7%a8%8b"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fqouq2lehwb%2f&is_video=false&description=%e4%b8%80%e4%b8%aa%20PHPer%20%e7%ac%ac%e4%b8%80%e6%ac%a1%e7%94%a8%20Koa2%20%e5%86%99%20Node.js%20%e7%9a%84%e5%bf%83%e8%b7%af%e5%8e%86%e7%a8%8b"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%b8%80%e4%b8%aa%20PHPer%20%e7%ac%ac%e4%b8%80%e6%ac%a1%e7%94%a8%20Koa2%20%e5%86%99%20Node.js%20%e7%9a%84%e5%bf%83%e8%b7%af%e5%8e%86%e7%a8%8b&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fqouq2lehwb%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fqouq2lehwb%2f&title=%e4%b8%80%e4%b8%aa%20PHPer%20%e7%ac%ac%e4%b8%80%e6%ac%a1%e7%94%a8%20Koa2%20%e5%86%99%20Node.js%20%e7%9a%84%e5%bf%83%e8%b7%af%e5%8e%86%e7%a8%8b"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqouq2lehwb%2f&title=%e4%b8%80%e4%b8%aa%20PHPer%20%e7%ac%ac%e4%b8%80%e6%ac%a1%e7%94%a8%20Koa2%20%e5%86%99%20Node.js%20%e7%9a%84%e5%bf%83%e8%b7%af%e5%8e%86%e7%a8%8b"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqouq2lehwb%2f&title=%e4%b8%80%e4%b8%aa%20PHPer%20%e7%ac%ac%e4%b8%80%e6%ac%a1%e7%94%a8%20Koa2%20%e5%86%99%20Node.js%20%e7%9a%84%e5%bf%83%e8%b7%af%e5%8e%86%e7%a8%8b"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqouq2lehwb%2f&title=%e4%b8%80%e4%b8%aa%20PHPer%20%e7%ac%ac%e4%b8%80%e6%ac%a1%e7%94%a8%20Koa2%20%e5%86%99%20Node.js%20%e7%9a%84%e5%bf%83%e8%b7%af%e5%8e%86%e7%a8%8b"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">一个 PHPer 第一次用 Koa2 写 Node.js 的心路历程</h1><div class="meta"><div class="postdate"><time datetime="2019-01-12" itemprop="datePublished">2019-01-12</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e学了一段时间的 js 了，突然想实践一下。正好公司有个小的项目要做，就顺手拿 Koa2 来做了。真是不做不知道，做了想不到。踩了一堆新手坑。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e初次接触 Koa2\x3c\/h2\x3e\n\x3cp\x3e在知道 Koa2 之前，我也了解过 Express，可惜并没有实战用过。后来大家都说 Koa 是一个比 Express 更牛X的东西，于是在好（作）奇（死）心作祟下，直接去用 Koa2 了。后来证明的确是作死，原本用 PHP 一天就能写完东西，愣是让我搞了三天。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e安装\x3c\/h3\x3e\n\x3cp\x3e最近 Node.js V8 发布了，原生支持 \x3ccode\x3easync\x3c\/code\x3e 和 \x3ccode\x3eawait\x3c\/code\x3e 调用了，所以直接把 Node.js 升级了一下。\x3c\/p\x3e\n\x3cp\x3e根据 Koa2 的教程，安装很简单，我是使用的 yarn 的（还真是比 npm 快）。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22yarn add koa\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eyarn add koa\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e默认就装了 Koa 2.2。然后装完了，其实我是一脸懵逼的，文档上说这样用。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const Koa = require(\x27koa\x27)\nconst app = new Koa()\n \n\/\/ response \napp.use(ctx =\x3e {\n  ctx.body = \x27Hello Koa\x27\n})\n \napp.listen(3000)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e Koa = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27koa\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e app = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Koa()\n \n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ response \x3c\/span\x3e\napp.use(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ectx\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  ctx.body = \x3cspan class=\x22hljs-string\x22\x3e\x27Hello Koa\x27\x3c\/span\x3e\n})\n \napp.listen(\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我照着代码写了下来，的确成功了。可是，难不成我要把所有的逻辑写在 \x3ccode\x3eapp.use\x3c\/code\x3e 里？\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009733613?w=521\x26amp;h=534\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009733613?w=521\x26amp;h=534\x22 alt=\x22a\x22 title=\x22a\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e中间件\x3c\/h3\x3e\n\x3cp\x3e我感觉我受到了惊吓，吓得我赶紧往下看文档。原来 Koa2 是一个中间件模型。\x3ccode\x3eapp.use\x3c\/code\x3e 可以有很多，每一个 \x3ccode\x3eapp.use\x3c\/code\x3e 会注册一个中间件，这个中间件是具体做事情的。每个中间件是依次执行的。一个经典的洋葱图可以解释这一切。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009733614?w=478\x26amp;h=435\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009733614?w=478\x26amp;h=435\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e那么，上面的实例就可以改造成这样。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22app.use(async (ctx, next) =\x3e {\n  await next()\n  ctx.body = \x27Hello Koa\x27\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eapp.use(\x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e (ctx, next) =\x26gt; {\n  \x3cspan class=\x22hljs-keyword\x22\x3eawait\x3c\/span\x3e next()\n  ctx.body = \x3cspan class=\x22hljs-string\x22\x3e\x27Hello Koa\x27\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e按照上面的洋葱头，以心为单位，next的两侧的语句分别在洋葱的左侧和右侧进行执行，颇像 \x3ccode\x3eLaravel\x3c\/code\x3e 的中间件。\x3c\/p\x3e\n\x3cp\x3e就这样，我知道了，所有的操作不必写在同一个 \x3ccode\x3eapp.use\x3c\/code\x3e 里。可是，下一个问题来了，我要把所有的逻辑都写再一个文件里？说好的 MVC 呢？没有 MVC 也叫做框架？Are you kidding me?（好吧后来发现原来 Koa2 并不是一个装置做网站的框架）\x3c\/p\x3e\n\x3cp\x3e既然没有 MVC，那就自己动手丰衣足食吧。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e路由\x3c\/h3\x3e\n\x3cp\x3e首先要处理的就是路由的问题。不过，由于是第一次用这货写项目，时间紧，（伪）任务重，看了文档后发现，原来还有一个中间件列表的链接，里面有各种开源的中间件。我想你们一定隔着屏幕都能听到我发出杠铃般的笑声了。有一个中间件非常棒，叫做 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/koa-router\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ekoa-router\x3c\/a\x3e。这货是这么用的。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var Koa = require(\x27koa\x27)\nvar Router = require(\x27koa-router\x27)\n \nvar app = new Koa()\nvar router = new Router()\n \nrouter.get(\x27\/\x27, function (ctx, next) {\n  \/\/ ctx.router available\n});\n \napp.use(router.routes())\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e Koa = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27koa\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e Router = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27koa-router\x27\x3c\/span\x3e)\n \n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Koa()\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e router = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Router()\n \nrouter.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ectx, next\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ctx.router available\x3c\/span\x3e\n});\n \napp.use(router.routes())\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e虽然是把逻辑和 \x3ccode\x3eapp.use\x3c\/code\x3e 分开了，但是，好像还是没有解决刚才的问题。说好的 MVC 也没有出现。于是我再去找了找，居然没有 \x3ccode\x3eController\x3c\/code\x3e 的中间件。我一下就懵逼了，玩脱了？还有一天啊我的宝贝儿。经过我半秒钟的慎重思考，我还是用 \x3ccode\x3ekoa-router\x3c\/code\x3e 自己实现一个控制器吧。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3eController\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const fs = require(\x27fs\x27)\n\nfunction addRoutes(router, routes) {\n  for (let route in routes) {\n    switch (route.method) {\n      case: \x27post\x27:\n        router.post(route.uri, route.fn)\n        console.log(`Register post url: ${route.uri}`)\n        break\n      case: \x27get\x27:\n        router.get(route.uri, route.fn)\n        console.log(`Register get url: ${route.uri}`)\n        break\n      default: \n        console.log(`Invalid url: ${route}`)\n    }\n  }\n}\n\nfunction addControllers(router) {\n  let files = fs.readdirSync(__dirname \x2b \x27\/controllers\x27)\n\n  let controllerFiles = files.filter(f =\x3e {\n    return f.endsWith(\x27.js\x27)\n  })\n\n  for (let controllerFile in controllerFiles) {\n    console.log(`process controller: ${controllerFile}...`)\n    let routes = require(__dirname \x2b \x27\/controllers\x27)\n    addRoutes(router, routes)\n  }\n}\n\nmodule.exports = () =\x3e {\n  let router = require(\x27koa-router\x27)()\n  addControllers(router)\n  return router.routes()\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e fs = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27fs\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eaddRoutes\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erouter, routes\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e route \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e routes) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e (route.method) {\n      \x3cspan class=\x22hljs-attr\x22\x3ecase\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27post\x27\x3c\/span\x3e:\n        router.post(route.uri, route.fn)\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e`Register post url: \x3cspan class=\x22hljs-subst\x22\x3e${route.uri}\x3c\/span\x3e`\x3c\/span\x3e)\n        \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27get\x27\x3c\/span\x3e:\n        router.get(route.uri, route.fn)\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e`Register get url: \x3cspan class=\x22hljs-subst\x22\x3e${route.uri}\x3c\/span\x3e`\x3c\/span\x3e)\n        \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e: \n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e`Invalid url: \x3cspan class=\x22hljs-subst\x22\x3e${route}\x3c\/span\x3e`\x3c\/span\x3e)\n    }\n  }\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eaddControllers\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erouter\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e files = fs.readdirSync(__dirname \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\/controllers\x27\x3c\/span\x3e)\n\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e controllerFiles = files.filter(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ef\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e f.endsWith(\x3cspan class=\x22hljs-string\x22\x3e\x27.js\x27\x3c\/span\x3e)\n  })\n\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e controllerFile \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e controllerFiles) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e`process controller: \x3cspan class=\x22hljs-subst\x22\x3e${controllerFile}\x3c\/span\x3e...`\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e routes = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(__dirname \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\/controllers\x27\x3c\/span\x3e)\n    addRoutes(router, routes)\n  }\n}\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e router = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27koa-router\x27\x3c\/span\x3e)()\n  addControllers(router)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e router.routes()\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我通过在 \x3ccode\x3econtrollers\x3c\/code\x3e 文件夹中，创建若干 \x3ccode\x3ejs\x3c\/code\x3e 文件来作为 \x3ccode\x3eController\x3c\/code\x3e 来使用。这里稍微参考了下 \x3ca href=\x22http:\/\/www.liaoxuefeng.com\/wiki\/001434446689867b27157e896e74d51a89c25cc8b43bdb3000\/001471133885340dad9058705804899b1cc2d0a10e7dc80000\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e廖雪峰的文章\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e然后，我们只需要在 \x3ccode\x3econtrollers\x3c\/code\x3e 文件夹中添加合适的文件就可以了。例如我们添加一个文件叫做 \x3ccode\x3echart.js\x3c\/code\x3e ，然后这样写代码。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let hello = async (ctx, next) =\x3e {\n  ctx.body = \x27Hello the fucking world!\x27\n}\n\nmodule.exports = [\n  {\n    method: \x27get\x27,\n    uri: \x27hello\x27,\n    fn: hello,\n  }\n]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e hello = \x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e (ctx, next) =\x26gt; {\n  ctx.body = \x3cspan class=\x22hljs-string\x22\x3e\x27Hello the fucking world!\x27\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = [\n  {\n    \x3cspan class=\x22hljs-attr\x22\x3emethod\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27get\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3euri\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27hello\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3efn\x3c\/span\x3e: hello,\n  }\n]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后再在 \x3ccode\x3eapp.js\x3c\/code\x3e 注册中间件即可。\x3c\/p\x3e\n\x3cp\x3e除此之外，我们还需要能够处理 \x3ccode\x3ectx\x3c\/code\x3e 里的内容，因为它里面存储的是原始的内容。还是由于时间紧，任（填）务（坑）重（急），我用了 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/koa-bodyparser\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ekoa-bodyparser\x3c\/a\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const bodyParser = require(\x27koa-bodyparser\x27)\n\napp.use(bodyParser())\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e bodyParser = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27koa-bodyparser\x27\x3c\/span\x3e)\n\napp.use(bodyParser())\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里要提醒的是，这货一定要放在处理路由中间件的前面。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3eModel\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3eMVC\x3c\/code\x3e 的 \x3ccode\x3eC\x3c\/code\x3e 已经解决了，接下来就要解决 \x3ccode\x3eM\x3c\/code\x3e 的问题了。这里我用的是 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/sequelize\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSequelize\x3c\/a\x3e。这个 \x3ccode\x3eORM\x3c\/code\x3e 和大多数的 \x3ccode\x3eORM\x3c\/code\x3e 都差不多，所以在这里这次没有踩到什么坑。我在根目录下新建了一个 \x3ccode\x3econfig.js\x3c\/code\x3e 的配置文件，然后新建了 \x3ccode\x3emodel.js\x3c\/code\x3e 用来定义模型。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const Sequelize = require(\x27sequelize\x27)\nconst config = require(\x27.\/config\x27).databases\n\n...\n\nmodule.exports = {\n  \/\/models\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e Sequelize = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27sequelize\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e config = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/config\x27\x3c\/span\x3e).databases\n\n...\n\nmodule.exports = {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/models\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3eView\x3c\/h3\x3e\n\x3cp\x3e视图，我是使用了一个中间件叫做 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/koa-views\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ekoa-view\x3c\/a\x3e。由于它使用的是 \x3ca href=\x22https:\/\/mozilla.github.io\/nunjucks\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eNunjucks\x3c\/a\x3e 模板引擎，对于写 \x3ccode\x3ePHP\x3c\/code\x3e 的我相对熟悉一点。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const view = require(\x27koa-view\x27)\n\nconst app = Koa()\n\napp.use(view(__dirname \x2b \x27\/views\x27))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e view = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27koa-view\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e app = Koa()\n\napp.use(view(__dirname \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\/views\x27\x3c\/span\x3e))\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/controller\n\nlet Hello = (ctx, next) =\x3e {\n  ctx.render(\x27hello\x27, datas)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/controller\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e Hello = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3ectx, next\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  ctx.render(\x3cspan class=\x22hljs-string\x22\x3e\x27hello\x27\x3c\/span\x3e, datas)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e只要在 \x27views\x27 文件夹中定义相对应的 html 文件即可。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e后记\x3c\/h2\x3e\n\x3cp\x3e这次的尝试，终于在我的修修补补中，搞出了一个简陋的 \x3ccode\x3eMVC\x3c\/code\x3e 模型。赶在了 deadline 前完成，真是一波三折啊。学习新技术，就是这样，要实践嘛= =下面给出我的项目目录作参考\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22koa2\/\n|\n\x2b- controllers\/\n|  |\n|  \x2b- chart.js\n|  ...\n|\n\x2b- static\/\n|  |\n|  \x2b- js\/\n|     ...\n|  |\n|  \x2b- style\/\n|     |\n|     \x2b- img\n|     ...\n|\n\x2b- views\/\n|  |\n|  \x2b- game.html\n|  ...\n|\n\x2b- app.js\n|\n\x2b- config.js\n|\n\x2b- controller.js\n|\n\x2b- model.js\n|\n\x2b- package.json\n|\n\x2b- yarn.lock\n|\n\x2b- node_modules\/\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gherkin\x22\x3e\x3ccode\x3ekoa2\/\n|\x3cspan class=\x22hljs-string\x22\x3e\n\x2b- controllers\/\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e  \x3c\/span\x3e|\n|\x3cspan class=\x22hljs-string\x22\x3e  \x2b- chart.js\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e  ...\n\x3c\/span\x3e|\n\x2b- static\/\n|\x3cspan class=\x22hljs-string\x22\x3e  \x3c\/span\x3e|\n|\x3cspan class=\x22hljs-string\x22\x3e  \x2b- js\/\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e     ...\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e  \x3c\/span\x3e|\n|\x3cspan class=\x22hljs-string\x22\x3e  \x2b- style\/\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e     \x3c\/span\x3e|\n|\x3cspan class=\x22hljs-string\x22\x3e     \x2b- img\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e     ...\n\x3c\/span\x3e|\n\x2b- views\/\n|\x3cspan class=\x22hljs-string\x22\x3e  \x3c\/span\x3e|\n|\x3cspan class=\x22hljs-string\x22\x3e  \x2b- game.html\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e  ...\n\x3c\/span\x3e|\n\x2b- app.js\n|\x3cspan class=\x22hljs-string\x22\x3e\n\x2b- config.js\n\x3c\/span\x3e|\n\x2b- controller.js\n|\x3cspan class=\x22hljs-string\x22\x3e\n\x2b- model.js\n\x3c\/span\x3e|\n\x2b- package.json\n|\x3cspan class=\x22hljs-string\x22\x3e\n\x2b- yarn.lock\n\x3c\/span\x3e|\n\x2b- node_modules\/\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e菜鸟作品，如有错误请指正，不胜感激。\x3c\/p\x3e\n\x3cp\x3e如果你喜欢我的文章，那就请我喝杯奶茶吧~\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009733699?w=266\x26amp;h=377\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009733699?w=266\x26amp;h=377\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>一个 PHPer 第一次用 Koa2 写 Node.js 的心路历程</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009733610">https://segmentfault.com/a/1190000009733610</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/qouq2lehwb/" target="_blank">https://alili.tech/archive/qouq2lehwb/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>