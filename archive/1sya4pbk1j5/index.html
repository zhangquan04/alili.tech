<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Node.js 安全清单"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Node.js 安全清单 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/1sya4pbk1j5/",
				"appid": "1613049289050283", 
				"title": "Node.js 安全清单 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-25T02:30:23"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/sl14l3jcdi/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/378mgqslkvt/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f1sya4pbk1j5%2f&text=Node.js%20%e5%ae%89%e5%85%a8%e6%b8%85%e5%8d%95"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f1sya4pbk1j5%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f1sya4pbk1j5%2f&text=Node.js%20%e5%ae%89%e5%85%a8%e6%b8%85%e5%8d%95"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f1sya4pbk1j5%2f&title=Node.js%20%e5%ae%89%e5%85%a8%e6%b8%85%e5%8d%95"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f1sya4pbk1j5%2f&is_video=false&description=Node.js%20%e5%ae%89%e5%85%a8%e6%b8%85%e5%8d%95"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Node.js%20%e5%ae%89%e5%85%a8%e6%b8%85%e5%8d%95&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f1sya4pbk1j5%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f1sya4pbk1j5%2f&title=Node.js%20%e5%ae%89%e5%85%a8%e6%b8%85%e5%8d%95"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1sya4pbk1j5%2f&title=Node.js%20%e5%ae%89%e5%85%a8%e6%b8%85%e5%8d%95"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1sya4pbk1j5%2f&title=Node.js%20%e5%ae%89%e5%85%a8%e6%b8%85%e5%8d%95"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1sya4pbk1j5%2f&title=Node.js%20%e5%ae%89%e5%85%a8%e6%b8%85%e5%8d%95"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Node.js 安全清单</h1><div class="meta"><div class="postdate"><time datetime="2019-01-25" itemprop="datePublished">2019-01-25</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3cp\x3eby \x3ca href=\x22https:\/\/blog.risingstack.com\/author\/gergely\x22\x3e\x3cstrong\x3eGergely Nemeth\x3c\/strong\x3e\x3c\/a\x3e(\x3ca href=\x22https:\/\/twitter.com\/@nthgergo\x22\x3e@nthgergo\x3c\/a\x3e)，RisingStack联合创始人。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e安全是不容忽视的，\x3c\/strong\x3e每个开发者都知道它非常重要，真正严肃对待它的却没有几人。我们 \x3ca href=\x22https:\/\/risingstack.com\/#\x22\x3eRisingStack\x3c\/a\x3e 希望你能认真对待这一问题——这就是我们整理这份清单来帮助你的原因，你的应用在被成千上万用户使用前必须要做安全检查。\x3c\/p\x3e\n\x3cp\x3e这份清单大部分内容是通用的，不仅适用于Node.js，同样适用于其他语言和框架，只是一些明确给出了在Node.js中使用的方法。同时推荐你去阅读我们的引导文章 \x3ca href=\x22https:\/\/blog.risingstack.com\/node-js-security-tips\x22\x3eNode.js security\x3c\/a\x3e，如果你刚开始使用Node.js，推荐你看这篇文章 \x3ca href=\x22https:\/\/blog.risingstack.com\/node-hero-tutorial-getting-started-with-node-js\/\x22\x3efirst chapter of Node Hero\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch2\x3e配置管理\x3c\/h2\x3e\n\x3ch3\x3eHTTP 安全头部\x3c\/h3\x3e\n\x3cp\x3e有些关于安全的HTTP头部是你的网站必须要有的：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eStrict-Transport-Security\x3c\/strong\x3e 强制将HTTP请求替换为HTTPS请求\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eX-Frame-Options\x3c\/strong\x3e 防止\x3ca href=\x22https:\/\/www.owasp.org\/index.php\/Clickjacking\x22\x3e点击劫持\x3c\/a\x3e\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eX-XSS-Protection\x3c\/strong\x3e 开启跨站脚本攻击（XSS）的过滤，大多数现代浏览器支持这个设置\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eX-Content-Type-Options\x3c\/strong\x3e 禁用浏览器对响应内容MIME类型的嗅探，严格使用响应的Content-Type的值\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eContent-Security-Policy\x3c\/strong\x3e 能有效防止多种攻击，包括跨站脚本和跨站注入\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3eNode.js开发者可以使用\x3ca href=\x22https:\/\/www.npmjs.com\/package\/helmet\x22\x3eHelmet\x3c\/a\x3e模块置这些头部，代码如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs php\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27express\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e helmet = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27helmet\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\n\napp.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(helmet());\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/koajs.com\x22\x3eKoa\x3c\/a\x3e和\x3ca href=\x22https:\/\/thinkjs.org\/\x22\x3eThinkJS\x3c\/a\x3e框架中可以使用\x3ca href=\x22https:\/\/www.npmjs.com\/package\/koa-helmet\x22\x3ekoa-helmet\x3c\/a\x3e来设置这些头部，当然有关安全的头部不止这些，更多请看\x3ca href=\x22\x22\x3eHelmet\x3c\/a\x3e和\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\x22\x3eMDN HTTP Headers\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e在大多数架构里这些头部可以设置在web服务器的配置中（Apache、Nginx），不需要对应用代码进行改动。在Nginx中的配置：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs mipsasm\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e# nginx.conf\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eadd_header \x3c\/span\x3eX-Frame-Options SAMEORIGIN\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eadd_header \x3c\/span\x3eX-Content-Type-Options nosniff\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eadd_header \x3c\/span\x3eX-XSS-Protection \x3cspan class=\x22hljs-string\x22\x3e\x221; mode=block\x22\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eadd_header \x3c\/span\x3eContent-Security-Policy \x3cspan class=\x22hljs-string\x22\x3e\x22default-src \x27self\x27\x22\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e有一个完整的Nginx配置文件，\x3ca href=\x22https:\/\/gist.github.com\/plentz\/6737338\x22\x3e帅气的传送门\x3c\/a\x3e在此。\x3c\/p\x3e\n\x3cp\x3e如果你想快速检查你的网站是否有了所有的必须头部，请使用这个\x3ca href=\x22http:\/\/cyh.herokuapp.com\/cyh\x22\x3e在线检查器\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch3\x3e客户端的敏感数据\x3c\/h3\x3e\n\x3cp\x3e当发布前端应用时，确保你的代码里永远不会包含API密码和证书，因为它可以被任何人看到。\x3c\/p\x3e\n\x3cp\x3e没有自动化的方法去检查你在代码里写了敏感数据，但是有两个可以降低向客户端暴露敏感数据风险的方法：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e使用 pull requests 提交代码\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e定期 code review\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2\x3e认证\x3c\/h2\x3e\n\x3ch3\x3e暴力攻击保护\x3c\/h3\x3e\n\x3cp\x3e穷举法是系统地枚举所有可能的候选者的一种解决方案，并检查每个候选是否满足陈述的问题。在Web应用程序中，登录端点可能是这方面的最佳候选者。\x3c\/p\x3e\n\x3cp\x3e为了保护你的应用面免受这些攻击，你必须实现某种限速策略。在Node.js中你可以使用 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/ratelimiter\x22\x3eratelimiter\x3c\/a\x3e  模块。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs qml\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e email = req.body.email;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e limit = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Limiter({ \x3cspan class=\x22hljs-attribute\x22\x3eid:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e email\x3c\/span\x3e, \x3cspan class=\x22hljs-attribute\x22\x3edb\x3c\/span\x3e: db });\n\nlimit.get(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr, limit\x3c\/span\x3e) \x3c\/span\x3e{\n\n});\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e你可以将它封装成一个中间件，然后在不同应用中使用它。Express和Koa都有这样的中间件，代码如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ratelimit = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27koa-ratelimit\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e redis = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27redis\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e koa = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27koa\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = koa();\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e emailBasedRatelimit = ratelimit({\n  \x3cspan class=\x22hljs-attr\x22\x3edb\x3c\/span\x3e: redis.createClient(),\n  \x3cspan class=\x22hljs-attr\x22\x3eduration\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e60000\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3emax\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3econtext\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e context.body.email;\n  }\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ipBasedRatelimit = ratelimit({\n  \x3cspan class=\x22hljs-attr\x22\x3edb\x3c\/span\x3e: redis.createClient(),\n  \x3cspan class=\x22hljs-attr\x22\x3eduration\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e60000\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3emax\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3econtext\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e context.ip;\n  }\n});\n\napp.post(\x3cspan class=\x22hljs-string\x22\x3e\x27\/login\x27\x3c\/span\x3e, ipBasedRatelimit, emailBasedRatelimit, handleLogin);\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在这段代码中限制了一个用户在给定时间窗口内可以尝试登录的次数，通过这样的方式我们可以降低暴力攻击的风险。\x3cstrong\x3e注意：这些配置需要根据应用进行调整，千万不要复制粘贴。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e想要测试你的服务在这种情况下的表现，你可以使用这个工具 \x3ca href=\x22https:\/\/github.com\/vanhauser-thc\/thc-hydra\x22\x3ehydra\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch2\x3eSession 管理\x3c\/h2\x3e\n\x3cp\x3e\x3cstrong\x3e安全使用cookie的重要性千万不能忘：尤其是动态web应用，需要在无状态的HTTP协议中通过cookie维护状态。\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch3\x3eCookie 标志位\x3c\/h3\x3e\n\x3cp\x3e下面这些属性可以设置在任何cookie上：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3esecure\x3c\/strong\x3e - 这个属性告诉浏览器只有在使用HTTPS通信的时候才发送cookie。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eHttpOnly\x3c\/strong\x3e - 这个属性用来防止例如跨站脚本等攻击，设置它的cookie不允许通过JavaScript来访问。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3eCookie 作用域\x3c\/h4\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3edomain\x3c\/strong\x3e - 这个属性用来和请求的URL指向服务端的域名进行比较，如果域名或者子域名匹配，接下来检查path属性。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3epath\x3c\/strong\x3e - 除了域名之外，还可以指定cookie有效的URL路径。如果域名和路径匹配，发送请求时将会携带此cookie。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eexpires\x3c\/strong\x3e - 这个属性用来设置持久cookie，在这个时间之前cookie不会过期。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e在Node.js中你可以使用\x3ca href=\x22https:\/\/www.npmjs.com\/package\/cookies\x22\x3ecookies\x3c\/a\x3e模块来设置cookie，这个模块比较基础，你有可能会使用封装过的模块，例如\x3ca href=\x22https:\/\/www.npmjs.com\/package\/cookie-session\x22\x3ecookie-session\x3c\/a\x3e。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs php\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cookieSession = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27cookie-session\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27express\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\n\napp.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(cookieSession({\n  name: \x3cspan class=\x22hljs-string\x22\x3e\x27session\x27\x3c\/span\x3e,\n  keys: [\n    process.env.COOKIE_KEY1,\n    process.env.COOKIE_KEY2\n  ]\n}));\n\napp.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(req, res, next)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e n = req.session.views || \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n  req.session.views = n\x2b\x2b;\n  res.end(n \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27 views\x27\x3c\/span\x3e);\n});\n\napp.listen(\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e);\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e示例来源于\x3ca href=\x22https:\/\/www.npmjs.com\/package\/cookie-session\x22\x3ecookie-session\x3c\/a\x3e 模块的文档。\x3c\/p\x3e\n\x3ch3\x3eCSRF\x3c\/h3\x3e\n\x3cp\x3e跨站请求伪造是一种强制用户在已经登录的网站上执行非自愿操作的攻击。这些攻击特别针对状态变更请求，而不是窃取数据，因为攻击者无法看到对伪造请求的响应。\x3c\/p\x3e\n\x3cp\x3e在Node.js中你可以使用 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/csrf\x22\x3ecsrf\x3c\/a\x3e 模块来减轻这类攻击，这个模块比较基础，有一些针对不同框架进行包装的模块，其中一个是\x3ca href=\x22https:\/\/www.npmjs.com\/package\/csurf\x22\x3ecsurf\x3c\/a\x3e，express框架中用来防止CSRF攻击的中间件。\x3c\/p\x3e\n\x3cp\x3e在路由层可以这样编码：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs php\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cookieParser = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27cookie-parser\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e csrf = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27csurf\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e bodyParser = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27body-parser\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27express\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ setup route middlewares \x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e csrfProtection = csrf({ cookie: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e });\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e parseForm = bodyParser.urlencoded({ extended: \x3cspan class=\x22hljs-keyword\x22\x3efalse\x3c\/span\x3e });\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ create express app \x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ we need this because \x22cookie\x22 is true in csrfProtection \x3c\/span\x3e\napp.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(cookieParser());\n\napp.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/form\x27\x3c\/span\x3e, csrfProtection, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(req, res)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ pass the csrfToken to the view \x3c\/span\x3e\n  res.render(\x3cspan class=\x22hljs-string\x22\x3e\x27send\x27\x3c\/span\x3e, { csrfToken: req.csrfToken() });\n});\n\napp.post(\x3cspan class=\x22hljs-string\x22\x3e\x27\/process\x27\x3c\/span\x3e, parseForm, csrfProtection, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(req, res)\x3c\/span\x3e \x3c\/span\x3e{\n  res.send(\x3cspan class=\x22hljs-string\x22\x3e\x27data is being processed\x27\x3c\/span\x3e);\n});\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在视图层可以这样使用CSRF的token：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs accesslog\x22\x3e\x26lt;form action=\x3cspan class=\x22hljs-string\x22\x3e\x22\/process\x22\x3c\/span\x3e method=\x3cspan class=\x22hljs-string\x22\x3e\x22\x3cspan class=\x22hljs-keyword\x22\x3ePOST\x3c\/span\x3e\x22\x3c\/span\x3e\x26gt;\n  \x26lt;input type=\x3cspan class=\x22hljs-string\x22\x3e\x22hidden\x22\x3c\/span\x3e name=\x3cspan class=\x22hljs-string\x22\x3e\x22_csrf\x22\x3c\/span\x3e value=\x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22csrfToken\x22}}\x22\x22\x3c\/span\x3e\x26gt;\n\n  Favorite color: \x26lt;input type=\x3cspan class=\x22hljs-string\x22\x3e\x22text\x22\x3c\/span\x3e name=\x3cspan class=\x22hljs-string\x22\x3e\x22favoriteColor\x22\x3c\/span\x3e\x26gt;\n  \x26lt;button type=\x3cspan class=\x22hljs-string\x22\x3e\x22submit\x22\x3c\/span\x3e\x26gt;Submit\x26lt;\/button\x26gt;\n\x26lt;\/form\x26gt;\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e示例来源于 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/csurf\x22\x3ecsurf\x3c\/a\x3e 模块的文档。\x3c\/p\x3e\n\x3ch2\x3e数据验证\x3c\/h2\x3e\n\x3ch3\x3eXSS\x3c\/h3\x3e\n\x3cp\x3e有两种相似但是不同类型的攻击需要防御，一种是反射型XSS，另一种是存储型XSS。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e反射性XSS\x3c\/strong\x3e 当攻击者用特制的链接将可执行JavaScript代码注入到HTML响应中时发生。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e存储型XSS\x3c\/strong\x3e 当存储了未经严格过滤的用户输入时发生，它会在在Web应用程序的权限下在用户的浏览器中运行。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e为了抵御这些攻击，你需要严格过滤用户输入。\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch3\x3eSQL 注入\x3c\/h3\x3e\n\x3cp\x3eSQL注入通过用户输入注入部分或完整的SQL查询，它能读取敏感信息或者具有破坏性。\x3c\/p\x3e\n\x3cp\x3e下面是一些例子：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs sql\x22\x3e`\x3cspan class=\x22hljs-keyword\x22\x3eselect\x3c\/span\x3e title, author \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e books \x3cspan class=\x22hljs-keyword\x22\x3ewhere\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eid\x3c\/span\x3e=$\x3cspan class=\x22hljs-keyword\x22\x3eid\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e`\n\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果\x3ccode\x3e$id\x3c\/code\x3e来源于用户的输入，如果用户输入了\x3ccode\x3e2 or 1=1\x3c\/code\x3e会怎么样？查询语句会变成这样：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3e`select title, author \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e books where \x3cspan class=\x22hljs-attribute\x22\x3eid\x3c\/span\x3e=2 \x3cspan class=\x22hljs-keyword\x22\x3eor\x3c\/span\x3e \x3cspan class=\x22hljs-attribute\x22\x3e1\x3c\/span\x3e=1`\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e抵御这类攻击的最简单方式就是使用参数化查询或者提前写好SQL语句。\x3c\/p\x3e\n\x3cp\x3e如果你在Node.js中使用PostgerSQL，你可以使用 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/pg\x22\x3enode-postgres\x3c\/a\x3e 模块。创建一个参数化查询只需要这样写代码：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs oxygene\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e q = \x3cspan class=\x22hljs-string\x22\x3e\x27SELECT name FROM books WHERE id = $1\x27\x3c\/span\x3e;\nclient.query(q, [\x3cspan class=\x22hljs-string\x22\x3e\x273\x27\x3c\/span\x3e], \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(err, \x3cspan class=\x22hljs-keyword\x22\x3eresult\x3c\/span\x3e)\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e{}\x3c\/span\x3e);\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/sqlmap.org\/\x22\x3esqlmap\x3c\/a\x3e 是一个开源的渗透测试工具，自动化\x3cstrong\x3e检测利用SQL注入漏洞并接管数据库\x3c\/strong\x3e的过程。\x3c\/p\x3e\n\x3ch3\x3e命令行注入\x3c\/h3\x3e\n\x3cp\x3e命令注入是攻击者在远程Web服务器上运行OS命令所使用的技术。通过这种方法，攻击者甚至可以从系统获得到密码。\x3c\/p\x3e\n\x3cp\x3e在实践中，如果你有这样的链接：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs vim\x22\x3e`http\x3cspan class=\x22hljs-variable\x22\x3es:\x3c\/span\x3e\/\/example.\x3cspan class=\x22hljs-keyword\x22\x3ecom\x3c\/span\x3e\/downloads?\x3cspan class=\x22hljs-keyword\x22\x3efile\x3c\/span\x3e=user1.txt`\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e它可以变成：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs vim\x22\x3e`http\x3cspan class=\x22hljs-variable\x22\x3es:\x3c\/span\x3e\/\/example.\x3cspan class=\x22hljs-keyword\x22\x3ecom\x3c\/span\x3e\/downloads?\x3cspan class=\x22hljs-keyword\x22\x3efile\x3c\/span\x3e=%\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3eBcat%\x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e\/etc\/passwd`\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e在示例中\x3ccode\x3e%3B\x3c\/code\x3e是标点符号点的转码，通过这种方式可以运行多个操作系统命令。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e为了抵御这类攻击，你必须确保严格过滤用户的输入。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e仍然用Node.js来做例子：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs scilab\x22\x3echild_process.\x3cspan class=\x22hljs-built_in\x22\x3eexec\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27ls\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(err, data)\x3c\/span\x3e {  \x3c\/span\x3e\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(data);\n});\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在底层\x3ccode\x3echild_process.exec\x3c\/code\x3e调用\x3ccode\x3e\/bin\/sh\x3c\/code\x3e，所以它是一个bash解释器并不是程序启动。\x3c\/p\x3e\n\x3cp\x3e当用户的输入传到这个地方，就会产生问题，任意一个反撇号或者\x3ccode\x3e$()\x3c\/code\x3e，就会有一个新的命令被攻击者注入。反引号的作用就是将反引号内的Linux命令先执行，然后将执行结果赋予变量。\x3c\/p\x3e\n\x3cp\x3e可以简单使用\x3ccode\x3echild_process.execFile\x3c\/code\x3e解决这个问题。\x3c\/p\x3e\n\x3ch2\x3e安全传输\x3c\/h2\x3e\n\x3ch3\x3eSSL Version, Algorithms, Key length\x3c\/h3\x3e\n\x3cp\x3eHTTP是一个明文协议，它必须通过SSL \/ TLS隧道进行安全保护，我们熟知的HTTPS就是这样。现在高等级的密码被广泛使用，如果在服务器配置错误，会使用一个弱密码来替代，或没有加密。\x3c\/p\x3e\n\x3cp\x3e你需要去测试：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e密码、钥匙和协议协商配置正确\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e证书有效性\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e使用 \x3ca href=\x22https:\/\/nmap.org\/\x22\x3enmap\x3c\/a\x3e和\x3ca href=\x22https:\/\/github.com\/iSECPartners\/sslyze\x22\x3esslyze\x3c\/a\x3e 工具可以将这件事变得简单。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e检查证书信息\x3c\/strong\x3e\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3e`nmap --script ssl-cert,ssl-enum-ciphers -\x3cspan class=\x22hljs-selector-tag\x22\x3ep\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e443\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e465\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e993\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e995\x3c\/span\x3e www\x3cspan class=\x22hljs-selector-class\x22\x3e.example\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.com\x3c\/span\x3e`\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3cstrong\x3e使用sslyze测试SSL\/TLS漏洞\x3c\/strong\x3e\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3e`.\/sslyze\x3cspan class=\x22hljs-selector-class\x22\x3e.py\x3c\/span\x3e --regular example\x3cspan class=\x22hljs-selector-class\x22\x3e.com\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e443\x3c\/span\x3e`\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3eHSTS\x3c\/h3\x3e\n\x3cp\x3e在配置管理部分，我们简要的谈到了它 。 \x3cstrong\x3eStrict-Transport-Security\x3c\/strong\x3e 头部强制浏览器和服务器使用安全连接（HTTP over SSL\/TLS），下面的配置来自Twitter：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs autohotkey\x22\x3e`strict-transport-security:max-age=\x3cspan class=\x22hljs-number\x22\x3e631138519\x3c\/span\x3e`\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这里的\x3ccode\x3emax-age\x3c\/code\x3e，指定了浏览器应该自动将HTTP请求转换为HTTPS的有效时间。\x3c\/p\x3e\n\x3cp\x3e可以通过下面的命令简单的测试：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs vim\x22\x3e`curl -s -D- http\x3cspan class=\x22hljs-variable\x22\x3es:\x3c\/span\x3e\/\/twitter.\x3cspan class=\x22hljs-keyword\x22\x3ecom\x3c\/span\x3e\/ | \x3cspan class=\x22hljs-keyword\x22\x3egrep\x3c\/span\x3e -i Strict`\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch2\x3e拒绝服务\x3c\/h2\x3e\n\x3ch3\x3e账号锁定\x3c\/h3\x3e\n\x3cp\x3e帐户锁定是一种减轻暴力猜测攻击的技术，在尝试登录失败几次之后，在给定时间内系统禁止其登录，最初只限制几分钟，以后成倍的增加限制时间。\x3c\/p\x3e\n\x3cp\x3e你可以使用上面我们讨论过的限速模式来抵御这种攻击。\x3c\/p\x3e\n\x3ch3\x3e正则表达式\x3c\/h3\x3e\n\x3cp\x3e这种攻击利用了大多数正则表达式实现的极端情况，导致它们工作非常缓慢。这种正则表达式被称为\x3ccode\x3eEvil Regexpes\x3c\/code\x3e：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e使用重复分组\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e重复组中出现：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e重复\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e交替重叠\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3ccode\x3e([a-zA-Z]\x2b)*\x3c\/code\x3e、\x3ccode\x3e(a\x2b)\x2b\x3c\/code\x3e 或者 \x3ccode\x3e(a|a?)\x2b\x3c\/code\x3e 都是有漏洞的正则表达式，像\x3ccode\x3eaaaaaaaaaaaaaaaaaaaaaaaa!\x3c\/code\x3e这样简单的输入就可以产生很大的计算量。更多信息请看\x3ca href=\x22https:\/\/www.owasp.org\/index.php\/Regular_expression_Denial_of_Service_-_ReDoS\x22\x3e正则表达式DOS\x3c\/a\x3e.\x3c\/p\x3e\n\x3cp\x3e你可以使用工具 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/safe-regex\x22\x3esafe-regex\x3c\/a\x3e检查你的正则表达式，它可能会误报，所以小心使用。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs crmsh\x22\x3e$ \x3cspan class=\x22hljs-keyword\x22\x3enode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esafe\x3c\/span\x3e.js \x27(beep|boop)*\x27\n\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n$ \x3cspan class=\x22hljs-keyword\x22\x3enode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esafe\x3c\/span\x3e.js \x27(a\x2b){\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e}\x27\n\x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2\x3e异常处理\x3c\/h2\x3e\n\x3ch3\x3e异常代码、错误跟踪栈\x3c\/h3\x3e\n\x3cp\x3e在不同的错误场景中，应用程序可能泄漏有关底层基础设施的敏感细节， 比如：\x3ccode\x3eX-Powered-By:Express\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e错误跟踪栈本身不是错误，但是它经常泄露让攻击者感兴趣的信息。提供debug信息作为操作产生错误的结果是一种糟糕的做法，你应该打印而不是向用户输出这些信息。\x3c\/p\x3e\n\x3ch2\x3eNPM\x3c\/h2\x3e\n\x3cp\x3e能力越大责任越大，NPM有大量可以方便使用的模块，相应的你需要检查你的应用用到了哪些，它们可能包含了至关重要的安全问题。\x3c\/p\x3e\n\x3ch3\x3eNode 安全项目\x3c\/h3\x3e\n\x3cp\x3e幸运的是Node安全项目有一个非常棒的工具，你可以检查你使用的模块的已知漏洞。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs coffeescript\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3enpm\x3c\/span\x3e i nsp -g\n\x3cspan class=\x22hljs-comment\x22\x3e# either audit the shrinkwrap\x3c\/span\x3e\nnsp audit-shrinkwrap\n\x3cspan class=\x22hljs-comment\x22\x3e# or the package.json\x3c\/span\x3e\nnsp audit-package\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e你还可以使用 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/requiresafe\x22\x3erequireSafe\x3c\/a\x3e 来帮你做这件事。\x3c\/p\x3e\n\x3ch3\x3eSnyk\x3c\/h3\x3e\n\x3cp\x3eSnyk和Node安全项目相似，但是它的目标不仅是提供工具发现漏洞，还能在你的项目仓库中解决相关安全问题。\x3c\/p\x3e\n\x3cp\x3e可以尝试一下\x3ca href=\x22https:\/\/snyk.io\x22\x3esnyk.io\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch2\x3eFinal\x3c\/h2\x3e\n\x3cp\x3e这个清单基于 \x3ca href=\x22https:\/\/www.owasp.org\/index.php\/Web_Application_Security_Testing_Cheat_Sheet\x22\x3eWeb Application Security Testing Cheat Sheet\x3c\/a\x3e（\x3ca href=\x22https:\/\/www.owasp.org\/index.php\/Main_Page\x22\x3eOWASP\x3c\/a\x3e维护）并且很大程度受它影响。\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e开放Web应用安全项目（OWASP）是一个全球性的非盈利慈善组织，致力于提高软件的安全性\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Node.js 安全清单</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/node-js-security-checklist-risingstack">https://www.zcfy.cc/article/node-js-security-checklist-risingstack</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/1sya4pbk1j5/" target="_blank">https://alili.tech/archive/1sya4pbk1j5/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>