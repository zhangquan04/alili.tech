<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="【vue&#43;axios】一个项目学会前端实现登录拦截"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>【vue&#43;axios】一个项目学会前端实现登录拦截 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/4nh0dh6zpy8/",
				"appid": "1613049289050283", 
				"title": "【vue&#43;axios】一个项目学会前端实现登录拦截 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-26T02:30:18"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/8q7i5jlm1tl/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/snwp9z2qe4/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f4nh0dh6zpy8%2f&text=%e3%80%90vue%2baxios%e3%80%91%e4%b8%80%e4%b8%aa%e9%a1%b9%e7%9b%ae%e5%ad%a6%e4%bc%9a%e5%89%8d%e7%ab%af%e5%ae%9e%e7%8e%b0%e7%99%bb%e5%bd%95%e6%8b%a6%e6%88%aa"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f4nh0dh6zpy8%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f4nh0dh6zpy8%2f&text=%e3%80%90vue%2baxios%e3%80%91%e4%b8%80%e4%b8%aa%e9%a1%b9%e7%9b%ae%e5%ad%a6%e4%bc%9a%e5%89%8d%e7%ab%af%e5%ae%9e%e7%8e%b0%e7%99%bb%e5%bd%95%e6%8b%a6%e6%88%aa"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f4nh0dh6zpy8%2f&title=%e3%80%90vue%2baxios%e3%80%91%e4%b8%80%e4%b8%aa%e9%a1%b9%e7%9b%ae%e5%ad%a6%e4%bc%9a%e5%89%8d%e7%ab%af%e5%ae%9e%e7%8e%b0%e7%99%bb%e5%bd%95%e6%8b%a6%e6%88%aa"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f4nh0dh6zpy8%2f&is_video=false&description=%e3%80%90vue%2baxios%e3%80%91%e4%b8%80%e4%b8%aa%e9%a1%b9%e7%9b%ae%e5%ad%a6%e4%bc%9a%e5%89%8d%e7%ab%af%e5%ae%9e%e7%8e%b0%e7%99%bb%e5%bd%95%e6%8b%a6%e6%88%aa"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e3%80%90vue%2baxios%e3%80%91%e4%b8%80%e4%b8%aa%e9%a1%b9%e7%9b%ae%e5%ad%a6%e4%bc%9a%e5%89%8d%e7%ab%af%e5%ae%9e%e7%8e%b0%e7%99%bb%e5%bd%95%e6%8b%a6%e6%88%aa&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f4nh0dh6zpy8%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f4nh0dh6zpy8%2f&title=%e3%80%90vue%2baxios%e3%80%91%e4%b8%80%e4%b8%aa%e9%a1%b9%e7%9b%ae%e5%ad%a6%e4%bc%9a%e5%89%8d%e7%ab%af%e5%ae%9e%e7%8e%b0%e7%99%bb%e5%bd%95%e6%8b%a6%e6%88%aa"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4nh0dh6zpy8%2f&title=%e3%80%90vue%2baxios%e3%80%91%e4%b8%80%e4%b8%aa%e9%a1%b9%e7%9b%ae%e5%ad%a6%e4%bc%9a%e5%89%8d%e7%ab%af%e5%ae%9e%e7%8e%b0%e7%99%bb%e5%bd%95%e6%8b%a6%e6%88%aa"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4nh0dh6zpy8%2f&title=%e3%80%90vue%2baxios%e3%80%91%e4%b8%80%e4%b8%aa%e9%a1%b9%e7%9b%ae%e5%ad%a6%e4%bc%9a%e5%89%8d%e7%ab%af%e5%ae%9e%e7%8e%b0%e7%99%bb%e5%bd%95%e6%8b%a6%e6%88%aa"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4nh0dh6zpy8%2f&title=%e3%80%90vue%2baxios%e3%80%91%e4%b8%80%e4%b8%aa%e9%a1%b9%e7%9b%ae%e5%ad%a6%e4%bc%9a%e5%89%8d%e7%ab%af%e5%ae%9e%e7%8e%b0%e7%99%bb%e5%bd%95%e6%8b%a6%e6%88%aa"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">【vue&#43;axios】一个项目学会前端实现登录拦截</h1><div class="meta"><div class="postdate"><time datetime="2019-01-26" itemprop="datePublished">2019-01-26</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e一个项目学会前端实现登录拦截\x3c\/h1\x3e\n\x3cblockquote\x3e\x3cp\x3e一个项目学会vue全家桶\x2baxios实现登录、拦截、登出功能，以及利用axios的http拦截器拦截请求和响应。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3e该项目是利用了Github 提供的personal token作为登录token，通过token访问你的Repository List。通过这个项目学习如何实现一个前端项目中所需要的\x3cbr\x3e登录及拦截、登出、token失效的拦截及对应 axios 拦截器的使用。\x3cbr\x3e\x3cstrong\x3e准备\x3c\/strong\x3e\x3cbr\x3e你需要先生成自己的 Github Personal Token（\x3ca href=\x22https:\/\/github.com\/settings\/tokens\/new\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e生成Token\x3c\/a\x3e）。\x3cbr\x3eToken 生成后 访问 \x3ca href=\x22http:\/\/www.iamsuperman.cn\/vue-axios-github\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDemo\x3c\/a\x3e，即可查看你的Repository List。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e项目结构\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.\n├── README.md\n├── dist  \/\/ 打包构建后的文件夹\n│\x26nbsp;\x26nbsp; ├── build.js\n│\x26nbsp;\x26nbsp; └── build.js.map\n├── index.html\n├── package.json\n├── src\n│\x26nbsp;\x26nbsp; ├── App.vue\n│\x26nbsp;\x26nbsp; ├── assets\n│\x26nbsp;\x26nbsp; │\x26nbsp;\x26nbsp; ├── css.css\n│\x26nbsp;\x26nbsp; │\x26nbsp;\x26nbsp; ├── icon.css\n│\x26nbsp;\x26nbsp; │\x26nbsp;\x26nbsp; └── logo.png\n│\x26nbsp;\x26nbsp; ├── constant\n│\x26nbsp;\x26nbsp; │\x26nbsp;\x26nbsp; └── api.js  \/\/ 配置api接口文件\n│\x26nbsp;\x26nbsp; ├── http.js \/\/ 封装fetch、post请求及http 拦截器配置文件\n│\x26nbsp;\x26nbsp; ├── index.vue\n│\x26nbsp;\x26nbsp; ├── login.vue\n│\x26nbsp;\x26nbsp; ├── main.js\n│\x26nbsp;\x26nbsp; ├── repository.vue\n│\x26nbsp;\x26nbsp; ├── router.js \/\/ 路由配置文件\n│\x26nbsp;\x26nbsp; └── store\n│\x26nbsp;\x26nbsp;     ├── store.js  \n│\x26nbsp;\x26nbsp;     └── types.js  \/\/ vuex types\n└── webpack.config.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs processing\x22\x3e\x3ccode\x3e.\n├── README.md\n├── \x3cspan class=\x22hljs-built_in\x22\x3edist\x3c\/span\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 打包构建后的文件夹\x3c\/span\x3e\n│\x26nbsp;\x26nbsp; ├── build.js\n│\x26nbsp;\x26nbsp; └── build.js.\x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e\n├── index.html\n├── \x3cspan class=\x22hljs-keyword\x22\x3epackage\x3c\/span\x3e.json\n├── src\n│\x26nbsp;\x26nbsp; ├── App.vue\n│\x26nbsp;\x26nbsp; ├── assets\n│\x26nbsp;\x26nbsp; │\x26nbsp;\x26nbsp; ├── css.css\n│\x26nbsp;\x26nbsp; │\x26nbsp;\x26nbsp; ├── icon.css\n│\x26nbsp;\x26nbsp; │\x26nbsp;\x26nbsp; └── logo.png\n│\x26nbsp;\x26nbsp; ├── constant\n│\x26nbsp;\x26nbsp; │\x26nbsp;\x26nbsp; └── api.js  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 配置api接口文件\x3c\/span\x3e\n│\x26nbsp;\x26nbsp; ├── http.js \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 封装fetch、post请求及http 拦截器配置文件\x3c\/span\x3e\n│\x26nbsp;\x26nbsp; ├── index.vue\n│\x26nbsp;\x26nbsp; ├── login.vue\n│\x26nbsp;\x26nbsp; ├── main.js\n│\x26nbsp;\x26nbsp; ├── repository.vue\n│\x26nbsp;\x26nbsp; ├── router.js \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 路由配置文件\x3c\/span\x3e\n│\x26nbsp;\x26nbsp; └── store\n│\x26nbsp;\x26nbsp;     ├── store.js  \n│\x26nbsp;\x26nbsp;     └── types.js  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ vuex types\x3c\/span\x3e\n└── webpack.config.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e技术栈\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eVue 2.0\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evue-router\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evuex\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eaxios\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evue-material\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e登录拦截逻辑\x3c\/h3\x3e\n\x3ch4\x3e第一步：路由拦截\x3c\/h4\x3e\n\x3cp\x3e首先在定义路由的时候就需要多添加一个自定义字段\x3ccode\x3erequireAuth\x3c\/code\x3e，用于判断该路由的访问是否需要登录。如果用户已经登录，则顺利进入路由，\x3cbr\x3e否则就进入登录页面。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const routes = [\n    {\n        path: \x27\/\x27,\n        name: \x27\/\x27,\n        component: Index\n    },\n    {\n        path: \x27\/repository\x27,\n        name: \x27repository\x27,\n        meta: {\n            requireAuth: true,  \/\/ 添加该字段，表示进入这个路由是需要登录的\n        },\n        component: Repository\n    },\n    {\n        path: \x27\/login\x27,\n        name: \x27login\x27,\n        component: Login\n    }\n];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e routes = [\n    {\n        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3ecomponent\x3c\/span\x3e: Index\n    },\n    {\n        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/repository\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27repository\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3emeta\x3c\/span\x3e: {\n            \x3cspan class=\x22hljs-attr\x22\x3erequireAuth\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加该字段，表示进入这个路由是需要登录的\x3c\/span\x3e\n        },\n        \x3cspan class=\x22hljs-attr\x22\x3ecomponent\x3c\/span\x3e: Repository\n    },\n    {\n        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/login\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27login\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3ecomponent\x3c\/span\x3e: Login\n    }\n];\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e定义完路由后，我们主要是利用\x3ccode\x3evue-router\x3c\/code\x3e提供的钩子函数\x3ccode\x3ebeforeEach()\x3c\/code\x3e对路由进行判断。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22router.beforeEach((to, from, next) =\x3e {\n    if (to.meta.requireAuth) {  \/\/ 判断该路由是否需要登录权限\n        if (store.state.token) {  \/\/ 通过vuex state获取当前的token是否存在\n            next();\n        }\n        else {\n            next({\n                path: \x27\/login\x27,\n                query: {redirect: to.fullPath}  \/\/ 将跳转的路由path作为参数，登录成功后跳转到该路由\n            })\n        }\n    }\n    else {\n        next();\n    }\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3erouter.beforeEach(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eto, \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e, next\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (to.meta.requireAuth) {  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 判断该路由是否需要登录权限\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (store.state.token) {  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 通过vuex state获取当前的token是否存在\x3c\/span\x3e\n            next();\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            next({\n                \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/login\x27\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-attr\x22\x3equery\x3c\/span\x3e: {\x3cspan class=\x22hljs-attr\x22\x3eredirect\x3c\/span\x3e: to.fullPath}  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将跳转的路由path作为参数，登录成功后跳转到该路由\x3c\/span\x3e\n            })\n        }\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        next();\n    }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e每个钩子方法接收三个参数：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eto: Route: 即将要进入的目标 路由对象\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3efrom: Route: 当前导航正要离开的路由\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3enext: Function: 一定要调用该方法来 resolve 这个钩子。执行效果依赖 next 方法的调用参数。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3enext(): 进行管道中的下一个钩子。如果全部钩子执行完了，则导航的状态就是 confirmed （确认的）。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3enext(false): 中断当前的导航。如果浏览器的 URL 改变了（可能是用户手动或者浏览器后退按钮），那么 URL 地址会重置到 from 路由对应的地址。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3enext(\x27\/\x27) 或者 next({ path: \x27\/\x27 }): 跳转到一个不同的地址。当前的导航被中断，然后进行一个新的导航。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e确保要调用 next 方法，否则钩子就不会被 resolved。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e完整的方法见\x3ccode\x3e\/src\/router.js\x3c\/code\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e其中，\x3ccode\x3eto.meta\x3c\/code\x3e中是我们自定义的数据，其中就包括我们刚刚定义的\x3ccode\x3erequireAuth\x3c\/code\x3e字段。通过这个字段来判断该路由是否需要登录权限。需要的话，同时当前应用不存在token，则跳转到登录页面，进行登录。登录成功后跳转到目标路由。\x3c\/p\x3e\n\x3cp\x3e登录拦截到这里就结束了吗？并没有。这种方式只是简单的前端路由控制，并不能真正阻止用户访问需要登录权限的路由。还有一种情况便是：当前token失效了，但是token依然保存在本地。这时候你去访问需要登录权限的路由时，实际上应该让用户重新登录。\x3cbr\x3e这时候就需要结合 http 拦截器 \x2b 后端接口返回的http 状态码来判断。\x3c\/p\x3e\n\x3ch4\x3e第二步：拦截器\x3c\/h4\x3e\n\x3cp\x3e要想统一处理所有http请求和响应，就得用上 axios 的拦截器。通过配置\x3ccode\x3ehttp response inteceptor\x3c\/code\x3e，当后端接口返回\x3ccode\x3e401 Unauthorized（未授权）\x3c\/code\x3e，让用户重新登录。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ http request 拦截器\naxios.interceptors.request.use(\n    config =\x3e {\n        if (store.state.token) {  \/\/ 判断是否存在token，如果存在的话，则每个http header都加上token\n            config.headers.Authorization = `token ${store.state.token}`;\n        }\n        return config;\n    },\n    err =\x3e {\n        return Promise.reject(err);\n    });\n\n\/\/ http response 拦截器\naxios.interceptors.response.use(\n    response =\x3e {\n        return response;\n    },\n    error =\x3e {\n        if (error.response) {\n            switch (error.response.status) {\n                case 401:\n                    \/\/ 返回 401 清除token信息并跳转到登录页面\n                    store.commit(types.LOGOUT);\n                    router.replace({\n                        path: \x27login\x27,\n                        query: {redirect: router.currentRoute.fullPath}\n                    })\n            }\n        }\n        return Promise.reject(error.response.data)   \/\/ 返回接口返回的错误信息\n    });\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ http request 拦截器\x3c\/span\x3e\naxios.interceptors.request.use(\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3econfig\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (store.state.token) {  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 判断是否存在token，如果存在的话，则每个http header都加上token\x3c\/span\x3e\n            config.headers.Authorization = \x3cspan class=\x22hljs-string\x22\x3e`token \x3cspan class=\x22hljs-subst\x22\x3e${store.state.token}\x3c\/span\x3e`\x3c\/span\x3e;\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e config;\n    },\n    err =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(err);\n    });\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ http response 拦截器\x3c\/span\x3e\naxios.interceptors.response.use(\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eresponse\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e response;\n    },\n    error =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (error.response) {\n            \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e (error.response.status) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e401\x3c\/span\x3e:\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回 401 清除token信息并跳转到登录页面\x3c\/span\x3e\n                    store.commit(types.LOGOUT);\n                    router.replace({\n                        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27login\x27\x3c\/span\x3e,\n                        \x3cspan class=\x22hljs-attr\x22\x3equery\x3c\/span\x3e: {\x3cspan class=\x22hljs-attr\x22\x3eredirect\x3c\/span\x3e: router.currentRoute.fullPath}\n                    })\n            }\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(error.response.data)   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回接口返回的错误信息\x3c\/span\x3e\n    });\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e完整的方法见\x3ccode\x3e\/src\/http.js\x3c\/code\x3e.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e通过上面这两步，就可以在前端实现登录拦截了。\x3ccode\x3e登出\x3c\/code\x3e功能也就很简单，只需要把当前token清除，再跳转到首页即可。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e关于axios\x3c\/h2\x3e\n\x3cp\x3e对于axios，很多刚开始学习vue的人都觉得文档比较难以看懂。我刚开始也是这么觉得的。但通过这么一个项目下来后，发现axios并不难理解。建议在学习axios的时带着下面的目的去看文档会更高效。因为掌握了下面这些内容，基本上就可以无障碍得在项目中使用axios了。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e发起http请求的方法\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ehttp 请求成功时返回的数据及其类型\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ehttp请求失败的处理\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e拦截器的使用\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ehttp的配置\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/mzabriskie\/axios\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eaxios文档\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e运行及构建\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22# install dependencies\nnpm install\n\n# serve with hot reload at localhost:8080\nnpm run dev\n\n# build for production with minification\nnpm run build\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e# install dependencies\x3c\/span\x3e\nnpm install\n\n\x3cspan class=\x22hljs-comment\x22\x3e# serve with hot reload at localhost:8080\x3c\/span\x3e\nnpm run dev\n\n\x3cspan class=\x22hljs-comment\x22\x3e# build for production with minification\x3c\/span\x3e\nnpm run build\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e项目地址：\x3ca href=\x22https:\/\/github.com\/superman66\/vue-axios-github\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/superman66\/vue-axios-github\x3c\/a\x3e\x3cbr\x3e欢迎star \x2b issues.\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>【vue+axios】一个项目学会前端实现登录拦截</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008383094">https://segmentfault.com/a/1190000008383094</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/4nh0dh6zpy8/" target="_blank">https://alili.tech/archive/4nh0dh6zpy8/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>