<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="H5实例教学--微信内嵌视频1（案例浅析）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>H5实例教学--微信内嵌视频1（案例浅析） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/xhjgf527wvr/",
				"appid": "1613049289050283", 
				"title": "H5实例教学--微信内嵌视频1（案例浅析） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-26T02:30:18"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/0hqst6af5tx/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/mzd8glfuhd/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fxhjgf527wvr%2f&text=H5%e5%ae%9e%e4%be%8b%e6%95%99%e5%ad%a6--%e5%be%ae%e4%bf%a1%e5%86%85%e5%b5%8c%e8%a7%86%e9%a2%911%ef%bc%88%e6%a1%88%e4%be%8b%e6%b5%85%e6%9e%90%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fxhjgf527wvr%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fxhjgf527wvr%2f&text=H5%e5%ae%9e%e4%be%8b%e6%95%99%e5%ad%a6--%e5%be%ae%e4%bf%a1%e5%86%85%e5%b5%8c%e8%a7%86%e9%a2%911%ef%bc%88%e6%a1%88%e4%be%8b%e6%b5%85%e6%9e%90%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fxhjgf527wvr%2f&title=H5%e5%ae%9e%e4%be%8b%e6%95%99%e5%ad%a6--%e5%be%ae%e4%bf%a1%e5%86%85%e5%b5%8c%e8%a7%86%e9%a2%911%ef%bc%88%e6%a1%88%e4%be%8b%e6%b5%85%e6%9e%90%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fxhjgf527wvr%2f&is_video=false&description=H5%e5%ae%9e%e4%be%8b%e6%95%99%e5%ad%a6--%e5%be%ae%e4%bf%a1%e5%86%85%e5%b5%8c%e8%a7%86%e9%a2%911%ef%bc%88%e6%a1%88%e4%be%8b%e6%b5%85%e6%9e%90%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=H5%e5%ae%9e%e4%be%8b%e6%95%99%e5%ad%a6--%e5%be%ae%e4%bf%a1%e5%86%85%e5%b5%8c%e8%a7%86%e9%a2%911%ef%bc%88%e6%a1%88%e4%be%8b%e6%b5%85%e6%9e%90%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fxhjgf527wvr%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fxhjgf527wvr%2f&title=H5%e5%ae%9e%e4%be%8b%e6%95%99%e5%ad%a6--%e5%be%ae%e4%bf%a1%e5%86%85%e5%b5%8c%e8%a7%86%e9%a2%911%ef%bc%88%e6%a1%88%e4%be%8b%e6%b5%85%e6%9e%90%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxhjgf527wvr%2f&title=H5%e5%ae%9e%e4%be%8b%e6%95%99%e5%ad%a6--%e5%be%ae%e4%bf%a1%e5%86%85%e5%b5%8c%e8%a7%86%e9%a2%911%ef%bc%88%e6%a1%88%e4%be%8b%e6%b5%85%e6%9e%90%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxhjgf527wvr%2f&title=H5%e5%ae%9e%e4%be%8b%e6%95%99%e5%ad%a6--%e5%be%ae%e4%bf%a1%e5%86%85%e5%b5%8c%e8%a7%86%e9%a2%911%ef%bc%88%e6%a1%88%e4%be%8b%e6%b5%85%e6%9e%90%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxhjgf527wvr%2f&title=H5%e5%ae%9e%e4%be%8b%e6%95%99%e5%ad%a6--%e5%be%ae%e4%bf%a1%e5%86%85%e5%b5%8c%e8%a7%86%e9%a2%911%ef%bc%88%e6%a1%88%e4%be%8b%e6%b5%85%e6%9e%90%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">H5实例教学--微信内嵌视频1（案例浅析）</h1><div class="meta"><div class="postdate"><time datetime="2019-01-26" itemprop="datePublished">2019-01-26</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVJCVu?w=133\x26amp;h=136\x22 src=\x22https:\/\/static.alili.tech\/img\/bVJCVu?w=133\x26amp;h=136\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e以上为案例二维码\x3cbr\x3e 首个H5案例解析\x3cbr\x3e 从头开始分析\x3c\/p\x3e\n\x3cp\x3e在 iOS 上，APP 都是使用的系统自带的浏览器进行页面渲染，video 播放视频的效果是统一的，只需要考虑不同的 iOS 版本是否有不一致的地方。在 iOS 上，播放视频默认会弹出一个播放器全屏播放视频，如下效果\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVJCVX?w=750\x26amp;h=1334\x22 src=\x22https:\/\/static.alili.tech\/img\/bVJCVX?w=750\x26amp;h=1334\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e播放器上下有的系统默认的控制栏，可以控制视频的播放进度、音量以及暂停或继续播放，播放视频时，视频会 “浮” 在页面上，页面上的所有元素都只能是在视频下面，这种效果显然不是我们想要的。\x3cbr\x3e但好在 iOS 10 Safari 中，video 新增了 playsinline 属性，可以使视频内联播放。(微信浏览器支持)\x3c\/p\x3e\n\x3cp\x3e在 webkit 的 blog 上提到\x3c\/p\x3e\n\x3cp\x3eA note about the playsinline attribute: this attribute has recently been added to the HTML specification, and WebKit has adopted this new attribute by unprefixing its legacy webkit-playsinline attribute. This legacy attribute has been supported since iPhoneOS 4.0, and accordance with our updated unprefixing policy, we’re pleased to have been able to unprefix webkit-playsinline.\x3c\/p\x3e\n\x3cp\x3e来源： \x3ca href=\x22http:\/\/www.cnblogs.com\/zzsdream\/p\/6372528.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.cnblogs.com\/zzsdre...\x3c\/a\x3e\x3cbr\x3e安卓实现： \x3c\/p\x3e\n\x3cp\x3eTBS 内核（\x26gt;=036849）支持一个叫 同层播放器 的视频播放器，这个不需要申请白名单，只需给 video 设置两个属性 x5-video-player-type=\x22h5\x22 和 x5-video-player-fullscreen=\x22true\x22，播放效果\x3c\/p\x3e\n\x3cp\x3e结合IOS和安卓微信下同层播放器的实现代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cvideo preload=\x26quot;load\x26quot; data-link=\x26quot;http:\/\/wag.i-h5.cn\/dj\/wyf\/video\/wb.mp4\x26quot;  playsinline x-webkit-airplay=\x26quot;true\x26quot; webkit-playsinline\n       x5-video-player-type=\x26quot;h5\x26quot; x5-video-player-fullscreen=\x26quot;true\x26quot; id=\x26quot;video\x26quot; width=\x26quot;100%\x26quot; src=\x26quot;http:\/\/wag.i-h5.cn\/dj\/wyf\/video\/wyf.mp4\x26quot;\x3e\x3c\/video\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs llvm\x22\x3e\x3ccode\x3e\x26lt;video preload=\x3cspan class=\x22hljs-string\x22\x3e\x22load\x22\x3c\/span\x3e data-link=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/wag.i-h5.cn\/dj\/wyf\/video\/wb.mp4\x22\x3c\/span\x3e  playsinline \x3cspan class=\x22hljs-keyword\x22\x3ex\x3c\/span\x3e-webkit-airplay=\x3cspan class=\x22hljs-string\x22\x3e\x22true\x22\x3c\/span\x3e webkit-playsinline\n       \x3cspan class=\x22hljs-keyword\x22\x3ex\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e-video-player-\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22h5\x22\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ex\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e-video-player-fullscreen=\x3cspan class=\x22hljs-string\x22\x3e\x22true\x22\x3c\/span\x3e id=\x3cspan class=\x22hljs-string\x22\x3e\x22video\x22\x3c\/span\x3e width=\x3cspan class=\x22hljs-string\x22\x3e\x22100%\x22\x3c\/span\x3e src=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/wag.i-h5.cn\/dj\/wyf\/video\/wyf.mp4\x22\x3c\/span\x3e\x26gt;\x26lt;\/video\x26gt;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e稍微讲一下video的事件\x3c\/p\x3e\n\x3cp\x3e此案例并没有使用timeupdate时间来实现播放进度的监听\x3cbr\x3e在此案例中\x3cbr\x3e要实现第一段视频播放完，出现选项给用户进行视频的选择交互。\x3cbr\x3e我们需要在出现选项时将视屏暂停，\x3cbr\x3e先来看下代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function getTime(obj){\n    obj.timer = setInterval(function(){\n        var t = obj.currentTime;\n        if(isAndroid) {\n            \/\/ 选项出现\n            if(Math.abs(t - 32.13) \x3c= .1 \x26amp;\x26amp; istest) {\n                selectBtn.style.display = \x27block\x27;\n                obj.pause();\n                clearInterval(obj.timer);\n            }\n            \/\/ \/\/ 墨鏡播放完必,镯子播放完毕,帽子播放完毕\n            if(Math.abs(t) \x3e 46.04 \x26amp;\x26amp; typenum == 1 || Math.abs(t) \x3e 65.16 \x26amp;\x26amp; typenum == 2 || Math.abs(t) \x3e 80.64 \x26amp;\x26amp; typenum == 4) {\n                selectBtn.style.display = \x27block\x27;\n                obj.pause();\n                istest = true;\n                clearInterval(obj.timer);\n            }\n        } else {\n            \/\/ 选项出现\n            if(Math.abs(t - 32.13) \x3c= .1 \x26amp;\x26amp; istest) {\n                selectBtn.style.display = \x27block\x27;\n                \/\/ obj.currentTime = 32.13;\n                obj.pause();\n                clearInterval(obj.timer);\n            }\n            \/\/ \/\/ 墨鏡播放完必,镯子播放完毕,帽子播放完毕\n            if(Math.abs(t) \x3e 46.04 \x26amp;\x26amp; typenum == 1 || Math.abs(t) \x3e 65.16 \x26amp;\x26amp; typenum == 2 || Math.abs(t) \x3e 80.24 \x26amp;\x26amp; typenum == 4) {\n                selectBtn.style.display = \x27block\x27;\n                obj.currentTime = 32.13;\n                obj.pause();\n                istest = true;\n                clearInterval(obj.timer);\n            }\n        }\n        \/\/ 项链播放，提前呼出点击按钮\n        if(t \x3e 172) {\n            \/\/ aLink.style.display = \x27block\x27;\n            \/\/ window.location.href = \x27http:\/\/wag.i-h5.cn\/dj\/wyf\/fenx.html\x27;\n        }\n    },20);\n}\n\/**\n * 视频开始play\n *\/\nvideo.addEventListener(\x27play\x27, function(){\n    \/\/ ovstatus = 1;\n    console.log(\x26quot;play\x26quot;)\n    getTime(this);\n}, false);\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetTime\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj\x3c\/span\x3e)\x3c\/span\x3e{\n    obj.timer = setInterval(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e t = obj.currentTime;\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(isAndroid) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 选项出现\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(t - \x3cspan class=\x22hljs-number\x22\x3e32.13\x3c\/span\x3e) \x26lt;= \x3cspan class=\x22hljs-number\x22\x3e.1\x3c\/span\x3e \x26amp;\x26amp; istest) {\n                selectBtn.style.display = \x3cspan class=\x22hljs-string\x22\x3e\x27block\x27\x3c\/span\x3e;\n                obj.pause();\n                clearInterval(obj.timer);\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ \/\/ 墨鏡播放完必,镯子播放完毕,帽子播放完毕\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(t) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e46.04\x3c\/span\x3e \x26amp;\x26amp; typenum == \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e || \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(t) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e65.16\x3c\/span\x3e \x26amp;\x26amp; typenum == \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e || \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(t) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e80.64\x3c\/span\x3e \x26amp;\x26amp; typenum == \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e) {\n                selectBtn.style.display = \x3cspan class=\x22hljs-string\x22\x3e\x27block\x27\x3c\/span\x3e;\n                obj.pause();\n                istest = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n                clearInterval(obj.timer);\n            }\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 选项出现\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(t - \x3cspan class=\x22hljs-number\x22\x3e32.13\x3c\/span\x3e) \x26lt;= \x3cspan class=\x22hljs-number\x22\x3e.1\x3c\/span\x3e \x26amp;\x26amp; istest) {\n                selectBtn.style.display = \x3cspan class=\x22hljs-string\x22\x3e\x27block\x27\x3c\/span\x3e;\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ obj.currentTime = 32.13;\x3c\/span\x3e\n                obj.pause();\n                clearInterval(obj.timer);\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ \/\/ 墨鏡播放完必,镯子播放完毕,帽子播放完毕\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(t) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e46.04\x3c\/span\x3e \x26amp;\x26amp; typenum == \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e || \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(t) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e65.16\x3c\/span\x3e \x26amp;\x26amp; typenum == \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e || \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(t) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e80.24\x3c\/span\x3e \x26amp;\x26amp; typenum == \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e) {\n                selectBtn.style.display = \x3cspan class=\x22hljs-string\x22\x3e\x27block\x27\x3c\/span\x3e;\n                obj.currentTime = \x3cspan class=\x22hljs-number\x22\x3e32.13\x3c\/span\x3e;\n                obj.pause();\n                istest = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n                clearInterval(obj.timer);\n            }\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 项链播放，提前呼出点击按钮\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(t \x26gt; \x3cspan class=\x22hljs-number\x22\x3e172\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ aLink.style.display = \x27block\x27;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ window.location.href = \x27http:\/\/wag.i-h5.cn\/dj\/wyf\/fenx.html\x27;\x3c\/span\x3e\n        }\n    },\x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e);\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * 视频开始play\n *\/\x3c\/span\x3e\nvideo.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27play\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ovstatus = 1;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22play\x22\x3c\/span\x3e)\n    getTime(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n}, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e该案例使用了定时器，在视频开始事件触发时开始每20ms触发一次，判断当前视频进度，若到达需停止的进度时（第一段片段播放完毕，或选项片段结束时），暂停视频，并出现浮层div块，为用户提供交互。\x3c\/p\x3e\n\x3cp\x3e点击选项后跳到对应的进度，继续播放视频。以上为该案例主要需要解决的问题。\x3c\/p\x3e\n\x3cp\x3e安卓浏览器左上角会出现推出播放的返回按钮，当点击按钮时将退出播放\x3cbr\x3e退出播放时，我们需要做相应的处理。TBS 有提供相应的事件，不过不同的版本有一点差异\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22                   TBS \x3c 036849    036849 \x3c= TBS \x3c 036900      036900 \x3c= TBS\n是否支持同层播放器        否                  是                     是\n退出全屏播放时触发                  x5videoenterfullscreen    x5videoexitfullscreen\n进入全屏播放时触发                  x5videoexitfullscreen     x5videoenterfullscreen\n通过监听这两个事件就可以知道当前的播放状态\n\ndocument.getElementById(\x27video\x27).addEventListener(\x26quot;x5videoexitfullscreen\x26quot;, function(){\n    alert(\x26quot;exit fullscreen\x26quot;)\n})\n\ndocument.getElementById(\x27video\x27).addEventListener(\x26quot;x5videoenterfullscreen\x26quot;, function(){\n    alert(\x26quot;enter fullscreen\x26quot;)\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e                   TBS \x26lt; \x3cspan class=\x22hljs-number\x22\x3e036849\x3c\/span\x3e    \x3cspan class=\x22hljs-number\x22\x3e036849\x3c\/span\x3e \x26lt;= TBS \x26lt; \x3cspan class=\x22hljs-number\x22\x3e036900\x3c\/span\x3e      \x3cspan class=\x22hljs-number\x22\x3e036900\x3c\/span\x3e \x26lt;= TBS\n是否支持同层播放器        否                  是                     是\n退出全屏播放时触发                  x5videoenterfullscreen    x5videoexitfullscreen\n进入全屏播放时触发                  x5videoexitfullscreen     x5videoenterfullscreen\n通过监听这两个事件就可以知道当前的播放状态\n\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27video\x27\x3c\/span\x3e).addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22x5videoexitfullscreen\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    alert(\x3cspan class=\x22hljs-string\x22\x3e\x22exit fullscreen\x22\x3c\/span\x3e)\n})\n\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27video\x27\x3c\/span\x3e).addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22x5videoenterfullscreen\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    alert(\x3cspan class=\x22hljs-string\x22\x3e\x22enter fullscreen\x22\x3c\/span\x3e)\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在对话框中发送 \/\/gettbs 可以查看相关信息，tbsCoreVersion 就是当前安装的 TBS 内核版本。\x3c\/p\x3e\n\x3cp\x3e补充资料：\x3cbr\x3eH5视频播放优化：\x3cbr\x3e\x3ca href=\x22http:\/\/www.xuanfengge.com\/html5-video-play.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.xuanfengge.com\/htm...\x3c\/a\x3e\x3cbr\x3evideoAPI：\x3cbr\x3e\x3ca href=\x22http:\/\/www.w3school.com.cn\/tags\/av_prop_playbackrate.asp\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.w3school.com.cn\/ta...\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>H5实例教学&ndash;微信内嵌视频1（案例浅析）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008452126">https://segmentfault.com/a/1190000008452126</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/xhjgf527wvr/" target="_blank">https://alili.tech/archive/xhjgf527wvr/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>