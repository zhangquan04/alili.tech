<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="一步一步实现字母索引导航栏"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>一步一步实现字母索引导航栏 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/rd30jrzoprj/",
				"appid": "1613049289050283", 
				"title": "一步一步实现字母索引导航栏 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-30T02:30:23"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/l48db4nszu/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/am2vl03nt5/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2frd30jrzoprj%2f&text=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e5%ae%9e%e7%8e%b0%e5%ad%97%e6%af%8d%e7%b4%a2%e5%bc%95%e5%af%bc%e8%88%aa%e6%a0%8f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2frd30jrzoprj%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2frd30jrzoprj%2f&text=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e5%ae%9e%e7%8e%b0%e5%ad%97%e6%af%8d%e7%b4%a2%e5%bc%95%e5%af%bc%e8%88%aa%e6%a0%8f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2frd30jrzoprj%2f&title=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e5%ae%9e%e7%8e%b0%e5%ad%97%e6%af%8d%e7%b4%a2%e5%bc%95%e5%af%bc%e8%88%aa%e6%a0%8f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2frd30jrzoprj%2f&is_video=false&description=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e5%ae%9e%e7%8e%b0%e5%ad%97%e6%af%8d%e7%b4%a2%e5%bc%95%e5%af%bc%e8%88%aa%e6%a0%8f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e5%ae%9e%e7%8e%b0%e5%ad%97%e6%af%8d%e7%b4%a2%e5%bc%95%e5%af%bc%e8%88%aa%e6%a0%8f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2frd30jrzoprj%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2frd30jrzoprj%2f&title=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e5%ae%9e%e7%8e%b0%e5%ad%97%e6%af%8d%e7%b4%a2%e5%bc%95%e5%af%bc%e8%88%aa%e6%a0%8f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frd30jrzoprj%2f&title=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e5%ae%9e%e7%8e%b0%e5%ad%97%e6%af%8d%e7%b4%a2%e5%bc%95%e5%af%bc%e8%88%aa%e6%a0%8f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frd30jrzoprj%2f&title=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e5%ae%9e%e7%8e%b0%e5%ad%97%e6%af%8d%e7%b4%a2%e5%bc%95%e5%af%bc%e8%88%aa%e6%a0%8f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frd30jrzoprj%2f&title=%e4%b8%80%e6%ad%a5%e4%b8%80%e6%ad%a5%e5%ae%9e%e7%8e%b0%e5%ad%97%e6%af%8d%e7%b4%a2%e5%bc%95%e5%af%bc%e8%88%aa%e6%a0%8f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">一步一步实现字母索引导航栏</h1><div class="meta"><div class="postdate"><time datetime="2019-01-30" itemprop="datePublished">2019-01-30</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e先来看下实现后的效果：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007686588?w=277\x26amp;h=487\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007686588?w=277\x26amp;h=487\x22 alt=\x22DEMO\x22 title=\x22DEMO\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e链接：\x3ca href=\x22http:\/\/www.luobotang.cn\/index-sidebar\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e在线DEMO\x3c\/a\x3e，\x3ca href=\x22https:\/\/github.com\/luobotang\/index-sidebar\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e源代码\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e这个索引导航栏的效果在很多 APP 中都有应用，我也是参考了一些 APP 的效果进行实现。\x3c\/p\x3e\n\x3cp\x3e不过之前接触移动端页面开发较少，所以是边学边做，也就把这个过程中的一些东西整理记录下来。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e设计\x3c\/h2\x3e\n\x3cp\x3e这个功能的基本需求可以总结为一句话：手指在导航栏（也就是 DEMO 上页面右侧的包含字母的竖条）拖动时，根据当前手指位置，页面主体内容列表跳转到对应字母的内容项。\x3c\/p\x3e\n\x3cp\x3e当然，延伸开来，可以是对于已经排序的列表，导航栏显示对应的索引字符列表，支持快速跳转到对应的索引位置。\x3c\/p\x3e\n\x3cp\x3e这里主要介绍导航栏的实现，只看导航栏的话，其实要实现的东西比较简单，只需要在手指移动时获取对应的字母即可。页面主体内容列表的跳转应该交由另一个列表组件实现。\x3c\/p\x3e\n\x3cp\x3e在程序代码中，组合导航栏和内容列表两个组件，导航栏索引字母更新时，内容列表跳转到对应的位置。\x3c\/p\x3e\n\x3cp\x3e结合 DEMO，整体的实现逻辑为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 创建一个内容列表组件\nvar itemList = new ItemList(data)\n\n\/\/ 创建一个索引导航组件\nvar indexSidebar = new IndexSidebar()\n\n\/\/ 组合两个组件实现功能\n\/\/ 监听索引导航组件，一旦索引字符更新，内容列表跳转至对应的索引字符\nindexSidebar.on(\x27charChange\x27, function (ch) {\n  itemList.gotoChar(ch)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建一个内容列表组件\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e itemList = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ItemList(data)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建一个索引导航组件\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e indexSidebar = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e IndexSidebar()\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 组合两个组件实现功能\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听索引导航组件，一旦索引字符更新，内容列表跳转至对应的索引字符\x3c\/span\x3e\nindexSidebar.on(\x3cspan class=\x22hljs-string\x22\x3e\x27charChange\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ech\x3c\/span\x3e) \x3c\/span\x3e{\n  itemList.gotoChar(ch)\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接下来，我们一步步实现。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e第 1 步：创建 IndexSidebar “类”\x3c\/h2\x3e\n\x3cp\x3e我选择采用实例化“类”的方式来创建新的组件对象，定义“类”，其实就是创建一个构造函数（当然，采用 ES6 语法会更清晰，不过考虑兼容性这里不使用）：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function IndexSidebar(options) {\n  \/\/ TODO 处理 options\n  this.initialize(options)\n}\n\nIndexSidebar.prototype.initialize = function (options) {\n  \/\/ TODO 初始化\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eIndexSidebar\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eoptions\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ TODO 处理 options\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.initialize(options)\n}\n\nIndexSidebar.prototype.initialize = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eoptions\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ TODO 初始化\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里借鉴 Backbone 的模式，将组件初始化的逻辑单独写在一个 \x3ccode\x3einitialize()\x3c\/code\x3e 方法中，当然逻辑也可以都写在构造函数中。\x3c\/p\x3e\n\x3cp\x3e在实现具体的功能前，我们可以先让前面设计的代码跑起来，首先补全导航组件的接口方法，支持监听事件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 特定事件触发时，调用传入的回调函数并传入事件数据\nIndexSidebar.prototype.on = function (event, callback) {\n  \/\/ TODO 实现事件监听\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 特定事件触发时，调用传入的回调函数并传入事件数据\x3c\/span\x3e\nIndexSidebar.prototype.on = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent, callback\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ TODO 实现事件监听\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里选择采用事件模式（或者说观察者模式吧），这样可以有多个“观察者”，为了完整，同样借鉴已有的模式实现，我们补全其他会用到的事件接口方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 触发特定事件，并给出事件数据供监听的回调函数使用\nIndexSidebar.prototype.trigger = function (event, data) {\n  \/\/ TODO\n}\n\n\/\/ 解除事件监听\nIndexSidebar.prototype.off = function (event, callback) {\n  \/\/ TODO\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 触发特定事件，并给出事件数据供监听的回调函数使用\x3c\/span\x3e\nIndexSidebar.prototype.trigger = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent, data\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ TODO\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 解除事件监听\x3c\/span\x3e\nIndexSidebar.prototype.off = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent, callback\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ TODO\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接着来搭个列表组件的架子，同样是类的模式，不过简单点，毕竟主要是为了实现索引导航栏组件，列表组件只是辅助：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 内容列表组件\nfunction ItemList(data) {\n  return {\n    gotoChar: function (ch) {\n      \/\/ TODO 实现按索引字符跳转功能\n    }\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 内容列表组件\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eItemList\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3egotoChar\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ech\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ TODO 实现按索引字符跳转功能\x3c\/span\x3e\n    }\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里偷懒了，虽然兼容 \x3ccode\x3enew ItemList(data)\x3c\/code\x3e 的用法，但其实并没有按照“类”的模式实现。\x3c\/p\x3e\n\x3cp\x3e好了，有了上面的这些代码，前面的设计应该可以运行了....虽然现在没什么用。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e第 2 步：实现手指拖动更新索引字母\x3c\/h2\x3e\n\x3cp\x3e我们首先解决导航组件最重要的交互功能，也就是手指拖动的动作处理。由于之前没做过触摸的功能，我只好先查下相关的事件用法（当然，尽管没用过，还是知道有相关的事件）：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/Touch_events\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eTouch events - MDN\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/Events\/touchstart\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etouchstart - MDN\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/Events\/touchmove\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etouchmove - MDN\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/Events\/touchend\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etouchend - MDN\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e看了上面这些文档，我发现 touch 相关的事件还有个特殊的事件数据，对应的是手指触摸屏幕的位置：\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/Touch\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eTouch - MDN\x3c\/a\x3e，显然这个数据是会用到的。\x3c\/p\x3e\n\x3cp\x3e之前做 PC 页面的时候，也做过类似的鼠标拖动的处理，使用到的浏览器事件主要是：mousedown, mousemove, mouseup。大致的处理逻辑是：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e鼠标按下（mousedown）时，记录拖动开始\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e鼠标移动（mousemove）时，如果拖动开始，则根据鼠标位置更新并计算相关数据\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e鼠标松开（mouseup）时，记录拖动结束\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这个逻辑也可以用在手指触摸的拖动上。注意一个小细节，手指在屏幕上触摸时，可能同时有多个位置，所以触摸事件的位置相关数据是一个列表：\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/TouchList\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eTouchList - MDN\x3c\/a\x3e。不过我这里不关心，只取列表中的第一个位置数据使用。\x3c\/p\x3e\n\x3cp\x3e这一部分的代码逻辑实现为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22IndexSidebar.prototype.initEvents = function (options) {\n  var el = this.el \/\/ el 对应导航栏容器元素，初始化过程略\n  var touching = false\n\n  el.addEventListener(\x27touchstart\x27, function (e) {\n    if (!touching) {\n      \/\/ 取消缺省行为，否则在 iOS 环境中会出现页面上下抖动\n      e.preventDefault()\n      var t = e.touches[0]\n      start(t.clientX, t.clientY)\n    }\n  }, false)\n\n  \/\/ 拖动过程中手指可能会移出导航栏，所以是在 document 上监听\n  \/\/ 不过貌似在 el 上监听也可以，这个暂不讨论了\n  \/\/ 后面的 touchend 也是类似的缘故\n  document.addEventListener(\x27touchmove\x27, function handler(e) {\n    if (touching) {\n      e.preventDefault()\n      var t = e.touches[0]\n      move(t.clientX, t.clientY)\n    }\n  }, false)\n\n  document.addEventListener(\x27touchend\x27, function (e) {\n    if (touching) {\n      e.preventDefault()\n      end()\n    }\n  }, false)\n\n  \/\/ TODO 实现索引字符的更新\n  function start(clientX, clientY) {}\n  function move(clientX, clientY) {}\n  function end() {}\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eIndexSidebar.prototype.initEvents = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eoptions\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e el = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.el \x3cspan class=\x22hljs-comment\x22\x3e\/\/ el 对应导航栏容器元素，初始化过程略\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e touching = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n\n  el.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27touchstart\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!touching) {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 取消缺省行为，否则在 iOS 环境中会出现页面上下抖动\x3c\/span\x3e\n      e.preventDefault()\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e t = e.touches[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]\n      start(t.clientX, t.clientY)\n    }\n  }, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拖动过程中手指可能会移出导航栏，所以是在 document 上监听\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 不过貌似在 el 上监听也可以，这个暂不讨论了\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 后面的 touchend 也是类似的缘故\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27touchmove\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ehandler\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touching) {\n      e.preventDefault()\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e t = e.touches[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]\n      move(t.clientX, t.clientY)\n    }\n  }, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27touchend\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touching) {\n      e.preventDefault()\n      end()\n    }\n  }, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ TODO 实现索引字符的更新\x3c\/span\x3e\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3estart\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eclientX, clientY\x3c\/span\x3e) \x3c\/span\x3e{}\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emove\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eclientX, clientY\x3c\/span\x3e) \x3c\/span\x3e{}\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eend\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e之所以抽出 \x3ccode\x3estart()\x3c\/code\x3e, \x3ccode\x3emove()\x3c\/code\x3e, \x3ccode\x3eend()\x3c\/code\x3e 三个函数，是为了在 PC 浏览器器上支持鼠标的拖动，这样监听鼠标拖动相关事件时，也能使用这里的逻辑。\x3c\/p\x3e\n\x3cp\x3e怎么计算手指触摸位置的字符呢？这个我想大家应该都能想到，我这里采用的是比较笨的方法，就是根据触摸位置计算索引导航栏中的距离最近的字符，大致过程为：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e已知手指相对屏幕（其实是视口，这里不区分了）位置（clientX, clientY）和索引字符数组（chars）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e获取索引导航组件距屏幕顶部的距离（boxClientTop）和自身的高度（boxHeight）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e计算得到手指位置在组件内部的相对高度（offsetY）：\x3ccode\x3eoffsetY = clientY - boxClientTop\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e根据手指位置的相对高度与组件高度的比例，从索引字符数组中取出对应位置的字符（略，这个不难算）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这里就不贴代码了，都是一些琐碎的计算，还要额外考虑手指位置在竖直方向上超出导航栏范围的情况。\x3c\/p\x3e\n\x3cp\x3e经过以上计算，可以得到一个索引字符 \x3ccode\x3ech\x3c\/code\x3e，接下来要做的就是通知“观察者”们，字符更新了（如果和上一个索引字符不同的话）：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22this.trigger(\x27charChange\x27, ch)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27charChange\x27\x3c\/span\x3e, ch)\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e第 3 步：实现组件事件接口\x3c\/h2\x3e\n\x3cp\x3e这个其实可以不必多写，类似的实现有很多。不过为了不依赖其他库，我选择自己实现。我就直接贴自己实现的版本了：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/* Event Emitter API *\/\n\nIndexSidebar.prototype.trigger = function (event, data) {\n  var listeners = this._listeners \x26amp;\x26amp; this._listeners[event]\n  if (listeners) {\n    listeners.forEach(function (listener) {\n      listener(data)\n    })\n  }\n}\n\nIndexSidebar.prototype.on = function (event, callback) {\n  this._listeners = this._listeners || {}\n  var listeners = this._listeners[event] || (this._listeners[event] = [])\n  listeners.push(callback)\n}\n\nIndexSidebar.prototype.off = function (event, callback) {\n  var listeners = this._listeners \x26amp;\x26amp; this._listeners[event]\n  if (listeners) {\n    var i = listeners.indexOf(callback)\n    if (i \x3e -1) {\n      listeners.splice(i, 1)\n      if (listeners.length === 0) {\n        this._listeners[event] = null\n      }\n    }\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/* Event Emitter API *\/\x3c\/span\x3e\n\nIndexSidebar.prototype.trigger = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent, data\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e listeners = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._listeners \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._listeners[event]\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (listeners) {\n    listeners.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3elistener\x3c\/span\x3e) \x3c\/span\x3e{\n      listener(data)\n    })\n  }\n}\n\nIndexSidebar.prototype.on = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent, callback\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._listeners = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._listeners || {}\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e listeners = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._listeners[event] || (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._listeners[event] = [])\n  listeners.push(callback)\n}\n\nIndexSidebar.prototype.off = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent, callback\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e listeners = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._listeners \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._listeners[event]\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (listeners) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = listeners.indexOf(callback)\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (i \x26gt; \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e) {\n      listeners.splice(i, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (listeners.length === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._listeners[event] = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n      }\n    }\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e使用对象属性 \x3ccode\x3e_listeners\x3c\/code\x3e 来记录事件监听函数，当然这里可以只实现成单个数组，不必搞得这么复杂。不过为了可能的组件扩展的需要，还是这么实现了，这样如果还需要支持其他类型的事件，例如对外暴露触摸开始事件“touchStarted”，事件接口这里就不需要修改了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e第 4 步：实现内容列表跳转至索引字符\x3c\/h2\x3e\n\x3cp\x3e到这里其实索引导航栏组件的开发已经结束，不过毕竟看不到效果嘛，所以就实现了简单的内容列表组件，从而可以对导航栏组件进行测试。\x3c\/p\x3e\n\x3cp\x3e内容列表组件在创建时，传入了数据，根据这些数据渲染出列表，并且在渲染的过程中记录索引，从而在输出的 HTML 结构上做出标记，以便查找并跳转：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 内容列表组件\nfunction ItemList(data) {\n  var list = []\n  var map = {}\n  var html\n\n  html = data.map(function (item) {\n    \/\/ 数组中每项为 \x26quot;Angola 安哥拉\x26quot; 的形式，且已排序\n    var i = item.lastIndexOf(\x27 \x27)\n    var en = item.slice(0, i)\n    var cn = item.slice(i \x2b 1)\n    var ch = en[0]\n    if (map[ch]) {\n      return \x27\x3cli\x3e\x27 \x2b en \x2b \x27\x3cbr\x3e\x27 \x2b cn \x2b \x27\x3c\/li\x3e\x27\n    } else {\n      \/\/ 同一索引字符首次出现时，在 HTML 上标记\n      map[ch] = true\n      return \x27\x3cli data-ch=\x26quot;\x27 \x2b ch \x2b \x27\x26quot;\x3e\x27 \x2b en \x2b \x27\x3cbr\x3e\x27 \x2b cn \x2b \x27\x3c\/li\x3e\x27\n    }\n  }).join(\x27\x27)\n\n  var elItemList = document.querySelector(\x27#item-container ul\x27)\n  elItemList.innerHTML = html\n\n  return {\n    gotoChar: function (ch) {\n      \/\/ TODO 实现按索引字符跳转功能\n    }\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 内容列表组件\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eItemList\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e list = []\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e map = {}\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e html\n\n  html = data.map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 数组中每项为 \x22Angola 安哥拉\x22 的形式，且已排序\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = item.lastIndexOf(\x3cspan class=\x22hljs-string\x22\x3e\x27 \x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e en = item.slice(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, i)\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cn = item.slice(i \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ch = en[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (map[ch]) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;li\x26gt;\x27\x3c\/span\x3e \x2b en \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;br\x26gt;\x27\x3c\/span\x3e \x2b cn \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/li\x26gt;\x27\x3c\/span\x3e\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 同一索引字符首次出现时，在 HTML 上标记\x3c\/span\x3e\n      map[ch] = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;li data-ch=\x22\x27\x3c\/span\x3e \x2b ch \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x22\x26gt;\x27\x3c\/span\x3e \x2b en \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;br\x26gt;\x27\x3c\/span\x3e \x2b cn \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/li\x26gt;\x27\x3c\/span\x3e\n    }\n  }).join(\x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e)\n\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e elItemList = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27#item-container ul\x27\x3c\/span\x3e)\n  elItemList.innerHTML = html\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3egotoChar\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ech\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ TODO 实现按索引字符跳转功能\x3c\/span\x3e\n    }\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e由于已在 HTML 结构上标记了索引字符，所以 gotoChar 的逻辑其实就是找带有标记的元素，然后让其移动滚动到组件顶部显示：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  return {\n    gotoChar: function (ch) {\n      if (ch === \x27*\x27) {\n        \/\/ 滚动至顶部\n        elItemList.scrollTop = 0\n      } else if (ch === \x27#\x27) {\n        \/\/ 滚动至底部\n        elItemList.scrollTop = elItemList.scrollHeight\n      } else {\n        \/\/ 滚动至特定索引字符处\n        var target = elItemList.querySelector(\x27[data-ch=\x26quot;\x27 \x2b ch \x2b \x27\x26quot;]\x27)\n        if (target) {\n          target.scrollIntoView()\n        }\n      }\n    }\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3egotoChar\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ech\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ch === \x3cspan class=\x22hljs-string\x22\x3e\x27*\x27\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 滚动至顶部\x3c\/span\x3e\n        elItemList.scrollTop = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ch === \x3cspan class=\x22hljs-string\x22\x3e\x27#\x27\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 滚动至底部\x3c\/span\x3e\n        elItemList.scrollTop = elItemList.scrollHeight\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 滚动至特定索引字符处\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e target = elItemList.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27[data-ch=\x22\x27\x3c\/span\x3e \x2b ch \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x22]\x27\x3c\/span\x3e)\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (target) {\n          target.scrollIntoView()\n        }\n      }\n    }\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eOK，以上就是所有的逻辑了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e第 5 步：完善索引导航组件\x3c\/h2\x3e\n\x3cp\x3e其实基本功能已经实现，不过既然是想作为开源组件发布，还是再“包装”下，主要做了以下几方面的完善：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e支持根据屏幕高度调整导航栏的高度\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e计算屏幕高度，和组件距离屏幕顶部和底部的距离，将索引字符平均分布。\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e支持组件配置选项，并提供缺省选项\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e由于不想依赖其他库，且考虑兼容性（不能使用 Object.assign），所以自己实现了：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var defaultOptions = {\n  chars: \x27*ABCDEFGHIJKLMNOPQRSTUVWXYZ#\x27,\n  isAdjust: true, \/\/ 是否需要自动调整导航栏高度\n  offsetTop: 70,\n  offsetBottom: 10,\n  lineScale: 0.7,\n  charOffsetX: 80,\n  charOffsetY: 20\n}\n\nfunction IndexSidebar(options) {\n  options = options || {}\n\n  \/\/ 遍历缺省选项逐一处理\n  for (var k in defaultOptions) {\n    if (defaultOptions.hasOwnProperty(k)) {\n      \/\/ 未给出选项值时使用缺省选项值\n      options[k] = options[k] || defaultOptions[k]\n    }\n  }\n\n  this.options = options\n  this.initialize(options)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e defaultOptions = {\n  \x3cspan class=\x22hljs-attr\x22\x3echars\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27*ABCDEFGHIJKLMNOPQRSTUVWXYZ#\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eisAdjust\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 是否需要自动调整导航栏高度\x3c\/span\x3e\n  offsetTop: \x3cspan class=\x22hljs-number\x22\x3e70\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eoffsetBottom\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3elineScale\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e0.7\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3echarOffsetX\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e80\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3echarOffsetY\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eIndexSidebar\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eoptions\x3c\/span\x3e) \x3c\/span\x3e{\n  options = options || {}\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 遍历缺省选项逐一处理\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e k \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e defaultOptions) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (defaultOptions.hasOwnProperty(k)) {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 未给出选项值时使用缺省选项值\x3c\/span\x3e\n      options[k] = options[k] || defaultOptions[k]\n    }\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.options = options\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.initialize(options)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e支持不同的方式引用组件\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e这个和一般的模块差不多，不过额外支持了一下 SeaJS（define.cmd）：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(function (factory) {\n\n  if (typeof module === \x27object\x27 \x26amp;\x26amp; module.export) {\n    module.export = factory()\n  } else if (typeof define === \x27function\x27 \x26amp;\x26amp; (define.amd || define.cmd)) {\n    define([], factory)\n  } else if (typeof window !== \x27undefined\x27) {\n    window.IndexSidebar = factory()\n  }\n\n})(function () {\n  \/\/ ...\n  return IndexSidebar\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3efactory\x3c\/span\x3e) \x3c\/span\x3e{\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.export) {\n    \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.export = factory()\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e define === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e \x26amp;\x26amp; (define.amd || define.cmd)) {\n    define([], factory)\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e !== \x3cspan class=\x22hljs-string\x22\x3e\x27undefined\x27\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.IndexSidebar = factory()\n  }\n\n})(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e IndexSidebar\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e从看到这个需求，到查文档、设计、实现，以及作为开源工具发布，用了大概不到 1 天的时间。希望可以有同学能够从我的这个过程中收获一些东西吧。\x3c\/p\x3e\n\x3cp\x3e当然，也欢迎提出意见、建议，更欢迎参与完善这个组件：\x3cbr\x3e\x3ca href=\x22https:\/\/github.com\/luobotang\/index-sidebar\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/luobotang\/...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e最后，特别欢迎使用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm i index-sidebar\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3enpm \x3cspan class=\x22hljs-selector-tag\x22\x3ei\x3c\/span\x3e index-sidebar\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e感谢阅读！\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>一步一步实现字母索引导航栏</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007692244">https://segmentfault.com/a/1190000007692244</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/rd30jrzoprj/" target="_blank">https://alili.tech/archive/rd30jrzoprj/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>