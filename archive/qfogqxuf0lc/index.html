<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Underscore 整体架构浅析"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Underscore 整体架构浅析 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/qfogqxuf0lc/",
				"appid": "1613049289050283", 
				"title": "Underscore 整体架构浅析 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-01T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/1zha7guy0am/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/34tmp4xbhq2/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fqfogqxuf0lc%2f&text=Underscore%20%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84%e6%b5%85%e6%9e%90"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fqfogqxuf0lc%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fqfogqxuf0lc%2f&text=Underscore%20%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84%e6%b5%85%e6%9e%90"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fqfogqxuf0lc%2f&title=Underscore%20%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84%e6%b5%85%e6%9e%90"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fqfogqxuf0lc%2f&is_video=false&description=Underscore%20%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84%e6%b5%85%e6%9e%90"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Underscore%20%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84%e6%b5%85%e6%9e%90&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fqfogqxuf0lc%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fqfogqxuf0lc%2f&title=Underscore%20%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84%e6%b5%85%e6%9e%90"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqfogqxuf0lc%2f&title=Underscore%20%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84%e6%b5%85%e6%9e%90"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqfogqxuf0lc%2f&title=Underscore%20%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84%e6%b5%85%e6%9e%90"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqfogqxuf0lc%2f&title=Underscore%20%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84%e6%b5%85%e6%9e%90"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Underscore 整体架构浅析</h1><div class="meta"><div class="postdate"><time datetime="2019-02-01" itemprop="datePublished">2019-02-01</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e前言\x3c\/h1\x3e\n\x3cp\x3e终于，楼主的「Underscore 源码解读系列」\x3ca href=\x22https:\/\/github.com\/hanzichi\/underscore-analysis\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eunderscore-analysis\x3c\/a\x3e 即将进入尾声，关注下 \x3ca href=\x22https:\/\/github.com\/hanzichi\/underscore-analysis#articles\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etimeline\x3c\/a\x3e 会发现楼主最近加快了解读速度。十一月，多事之秋，最近好多事情搞的楼主心力憔悴，身心俱疲，也想尽快把这个系列完结掉，也好了却一件心事。\x3c\/p\x3e\n\x3cp\x3e本文预计是解读系列的倒数第二篇，最后一篇那么显然就是大总结了。楼主的 Underscore 系列解读完整版地址 \x3ca href=\x22https:\/\/github.com\/hanzichi\/underscore-analysis\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/hanzichi\/u...\x3c\/a\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e常规调用\x3c\/h1\x3e\n\x3cp\x3e之前写的文章，关注点大多在具体的方法，具体的知识细节，也有读者留言建议楼主讲讲整体架构，这是必须会讲的，只是楼主把它安排在了最后，也就是本文，因为楼主觉得不掌握整体架构对于具体方法的理解也是没有大的问题的。\x3c\/p\x3e\n\x3cp\x3eUnderscore 大多数时候的调用形式为 \x3ccode\x3e_.funcName(xx, xx)\x3c\/code\x3e，这也是 \x3ca href=\x22http:\/\/underscorejs.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e文档中\x3c\/a\x3e 的调用方式。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22_.each([1, 2, 3], alert);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e_.each([\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e], alert);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最简单的实现方式，我们可以把 \x3ccode\x3e_\x3c\/code\x3e 看做一个简单的对象：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var _ = {};\n_.each = function() {\n  \/\/ ...\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _ = {};\n_.each = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在 JavaScript 中，\x3cstrong\x3e一切皆对象\x3c\/strong\x3e，实际上，源码中的 \x3ccode\x3e_\x3c\/code\x3e 变量是一个方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var _ = function(obj) {\n  if (obj instanceof _) return obj;\n  if (!(this instanceof _)) return new _(obj);\n  this._wrapped = obj;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _ = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (obj \x3cspan class=\x22hljs-keyword\x22\x3einstanceof\x3c\/span\x3e _) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e obj;\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3einstanceof\x3c\/span\x3e _)) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e _(obj);\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._wrapped = obj;\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e为什么会是方法？我们接下去看。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3eOOP\x3c\/h1\x3e\n\x3cp\x3eUnderscore 支持 OOP 形式的调用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22_([1, 2, 3]).each(alert);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e_([\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e]).each(alert);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这其实是非常经典的「无 new 构造」，\x3ccode\x3e_\x3c\/code\x3e 其实就是一个 \x3cstrong\x3e构造函数\x3c\/strong\x3e，\x3ccode\x3e_([1, 2, 3])\x3c\/code\x3e 的结果就是一个对象实例，该实例有个 \x3ccode\x3e_wrapped\x3c\/code\x3e 属性，属性值是 \x3ccode\x3e[1, 2, 3]\x3c\/code\x3e。实例要调用 \x3ccode\x3eeach\x3c\/code\x3e 方法，其本身没有这个方法，那么应该来自原型链，也就是说 \x3ccode\x3e_.prototype\x3c\/code\x3e 上应该有这个方法，那么，方法是如何挂载上去的呢？\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3e方法挂载\x3c\/h1\x3e\n\x3cp\x3e现在我们已经明确以下两点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e_\x3c\/code\x3e 是一个函数（支持无 new 调用的构造函数）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e_\x3c\/code\x3e 的属性有很多方法，比如 \x3ccode\x3e_.each\x3c\/code\x3e，\x3ccode\x3e_.template\x3c\/code\x3e 等等\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e\x3cstrong\x3e我们的目标是让 \x3ccode\x3e_\x3c\/code\x3e 的构造实例也能调用这些方法\x3c\/strong\x3e。仔细想想，其实也不难，我们可以遍历 \x3ccode\x3e_\x3c\/code\x3e 上的属性，如果属性值类型是函数，那么就将函数挂到 \x3ccode\x3e_\x3c\/code\x3e 的原型链上去。\x3c\/p\x3e\n\x3cp\x3e源码中用来完成这件事的是 \x3ccode\x3e_.mixin\x3c\/code\x3e 方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Add your own custom functions to the Underscore object.\n\/\/ 可向 underscore 函数库扩展自己的方法\n\/\/ obj 参数必须是一个对象（JavaScript 中一切皆对象）\n\/\/ 且自己的方法定义在 obj 的属性上\n\/\/ 如 obj.myFunc = function() {...}\n\/\/ 形如 {myFunc: function(){\x22}}\x22\n\/\/ 之后便可使用如下: _.myFunc(..) 或者 OOP _(..).myFunc(..)\n_.mixin = function(obj) {\n  \/\/ 遍历 obj 的 key，将方法挂载到 Underscore 上\n  \/\/ 其实是将方法浅拷贝到 _.prototype 上\n  _.each(_.functions(obj), function(name) {\n    \/\/ 直接把方法挂载到 _[name] 上\n    \/\/ 调用类似 _.myFunc([1, 2, 3], ..)\n    var func = _[name] = obj[name];\n\n    \/\/ 浅拷贝\n    \/\/ 将 name 方法挂载到 _ 对象的原型链上，使之能 OOP 调用\n    _.prototype[name] = function() {\n      \/\/ 第一个参数\n      var args = [this._wrapped];\n\n      \/\/ arguments 为 name 方法需要的其他参数\n      push.apply(args, arguments);\n      \/\/ 执行 func 方法\n      \/\/ 支持链式操作\n      return result(this, func.apply(_, args));\n    };\n  });\n};\n\n\/\/ Add all of the Underscore functions to the wrapper object.\n\/\/ 将前面定义的 underscore 方法添加给包装过的对象\n\/\/ 即添加到 _.prototype 中\n\/\/ 使 underscore 支持面向对象形式的调用\n_.mixin(_);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Add your own custom functions to the Underscore object.\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 可向 underscore 函数库扩展自己的方法\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ obj 参数必须是一个对象（JavaScript 中一切皆对象）\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 且自己的方法定义在 obj 的属性上\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如 obj.myFunc = function() {...}\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 形如 {myFunc: function(){\x22}}\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 之后便可使用如下: _.myFunc(..) 或者 OOP _(..).myFunc(..)\x3c\/span\x3e\n_.mixin = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 遍历 obj 的 key，将方法挂载到 Underscore 上\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 其实是将方法浅拷贝到 _.prototype 上\x3c\/span\x3e\n  _.each(_.functions(obj), \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ename\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 直接把方法挂载到 _[name] 上\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调用类似 _.myFunc([1, 2, 3], ..)\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e func = _[name] = obj[name];\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 浅拷贝\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将 name 方法挂载到 _ 对象的原型链上，使之能 OOP 调用\x3c\/span\x3e\n    _.prototype[name] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 第一个参数\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e args = [\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._wrapped];\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ arguments 为 name 方法需要的其他参数\x3c\/span\x3e\n      push.apply(args, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 执行 func 方法\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 支持链式操作\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e result(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, func.apply(_, args));\n    };\n  });\n};\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Add all of the Underscore functions to the wrapper object.\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将前面定义的 underscore 方法添加给包装过的对象\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 即添加到 _.prototype 中\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 使 underscore 支持面向对象形式的调用\x3c\/span\x3e\n_.mixin(_);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/underscorejs.org\/#mixin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e_.mixin\x3c\/a\x3e 方法可以向 Underscore 库增加自己定义的方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22_.mixin({\n  capitalize: function(string) {\n    return string.charAt(0).toUpperCase() \x2b string.substring(1).toLowerCase();\n  }\n});\n_(\x26quot;fabio\x26quot;).capitalize();\n=\x3e \x26quot;Fabio\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e_.mixin({\n  \x3cspan class=\x22hljs-attr\x22\x3ecapitalize\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3estring\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e string.charAt(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e).toUpperCase() \x2b string.substring(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e).toLowerCase();\n  }\n});\n_(\x3cspan class=\x22hljs-string\x22\x3e\x22fabio\x22\x3c\/span\x3e).capitalize();\n=\x26gt; \x3cspan class=\x22hljs-string\x22\x3e\x22Fabio\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e同时，Underscore 也加入了一些 Array 原生的方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Add all mutator Array functions to the wrapper.\n\/\/ 将 Array 原型链上有的方法都添加到 underscore 中\n_.each([\x27pop\x27, \x27push\x27, \x27reverse\x27, \x27shift\x27, \x27sort\x27, \x27splice\x27, \x27unshift\x27], function(name) {\n  var method = ArrayProto[name];\n  _.prototype[name] = function() {\n    var obj = this._wrapped;\n    method.apply(obj, arguments);\n\n    if ((name === \x27shift\x27 || name === \x27splice\x27) \x26amp;\x26amp; obj.length === 0)\n      delete obj[0];\n\n    \/\/ 支持链式操作\n    return result(this, obj);\n  };\n});\n\n\/\/ Add all accessor Array functions to the wrapper.\n\/\/ 添加 concat、join、slice 等数组原生方法给 Underscore\n_.each([\x27concat\x27, \x27join\x27, \x27slice\x27], function(name) {\n  var method = ArrayProto[name];\n  _.prototype[name] = function() {\n    return result(this, method.apply(this._wrapped, arguments));\n  };\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Add all mutator Array functions to the wrapper.\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将 Array 原型链上有的方法都添加到 underscore 中\x3c\/span\x3e\n_.each([\x3cspan class=\x22hljs-string\x22\x3e\x27pop\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27push\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27reverse\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27shift\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27sort\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27splice\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27unshift\x27\x3c\/span\x3e], \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ename\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e method = ArrayProto[name];\n  _.prototype[name] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e obj = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._wrapped;\n    method.apply(obj, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ((name === \x3cspan class=\x22hljs-string\x22\x3e\x27shift\x27\x3c\/span\x3e || name === \x3cspan class=\x22hljs-string\x22\x3e\x27splice\x27\x3c\/span\x3e) \x26amp;\x26amp; obj.length === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n      \x3cspan class=\x22hljs-keyword\x22\x3edelete\x3c\/span\x3e obj[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 支持链式操作\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e result(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, obj);\n  };\n});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Add all accessor Array functions to the wrapper.\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加 concat、join、slice 等数组原生方法给 Underscore\x3c\/span\x3e\n_.each([\x3cspan class=\x22hljs-string\x22\x3e\x27concat\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27join\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27slice\x27\x3c\/span\x3e], \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ename\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e method = ArrayProto[name];\n  _.prototype[name] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e result(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, method.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._wrapped, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e));\n  };\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader4\x22\x3e链式调用\x3c\/h1\x3e\n\x3cp\x3eUnderscore 也支持链式调用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 非 OOP 链式调用\n_.chain([1, 2, 3])\n  .map(function(a) {return a * 2;})\n  .reverse()\n  .value(); \/\/ [6, 4, 2]\n\n\/\/ OOP 链式调用\n_([1, 2, 3])\n  .chain()\n  .map(function(a){return a * 2;})\n  .first()\n  .value(); \/\/ 2\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 非 OOP 链式调用\x3c\/span\x3e\n_.chain([\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e])\n  .map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea\x3c\/span\x3e) \x3c\/span\x3e{\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e a * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;})\n  .reverse()\n  .value(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ [6, 4, 2]\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ OOP 链式调用\x3c\/span\x3e\n_([\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e])\n  .chain()\n  .map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e a * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;})\n  .first()\n  .value(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e乍一看似乎有 OOP 和非 OOP 两种链式调用形式，其实只是一种，\x3ccode\x3e_.chain([1, 2, 3])\x3c\/code\x3e 和 \x3ccode\x3e_([1, 2, 3]).chain()\x3c\/code\x3e 的结果是一样的。如何实现的？我们深入 \x3ccode\x3echain\x3c\/code\x3e 方法看下。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22_.chain = function(obj) {\n  \/\/ 无论是否 OOP 调用，都会转为 OOP 形式\n  \/\/ 并且给新的构造对象添加了一个 _chain 属性\n  var instance = _(obj);\n\n  \/\/ 标记是否使用链式操作\n  instance._chain = true;\n\n  \/\/ 返回 OOP 对象\n  \/\/ 可以看到该 instance 对象除了多了个 _chain 属性\n  \/\/ 其他的和直接 _(obj) 的结果一样\n  return instance;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e_.chain = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 无论是否 OOP 调用，都会转为 OOP 形式\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 并且给新的构造对象添加了一个 _chain 属性\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e instance = _(obj);\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 标记是否使用链式操作\x3c\/span\x3e\n  instance._chain = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回 OOP 对象\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 可以看到该 instance 对象除了多了个 _chain 属性\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 其他的和直接 _(obj) 的结果一样\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e instance;\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们看下 \x3ccode\x3e_.chain([1, 2, 3])\x3c\/code\x3e 的结果，将参数代入函数中，其实就是对参数进行无 new 构造，然后返回实例，只是实例多了个 \x3ccode\x3e_chain\x3c\/code\x3e 属性，其他的和直接 \x3ccode\x3e_([1, 2, 3])\x3c\/code\x3e 一模一样。再来看 \x3ccode\x3e_([1, 2, 3]).chain()\x3c\/code\x3e，\x3ccode\x3e_([1, 2, 3])\x3c\/code\x3e 返回构造实例，该实例有 \x3ccode\x3echain\x3c\/code\x3e 方法，调用方法，为实例添加 \x3ccode\x3e_chain\x3c\/code\x3e 属性，返回该实例对象。所以，这两者效果是一致的，结果都是转为了 OOP 的形式。\x3c\/p\x3e\n\x3cp\x3e说了这么多，似乎还没讲到正题上，它是如何「链」下去的？我们以如下代码为例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22_([1, 2, 3])\n  .chain()\n  .map(function(a){return a * 2;})\n  .first()\n  .value(); \/\/ 2\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e_([\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e])\n  .chain()\n  .map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e a * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;})\n  .first()\n  .value(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当调用 \x3ccode\x3emap\x3c\/code\x3e 方法的时候，实际上可能会有返回值。我们看下 \x3ccode\x3e_.mixin\x3c\/code\x3e 源码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 执行 func 方法\n\/\/ 支持链式操作\nreturn result(this, func.apply(_, args));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 执行 func 方法\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 支持链式操作\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e result(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, func.apply(_, args));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eresult\x3c\/code\x3e 是一个重要的内部帮助函数（Helper function ）：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Helper function to continue chaining intermediate results.\n\/\/ 一个帮助方法（Helper function）\nvar result = function(instance, obj) {\n  \/\/ 如果需要链式操作，则对 obj 运行 chain 方法，使得可以继续后续的链式操作\n  \/\/ 如果不需要，直接返回 obj\n  return instance._chain ? _(obj).chain() : obj;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Helper function to continue chaining intermediate results.\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 一个帮助方法（Helper function）\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e result = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3einstance, obj\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果需要链式操作，则对 obj 运行 chain 方法，使得可以继续后续的链式操作\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果不需要，直接返回 obj\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e instance._chain ? _(obj).chain() : obj;\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果需要链式操作（实例会有带有 _chain 属性），则对运算结果调用 \x3ccode\x3echain\x3c\/code\x3e 函数，使之可以继续链式调用。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3e小结\x3c\/h1\x3e\n\x3cp\x3eUnderscore 整体架构，或者说是基础实现大概就是这个样子，代码部分就讲到这了，接下去系列解读最后一篇，讲讲这段时间（几乎也是历时半年了）的一些心得体会吧，没钱的就捧个人场吧！\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Underscore 整体架构浅析</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007348258">https://segmentfault.com/a/1190000007348258</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/qfogqxuf0lc/" target="_blank">https://alili.tech/archive/qfogqxuf0lc/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>