<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="10倍性能提升：优化一个静态网站"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>10倍性能提升：优化一个静态网站 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/oj0yuf8a0be/",
				"appid": "1613049289050283", 
				"title": "10倍性能提升：优化一个静态网站 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-20T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/28gc3b9x6uu/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/3bwdghiimhw/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2foj0yuf8a0be%2f&text=10%e5%80%8d%e6%80%a7%e8%83%bd%e6%8f%90%e5%8d%87%ef%bc%9a%e4%bc%98%e5%8c%96%e4%b8%80%e4%b8%aa%e9%9d%99%e6%80%81%e7%bd%91%e7%ab%99"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2foj0yuf8a0be%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2foj0yuf8a0be%2f&text=10%e5%80%8d%e6%80%a7%e8%83%bd%e6%8f%90%e5%8d%87%ef%bc%9a%e4%bc%98%e5%8c%96%e4%b8%80%e4%b8%aa%e9%9d%99%e6%80%81%e7%bd%91%e7%ab%99"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2foj0yuf8a0be%2f&title=10%e5%80%8d%e6%80%a7%e8%83%bd%e6%8f%90%e5%8d%87%ef%bc%9a%e4%bc%98%e5%8c%96%e4%b8%80%e4%b8%aa%e9%9d%99%e6%80%81%e7%bd%91%e7%ab%99"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2foj0yuf8a0be%2f&is_video=false&description=10%e5%80%8d%e6%80%a7%e8%83%bd%e6%8f%90%e5%8d%87%ef%bc%9a%e4%bc%98%e5%8c%96%e4%b8%80%e4%b8%aa%e9%9d%99%e6%80%81%e7%bd%91%e7%ab%99"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=10%e5%80%8d%e6%80%a7%e8%83%bd%e6%8f%90%e5%8d%87%ef%bc%9a%e4%bc%98%e5%8c%96%e4%b8%80%e4%b8%aa%e9%9d%99%e6%80%81%e7%bd%91%e7%ab%99&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2foj0yuf8a0be%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2foj0yuf8a0be%2f&title=10%e5%80%8d%e6%80%a7%e8%83%bd%e6%8f%90%e5%8d%87%ef%bc%9a%e4%bc%98%e5%8c%96%e4%b8%80%e4%b8%aa%e9%9d%99%e6%80%81%e7%bd%91%e7%ab%99"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2foj0yuf8a0be%2f&title=10%e5%80%8d%e6%80%a7%e8%83%bd%e6%8f%90%e5%8d%87%ef%bc%9a%e4%bc%98%e5%8c%96%e4%b8%80%e4%b8%aa%e9%9d%99%e6%80%81%e7%bd%91%e7%ab%99"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2foj0yuf8a0be%2f&title=10%e5%80%8d%e6%80%a7%e8%83%bd%e6%8f%90%e5%8d%87%ef%bc%9a%e4%bc%98%e5%8c%96%e4%b8%80%e4%b8%aa%e9%9d%99%e6%80%81%e7%bd%91%e7%ab%99"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2foj0yuf8a0be%2f&title=10%e5%80%8d%e6%80%a7%e8%83%bd%e6%8f%90%e5%8d%87%ef%bc%9a%e4%bc%98%e5%8c%96%e4%b8%80%e4%b8%aa%e9%9d%99%e6%80%81%e7%bd%91%e7%ab%99"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">10倍性能提升：优化一个静态网站</h1><div class="meta"><div class="postdate"><time datetime="2019-01-20" itemprop="datePublished">2019-01-20</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3cp\x3e几个月前，我在国外旅行，当时想给一个朋友展示我的个人（静态）网站。我尝试导航到我的网站，但花费的时间比我预想的要长得多。这个网站基本没有动态的内容--它是有些动画和响应式设计，但内容一样。我震惊于这样的结果：6秒才完成DOMContentLoaded，8.2秒才整页下载完成。这个静态网站有50个请求，总数据大小2.9mb。我习惯了网速1GB\/s，只需从洛杉矶连接到旧金山的服务器，这使得这个怪物般的网站看起来非常快。在意大利，在每秒8mb的网速下，情况完全不同。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/cdn-images-1.medium.com\/freeze\/max\/60\/1*sxIvkkEHivt-AUTGisUgUg.png?q=20\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e这是我第一次研究网站优化。以前，我要添加一个库或者资源，就把数据放进去，并通过src=\x22\x22指向资源。我完全没有关心性能，不管是缓存或者懒加载。\x3c\/p\x3e\n\x3cp\x3e我开始寻找有相似经验的朋友。不幸的是，很多有关静态优化的文献早已过时--有些是来自2010或者2011年讨论的内容，有些前提假设已经错误，有些把那些无用的话重复了一遍又一遍。\x3c\/p\x3e\n\x3cp\x3e然而，我还是发现两处优秀的资源-- \x3ca href=\x22https:\/\/hpbn.co\x22\x3eHigh Performance Browser Networking\x3c\/a\x3e和 \x3ca href=\x22https:\/\/danluu.com\/octopress-speedup\/\x22\x3eDan Luu’s similar experience with optimizing static sites\x3c\/a\x3e。虽然我没有像Dan一样去除格式和内容，我还是让我的页面加载速度快了10倍。达到了大约五分之一秒就完成DOMContentLoaded和355ms下载完整个页面。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/cdn-images-1.medium.com\/freeze\/max\/60\/1*LljXapRoovLOfns4dty-OQ.png?q=20\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch3\x3e进程\x3c\/h3\x3e\n\x3cp\x3e第一步是对网站进行整体研究。我想要弄清楚什么花费了最多的时间，应该怎么并行请求。我使用好几种工具，从世界各处测试了我的网站，包括：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/tools.pingdom.com\/\x22\x3ehttps:\/\/tools.pingdom.com\/\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.webpagetest.org\/\x22\x3ewww.webpagetest.org\/\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/tools.keycdn.com\/speed\x22\x3ehttps:\/\/tools.keycdn.com\/speed\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/developers.google.com\/web\/tools\/lighthouse\/\x22\x3ehttps:\/\/developers.google.com\/web\/tools\/lighthouse\/\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/developers.google.com\/speed\/pagespeed\/insights\/\x22\x3ehttps:\/\/developers.google.com\/speed\/pagespeed\/insights\/\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/webspeedtest.cloudinary.com\/\x22\x3ehttps:\/\/webspeedtest.cloudinary.com\/\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e有些工具是能给出有提升作用的意见，但只有当您的静态网站只有50个请求时才能做到这一点--就像所有东西都来自一个空gif图像，这种从90s年代遗留下来却从未被使用的资源（我下载了6个字体但只用了一个）。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/cdn-images-1.medium.com\/freeze\/max\/60\/1*61ngDdpQfLqBo-I8F_tuqw.png?q=20\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e这是我网站的时间线--我在Web Archive上测试了。虽然我没有提供最原始的数据，但这个数据很像我几个月前看到的原始数据了。\x3c\/p\x3e\n\x3cp\x3e所有我能控制的一切我想要提高--从内容和通过javascript连接服务器（Nginx）的速度和DNS设置。\x3c\/p\x3e\n\x3ch3\x3e优化\x3c\/h3\x3e\n\x3ch4\x3e缩小和压缩内容\x3c\/h4\x3e\n\x3cp\x3e首先我注意到的是，不管是CSS还是JS,我都有十多个请求。这些JS请求都没有用HTTP keep-alive形式；对于不同网站，有的还是https请求。这添加了多条路线去到不同的CDN或者服务器，而且有些js文件还请求了其它资源，这就形成了上面看到阻塞联级。\x3c\/p\x3e\n\x3cp\x3e我使用\x3ca href=\x22https:\/\/webpack.js.org\/\x22\x3ewebpack\x3c\/a\x3e 去合并我的资源使其变成单一的文件。任何时候，只要内容改变，它就会自动压缩，并且让所有依赖的资源变成单一文件。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/i.embed.ly\/1\/display\/resize?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F13029040%3Fs%3D400%26v%3D4\x26amp;key=a19fcc184b9711e1b4764040d3dc5c07\x26amp;width=40\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e我尝试了几种方案。原先这个单一的bundle.js文件放在\x26lt;head\x26gt;头部，这会形成阻塞。它最终的大小是829kb，包括了每一个非图片资源（字体，css，所有库，依赖文件和js文件）。这里面最大的是font-awesome字体，在829kb中占了724kb。\x3c\/p\x3e\n\x3cp\x3e我将font awesome的字体和样式进行了处理，只留下我使用的3个字体-- fa-github, fa-envelope, and fa-code。我用 \x3ca href=\x22http:\/\/fontello.com\/\x22\x3efontello\x3c\/a\x3e ，它能让我用我需要的字体。结果文件的大小下降到94kb。\x3c\/p\x3e\n\x3cp\x3e目前网站如果只用样式表去构建，就会出错。添加一个具有阻塞性质的bundle.js文件是必要的，加载时间为118ms，比上面的要好一个数量级以上。\x3c\/p\x3e\n\x3cp\x3e还有一些额外的好处--我不再有资源指向第三方资源或者CDN，所以用户不需要：1）发送CDN请求；2）形成htpps握手；3）等待所有资源从第三方下载完成。\x3c\/p\x3e\n\x3cp\x3e尽管CDN和分布式缓存对于大型网站，分布式网站是有用，但它对我这个小的静态网站没什么用。额外的几百毫秒损失是可以接受的。\x3c\/p\x3e\n\x3ch4\x3e压缩资源\x3c\/h4\x3e\n\x3cp\x3e我加载了一个8MB大小的头部图片，然后以10％的宽度\/高度显示它。这不是缺少优化，而是对用户bandwidth的浪费。\n\x3cimg src=\x22https:\/\/cdn-images-1.medium.com\/freeze\/max\/60\/1*h79KSROW3oY6KWfQm6u5yA.png?q=20\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e我所有图片用 \x3ca href=\x22https:\/\/webspeedtest.cloudinary.com\/\x22\x3ehttps:\/\/webspeedtest.cloudinary.com\/\x3c\/a\x3e 压缩--它也提醒我转成用 \x3ca href=\x22https:\/\/developers.google.com\/speed\/webp\/\x22\x3ewebp\x3c\/a\x3e，但是我想兼容更多的网站，所以我坚持使用jpg图片。也能添加一个机制，只让那些可以支持的网站使用，但我想保持简单，添加这种抽象层的代码似乎不值得。\x3c\/p\x3e\n\x3ch4\x3e提高Web服务-- HTTP2, TLS还有更多\x3c\/h4\x3e\n\x3cp\x3e我首先做的是变成https--原先我在80端口上运行Nginx，只是从 \/var\/www\/html加载服务文件。\n\x3cimg src=\x22https:\/\/i.embed.ly\/1\/display\/resize?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F13029040%3Fs%3D400%26v%3D4\x26amp;key=a19fcc184b9711e1b4764040d3dc5c07\x26amp;width=40\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e我开始设置成https，并且将我的资源请求都从http重定向到https。我从 \x3ca href=\x22https:\/\/letsencrypt.org\/\x22\x3eLet’s Encrypt\x3c\/a\x3e（一个伟大的网站，也可注册 \x3ca href=\x22https:\/\/community.letsencrypt.org\/t\/acme-v2-and-wildcard-certificate-support-is-live\/55579\x22\x3ewildcard certificates\x3c\/a\x3e）获得我的TLS证书。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/i.embed.ly\/1\/display\/resize?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F13029040%3Fs%3D400%26v%3D4\x26amp;key=a19fcc184b9711e1b4764040d3dc5c07\x26amp;width=40\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e只需添加http2指令，Nginx就能够利用所有最新HTTP优势特性。注意，如果你想使用http2（前版本是SPDY）特性，你必须使用HTTPS。了解更多 \x3ca href=\x22https:\/\/hpbn.co\/http2\/\x22\x3ehere\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e你还可以使用_http2_push命令作用于图片images\/Headshot.jpg;。\x3c\/p\x3e\n\x3cp\x3e注意：启用gzip和TLS可能会使您面临\x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/BREACH\x22\x3eBREACH\x3c\/a\x3e的风险。基于这是一个静态网站，面临BREACH的风险非常低，压缩对我来说就不是问题。\x3c\/p\x3e\n\x3ch4\x3e利用缓存和压缩\x3c\/h4\x3e\n\x3cp\x3e还有什么是Nginx就可以完成的？第一个蹦出来的想法是缓存和压缩\x3c\/p\x3e\n\x3cp\x3e我发送的是原始没有压缩的HTML的文件。只要单单添加 _gzip和_line命令，文件的大小从16000bytes变成8000bytes，下降了百分之五十。\x3c\/p\x3e\n\x3cp\x3e我们还可以进一步提高速度，如果我们设置了 _gzip_static，它会去寻找以前压缩的版本。当与我们上面的webpack配置结合在一起--我们能在编译时使用\x3ca href=\x22https:\/\/github.com\/webpack-contrib\/zopfli-webpack-plugin\x22\x3eZopflicPlugin\x3c\/a\x3e去预压缩我们所有的文件。这样就节省了计算资源，能让我们不用考虑速度去最大限度压缩我们的资源。\x3c\/p\x3e\n\x3cp\x3e不仅如此，我的网站很少发生变化，所以我希望资源尽可能长时间被缓存。这样的话，在以后的访问中，用户就不需要重新下载所有内容（特别是 bundle.js）。\x3c\/p\x3e\n\x3cp\x3e我更新完的服务器备注是这样的。注意，我并没有讲解所有我做的改变，比如TCP设置的变化，gzip指令和文件缓存。如果你想了解更多这些内容，\x3ca href=\x22https:\/\/www.nginx.com\/blog\/tuning-nginx\/\x22\x3eread this article on tuning Nginx.\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/i.embed.ly\/1\/display\/resize?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F13029040%3Fs%3D400%26v%3D4\x26amp;key=a19fcc184b9711e1b4764040d3dc5c07\x26amp;width=40\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e相应的服务器内容\n\x3cimg src=\x22https:\/\/i.embed.ly\/1\/display\/resize?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F13029040%3Fs%3D400%26v%3D4\x26amp;key=a19fcc184b9711e1b4764040d3dc5c07\x26amp;width=40\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch3\x3e懒加载\x3c\/h3\x3e\n\x3cp\x3e最后我网站还有一个小变化，速度会有稍许提升。有5张图片是看不见的，除非你按下相关的标签，但这些图片还是跟其他资源同时下载（因为\x3cimg src=\x22\x22\x3e这个标签）\x3c\/p\x3e\n\x3cp\x3e我写了一个简短的脚本去修改那些拥有\x3cem\x3elazyload\x3c\/em\x3e名称的元素的属性。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/i.embed.ly\/1\/display\/resize?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F13029040%3Fs%3D400%26v%3D4\x26amp;key=a19fcc184b9711e1b4764040d3dc5c07\x26amp;width=40\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e所以一旦内容完成加载完成，\x3cimg\x3e标签就会变成\x3cimg src=\x22\x22\x3e，这样才加载这些图片。\x3c\/p\x3e\n\x3ch3\x3e总结\x3c\/h3\x3e\n\x3cp\x3e这些使我页面第一次加载从超过8秒到小于350毫米，非第一次加载更是达到200毫秒。我强烈推荐阅读\x3ca href=\x22https:\/\/hpbn.co\/#toc\x22\x3eHigh Performance Browser Networking\x3c\/a\x3e --它能很容易读完，却提供了现代网站的概况，对现在网络模型的每一层都给出了很好优化建议。\x3c\/p\x3e\n\x3cp\x3e我有哪些遗漏了吗？是否一些方法违反了最佳实践或者有更好的提高性能的方法？请联系_\x3ca href=\x22https:\/\/medium.com\/@jonluca\x22\x3e\x3cem\x3eJonLuca De Caro\x3c\/em\x3e\x3c\/a\x3e_!_\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/goo.gl\/w4Pbea\x22\x3e\n\x3cimg src=\x22https:\/\/cdn-images-1.medium.com\/freeze\/max\/60\/1*PZjwR1Nbluff5IMI6Y1T6g@2x.png?q=20\x22 alt=\x22\x22\x3e\n\x3c\/a\x3e\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>10倍性能提升：优化一个静态网站</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/10x-performance-increases-optimizing-a-static-site">https://www.zcfy.cc/article/10x-performance-increases-optimizing-a-static-site</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/oj0yuf8a0be/" target="_blank">https://alili.tech/archive/oj0yuf8a0be/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>