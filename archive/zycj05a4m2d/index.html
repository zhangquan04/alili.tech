<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="同源策略和跨域"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>同源策略和跨域 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/zycj05a4m2d/",
				"appid": "1613049289050283", 
				"title": "同源策略和跨域 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-01T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/yxoqi8usq1c/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/zeqmdce19g/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fzycj05a4m2d%2f&text=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e5%92%8c%e8%b7%a8%e5%9f%9f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fzycj05a4m2d%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fzycj05a4m2d%2f&text=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e5%92%8c%e8%b7%a8%e5%9f%9f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fzycj05a4m2d%2f&title=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e5%92%8c%e8%b7%a8%e5%9f%9f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fzycj05a4m2d%2f&is_video=false&description=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e5%92%8c%e8%b7%a8%e5%9f%9f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e5%92%8c%e8%b7%a8%e5%9f%9f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fzycj05a4m2d%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fzycj05a4m2d%2f&title=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e5%92%8c%e8%b7%a8%e5%9f%9f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fzycj05a4m2d%2f&title=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e5%92%8c%e8%b7%a8%e5%9f%9f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fzycj05a4m2d%2f&title=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e5%92%8c%e8%b7%a8%e5%9f%9f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fzycj05a4m2d%2f&title=%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5%e5%92%8c%e8%b7%a8%e5%9f%9f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">同源策略和跨域</h1><div class="meta"><div class="postdate"><time datetime="2019-02-01" itemprop="datePublished">2019-02-01</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e在前端开发的过程中，我们经常遇到\x22跨域\x22的问题，以下的文章将列举一下我在工作中碰到的跨域问题。\x3cbr\x3e以及稍稍的探讨一下为什么会有\x22跨域\x22问题的出现，和所谓的\x22同源策略\x22\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3e同源策略\x3c\/h1\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e1. 历史\x3c\/h2\x3e\n\x3cp\x3e1995 年由 \x3ccode\x3eNetscape\x3c\/code\x3e 公司提出，之后被其他浏览器厂商采纳。\x3c\/p\x3e\n\x3cp\x3e同源策略只是一个规范，并没有指定其具体的使用范围和实现方式，各个浏览器厂商都针对同源策略做了自己的实现。\x3c\/p\x3e\n\x3cp\x3e一些 web 技术都默认采取了同源策略，这些技术范围包括但不限于\x3ccode\x3eSilverlight\x3c\/code\x3e, \x3ccode\x3eAdobe  Flash\x3c\/code\x3e, \x3ccode\x3eAdobe Acrobat\x3c\/code\x3e, \x3ccode\x3eDom\x3c\/code\x3e, \x3ccode\x3eXMLHttpRequest\x3c\/code\x3e。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e2. 定义\x3c\/h2\x3e\n\x3cblockquote\x3eUnder the policy, a web browser permits scripts contained in a first web page to access data in a second web page, but only if both web pages have the same origin. An origin is defined as a combination of \x3cem\x3eURI scheme\x3c\/em\x3e, \x3cem\x3ehostname\x3c\/em\x3e, and \x3cem\x3eport number\x3c\/em\x3e.\x3c\/blockquote\x3e\n\x3cp\x3e判断同源的三个要素：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e相同的协议\x3c\/li\x3e\n\x3cli\x3e相同的域名\x3c\/li\x3e\n\x3cli\x3e相同的端口号\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e3. 存在的意义\x3c\/h2\x3e\n\x3cblockquote\x3e为了保证使用者信息的安全，防止恶意网站篡改用户数据\x3c\/blockquote\x3e\n\x3cp\x3e举个例子：\x3c\/p\x3e\n\x3cp\x3e假设没有同源策略，那么我在A网站下的\x3ccode\x3ecookie\x3c\/code\x3e就可以被任何一个网站拿到；那么这个网站的所有者，就可以使用我的\x3ccode\x3ecookie\x3c\/code\x3e(也就是我的身份)在A网站下进行操作。\x3c\/p\x3e\n\x3cp\x3e同源策略可以算是 web 前端安全的基石，如果缺少同源策略，浏览器也就没有了安全性可言。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e4. 限制范围\x3c\/h2\x3e\n\x3cp\x3e非同源的网站之间\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e无法共享 cookie, localStorage, indexDB\x3c\/li\x3e\n\x3cli\x3e无法操作彼此的 dom 元素\x3c\/li\x3e\n\x3cli\x3e无法发送 ajax 请求\x3c\/li\x3e\n\x3cli\x3e无法通过 flash 发送 http 请求\x3c\/li\x3e\n\x3cli\x3e其他\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3e跨域\x3c\/h1\x3e\n\x3cp\x3e同源策略做了很严格的限制，但是在实际的场景中，又确实有很多地方需要\x3cstrong\x3e突破\x3c\/strong\x3e同源策略的限制，也就是我们常说的\x3ccode\x3e跨域\x3c\/code\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e1. cookie\x3c\/h2\x3e\n\x3cp\x3e同源策略最早被提出的时候，为的就是防止不同域名的网页之间共享 cookie，但是如果两个网页的一级域名是相同的，可以通过设置 \x3ccode\x3edocument.domain\x3c\/code\x3e来共享 cookie。\x3c\/p\x3e\n\x3cp\x3e举个例子，\x3cbr\x3e\x3ccode\x3ehttps:\/\/market.douban.com\x3c\/code\x3e和\x3ccode\x3ehttps:\/\/book.douban.com\x3c\/code\x3e，这两个网页的一级域名都是 \x3ccode\x3edouban.com\x3c\/code\x3e，如果我在 \x3ccode\x3emarket.douban.com\x3c\/code\x3e中执行了\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    document.domain = \x27douban.com\x27\n    document.cookie = \x27cross=yes\x27\n    或\n    document.cookie = \x27cross=yes;path=\/;domain=douban.com\x27\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.domain = \x3cspan class=\x22hljs-string\x22\x3e\x27douban.com\x27\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.cookie = \x3cspan class=\x22hljs-string\x22\x3e\x27cross=yes\x27\x3c\/span\x3e\n    或\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.cookie = \x3cspan class=\x22hljs-string\x22\x3e\x27cross=yes;path=\/;domain=douban.com\x27\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样设置了 cookie 之后，在 \x3ccode\x3ebook.douban.com\x3c\/code\x3e 中是可以取到这个 cookie 的。\x3c\/p\x3e\n\x3cp\x3e除了在前端设置之外，也可以直接在 response 里将 cookie 的 domain 设置成 \x3ccode\x3e.douban.com\x3c\/code\x3e。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e2. Ajax\x3c\/h2\x3e\n\x3cp\x3e在使用 ajax 的过程中，我们碰到的同源限制的问题是最多的。\x3c\/p\x3e\n\x3cp\x3e针对 ajax ，我们有三种方式可以绕过同源策略的限制：\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e2.1 设置 CORS\x3c\/h3\x3e\n\x3cp\x3e设置 cross-domain 是目前在 ajax 中最常用的一种跨域的方式，相比\x3ccode\x3ejsonp\x3c\/code\x3e和\x3ccode\x3ewebsoket\x3c\/code\x3e也是最安全的一种方式。\x3c\/p\x3e\n\x3cp\x3e唯一美中不足的是低版本的浏览器支持的不是很好\x3c\/p\x3e\n\x3cblockquote\x3eIE ✘ 5.5\x2b ◒ 8\x2b² ◒ 10\x2b¹ ✔ 11\x3cp\x3eEdge ✔\x3c\/p\x3e\n\x3cp\x3eFirefox ✘ 2\x2b ✔ 3.5\x2b\x3c\/p\x3e\n\x3cp\x3eChrome ◒ 4\x2b¹ ✔ 13\x2b\x3c\/p\x3e\n\x3cp\x3eSafari ✘ 3.1\x2b ◒ 4\x2b¹ ✔ 6\x2b³\x3c\/p\x3e\n\x3cp\x3eOpera ✘ 9\x2b ✔ 12\x2b\x3c\/p\x3e\n\x3cp\x3e¹Does not support CORS for images in \x3ccode\x3e\x26lt;canvas\x26gt;\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e²Supported somewhat in IE8 and IE9 using the XDomainRequest object (but has \x3ca href=\x22http:\/\/blogs.msdn.com\/b\/ieinternals\/archive\/2010\/05\/13\/xdomainrequest-restrictions-limitations-and-workarounds.aspx\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3elimitations\x3c\/a\x3e)\x3c\/p\x3e\n\x3cp\x3e³Does not support CORS for \x3ccode\x3e\x26lt;video\x26gt;\x3c\/code\x3e in \x3ccode\x3e\x26lt;canvas\x26gt;\x3c\/code\x3e: \x3ca href=\x22https:\/\/bugs.webkit.org\/show_bug.cgi?id=135379\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/bugs.webkit.org\/show_...\x3c\/a\x3e\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch4\x3e2.1.1 CORS 的运作\x3c\/h4\x3e\n\x3cp\x3eCROS 的设置，大部分是需要在服务端进行设置，在服务端设置之前，先来看一下 CROS 在浏览器中是怎么运作的：\x3c\/p\x3e\n\x3cp\x3e首先，在浏览器中，http 请求将被分为两种 \x3ccode\x3e简单请求(simple request)\x3c\/code\x3e 和 \x3ccode\x3e非简单请求(not-so-simple request)\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e简单请求的判断包括两个条件：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cp\x3e请求方法必须是一下几种:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eHEAD\x3c\/li\x3e\n\x3cli\x3eGET\x3c\/li\x3e\n\x3cli\x3ePOST\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eHTTP 头只能包括以下信息：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eAccept\x3c\/li\x3e\n\x3cli\x3eAccept-Language\x3c\/li\x3e\n\x3cli\x3eContent-Language\x3c\/li\x3e\n\x3cli\x3eLast-Event-ID\x3c\/li\x3e\n\x3cli\x3eContent-Type: 只限于[application\/x-www-form-urlencoded, multipart\/form-data, text\/plain]\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e不能同时满足以上两个条件的，就都视作\x3ccode\x3e非简单请求\x3c\/code\x3e\x3c\/p\x3e\n\x3ch4\x3e2.1.2 简单请求(simple request)\x3c\/h4\x3e\n\x3ch5\x3e浏览器端\x3c\/h5\x3e\n\x3cp\x3e浏览器在处理简单请求时，会在 Header 中加上一个 \x3ccode\x3eorigin(protocal \x2b host \x2b path \x2b port)\x3c\/code\x3e 字段，来标明这个请求是来自哪里。\x3c\/p\x3e\n\x3cp\x3e在 CROS 请求中，默认是不会携带 \x3ccode\x3ecookie\x3c\/code\x3e之类的用户信息的，但是不携带用户信息的话，是没办法判断用户身份的，所以，可以在请求时将\x3ccode\x3ewithCredentials\x3c\/code\x3e设置为 true, 例如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    var xhr = new XMLHttpRequest()\n    xhr.withCredentials = true\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3e    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eXMLHttpRequest\x3c\/span\x3e()\n    xhr.withCredentials = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e设置了这个值之后，在服务端会将 \x3ccode\x3eresponse\x3c\/code\x3e 中的 \x3ccode\x3eAccess-Control-Allow-Credentials\x3c\/code\x3e 也设置为 \x3ccode\x3etrue\x3c\/code\x3e，这样浏览器才会相应 \x3ccode\x3ecookie\x3c\/code\x3e\x3c\/p\x3e\n\x3ch5\x3e服务端\x3c\/h5\x3e\n\x3cp\x3e在服务端拿到这个请求之后，会对 origin 进行判断，如果是在允许范围内的请求，将会在 respones 返回的 Header 中加上：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    Access-Control-Allow-Origin: origin\n    Access-Control-Allow-Credentials: true\n    Access-Control-Expose-Headers: something\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs yaml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attr\x22\x3e    Access-Control-Allow-Origin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eorigin\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    Access-Control-Allow-Credentials:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    Access-Control-Expose-Headers:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3esomething\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e下面来说说这几个字段都代表什么：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eAccess-Control-Allow-Origin\x3cp\x3e看名字大概就能猜出来，这个就是告诉浏览器，服务端接受那些域名的访问。值可以是 \x3ccode\x3erequest\x3c\/code\x3e 中的 \x3ccode\x3eorigin\x3c\/code\x3e，也可以是 \x3ccode\x3e*\x3c\/code\x3e，也可以是\x3ccode\x3eoriginA | originB\x3c\/code\x3e 这样的形式，但是目前看来，在浏览器中只支持单一值和\x3ccode\x3e*\x3c\/code\x3e两种方式。具体可以参考这里：\x3ca href=\x22https:\/\/www.w3.org\/TR\/cors\/#access-control-allow-origin-response-header\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eaccess-control-allow-origin-response-header\x3c\/a\x3e\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3eAccess-Control-Allow-Credentials\x3cp\x3e从名字上来看，这个字段标明了是否拥有用户相关的权限。\x3c\/p\x3e\n\x3cp\x3e在浏览器中，具体表现为是否可以发送 cookie。这个值可以选择性返回，如果不返回的话，默认就    是不允许发送 cookie，如果返回，则只能返回 true。\x3c\/p\x3e\n\x3cp\x3e另外，如果这个值被设为了\x3ccode\x3etrue\x3c\/code\x3e，那么\x3ccode\x3eAccess-Control-Allow-Origin\x3c\/code\x3e就不能被设置为    \x3ccode\x3e*\x3c\/code\x3e，必须要显示指定为\x3ccode\x3eorigin\x3c\/code\x3e的值；并且返回的\x3ccode\x3ecookie\x3c\/code\x3e因为是在被跨域访问的域名下，因为遵守同    源策略，所以在\x3ccode\x3eorigin\x3c\/code\x3e网页中是不能被读取到的。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eAccess-Control-Expose-Headers\x3c\/p\x3e\n\x3cp\x3e从字面意义上来看，这个字段返回的就是\x3cstrong\x3e其他\x3c\/strong\x3e可被返回的数据。\x3c\/p\x3e\n\x3cp\x3e之所以会有这个字段，是因为在\x3ccode\x3e简单请求\x3c\/code\x3e中，\x3ccode\x3eresponse\x3c\/code\x3e返回的头信息中，浏览器只能拿到以下几个基本字段：\x3ccode\x3eCache-Control\x3c\/code\x3e, \x3ccode\x3eContent-Language\x3c\/code\x3e, \x3ccode\x3eContent-Type\x3c\/code\x3e, \x3ccode\x3eExpires\x3c\/code\x3e, \x3ccode\x3eLast-Modified\x3c\/code\x3e, \x3ccode\x3ePragma\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e如果想要拿到更多的额外信息，只能在\x3ccode\x3eAccess-Control-Expose-Headers\x3c\/code\x3e里设置，例如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22     Access-Control-Expose-Headers: \x26quot;Foo=foo\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e     \x3cspan class=\x22hljs-keyword\x22\x3eAccess\x3c\/span\x3e-Control-Expose-Headers: \x3cspan class=\x22hljs-string\x22\x3e\x22Foo=foo\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样的话，在浏览中，就可以获取 \x3ccode\x3eFoo\x3c\/code\x3e 这个字段所携带的信息了\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3e2.1.3 非简单请求(not-so-simple request)\x3c\/h4\x3e\n\x3cp\x3e与\x3ccode\x3e简单请求\x3c\/code\x3e最大的不同在于，\x3ccode\x3e非简单请求\x3c\/code\x3e实际上是发送了两个请求。\x3c\/p\x3e\n\x3ch5\x3e预请求\x3c\/h5\x3e\n\x3cp\x3e首先，在正式请求之前，会先发送一个\x3ccode\x3e预请求(preflight-request)\x3c\/code\x3e，这个请求的作用是尽可能少的携带信息，供服务端判断是否响应该请求。\x3c\/p\x3e\n\x3ch5\x3e浏览器\x3c\/h5\x3e\n\x3cp\x3e浏览器发送\x3ccode\x3e预请求\x3c\/code\x3e，请求的 \x3ccode\x3eRequest Method\x3c\/code\x3e 会设置为 \x3ccode\x3eoptions\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e另外，还会带上这几个字段：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eOrigin: 同\x3ccode\x3e简单请求\x3c\/code\x3e的\x3ccode\x3eorigin\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3eAccess-Control-Request-Method: 请求将要使用的方法\x3c\/li\x3e\n\x3cli\x3eAccess-Control-Request-Headers: 浏览器会额外发送哪些头信息\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch5\x3e服务端\x3c\/h5\x3e\n\x3cp\x3e服务端收到\x3ccode\x3e预请求\x3c\/code\x3e之后会根据\x3ccode\x3erequest\x3c\/code\x3e中的\x3ccode\x3eorigin\x3c\/code\x3e,\x3ccode\x3eAccess-Control-Request-Method\x3c\/code\x3e和\x3ccode\x3eAccess-Control-Request-Headers\x3c\/code\x3e判断是否响应该请求。\x3c\/p\x3e\n\x3cp\x3e如果判断响应这个请求，返回的\x3ccode\x3eresponse\x3c\/code\x3e中将会携带：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eAccess-Control-Allow-Origin: origin\x3c\/li\x3e\n\x3cli\x3eAccess-Control-Allow-Methods: like request\x3c\/li\x3e\n\x3cli\x3eAccess-Control-Allow-Headers: like request\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e如果否定这个请求，直接返回不带这三个字段的\x3ccode\x3eresponse\x3c\/code\x3e就可以，浏览器将会把这种返回判断为失败的返回，触发\x3ccode\x3eonerror\x3c\/code\x3e方法\x3c\/p\x3e\n\x3ch5\x3e正式响应\x3c\/h5\x3e\n\x3cp\x3e如果\x3ccode\x3e预请求\x3c\/code\x3e被正确响应，接下来就会发送正式请求，正式请求的\x3ccode\x3erequest\x3c\/code\x3e和正常的 ajax 请求基本没有区别，只是会携带 \x3ccode\x3eorigin\x3c\/code\x3e 字段；\x3ccode\x3eresponse\x3c\/code\x3e和\x3ccode\x3e简单请求\x3c\/code\x3e一样，会携带上\x3ccode\x3eAccess-Control-*\x3c\/code\x3e这些字段\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e2.2 websocket\x3c\/h3\x3e\n\x3cp\x3ewebsocket 不遵循同源策略。\x3c\/p\x3e\n\x3cp\x3e但是在 websocket 请求头中会带上 \x3ccode\x3eorigin\x3c\/code\x3e 这个字段，服务端可以通过这个字段来判断是否需要响应，在浏览器端并没有做任何限制。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e2.3 jsonp\x3c\/h3\x3e\n\x3cp\x3ejsonp 其实算是一种 hack 形式的请求。\x3c\/p\x3e\n\x3cp\x3ejsonp 的本质其实是请求一段 js 代码，是对静态文件资源的请求，所以并不遵循同源策略。但是因为是对静态文件资源的请求，所以只能支持 \x3ccode\x3eGET\x3c\/code\x3e 请求，对于其他方法没有办法支持。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader11\x22\x3e3. iframe\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e3.1 iframe 中的同源策略\x3c\/h3\x3e\n\x3cp\x3e根据同源策略的规定，如果两个页面不同源，那么相互之间其实是\x3cstrong\x3e隔离\x3c\/strong\x3e的。\x3c\/p\x3e\n\x3cp\x3e在使用 iframe 的页面中，虽然我们可以通过\x3ccode\x3eiframe.contentWindow\x3c\/code\x3e,\x3ccode\x3ewindow.parent\x3c\/code\x3e,\x3ccode\x3ewindow.top\x3c\/code\x3e等方法拿到\x3ccode\x3ewindow\x3c\/code\x3e对象，但是根据同源策略，浏览器将对非同源的页面之间的\x3ccode\x3ewindow\x3c\/code\x3e和\x3ccode\x3elocation\x3c\/code\x3e对象添加限制\x3c\/p\x3e\n\x3cp\x3e不同源的两个网页将不能：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e操作彼此的 dom\x3c\/li\x3e\n\x3cli\x3e获取\/调用彼此 \x3ccode\x3ewindow\x3c\/code\x3e 对象中的属性\/方法\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e不同源的两个网页可以：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e改变父\/子级的 url\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e具体的规则可以参考这里：\x3ca href=\x22https:\/\/html.spec.whatwg.org\/multipage\/browsers.html#integration-with-idl\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eintegration-with-idl\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e但是在现实世界中，有很多场景下，其实是需要两个非同源的 iframe 之间进行“跨域”操作的。为了实现这种“跨域”，我们借用了以下几种方法：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e片段标识符（fragment identifier）\x3c\/li\x3e\n\x3cli\x3e使用 window.name\x3c\/li\x3e\n\x3cli\x3e跨文档通信\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3e3.2 使用片段标识符（fragment identifier）\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3e片段标识符\x3c\/code\x3e指的就是 url 中 \x3ccode\x3e#\x3c\/code\x3e 之后的部分，也就是我们常说的 \x3ccode\x3elocation.hash\x3c\/code\x3e。\x3cbr\x3e使用片段标识符依托于以下几个关键点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e改变 url 里的这个部分，是不会触发页面的刷新的\x3c\/li\x3e\n\x3cli\x3e父级页面虽然不能操作 iframe 中的 \x3ccode\x3ewindow\x3c\/code\x3e 和 \x3ccode\x3edom\x3c\/code\x3e，但是可以改变 iframe 的 \x3ccode\x3eurl\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3ewindow 对象可以监听 \x3ccode\x3ehashchange\x3c\/code\x3e 事件\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e通过这几个关键点，可以实现基于 \x3ccode\x3ehashchange\x3c\/code\x3e 来操作页面\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3e3.3 使用 window.name\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3ewindow.name\x3c\/code\x3e这个属性最厉害的地方在于，\x3ccode\x3ewindow\x3c\/code\x3e对象没有改变的话，这个 \x3ccode\x3ewindow\x3c\/code\x3e 跳转的网页，都读取 \x3ccode\x3ewindow.name\x3c\/code\x3e 这个值。\x3c\/p\x3e\n\x3cp\x3e例如，A 网页设置了 \x3ccode\x3ewindow.name\x3c\/code\x3e，然后跳转到了 B 网页，但是 B 网页中，仍然可以读取到 A 设置的 \x3ccode\x3ewindow.name\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e通过这个特性，在 iframe 中，子页面可以先设置 \x3ccode\x3ewindow.name\x3c\/code\x3e；\x3c\/p\x3e\n\x3cp\x3e然后跳转到一个跟父页面同级的地址，这个 \x3ccode\x3ewindow.name\x3c\/code\x3e 依然存在，因为已经调到了跟父级页面同源的地址中，所以父页面可以获取到 \x3ccode\x3eiframe.contentWindow\x3c\/code\x3e中属性，也就是可以读取到 \x3ccode\x3ewindow.name\x3c\/code\x3e 了\x3c\/p\x3e\n\x3cp\x3e这种方法最大的优点就是\x3ccode\x3ewindow.name\x3c\/code\x3e可以传一个很长的字符串，但是缺点也比较明显，就是需要在父级页面不停的去检查子页面的\x3ccode\x3ewindow.name\x3c\/code\x3e是否被改变\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader15\x22\x3e3.4 跨文档通信API（Cross-document messaging）\x3c\/h3\x3e\n\x3cp\x3e虽然上面的两种方法都可以实现不同源页面之间的通信，但是总归是属于\x3ccode\x3ehack\x3c\/code\x3e的方法，眼看着大家对非同源页面的通信都有需求，所以在 HTML5 规范中，添加了一个\x3ccode\x3ewindow.postMessage\x3c\/code\x3e的方法。\x3c\/p\x3e\n\x3cp\x3e通过这个方法，可以方便的实现不同源的页面之间的通信。\x3c\/p\x3e\n\x3cp\x3e看一个简单的例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\n\/\/ Page Foo\niframe.contentWindow.postMessage(\x27Hello from foo\x27, \x27\/path\/to\/bar\x27)\n\n\n\/\/ Page Bar\nwindow.parent.addEventListener(\x27message\x27, function (e) {\n    console.log(e.source)    \/\/ 发送消息的窗口\n    console.log(e.origin)  \/\/ 消息发向的网址\n    console.log(e.data)    \/\/ 消息内容\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Page Foo\x3c\/span\x3e\niframe.contentWindow.postMessage(\x3cspan class=\x22hljs-string\x22\x3e\x27Hello from foo\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/path\/to\/bar\x27\x3c\/span\x3e)\n\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Page Bar\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.parent.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27message\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e.source)    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 发送消息的窗口\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e.origin)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 消息发向的网址\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e.data)    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 消息内容\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3e2.6 canvas\x3c\/h3\x3e\n\x3cp\x3e在 \x3ccode\x3ecanvas\x3c\/code\x3e 的使用过程中，也会碰到同源策略的限制。\x3c\/p\x3e\n\x3cp\x3e以下的几种操作，都会受到同源策略的限制：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3ecanvas.toDataURL\x3c\/li\x3e\n\x3cli\x3ecanvas.toBlob\x3c\/li\x3e\n\x3cli\x3ecanvas.getContent(\x272d\x27).getImageData(x,y,w,h)\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e例如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\n\/\/ 这段 JS 运行在 a.com 这个域名下\nvar canvas = document.createElement(\x27canvas\x27)\nvar ctx = canvas.getContent(\x272d\x27)\nvar src = \x27http:\/\/b.com\/path\/to\/a\/image\x27\nvar img = new Image()\nimg.onload = function () {\n    canvas.with = img.style.width\n    canvas.height = img.style.height\n    ctx.drawImage(img)\n    \/\/ 以下的这这三种操作都会报错\n    canvas.toDataURL(\x27image\/jpg\x27)\n    canvas.toBlob(function () {})\n    ctx.getImageData(0, 0, 10, 10)\n}\nimg.src = src\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这段 JS 运行在 a.com 这个域名下\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e canvas = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27canvas\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ctx = canvas.getContent(\x3cspan class=\x22hljs-string\x22\x3e\x272d\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e src = \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/b.com\/path\/to\/a\/image\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e img = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Image()\nimg.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    canvas.with = img.style.width\n    canvas.height = img.style.height\n    ctx.drawImage(img)\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 以下的这这三种操作都会报错\x3c\/span\x3e\n    canvas.toDataURL(\x3cspan class=\x22hljs-string\x22\x3e\x27image\/jpg\x27\x3c\/span\x3e)\n    canvas.toBlob(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{})\n    ctx.getImageData(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e)\n}\nimg.src = src\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行时会报错\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Uncaught SecurityError: Failed to execute \x27toDataURL\x27 on \x27HTMLCanvasElement\x27: Tainted canvases may not be exported.\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs smali\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eUncaught SecurityError: Failed to\x3cspan class=\x22hljs-built_in\x22\x3e execute \x3c\/span\x3e\x27toDataURL\x27 on \x27HTMLCanvasElement\x27: Tainted canvases may\x3cspan class=\x22hljs-built_in\x22\x3e not \x3c\/span\x3ebe exported.\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看到是\x3ccode\x3etoDataURL\x3c\/code\x3e的时候，因为 \x3ccode\x3ea.com\x3c\/code\x3e和\x3ccode\x3eb.com\x3c\/code\x3e是不同源的两个网页，触发了同源策略的限制。换成\x3ccode\x3etoBlob\x3c\/code\x3e或\x3ccode\x3egetImageData\x3c\/code\x3e会报同样的错误。\x3c\/p\x3e\n\x3cp\x3e我们来探究以下报这个错误的原因：\x3c\/p\x3e\n\x3cp\x3e首先，所有\x3ccode\x3ebitmaps\x3c\/code\x3e类型的对象，在被\x3ccode\x3ecanvas\x3c\/code\x3e或\x3ccode\x3eImageBitmap\x3c\/code\x3e使用时，都会先检查当前这对象，是不是处在\x3ccode\x3eorigin clean\x3c\/code\x3e的状态。\x3c\/p\x3e\n\x3cp\x3e然后，所有\x3ccode\x3ebitmaps\x3c\/code\x3e类型的对象，默认情况下，这个\x3ccode\x3eorigin clean\x3c\/code\x3e都是\x3ccode\x3etrue\x3c\/code\x3e，但是如果这个\x3ccode\x3ebitmaps\x3c\/code\x3e被跨域调用，那么，这个\x3ccode\x3eorigin clean\x3c\/code\x3e将会被设置成 \x3ccode\x3efalse\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e再然后，在使用\x3ccode\x3etoDataURL\x3c\/code\x3e,\x3ccode\x3etoBlob\x3c\/code\x3e和\x3ccode\x3egetImageData\x3c\/code\x3e时，都会先检查\x3ccode\x3eorigin clean\x3c\/code\x3e，如果为 \x3ccode\x3efalse\x3c\/code\x3e 的话，就会抛出\x3ccode\x3eSecurityError\x3c\/code\x3e这样的异常。\x3c\/p\x3e\n\x3cp\x3e那么，这个\x3ccode\x3eorigin clean\x3c\/code\x3e的状态，是如何设置的呢？\x3c\/p\x3e\n\x3cp\x3e可以通过\x3ccode\x3ecrossOrigin\x3c\/code\x3e来设置，看代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var canvas = document.createElement(\x27canvas\x27)\nvar ctx = canvas.getContent(\x272d\x27)\nvar src = \x27http:\/\/b.com\/path\/to\/a\/image\x27\nvar img = new Image()\nimg.onload = function () {\n    canvas.with = img.style.width\n    canvas.height = img.style.height\n    ctx.drawImage(img)\n    canvas.toDataURL(\x27image\/jpg\x27)\n}\nimg.crossOrigin = \x27*\x27\nimg.src = src\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e canvas = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27canvas\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ctx = canvas.getContent(\x3cspan class=\x22hljs-string\x22\x3e\x272d\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e src = \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/b.com\/path\/to\/a\/image\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e img = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Image()\nimg.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    canvas.with = img.style.width\n    canvas.height = img.style.height\n    ctx.drawImage(img)\n    canvas.toDataURL(\x3cspan class=\x22hljs-string\x22\x3e\x27image\/jpg\x27\x3c\/span\x3e)\n}\nimg.crossOrigin = \x3cspan class=\x22hljs-string\x22\x3e\x27*\x27\x3c\/span\x3e\nimg.src = src\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e加上了\x3ccode\x3ecrossOrigin\x3c\/code\x3e这个属性，然后执行，发现还会报个错：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Image from origin \x27http:\/\/b.com\x27 has been blocked from loading by Cross-Origin Resource Sharing policy: No \x27Access-Control-Allow-Origin\x27 header is present on the requested resource. Origin \x27http:\/\/localhost:3000\x27 is therefore not allowed access\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs oxygene\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eImage \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e origin \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/b.com\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ehas\x3c\/span\x3e been blocked \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e loading \x3cspan class=\x22hljs-keyword\x22\x3eby\x3c\/span\x3e Cross-Origin Resource Sharing policy: No \x3cspan class=\x22hljs-string\x22\x3e\x27Access-Control-Allow-Origin\x27\x3c\/span\x3e header \x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e present \x3cspan class=\x22hljs-keyword\x22\x3eon\x3c\/span\x3e the requested resource. Origin \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:3000\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e therefore \x3cspan class=\x22hljs-keyword\x22\x3enot\x3c\/span\x3e allowed access\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e看报错信息大概可以知道，是\x3ccode\x3eAccess-Control-Allow-Origin\x3c\/code\x3e这里出了问题，只需要把\x3ccode\x3eAccess-Control-Allow-Origin\x3c\/code\x3e设置成对应的值就可以了。\x3c\/p\x3e\n\x3cp\x3e更具体的原因可以参考这里：\x3ca href=\x22https:\/\/html.spec.whatwg.org\/multipage\/scripting.html#security-with-canvas-elements\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSecurity with canvas elements\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader17\x22\x3e2.7 flash\x3c\/h3\x3e\n\x3cp\x3eflash在进行 HTTP 请求时，也遵循同源策略。\x3c\/p\x3e\n\x3cp\x3e但是相比较以上的各种场景和绕过同源策略的方法，flash 的跨域请求设置很容易，只需要在目标服务的根目录下设置一个\x3ccode\x3ecrossdomain.xml\x3c\/code\x3e文件即可。\x3c\/p\x3e\n\x3cp\x3e这个文件中会规定哪些域可以访问当前服务，看一个真实世界里的例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c?xml version=\x26quot;1.0\x26quot;?\x3e\n\x3c!DOCTYPE cross-domain-policy\n SYSTEM \x26quot;http:\/\/www.macromedia.com\/xml\/dtds\/cross-domain-policy.dtd\x26quot;\x3e\n\x3ccross-domain-policy\x3e\n  \x3csite-control permitted-cross-domain-policies=\x26quot;master-only\x26quot;\/\x3e\n  \x3callow-access-from domain=\x26quot;t.simple.com\x26quot;\/\x3e\n  \x3callow-access-from domain=\x26quot;img1.simple.com\x26quot;\/\x3e\n  \x3callow-access-from domain=\x26quot;img2.simple.com\x26quot;\/\x3e\n  \x3callow-access-from domain=\x26quot;img3.simple.com\x26quot;\/\x3e\n  \x3callow-access-from domain=\x26quot;img4.simple.com\x26quot;\/\x3e\n  \x3callow-access-from domain=\x26quot;img5.simple.com\x26quot;\/\x3e\n  \x3callow-access-from domain=\x26quot;*.simple.com.cn\x26quot;\/\x3e\n  \x3callow-access-from domain=\x26quot;all.vic.sina.com.cn\x26quot;\/\x3e\n\x3c\/cross-domain-policy\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22xml\x22\x3e\x3cspan class=\x22php\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;?\x3c\/span\x3exml version=\x3cspan class=\x22hljs-string\x22\x3e\x221.0\x22\x3c\/span\x3e\x3cspan class=\x22hljs-meta\x22\x3e?\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE cross-domain-policy\n SYSTEM \x22http:\/\/www.macromedia.com\/xml\/dtds\/cross-domain-policy.dtd\x22\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ecross-domain-policy\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3esite-control\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3epermitted-cross-domain-policies\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22master-only\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eallow-access-from\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edomain\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22t.simple.com\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eallow-access-from\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edomain\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22img1.simple.com\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eallow-access-from\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edomain\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22img2.simple.com\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eallow-access-from\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edomain\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22img3.simple.com\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eallow-access-from\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edomain\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22img4.simple.com\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eallow-access-from\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edomain\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22img5.simple.com\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eallow-access-from\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edomain\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22*.simple.com.cn\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eallow-access-from\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edomain\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22all.vic.sina.com.cn\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ecross-domain-policy\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader18\x22\x3e参考文章:\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/Same-origin_policy\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSame-origin policy\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/html.spec.whatwg.org\/multipage\/browsers.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ebrowsers\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2016\/04\/same-origin-policy.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e浏览器同源政策及其规避方法\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/html.spec.whatwg.org\/multipage\/scripting.html#security-with-canvas-elements\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3esecurity-with-canvas-elements\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/html.spec.whatwg.org\/multipage\/scripting.html#concept-canvas-origin-clean\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3econcept-canvas-origin-clean\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>同源策略和跨域</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007366644">https://segmentfault.com/a/1190000007366644</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/zycj05a4m2d/" target="_blank">https://alili.tech/archive/zycj05a4m2d/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>