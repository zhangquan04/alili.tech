<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="你不知道的 XMLHttpRequest"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>你不知道的 XMLHttpRequest | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/emo34mxsncp/",
				"appid": "1613049289050283", 
				"title": "你不知道的 XMLHttpRequest | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-17T02:30:25"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/5bmajmttb8b/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/4gu6y454zfd/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2femo34mxsncp%2f&text=%e4%bd%a0%e4%b8%8d%e7%9f%a5%e9%81%93%e7%9a%84%20XMLHttpRequest"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2femo34mxsncp%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2femo34mxsncp%2f&text=%e4%bd%a0%e4%b8%8d%e7%9f%a5%e9%81%93%e7%9a%84%20XMLHttpRequest"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2femo34mxsncp%2f&title=%e4%bd%a0%e4%b8%8d%e7%9f%a5%e9%81%93%e7%9a%84%20XMLHttpRequest"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2femo34mxsncp%2f&is_video=false&description=%e4%bd%a0%e4%b8%8d%e7%9f%a5%e9%81%93%e7%9a%84%20XMLHttpRequest"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%a0%e4%b8%8d%e7%9f%a5%e9%81%93%e7%9a%84%20XMLHttpRequest&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2femo34mxsncp%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2femo34mxsncp%2f&title=%e4%bd%a0%e4%b8%8d%e7%9f%a5%e9%81%93%e7%9a%84%20XMLHttpRequest"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2femo34mxsncp%2f&title=%e4%bd%a0%e4%b8%8d%e7%9f%a5%e9%81%93%e7%9a%84%20XMLHttpRequest"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2femo34mxsncp%2f&title=%e4%bd%a0%e4%b8%8d%e7%9f%a5%e9%81%93%e7%9a%84%20XMLHttpRequest"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2femo34mxsncp%2f&title=%e4%bd%a0%e4%b8%8d%e7%9f%a5%e9%81%93%e7%9a%84%20XMLHttpRequest"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">你不知道的 XMLHttpRequest</h1><div class="meta"><div class="postdate"><time datetime="2019-01-17" itemprop="datePublished">2019-01-17</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e本文详细介绍了 XMLHttpRequest 相关知识，涉及内容：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eAJAX、XMLHTTP、XMLHttpRequest详解、XMLHttpRequest Level 1、Level 2 详解\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eXHR 上传、下载数据、XHR 流式传输、XHR 定时轮询和长轮询区别与优缺点、XMLHttpRequest 库 (Mock.js、Zone.js、Oboe.js、fetch.js)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eXMLHttpRequest 常用代码片段：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eArrayBuffer 对象转字符串\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e字符串转 ArrayBuffer 对象\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e创建 XHR 对象\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3esendAsBinary() polyfill\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e获取 XMLHttpRequest 响应体\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e获取 responseURL\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e验证请求是否成功\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e解析查询参数为Map对象\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eXHR 下载图片\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eXHR 上传图片\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eXHR 上传进度条\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e分析 AJAX 请求状态为 0、GET请求方式为什么不能通过send() 方法发送请求体、简单请求和预请求、XMLHttpRequest对象垃圾回收机制、Get与Post请求区别、如何避免重复发送请求、AJAX 站点 SEO 优化等问题。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3eAJAX\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3eAJAX 定义\x3c\/h3\x3e\n\x3cblockquote\x3e\n\x3cp\x3e\x3cstrong\x3eAJAX\x3c\/strong\x3e即“\x3cstrong\x3eAsynchronous JavaScript and XML\x3c\/strong\x3e”（异步的\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/JavaScript\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScript\x3c\/a\x3e与\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/XML\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eXML\x3c\/a\x3e技术），指的是一套综合了多项技术的\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/%E7%80%8F%E8%A6%BD%E5%99%A8\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e浏览器\x3c\/a\x3e端\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/%E7%B6%B2%E9%A0%81\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e网页\x3c\/a\x3e开发技术。Ajax的概念由\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/%E5%82%91%E8%A5%BF%C2%B7%E8%A9%B9%E5%A7%86%E5%A3%AB%C2%B7%E8%B3%88%E7%91%9E%E7%89%B9\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e杰西·詹姆士·贾瑞特\x3c\/a\x3e所提出。 \x3c\/p\x3e\n\x3cp\x3e传统的Web应用允许用户端填写表单（form），当提交表单时就向\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/%E7%B6%B2%E9%A0%81%E4%BC%BA%E6%9C%8D%E5%99%A8\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e网页服务器\x3c\/a\x3e发送一个请求。服务器接收并处理传来的表单，然后送回一个新的网页，但这个做法浪费了许多带宽，因为在前后两个页面中的大部分HTML码往往是相同的。由于每次应用的沟通都需要向服务器发送请求，应用的回应时间依赖于服务器的回应时间。这导致了用户界面的回应比本机应用慢得多。\x3c\/p\x3e\n\x3cp\x3e与此不同，AJAX应用可以仅向服务器发送并取回必须的数据，并在客户端采用JavaScript处理来自服务器的回应。因为在服务器和浏览器之间交换的数据大量减少（大约只有原来的5%）\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Wikipedia:%E5%88%97%E6%98%8E%E6%9D%A5%E6%BA%90\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e[来源请求]\x3c\/a\x3e,服务器回应更快了。同时，很多的处理工作可以在发出请求的\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/%E5%AE%A2%E6%88%B7%E7%AB%AF\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e客户端\x3c\/a\x3e机器上完成，因此Web服务器的负荷也减少了。\x3c\/p\x3e\n\x3cp\x3e类似于\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/DHTML\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDHTML\x3c\/a\x3e或\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/LAMP\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eLAMP\x3c\/a\x3e，AJAX不是指一种单一的技术，而是有机地利用了一系列相关的技术。虽然其名称包含XML，但实际上数据格式可以由\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/JSON\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJSON\x3c\/a\x3e代替，进一步减少数据量，形成所谓的AJAJ。而客户端与服务器也并不需要异步。一些基于AJAX的“派生／合成”式（derivative\/composite）的技术也正在出现，如\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/AFLAX\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAFLAX\x3c\/a\x3e。 —— 维基百科\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3eAJAX 应用\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e运用\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/XHTML\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eXHTML\x3c\/a\x3e\x2b\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/CSS\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCSS\x3c\/a\x3e来表达信息；\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e运用\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/JavaScript\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScript\x3c\/a\x3e操作\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/%E6%96%87%E4%BB%B6%E7%89%A9%E4%BB%B6%E6%A8%A1%E5%9E%8B\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDOM\x3c\/a\x3e（Document Object Model）来运行动态效果；\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e运用\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/XML\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eXML\x3c\/a\x3e和\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/XSLT\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eXSLT\x3c\/a\x3e操作数据\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e运用\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/XMLHttpRequest\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eXMLHttpRequest\x3c\/a\x3e或新的Fetch API与\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/%E7%B6%B2%E9%A0%81%E4%BC%BA%E6%9C%8D%E5%99%A8\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e网页服务器\x3c\/a\x3e进行异步数据交换；\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e注意：AJAX与\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Flash\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFlash\x3c\/a\x3e、\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Silverlight\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSilverlight\x3c\/a\x3e和\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Java_Applet\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJava Applet\x3c\/a\x3e等\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/RIA\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRIA\x3c\/a\x3e技术是有区分的。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3eAJAX 兼容性\x3c\/h3\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/JavaScript\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScript\x3c\/a\x3e 编程的最大问题来自不同的浏览器对各种技术和标准的支持。\x3c\/p\x3e\n\x3cp\x3eXmlHttpRequest 对象在不同浏览器中不同的创建方法，以下是跨浏览器的通用方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Provide the XMLHttpRequest class for IE 5.x-6.x:\n\/\/ Other browsers (including IE 7.x-8.x) ignore this\n\/\/   when XMLHttpRequest is predefined\nvar xmlHttp;\nif (typeof XMLHttpRequest != \x26quot;undefined\x26quot;) {\n    xmlHttp = new XMLHttpRequest();\n} else if (window.ActiveXObject) {\n    var aVersions = [\x26quot;Msxml2.XMLHttp.5.0\x26quot;, \x26quot;Msxml2.XMLHttp.4.0\x26quot;, \n        \x26quot;Msxml2.XMLHttp.3.0\x26quot;, \x26quot;Msxml2.XMLHttp\x26quot;, \x26quot;Microsoft.XMLHttp\x26quot;];\n    for (var i = 0; i \x3c aVersions.length; i\x2b\x2b) {\n        try {\n            xmlHttp = new ActiveXObject(aVersions[i]);\n            break;\n        } catch (e) {}\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Provide the XMLHttpRequest class for IE 5.x-6.x:\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Other browsers (including IE 7.x-8.x) ignore this\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/   when XMLHttpRequest is predefined\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xmlHttp;\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e XMLHttpRequest != \x3cspan class=\x22hljs-string\x22\x3e\x22undefined\x22\x3c\/span\x3e) {\n    xmlHttp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.ActiveXObject) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e aVersions = [\x3cspan class=\x22hljs-string\x22\x3e\x22Msxml2.XMLHttp.5.0\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22Msxml2.XMLHttp.4.0\x22\x3c\/span\x3e, \n        \x3cspan class=\x22hljs-string\x22\x3e\x22Msxml2.XMLHttp.3.0\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22Msxml2.XMLHttp\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22Microsoft.XMLHttp\x22\x3c\/span\x3e];\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; aVersions.length; i\x2b\x2b) {\n        \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n            xmlHttp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ActiveXObject(aVersions[i]);\n            \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n        } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e) {}\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e详细信息请参考 - \x3ca href=\x22http:\/\/caniuse.com\/#search=XMLHttpRequest\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCan I use XMLHttpRequest\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3eAJAX\/HTTP 库对比\x3c\/h3\x3e\n\x3cdiv class=\x22table-wrap\x22\x3e\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e \x3c\/th\x3e\n\x3cth\x3e \x3c\/th\x3e\n\x3cth\x3eSupport\x3c\/th\x3e\n\x3cth\x3e \x3c\/th\x3e\n\x3cth\x3e \x3c\/th\x3e\n\x3cth\x3e \x3c\/th\x3e\n\x3cth\x3eFeatures\x3c\/th\x3e\n\x3cth\x3e \x3c\/th\x3e\n\x3cth\x3e \x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3eAll Browsers\x3c\/td\x3e\n\x3ctd\x3eChrome \x26amp; Firefox1\x3c\/td\x3e\n\x3ctd\x3eNode\x3c\/td\x3e\n\x3ctd\x3eConcise Syntax\x3c\/td\x3e\n\x3ctd\x3ePromises\x3c\/td\x3e\n\x3ctd\x3eNative2\x3c\/td\x3e\n\x3ctd\x3eSingle Purpose3\x3c\/td\x3e\n\x3ctd\x3eFormal Specification\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/XMLHttpRequest\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eXMLHttpRequest\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/nodejs.org\/api\/http.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eNode HTTP\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/GlobalFetch\/fetch\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3efetch()\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/github.com\/github\/fetch\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFetch polyfill\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/github.com\/bitinn\/node-fetch\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3enode-fetch\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/github.com\/matthew-andrews\/isomorphic-fetch\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eisomorphic-fetch\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/github.com\/visionmedia\/superagent\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3esuperagent\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/github.com\/mzabriskie\/axios\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eaxios\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/github.com\/request\/request\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3erequest\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/jquery.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejQuery\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/github.com\/ded\/reqwest\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereqwest\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3ctd\x3e✓\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\x3c\/div\x3e\n\x3cp\x3e1 \x3cstrong\x3eChrome \x26amp; Firefox\x3c\/strong\x3e are listed separately because they support \x3ccode\x3efetch()\x3c\/code\x3e: \x3ca href=\x22http:\/\/caniuse.com\/fetch\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ecaniuse.com\/fetch\x3c\/a\x3e\x3cbr\x3e2 \x3cstrong\x3eNative:\x3c\/strong\x3e Meaning you can just use it - no need to include a library.\x3cbr\x3e3 \x3cstrong\x3eSingle Purpose:\x3c\/strong\x3e Meaning this library or technology is ONLY used for AJAX \/ HTTP communication, nothing else.\x3c\/p\x3e\n\x3cp\x3e详细信息请参考 - \x3ca href=\x22http:\/\/andrewhfarmer.com\/ajax-libraries\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAJAX\/HTTP Library Comparison\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3eXMLHTTP\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3eXMLHTTP 定义\x3c\/h3\x3e\n\x3cblockquote\x3e\n\x3cp\x3e\x3cstrong\x3eXMLHTTP\x3c\/strong\x3e 是一组\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/API\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAPI\x3c\/a\x3e函数集，可被\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/JavaScript\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScript\x3c\/a\x3e、JScript、\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/VBScript\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eVBScript\x3c\/a\x3e以及其它\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Web%E6%B5%8F%E8%A7%88%E5%99%A8\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eweb浏览器\x3c\/a\x3e内嵌的\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e脚本语言\x3c\/a\x3e调用，通过\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/HTTP\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eHTTP\x3c\/a\x3e在浏览器和\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Web%E6%9C%8D%E5%8A%A1%E5%99%A8\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eweb服务器\x3c\/a\x3e之间收发\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/XML\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eXML\x3c\/a\x3e或其它数据。XMLHTTP最大的好处在于可以动态地更新网页，它无需重新从服务器读取整个网页，也不需要安装额外的插件。该技术被许多网站使用，以实现快速响应的动态网页应用。例如：\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Google\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGoogle\x3c\/a\x3e的\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Gmail\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGmail\x3c\/a\x3e服务、Google Suggest动态查找界面以及\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Google%E5%9C%B0%E5%9B%BE\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGoogle Map\x3c\/a\x3e地理信息服务。\x3c\/p\x3e\n\x3cp\x3eXMLHTTP是\x3cstrong\x3eAJAX\x3c\/strong\x3e网页开发技术的重要组成部分。除XML之外，XMLHTTP还能用于获取其它格式的数据，如\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/JSON\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJSON\x3c\/a\x3e或者甚至纯文本。—— 维基百科\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3eXMLHTTP 背景知识\x3c\/h3\x3e\n\x3cblockquote\x3e\n\x3cp\x3eXMLHTTP最初是由微软公司发明的，在\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Internet_Explorer\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eInternet Explorer\x3c\/a\x3e\x26nbsp;5.0中用作\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/ActiveX\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eActiveX\x3c\/a\x3e对象，可通过JavaScript、VBScript或其它浏览器支持的脚本语言访问。\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Mozilla\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMozilla\x3c\/a\x3e的开发人员后来在Mozilla 1.0中实现了一个兼容的版本。之后苹果电脑公司在\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Safari\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSafari\x3c\/a\x3e\x26nbsp;1.2中开始支持XMLHTTP，而\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/Opera\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eOpera\x3c\/a\x3e从8.0版开始也宣布支持XMLHTTP。\x3c\/p\x3e\n\x3cp\x3e大多数使用了XMLHTTP的设计良好的网页，会使用简单的JavaScript函数，将不同浏览器之间调用XMLHTTP的差异性屏蔽，该函数会自动检测浏览器版本并隐藏不同环境的差异。\x3c\/p\x3e\n\x3cp\x3e在\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/DOM\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDOM\x3c\/a\x3e\x26nbsp;3（文档对象模型 Level 3）的读取和保存规范（Load and Save Specification）中也有类似的功能，它已经成为\x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/W3C\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eW3C\x3c\/a\x3e推荐的方法。截止2011年，大多数浏览器已经支持。—— 维基百科\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3eXMLHTTP 实现\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eActiveXObject\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eXMLHttpRequest\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3e什么是 ActiveX 控件\x3c\/h4\x3e\n\x3cp\x3eMicrosoft ActiveX 控件是由软件提供商开发的可重用的软件组件。使用 ActiveX 控件，可以很快地在网址、台式应用程序、以及开发工具中加入特殊的功能。例如，StockTicker 控件可以用来在网页上即时地加入活动信息，动画控件可用来向网页中加入动画特性。\x3c\/p\x3e\n\x3ch4\x3eActiveXObject 对象\x3c\/h4\x3e\n\x3cp\x3eJavaScript 中 ActiveXObject 对象是启用并返回 Automation 对象的引用。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eActiveXObject 语法\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22newObj = new ActiveXObject(servername.typename[, location])\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enewObj = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ActiveXObject(servername.typename[, location])\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e参数：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3enewObj\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e必选 - ActiveXObject\x26nbsp;分配到的变量名称\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eservername\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e必选 - 提供对象的应用程序名称\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3etypename\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e必选 - 要创建的对象的类型或类\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3elocation\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e可选 - 要再其中创建对象的网络服务器的名称\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3eActiveXObject 使用\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 在IE5.x和IE6下创建xmlHttp对象\n\/\/ servername - MSXML2\n\/\/ typename - XMLHTTP.3.0\nvar xmlHttp = new ActiveXObject(\x27MSXML2.XMLHTTP.3.0\x27);\nxmlHttp.open(\x26quot;GET\x26quot;, \x26quot;http:\/\/localhost\/books.xml\x26quot;, false);  \nxmlHttp.send();  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在IE5.x和IE6下创建xmlHttp对象\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ servername - MSXML2\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ typename - XMLHTTP.3.0\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xmlHttp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ActiveXObject(\x3cspan class=\x22hljs-string\x22\x3e\x27MSXML2.XMLHTTP.3.0\x27\x3c\/span\x3e);\nxmlHttp.open(\x3cspan class=\x22hljs-string\x22\x3e\x22GET\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/localhost\/books.xml\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);  \nxmlHttp.send();  \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e详细信息可以参考 - \x3ca href=\x22https:\/\/msdn.microsoft.com\/zh-cn\/library\/7sw4ddf8(v=vs.94\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emsdn - JavaScript 对象 - ActiveXObject 对象\x3c\/a\x3e.aspx)\x3c\/p\x3e\n\x3ch4\x3eXMLHttpRequest\x3c\/h4\x3e\n\x3cp\x3eXMLHttpRequest 是一个API, 它为客户端提供了在客户端和服务器之间传输数据的功能。它提供了一个通过 URL 来获取数据的简单方式，并且不会使整个页面刷新。这使得网页只更新一部分页面而不会打扰到用户。XMLHttpRequest 在\x26nbsp;\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/AJAX\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAJAX\x26nbsp;\x3c\/a\x3e中被大量使用。\x3c\/p\x3e\n\x3cp\x3eXMLHttpRequest 是一个\x26nbsp;\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-cn\/JavaScript\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScript\x3c\/a\x3e\x26nbsp;对象，它最初由微软设计,随后被 Mozilla、Apple 和 Google采纳. 如今,该对象已经被\x26nbsp;\x3ca href=\x22http:\/\/www.w3.org\/TR\/XMLHttpRequest\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eW3C组织标准化\x3c\/a\x3e. 通过它,你可以很容易的取回一个URL上的资源数据. 尽管名字里有XML, 但\x26nbsp;XMLHttpRequest\x26nbsp;可以取回所有类型的数据资源，并不局限于XML。 而且除了\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-cn\/HTTP\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eHTTP\x3c\/a\x3e\x26nbsp;,它还支持\x3ccode\x3efile\x3c\/code\x3e\x26nbsp;和\x26nbsp;\x3ccode\x3eftp\x3c\/code\x3e\x26nbsp;协议。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eXMLHttpRequest 语法\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var req = new XMLHttpRequest();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e req = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3eXMLHttpRequest 使用\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest(); \/\/ 创建xhr对象\nxhr.open( method, url );\nxhr.onreadystatechange = function () { ... };\nxhr.setRequestHeader( ..., ... );\nxhr.send( optionalEncodedData );\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建xhr对象\x3c\/span\x3e\nxhr.open( method, url );\nxhr.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... };\nxhr.setRequestHeader( ..., ... );\nxhr.send( optionalEncodedData );\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3eXMLHttpRequest 详解\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e构造函数\x3c\/h3\x3e\n\x3cp\x3e用于初始化一个 XMLHttpRequest 对象，必须在所有其它方法被调用前调用构造函数。使用示例如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var req = new XMLHttpRequest();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e req = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eXMLHttpRequest\x3c\/span\x3e();\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e属性\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eonreadystatechange:  Function - 当 readyState 属性改变时会调用它。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ereadyState:  unsigned short - 用于表示请求的五种状态：\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e值\x3c\/th\x3e\n\x3cth\x3e状态\x3c\/th\x3e\n\x3cth\x3e描述\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3e0\x3c\/td\x3e\n\x3ctd\x3eUNSENT (未打开)\x3c\/td\x3e\n\x3ctd\x3e表示已创建 XHR 对象，open() 方法还未被调用\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e1\x3c\/td\x3e\n\x3ctd\x3eOPENED (未发送)\x3c\/td\x3e\n\x3ctd\x3eopen() 方法已被成功调用，send() 方法还未被调用\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e2\x3c\/td\x3e\n\x3ctd\x3eHEADERS_RECEIVED (已获取响应头)\x3c\/td\x3e\n\x3ctd\x3esend() 方法已经被调用，响应头和响应状态已经返回\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e3\x3c\/td\x3e\n\x3ctd\x3eLOADING (正在下载响应体)\x3c\/td\x3e\n\x3ctd\x3e响应体下载中，responseText中已经获取了部分数据\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e4\x3c\/td\x3e\n\x3ctd\x3eDONE (请求完成)\x3c\/td\x3e\n\x3ctd\x3e整个请求过程已经完毕\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eresponse: varies - 响应体的类型由 responseType 来指定，可以是 ArrayBuffer、Blob、Document、JSON，或者是字符串。如果请求未完成或失败，则该值为 null。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eresponse: varies - 响应体的类型由 responseType 来指定，可以是 ArrayBuffer、Blob、Document、JSON，或者是字符串。如果请求未完成或失败，则该值为 null。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eresponseText: DOMString - 此请求的响应为文本，或者当请求未成功或还是未发送时未 null \x3cstrong\x3e(只读)\x3c\/strong\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eresponseType: XMLHttpRequestResponseType - 设置该值能够改变响应类型，就是告诉服务器你期望的响应格式：\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e值\x3c\/th\x3e\n\x3cth\x3e响应数据类型\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x22\x22 (空字符串)\x3c\/td\x3e\n\x3ctd\x3e字符串(默认值)\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x22arraybuffer\x22\x3c\/td\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/ArrayBuffer\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eArrayBuffer\x3c\/a\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x22blob\x22\x3c\/td\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/Blob\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eBlob\x3c\/a\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x22document\x22\x3c\/td\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/Document\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDocument\x3c\/a\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x22json\x22\x3c\/td\x3e\n\x3ctd\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/JSON\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJSON\x3c\/a\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x22text\x22\x3c\/td\x3e\n\x3ctd\x3e字符串\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cp\x3exhr.spec 规范中定义的 XMLHttpRequestResponseType 类型如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22enum XMLHttpRequestResponseType {\n  \x26quot;\x26quot;,\n  \x26quot;arraybuffer\x26quot;,\n  \x26quot;blob\x26quot;,\n  \x26quot;document\x26quot;,\n  \x26quot;json\x26quot;,\n  \x26quot;text\x26quot;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eenum\x3c\/span\x3e XMLHttpRequestResponseType {\n  \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22arraybuffer\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22blob\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22document\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22json\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22text\x22\x3c\/span\x3e\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\x3c\/ul\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3eresponseXML: Document - 本次请求响应式一个 Document 对象，如果是以下情况则值为 null：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e请求未成功\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e请求未发送\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e响应无法被解析成 XML 或 HTML\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3estatus: unsigned short - 请求的响应状态码，如 200 (表示一个成功的请求)。  \x3cstrong\x3e(只读)\x3c\/strong\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3estatusText: DOMString - 请求的响应状态信息，包含一个状态码和消息文本，如 \x22200 OK\x22。 \x3cstrong\x3e(只读)\x3c\/strong\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3etimeout: unsigned long - 表示一个请求在被自动终止前所消耗的毫秒数。默认值为 0，意味着没有超时时间。超时并不能应用在同步请求中，否则会抛出一个 InvalidAccessError 异常。当发生超时时，timeout 事件将会被触发。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eupload: XMLHttpRequestUpload - 可以在 upload 上添加一个事件监听来跟踪上传过程\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ewithCredentials: boolean -  表明在进行跨站 (cross-site) 的访问控制 (Access-Control) 请求时，是否使用认证信息 (例如cookie或授权的header)。默认为 false。\x3cstrong\x3e注意：这不会影响同站 same-site 请求\x3c\/strong\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e方法\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eabort() - 如果请求已经被发送，则立刻中止请求。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3egetAllResponseHeaders() - 返回所有响应头信息(响应头名和值)，如果响应头还没有接收，则返回 null。\x3cstrong\x3e注意：使用该方法获取的 response headers 与在开发者工具 Network 面板中看到的响应头不一致\x3c\/strong\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3egetResponseHeader() - 返回指定响应头的值，如果响应头还没有被接收，或该响应头不存在，则返回 null。\x3cstrong\x3e注意：使用该方法获取某些响应头时，浏览器会抛出异常，具体原因如下：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.w3.org\/TR\/XMLHttpRequest\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eW3C的 xhr 标准中做了限制\x3c\/a\x3e，规定客户端无法获取 response 中的 \x3ccode\x3eSet-Cookie\x3c\/code\x3e、\x3ccode\x3eSet-Cookie2 \x3c\/code\x3e这2个字段，无论是同域还是跨域请求。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.w3.org\/TR\/cors\/#access-control-allow-credentials-response-header\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eW3C 的 cors 标准对于跨域请求也做了限制\x3c\/a\x3e，规定对于跨域请求，客户端允许获取的response header字段只限于 \x3ca href=\x22https:\/\/www.w3.org\/TR\/cors\/#ascii-case-insensitive\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3esimple response header\x3c\/a\x3e (常见的 simple response header 如下)\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eCache-Control\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eContent-Language\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eContent-Type\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eExpires\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eLast-Modified\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ePragma\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e和 Access-Control-Expose-Headers。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eopen() - 初始化一个请求：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e方法签名：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22void open(\n   DOMString method,\n   DOMString url,\n   optional boolean async,\n   optional DOMString user,\n   optional DOMString password\n);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs oxygene\x22\x3e\x3ccode\x3evoid open(\n   DOMString \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3emethod\x3c\/span\x3e,\n   \x3cspan class=\x22hljs-title\x22\x3eDOMString\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eurl\x3c\/span\x3e,\n   \x3cspan class=\x22hljs-title\x22\x3eoptional\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eboolean\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3easync\x3c\/span\x3e,\n   \x3cspan class=\x22hljs-title\x22\x3eoptional\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eDOMString\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3euser\x3c\/span\x3e,\n   \x3cspan class=\x22hljs-title\x22\x3eoptional\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eDOMString\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3epassword\x3c\/span\x3e\n);\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e参数：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3emethod - 请求所使用的 HTTP 方法，如 GET、POST、PUT、DELETE\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eurl - 请求的 URL 地址\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3easync - 一个可选的布尔值参数，默认值为 true，表示执行异步操作。如果值为 false，则 send() 方法不会返回任何东西，直到接收到了服务器的返回数据\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3euser - 用户名，可选参数，用于授权。默认参数为空字符串\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3epassword - 密码，可选参数，用于授权。默认参数为空字符串\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e备注：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e如果 method 不是有效的 HTTP 方法或 url 地址不能被成功解析，将会抛出 \x3ccode\x3eSyntaxError\x3c\/code\x3e 异常\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e如果请求方法(不区分大小写)为 \x3ccode\x3eCONNECT\x3c\/code\x3e、\x3ccode\x3eTRACE\x3c\/code\x3e 或 \x3ccode\x3eTRACK\x3c\/code\x3e 将会抛出 \x3ccode\x3eSecurityError\x3c\/code\x3e 异常\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eoverrideMimeType() - 重写由服务器返回的 \x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/%E5%A4%9A%E7%94%A8%E9%80%94%E4%BA%92%E8%81%AF%E7%B6%B2%E9%83%B5%E4%BB%B6%E6%93%B4%E5%B1%95\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMIME\x3c\/a\x3e 类型。例如，可以用于强制把响应流当做 \x3ccode\x3etext\/xml\x3c\/code\x3e 来解析，即使服务器没有指明数据是这个类型。\x3cstrong\x3e注意：这个方法必须在 send() 之前被调用。\x3c\/strong\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3esend() - 发送请求。如果该请求是异步模式(默认)，该方法会立刻返回。相反，如果请求是同步模式，则直到请求的响应完全接受以后，该方法才会返回。\x3cstrong\x3e注意：所有相关的事件绑定必须在调用 send() 方法之前进行。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cp\x3e方法签名：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22void send();\nvoid send(ArrayBuffer data);\nvoid send(Blob data);\nvoid send(Document data);\nvoid send(DOMString? data);\nvoid send(FormData data);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cpp\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esend\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e;\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esend\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(ArrayBuffer data)\x3c\/span\x3e\x3c\/span\x3e;\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esend\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(Blob data)\x3c\/span\x3e\x3c\/span\x3e;\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esend\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(Document data)\x3c\/span\x3e\x3c\/span\x3e;\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esend\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(DOMString? data)\x3c\/span\x3e\x3c\/span\x3e;\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esend\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(FormData data)\x3c\/span\x3e\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3esetRequestHeader() - 设置 HTTP 请求头信息。\x3cstrong\x3e注意：在这之前，你必须确认已经调用了 open() 方法打开了一个 url\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e方法签名：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22void setRequestHeader(\n   DOMString header,\n   DOMString value\n);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cs\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esetRequestHeader\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\n   DOMString header,\n   DOMString \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e\n\x3c\/span\x3e)\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e参数：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eheader - 请求头名称\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evalue - 请求头的值\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3esendAsBinary() - 发送二进制的 send() 方法的变种。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e方法签名：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22void sendAsBinary(\n   in DOMString body\n);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cs\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esendAsBinary\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\n   \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e DOMString body\n\x3c\/span\x3e)\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e参数：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3ebody - 消息体\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3e浏览器兼容性\x3c\/h3\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3eDesktop\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3eFeature\x3c\/th\x3e\n\x3cth\x3eChrome\x3c\/th\x3e\n\x3cth\x3eFirefox (Gecko)\x3c\/th\x3e\n\x3cth\x3eInternet Explorer\x3c\/th\x3e\n\x3cth\x3eOpera\x3c\/th\x3e\n\x3cth\x3eSafari (WebKit)\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3eBasic support (XHR1)\x3c\/td\x3e\n\x3ctd\x3e1\x3c\/td\x3e\n\x3ctd\x3e1.0\x3c\/td\x3e\n\x3ctd\x3e5 (via ActiveXObject)7 (XMLHttpRequest)\x3c\/td\x3e\n\x3ctd\x3e(Yes)\x3c\/td\x3e\n\x3ctd\x3e1.2\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3esend(ArrayBuffer)\x3c\/td\x3e\n\x3ctd\x3e9\x3c\/td\x3e\n\x3ctd\x3e9\x3c\/td\x3e\n\x3ctd\x3e?\x3c\/td\x3e\n\x3ctd\x3e11.60\x3c\/td\x3e\n\x3ctd\x3e?\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3esend(Blob)\x3c\/td\x3e\n\x3ctd\x3e7\x3c\/td\x3e\n\x3ctd\x3e3.6\x3c\/td\x3e\n\x3ctd\x3e?\x3c\/td\x3e\n\x3ctd\x3e12\x3c\/td\x3e\n\x3ctd\x3e?\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3esend(FormData)\x3c\/td\x3e\n\x3ctd\x3e6\x3c\/td\x3e\n\x3ctd\x3e4\x3c\/td\x3e\n\x3ctd\x3e?\x3c\/td\x3e\n\x3ctd\x3e12\x3c\/td\x3e\n\x3ctd\x3e?\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eresponse\x3c\/td\x3e\n\x3ctd\x3e10\x3c\/td\x3e\n\x3ctd\x3e6\x3c\/td\x3e\n\x3ctd\x3e10\x3c\/td\x3e\n\x3ctd\x3e11.60\x3c\/td\x3e\n\x3ctd\x3e?\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eresponseType = \x27arraybuffer\x27\x3c\/td\x3e\n\x3ctd\x3e10\x3c\/td\x3e\n\x3ctd\x3e6\x3c\/td\x3e\n\x3ctd\x3e10\x3c\/td\x3e\n\x3ctd\x3e11.60\x3c\/td\x3e\n\x3ctd\x3e?\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eresponseType = \x27blob\x27\x3c\/td\x3e\n\x3ctd\x3e19\x3c\/td\x3e\n\x3ctd\x3e6\x3c\/td\x3e\n\x3ctd\x3e10\x3c\/td\x3e\n\x3ctd\x3e12\x3c\/td\x3e\n\x3ctd\x3e?\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eresponseType = \x27document\x27\x3c\/td\x3e\n\x3ctd\x3e18\x3c\/td\x3e\n\x3ctd\x3e11\x3c\/td\x3e\n\x3ctd\x3e未实现\x3c\/td\x3e\n\x3ctd\x3e未实现\x3c\/td\x3e\n\x3ctd\x3e未实现\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eresponseType = \x27json\x27\x3c\/td\x3e\n\x3ctd\x3e未实现\x3c\/td\x3e\n\x3ctd\x3e10\x3c\/td\x3e\n\x3ctd\x3e未实现\x3c\/td\x3e\n\x3ctd\x3e12\x3c\/td\x3e\n\x3ctd\x3e未实现\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eProgress Events\x3c\/td\x3e\n\x3ctd\x3e7\x3c\/td\x3e\n\x3ctd\x3e3.5\x3c\/td\x3e\n\x3ctd\x3e10\x3c\/td\x3e\n\x3ctd\x3e12\x3c\/td\x3e\n\x3ctd\x3e?\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3ewithCredentials\x3c\/td\x3e\n\x3ctd\x3e3\x3c\/td\x3e\n\x3ctd\x3e3.5\x3c\/td\x3e\n\x3ctd\x3e10\x3c\/td\x3e\n\x3ctd\x3e12\x3c\/td\x3e\n\x3ctd\x3e4\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3e事件\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/Events\/loadstart\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eloadstart\x3c\/a\x3e - 当程序开始加载时，loadstart 事件将被触发。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/Events\/%E8%BF%9B%E5%BA%A6%E6%9D%A1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eprogress\x3c\/a\x3e - 进度事件会被触发用来指示一个操作正在进行中。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/Events\/abort\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eabort\x3c\/a\x3e - 当一个资源的加载已中止时，将触发\x26nbsp;abort 事件。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/Events\/error\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eerror\x3c\/a\x3e - 当一个资源加载失败时会触发error事件。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/Events\/load\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eload\x3c\/a\x3e - 当一个资源及其依赖资源已完成加载时，将触发load事件。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/Events\/timeout\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etimeout\x3c\/a\x3e - 当进度由于预定时间到期而终止时，会触发timeout\x26nbsp;事件。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/Events\/loadend\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eloadend\x3c\/a\x3e - 当一个资源加载进度停止时 (例如，在已经分派“错误”，“中止”或“加载”之后)，触发loadend事件。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/Events\/readystatechange\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereadystatechange\x3c\/a\x3e - readystatechange 事件会在 document.readyState属性发生变化时触发。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader15\x22\x3eXMLHttpRequest Level 1\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3eXMLHttpRequest Level 1 使用\x3c\/h3\x3e\n\x3cp\x3e首先，创建一个 XMLHttpRequest 对象：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后，向服务器发出一个 HTTP 请求：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22xhr.open(\x27GET\x27, \x27example.php\x27);\nxhr.send();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3exhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27example.php\x27\x3c\/span\x3e);\nxhr.send();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接着，就等待远程主机做出回应。这时需要监控XMLHttpRequest对象的状态变化，指定回调函数。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22xhr.onreadystatechange = function(){\n　　if ( xhr.readyState == 4 \x26amp;\x26amp; xhr.status == 200 ) {\n　　　　　alert( xhr.responseText );\n　　} else {\n　　　　　alert( xhr.statusText );\n　　}\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3exhr.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n　　\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ( xhr.readyState == \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e \x26amp;\x26amp; xhr.status == \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e ) {\n　　　　　alert( xhr.responseText );\n　　} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n　　　　　alert( xhr.statusText );\n　　}\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的代码包含了老版本 XMLHttpRequest 对象的主要属性：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3exhr.readyState： XMLHttpRequest对象的状态，等于4表示数据已经接收完毕。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3exhr.status：服务器返回的状态码，等于200表示一切正常。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3exhr.responseText：服务器返回的文本数据。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3exhr.statusText：服务器返回的状态文本。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader17\x22\x3eXMLHttpRequest Level 1 缺点\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e只支持文本数据的传送，无法用来读取和上传二进制文件。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e传送和接收数据时，没有进度信息，只能提示有没有完成。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e受到\x3ca href=\x22http:\/\/www.w3.org\/Security\/wiki\/Same_Origin_Policy\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x22同域限制\x22\x3c\/a\x3e（Same Origin Policy），只能向同一域名的服务器请求数据。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader18\x22\x3eXMLHttpRequest Level 2\x3c\/h2\x3e\n\x3cp\x3eXMLHttpRequest Level 2 针对 XMLHttpRequest Level 1 的缺点，做了大幅改进。具体如下：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e可以设置HTTP请求的超时时间。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e可以使用FormData对象管理表单数据。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e可以上传文件。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e可以请求不同域名下的数据（跨域请求）。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e可以获取服务器端的二进制数据。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e可以获得数据传输的进度信息。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader19\x22\x3e设置超时时间\x3c\/h3\x3e\n\x3cp\x3e新版本 XMLHttpRequest 对象，增加了 timeout 属性，可以设置HTTP请求的时限。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22　xhr.timeout = 3000;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs abnf\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e　xhr.timeout = \x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的语句，将最长等待时间设为3000毫秒。过了这个时限，就自动停止HTTP请求。与之配套的还有一个timeout事件，用来指定回调函数。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22xhr.ontimeout = function(event){\n　　console.log(\x27请求超时\x27);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3exhr.ontimeout = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e)\x3c\/span\x3e{\n　　\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27请求超时\x27\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader20\x22\x3eFormData 对象\x3c\/h3\x3e\n\x3cp\x3eAJAX 操作往往用来传递表单数据。为了方便表单处理，HTML 5新增了一个 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/FormData\/FormData\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFormData\x3c\/a\x3e 对象，可以用于模拟表单。\x3c\/p\x3e\n\x3ch4\x3eFormData 简介\x3c\/h4\x3e\n\x3cp\x3e\x3cstrong\x3e构造函数 FormData()\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e用于创建一个新的 FormData 对象。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e语法\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var formData = new FormData(form)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e formData = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FormData(form)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cp\x3e参数\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3eform 可选 - 一个 HTML 上的 \x3ccode\x3e\x26lt;form\x26gt;\x3c\/code\x3e 表单元素。当使用 form 参数，创建的 FormData 对象会自动将 form 中的表单值也包含进去，文件内容会被编码\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\x3c\/ul\x3e\n\x3ch4\x3eFormData 使用\x3c\/h4\x3e\n\x3cp\x3e首先，新建一个 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/FormData\/FormData\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFormData\x3c\/a\x3e 对象：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var formData = new FormData();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e formData = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FormData();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后，为它添加表单项：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22formData.append(\x27username\x27, \x27semlinker\x27);\nformData.append(\x27id\x27, 2005821040);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eformData.append(\x3cspan class=\x22hljs-string\x22\x3e\x27username\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27semlinker\x27\x3c\/span\x3e);\nformData.append(\x3cspan class=\x22hljs-string\x22\x3e\x27id\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2005821040\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后，直接传送这个FormData对象。这与提交网页表单的效果，完全一样。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22xhr.send(formData);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3exhr.send(formData);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eFormData 对象也可以用来获取网页表单的值。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var form = document.getElementById(\x27myform\x27); \/\/ 获取页面上表单对象\nvar formData = new FormData(form);\nformData.append(\x27username\x27, \x27semlinker\x27); \/\/ 添加一个表单项\nxhr.open(\x27POST\x27, form.action);\nxhr.send(formData);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e form = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27myform\x27\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取页面上表单对象\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e formData = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FormData(form);\nformData.append(\x3cspan class=\x22hljs-string\x22\x3e\x27username\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27semlinker\x27\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加一个表单项\x3c\/span\x3e\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e, form.action);\nxhr.send(formData);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader21\x22\x3e上传文件\x3c\/h3\x3e\n\x3cp\x3e新版 XMLHttpRequest 对象，不仅可以发送文本信息，还可以上传文件。\x3c\/p\x3e\n\x3cp\x3e1.为了上传文件, 我们得先选中一个文件. 一个 type 为 file 的 input 输入框\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cinput id=\x26quot;input\x26quot; type=\x26quot;file\x26quot;\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22input\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.然后用 FormData 对象包裹选中的文件\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var input = document.getElementById(\x26quot;input\x26quot;),\n    formData = new FormData();\nformData.append(\x26quot;file\x26quot;,input.files[0]); \/\/ file名称与后台接收的名称一致\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3einput\x3c\/span\x3e = document.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22input\x22\x3c\/span\x3e),\n    formData = new FormData();\nformData.\x3cspan class=\x22hljs-keyword\x22\x3eappend\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-keyword\x22\x3einput\x3c\/span\x3e.files[0]); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ file名称与后台接收的名称一致\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e3.设置上传地址和请求方法\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var url = \x26quot;http:\/\/localhost:3000\/upload\x26quot;,\n    method = \x26quot;POST\x26quot;;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e url = \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/localhost:3000\/upload\x22\x3c\/span\x3e,\n    method = \x3cspan class=\x22hljs-string\x22\x3e\x22POST\x22\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e4.发送 FormData 对象\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22xhr.send(formData);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3exhr.send(formData);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader22\x22\x3e跨域资源共享 (CORS)\x3c\/h3\x3e\n\x3cp\x3e新版本的 XMLHttpRequest 对象，可以向不同域名的服务器发出 HTTP 请求。这叫做 \x3ca href=\x22http:\/\/en.wikipedia.org\/wiki\/Cross-Origin_Resource_Sharing\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x22跨域资源共享\x22\x3c\/a\x3e（Cross-origin resource sharing，简称 CORS）。\x3c\/p\x3e\n\x3cp\x3e使用\x22跨域资源共享\x22的前提，是浏览器必须支持这个功能，而且服务器端必须同意这种\x22跨域\x22。如果能够满足上面的条件，则代码的写法与不跨域的请求完全一样。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22xhr.open(\x27GET\x27, \x27http:\/\/other.server\/and\/path\/to\/script\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3exhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/other.server\/and\/path\/to\/script\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader23\x22\x3e接收二进制数据\x3c\/h3\x3e\n\x3cp\x3eXMLHttpRequest Level 1 XMLHttpRequest 对象只能处理文本数据，新版则可以处理二进制数据。从服务器取回二进制数据，较新的方法是使用新增的 responseType 属性。如果服务器返回文本数据，这个属性的值是 \x22TEXT\x22，这是默认值。较新的浏览器还支持其他值，也就是说，可以接收其他格式的数据。\x3c\/p\x3e\n\x3cp\x3e你可以把 responseType 设为 blob，表示服务器传回的是二进制对象。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\nxhr.open(\x27GET\x27, \x27\/path\/to\/image.png\x27);\nxhr.responseType = \x27blob\x27;\nxhr.send();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/path\/to\/image.png\x27\x3c\/span\x3e);\nxhr.responseType = \x3cspan class=\x22hljs-string\x22\x3e\x27blob\x27\x3c\/span\x3e;\nxhr.send();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接收数据的时候，用浏览器自带的 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/Blob\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eBlob\x3c\/a\x3e 对象即可。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e一个 \x26nbsp;\x3cstrong\x3eBlob \x3c\/strong\x3e对象表示一个不可变的, 原始数据的类似文件对象。Blob 表示的数据不一定是一个 JavaScript 原生格式。\x26nbsp;\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/File\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eFile\x3c\/code\x3e\x3c\/a\x3e\x26nbsp;接口基于Blob，继承 blob功能并将其扩展为支持用户系统上的文件。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var blob = new Blob([xhr.response], {type: \x27image\/png\x27});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e blob = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Blob([xhr.response], {\x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27image\/png\x27\x3c\/span\x3e});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e更多示例请参考\x26nbsp;\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-cn\/DOM\/XMLHttpRequest\/Sending_and_Receiving_Binary_Data\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e发送和接收二进制数据\x3c\/a\x3e\x26nbsp;。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader24\x22\x3e进度信息\x3c\/h3\x3e\n\x3cp\x3e新版本的 XMLHttpRequest 对象，传送数据的时候，有一个 progress 事件，用来返回进度信息。\x3c\/p\x3e\n\x3cp\x3e它分成上传和下载两种情况。下载的 progress 事件属于 XMLHttpRequest 对象，上传的 progress 事件属于XMLHttpRequest.upload 对象。\x3c\/p\x3e\n\x3cp\x3e我们先定义progress事件的回调函数：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22xhr.onprogress = updateProgress;\nxhr.upload.onprogress = updateProgress;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3exhr.onprogress = updateProgress;\nxhr.upload.onprogress = updateProgress;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后，在回调函数里面，使用这个事件的一些属性。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function updateProgress(event) {\n　　if (event.lengthComputable) {\n　　　　var percentComplete = event.loaded \/ event.total;\n　　}\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eupdateProgress\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n　　\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.lengthComputable) {\n　　　　\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e percentComplete = event.loaded \/ event.total;\n　　}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的代码中，event.total 是需要传输的总字节，event.loaded 是已经传输的字节。如果event.lengthComputable 不为真，则 event.total 等于0。\x3c\/p\x3e\n\x3cp\x3e各个浏览器 XMLHttpRequest Level 2 的兼容性 - \x3ca href=\x22http:\/\/caniuse.com\/#feat=xhr2\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCan I use\/xhr2\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader25\x22\x3eXHR 下载数据\x3c\/h2\x3e\n\x3cp\x3eXHR 可以传输基于文本和二进制数据。实际上，浏览器可以为各种本地数据类型提供自动编码和解码，这样可以让应用程序将这些类型直接传递给XHR，以便正确编码，反之亦然，这些类型可以由浏览器自动解码：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eArrayBuffer - 固定长度二进制数据缓冲区\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eBlob - 二进制不可变数据\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eDocument - HTML或XML文档\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eJSON - JavaScript Object Notation\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eText - 普通文本\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3eXHR 下载图片示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\n    xhr.open(\x27GET\x27, \x27https:\/\/avatars2.githubusercontent.com\/u\/4220799?v=3\x27);\n    xhr.responseType = \x27blob\x27; \/\/ 1\n\n    xhr.onload = function() {\n        if (this.status == 200) {\n            var img = document.createElement(\x27img\x27);\n            img.src = window.URL.createObjectURL(this.response); \/\/ 2\n            img.onload = function() {\n                window.URL.revokeObjectURL(this.src); \/\/3\n            };\n            document.body.appendChild(img);\n        }\n    };\n    xhr.send();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n    xhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/avatars2.githubusercontent.com\/u\/4220799?v=3\x27\x3c\/span\x3e);\n    xhr.responseType = \x3cspan class=\x22hljs-string\x22\x3e\x27blob\x27\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1\x3c\/span\x3e\n\n    xhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.status == \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e img = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27img\x27\x3c\/span\x3e);\n            img.src = \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.URL.createObjectURL(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.response); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2\x3c\/span\x3e\n            img.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.URL.revokeObjectURL(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.src); \x3cspan class=\x22hljs-comment\x22\x3e\/\/3\x3c\/span\x3e\n            };\n            \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(img);\n        }\n    };\n    xhr.send();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e(1) 设置响应的数据类型为 blob\x3c\/p\x3e\n\x3cp\x3e(2) 基于Blob创建一个唯一的对象URL，并作为图片的源地址 (\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/URL\/createObjectURL\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eURL.createObjectURL()\x3c\/a\x3e)\x3c\/p\x3e\n\x3cp\x3e(3) 图片加载成功后释放对象的URL(\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/URL\/revokeObjectURL\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eURL.revokeObjectURL()\x3c\/a\x3e)\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader26\x22\x3eXHR 上传数据\x3c\/h2\x3e\n\x3cp\x3e通过 XHR 上传数据对于所有数据类型来说都是简单而有效的。实际上，唯一的区别是当我们在XHR请求中调用 send() 时，我们需传递不同的数据对象。其余的由浏览器处理：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\nxhr.open(\x27POST\x27,\x27\/upload\x27);\nxhr.onload = function() { ... };\nxhr.send(\x26quot;text string\x26quot;); \/\/ 1\n\nvar formData = new FormData(); \/\/ 2\nformData.append(\x27id\x27, 123456);\nformData.append(\x27topic\x27, \x27performance\x27);\n\nvar xhr = new XMLHttpRequest();\nxhr.open(\x27POST\x27, \x27\/upload\x27);\nxhr.onload = function() { ... };\nxhr.send(formData); \/\/ 3\n\nvar xhr = new XMLHttpRequest();\nxhr.open(\x27POST\x27, \x27\/upload\x27);\nxhr.onload = function() { ... };\nvar uInt8Array = new Uint8Array([1, 2, 3]); \/\/ 4\nxhr.send(uInt8Array.buffer); \/\/ 5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27\/upload\x27\x3c\/span\x3e);\nxhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... };\nxhr.send(\x3cspan class=\x22hljs-string\x22\x3e\x22text string\x22\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e formData = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FormData(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2\x3c\/span\x3e\nformData.append(\x3cspan class=\x22hljs-string\x22\x3e\x27id\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e123456\x3c\/span\x3e);\nformData.append(\x3cspan class=\x22hljs-string\x22\x3e\x27topic\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27performance\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/upload\x27\x3c\/span\x3e);\nxhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... };\nxhr.send(formData); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 3\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/upload\x27\x3c\/span\x3e);\nxhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... };\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e uInt8Array = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eUint8Array\x3c\/span\x3e([\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e]); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 4\x3c\/span\x3e\nxhr.send(uInt8Array.buffer); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e(1) 发送普通的文本到服务器\x3c\/p\x3e\n\x3cp\x3e(2) 通过 FormData API 创建动态表单\x3c\/p\x3e\n\x3cp\x3e(3) 发送 FormData 数据到服务器\x3c\/p\x3e\n\x3cp\x3e(4) 创建 Unit8Array 数组 (\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Uint8Array\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eUint8Array\x3c\/a\x3e 数组类型表示一个8位无符号整型数组，创建时内容被初始化为0)\x3c\/p\x3e\n\x3cp\x3e(5) 发送二进制数据到服务器\x3c\/p\x3e\n\x3cp\x3eXHR send() 方法签名：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22void send();\nvoid send(ArrayBuffer data);\nvoid send(Blob data);\nvoid send(Document data);\nvoid send(DOMString? data);\nvoid send(FormData data);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e send();\n\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e send(\x3cspan class=\x22hljs-built_in\x22\x3eArrayBuffer\x3c\/span\x3e data);\n\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e send(Blob data);\n\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e send(Document data);\n\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e send(DOMString? data);\n\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e send(FormData data);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e除此之外，XHR 还支持大文件分块传输：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var blob = ...; \/\/ 1\n\nconst BYTES_PER_CHUNK = 1024 * 1024; \/\/ 2\nconst SIZE = blob.size;\n\nvar start = 0;\nvar end = BYTES_PER_CHUNK;\n\nwhile(start \x3c SIZE) { \/\/ 3\n  var xhr = new XMLHttpRequest();\n  xhr.open(\x27POST\x27, \x27\/upload\x27);\n  xhr.onload = function() { ... };\n\n  xhr.setRequestHeader(\x27Content-Range\x27, start\x2b\x27-\x27\x2bend\x2b\x27\/\x27\x2bSIZE); \/\/ 4\n  xhr.send(blob.slice(start, end)); \/\/ 5\n\n  start = end;\n  end = start \x2b BYTES_PER_CHUNK;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e blob = ...; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e BYTES_PER_CHUNK = \x3cspan class=\x22hljs-number\x22\x3e1024\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e1024\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SIZE = blob.size;\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e start = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e end = BYTES_PER_CHUNK;\n\n\x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e(start \x26lt; SIZE) { \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 3\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n  xhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/upload\x27\x3c\/span\x3e);\n  xhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... };\n\n  xhr.setRequestHeader(\x3cspan class=\x22hljs-string\x22\x3e\x27Content-Range\x27\x3c\/span\x3e, start\x2b\x3cspan class=\x22hljs-string\x22\x3e\x27-\x27\x3c\/span\x3e\x2bend\x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e\x2bSIZE); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 4\x3c\/span\x3e\n  xhr.send(blob.slice(start, end)); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 5\x3c\/span\x3e\n\n  start = end;\n  end = start \x2b BYTES_PER_CHUNK;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e(1) 一个任意的数据块 (二进制或文本)\x3c\/p\x3e\n\x3cp\x3e(2) 将数据库大小设置为 1MB\x3c\/p\x3e\n\x3cp\x3e(3) 迭代提供的数据，增量为1MB\x3c\/p\x3e\n\x3cp\x3e(4) 设置上传的数据范围 (\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/HTTP\/Headers\/Content-Range\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eContent-Range请求头\x3c\/a\x3e)\x3c\/p\x3e\n\x3cp\x3e(5) 通过 XHR 上传 1MB 数据块\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader27\x22\x3e监听上传和下载进度\x3c\/h2\x3e\n\x3cp\x3eXHR 对象提供了一系列 API，用于监听进度事件，表示请求的当前状态：\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e事件类型\x3c\/th\x3e\n\x3cth\x3e描述\x3c\/th\x3e\n\x3cth\x3e触发次数\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3eloadstart\x3c\/td\x3e\n\x3ctd\x3e开始传输\x3c\/td\x3e\n\x3ctd\x3e1次\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eprogress\x3c\/td\x3e\n\x3ctd\x3e传输中\x3c\/td\x3e\n\x3ctd\x3e0次或多次\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eerror\x3c\/td\x3e\n\x3ctd\x3e传输中出现错误\x3c\/td\x3e\n\x3ctd\x3e0次或1次\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eabort\x3c\/td\x3e\n\x3ctd\x3e传输被用户取消\x3c\/td\x3e\n\x3ctd\x3e0次或1次\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eload\x3c\/td\x3e\n\x3ctd\x3e传输成功\x3c\/td\x3e\n\x3ctd\x3e0次或1次\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eloadend\x3c\/td\x3e\n\x3ctd\x3e传输完成\x3c\/td\x3e\n\x3ctd\x3e1次\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cp\x3e每个 XHR 传输都以 \x3ccode\x3eloadstart\x3c\/code\x3e 事件开始，并以 \x3ccode\x3eloadend\x3c\/code\x3e 事件结束，并在这两个事件期间触发一个或多个附加事件来指示传输的状态。因此，为了监控进度，应用程序可以在 XHR 对象上注册一组 JavaScript 事件侦听器：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\nxhr.open(\x27GET\x27,\x27\/resource\x27);\nxhr.timeout = 5000; \/\/ 1\n\nxhr.addEventListener(\x27load\x27, function() { ... }); \/\/ 2\nxhr.addEventListener(\x27error\x27, function() { ... }); \/\/ 3\n\nvar onProgressHandler = function(event) {\n  if(event.lengthComputable) {\n    var progress = (event.loaded \/ event.total) * 100; \/\/ 4\n    ...\n  }\n}\n\nxhr.upload.addEventListener(\x27progress\x27, onProgressHandler); \/\/ 5\nxhr.addEventListener(\x27progress\x27, onProgressHandler); \/\/ 6\nxhr.send();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27\/resource\x27\x3c\/span\x3e);\nxhr.timeout = \x3cspan class=\x22hljs-number\x22\x3e5000\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1\x3c\/span\x3e\n\nxhr.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27load\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... }); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2\x3c\/span\x3e\nxhr.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... }); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 3\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e onProgressHandler = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(event.lengthComputable) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e progress = (event.loaded \/ event.total) * \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 4\x3c\/span\x3e\n    ...\n  }\n}\n\nxhr.upload.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27progress\x27\x3c\/span\x3e, onProgressHandler); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 5\x3c\/span\x3e\nxhr.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27progress\x27\x3c\/span\x3e, onProgressHandler); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 6\x3c\/span\x3e\nxhr.send();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e(1) 设置请求超时时间为 5,000 ms (默认无超时时间)\x3c\/p\x3e\n\x3cp\x3e(2) 注册成功回调\x3c\/p\x3e\n\x3cp\x3e(3) 注册异常回调\x3c\/p\x3e\n\x3cp\x3e(4) 计算已完成的进度\x3c\/p\x3e\n\x3cp\x3e(5) 注册上传进度事件回调\x3c\/p\x3e\n\x3cp\x3e(6) 注册下载进度事件回调\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader28\x22\x3e使用XHR流式传输数据\x3c\/h2\x3e\n\x3cp\x3e在某些情况下，应用程序可能需要或希望逐步处理数据流：将数据上传到服务器，使其在客户机上可用，或者在从服务器下载数据时，进行流式处理。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\nxhr.open(\x27GET\x27, \x27\/stream\x27);\nxhr.seenBytes = 0;\n\nxhr.onreadystatechange = function() {  \/\/ 1\n  if(xhr.readyState \x3e 2) {\n    var newData = xhr.responseText.substr(xhr.seenBytes); \/\/ 2\n    \/\/ process newData\n    xhr.seenBytes = xhr.responseText.length; \/\/ 3\n  }\n};\n\nxhr.send();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/stream\x27\x3c\/span\x3e);\nxhr.seenBytes = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\nxhr.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(xhr.readyState \x26gt; \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e newData = xhr.responseText.substr(xhr.seenBytes); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ process newData\x3c\/span\x3e\n    xhr.seenBytes = xhr.responseText.length; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 3\x3c\/span\x3e\n  }\n};\n\nxhr.send();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e(1) 监听 onreadystatechange 事件\x3c\/p\x3e\n\x3cp\x3e(2) 从部分响应中提取新数据\x3c\/p\x3e\n\x3cp\x3e(3) 更新处理的字节偏移\x3c\/p\x3e\n\x3cp\x3e这个例子可以在大多数现代浏览器中使用。但是,性能并不好，而且还有大量的注意事项和问题：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e请注意，我们正在手动跟踪所看到字节的偏移量，然后手动分割数据：responseText 正在缓冲完整的响应！对于小的传输，这可能不是一个问题，但对于更大的下载，特别是在内存受限的设备，如手机，这是一个问题。释放缓冲响应的唯一方法是完成请求并打开一个新的请求。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e部分响应只能从 responseText 属性中读取，这将限制为仅限文本传输。没有办法读取二进制传输的部分响应。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e一旦读取了部分数据，我们必须识别消息边界：应用程序逻辑必须定义自己的数据格式，然后缓冲并解析流以提取单个消息。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e浏览器在处理缓冲数据方面有所不同：一些浏览器可能会立即释放数据，而其他浏览器可能会缓冲小的响应并等到积累到一定大小的数据块才释放它们。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e浏览器对不同 Content-Type 资源类型的处理方式不同，对于某些资源类型允许逐步读取 - 例如，text \/ html 类型，而其他 Content-Type 类型只能使用 application \/ x-javascript。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader29\x22\x3eXHR 定时轮询\x3c\/h2\x3e\n\x3cp\x3e从服务器检索更新的最简单的策略之一是让客户端进行定期检查：客户端可以以周期性间隔（轮询服务器）启动后台XHR请求，以检查更新。如果新数据在服务器上可用，则在响应中返回，否则响应为空。\x3c\/p\x3e\n\x3cp\x3e定时轮询的方式很简单，但如果定时间隔很短的话，也是很低效。因此设置合适的时间间隔显得至关重要：轮询间隔时间过长，会导致更新不及时，然而间隔时间过短的话，则会导致客户端与服务器不必要的流程和高开销。接下来我们来看一个简单的示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function checkUpdates(url) {\n  var xhr = new XMLHttpRequest();\n  xhr.open(\x27GET\x27, url);\n  xhr.onload = function() { ... }; \/\/ 1\n  xhr.send();\n}\n\nsetInterval(function() { checkUpdates(\x27\/updates\x27) }, 60000); \/\/ 2\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3echeckUpdates\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n  xhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, url);\n  xhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... }; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1\x3c\/span\x3e\n  xhr.send();\n}\n\nsetInterval(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ checkUpdates(\x3cspan class=\x22hljs-string\x22\x3e\x27\/updates\x27\x3c\/span\x3e) }, \x3cspan class=\x22hljs-number\x22\x3e60000\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e(1) 处理服务端接收的数据\x3c\/p\x3e\n\x3cp\x3e(2) 设置定时轮询时间为 60s\x3c\/p\x3e\n\x3cp\x3e定时轮询会产生以下的问题：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e每个 XHR 请求都是一个独立的 HTTP 请求，平均来说，HTTP 的请求头可能会引起大约 800 字节的开销 (不带HTTP cookie)。\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cblockquote\x3e\x3cp\x3e每个浏览器发起 HTTP 请求时都将携带额外的 500 - 800 字节的元数据 (请求头)，如 user-agent、accept、Cache-Control 缓存控制头等。更糟糕的是，500 - 800 字节是理想的情况，如果携带 Cookies 信息，那么这个数值将会更大。总而言之，这些未压缩的 HTTP 元数据会引起很大开销。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e如果数据能够在间隔期间顺序到达，那么定时轮询可以正常工作。但我们并没有任何机制保证数据的正常接收。另外周期性轮询也将会引起服务器上可用的消息及其传送到客户端之间引入额外的延迟。简单的理解是如果有轮询期间有新的可用消息，客户端是不会马上收到此新消息，而是要等到下一次轮询的时候，才能获取最新数据。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e除非仔细考虑，不然轮询通常会成为无线网络上昂贵的性能反模式。频繁地轮询会大量的消耗移动设备的电量。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader30\x22\x3e轮询开销\x3c\/h3\x3e\n\x3cp\x3e平均每个 HTTP 1.x 请求会增加大约 800字节的请求和响应开销 (详细信息可以查看 - \x3ca href=\x22https:\/\/hpbn.co\/http1x\/#measuring-and-controlling-protocol-overhead\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMeasuring and Controlling Protocol Overhead\x3c\/a\x3e) 。另外在客户端登录后，我们还将产生一个额外的身份验证 cookie 和 消息ID; 假设这又增加了50个字节。因此，不返回新消息的请求将产生 850字节开销！现在假设我们有10,000个客户端，所有的轮询间隔时间都是60秒：\x3cbr\x3e$$\x3cbr\x3e(850 bytes \x3cem\x3e 8 bits \x3c\/em\x3e 10,000) \/ 60 seconds ≈ 1.13 Mbps\x3cbr\x3e$$\x3cbr\x3e每个客户端在每个请求上发送 850 字节的数据，这转换为每秒 167 个请求，服务器上的吞吐量大约为 1.13 Mbps！这不是一个固定的值，此外该计算值还是在假设服务器没有向任何客户端传递任何新的消息的理想情况下计算而得的。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader31\x22\x3eXHR 长轮询\x3c\/h2\x3e\n\x3cp\x3e周期性轮询的挑战在于有可能进行许多不必要的和空的检查。考虑到这一点，如果我们对轮询工作流程进行了轻微的修改，而不是在没有更新可用的情况下返回一个空的响应，我们可以保持连接空闲，直到更新可用吗？\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008950792\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008950792\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e（图片来源 - \x3ca href=\x22https:\/\/hpbn.co\/xmlhttprequest\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/hpbn.co\/xmlhttprequest\/\x3c\/a\x3e）\x3c\/p\x3e\n\x3cp\x3e通过保持长连接，直到更新可用，数据可以立即发送到客户端，一旦它在服务器上可用。因此，长时间轮询为消息延迟提供了最佳的情况，并且还消除了空检查，这减少了 XHR 请求的数量和轮询的总体开销。一旦更新被传递，长的轮询请求完成，并且客户端可以发出另一个长轮询请求并等待下一个可用的消息：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function checkUpdates(url) {\n  var xhr = new XMLHttpRequest();\n  xhr.open(\x27GET\x27, url);\n  xhr.onload = function() { \/\/ 1\n    ...\n    checkUpdates(\x27\/updates\x27); \/\/ 2\n  };\n  xhr.send();\n}\n\ncheckUpdates(\x27\/updates\x27); \/\/ 3\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3echeckUpdates\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n  xhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, url);\n  xhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1\x3c\/span\x3e\n    ...\n    checkUpdates(\x3cspan class=\x22hljs-string\x22\x3e\x27\/updates\x27\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2\x3c\/span\x3e\n  };\n  xhr.send();\n}\n\ncheckUpdates(\x3cspan class=\x22hljs-string\x22\x3e\x27\/updates\x27\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 3\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e(1) 处理接收到的数据并启动下一轮检测更新\x3c\/p\x3e\n\x3cp\x3e(2) 启动下一轮检测更新\x3c\/p\x3e\n\x3cp\x3e(3) 发起首次更新请求\x3c\/p\x3e\n\x3cp\x3e那么长时间轮询总是比定期轮询更好的选择？除非消息到达率已知且不变，否则长轮询将始终提供更短的消息延迟。\x3c\/p\x3e\n\x3cp\x3e另一方面，开销讨论需要更细微的观点。首先，请注意，每个传递的消息仍然引起相同的 HTTP 开销;每个新消息都是独立的 HTTP 请求。但是，如果消息到达率高，那么长时间轮询会比定期轮询发出更多的XHR请求！\x3c\/p\x3e\n\x3cp\x3e长轮询通过最小化消息延迟来动态地适应消息到达速率，这是您可能想要的或可能不需要的行为。如果对消息延迟要求不高的话，则定时轮询可能是更有效的传输方式 - 例如，如果消息更新速率较高，则定时轮询提供简单的 \x22消息聚合\x22 机制 (即合并一定时间内的消息)，这可以减少请求数量并提高移动设备的电池寿命。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader32\x22\x3eXMLHttpRequest 库\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader33\x22\x3eMock.js\x3c\/h3\x3e\n\x3cp\x3eMock.js 是一款模拟数据生成器，旨在帮助前端攻城师独立于后端进行开发，帮助编写单元测试。提供了以下模拟功能：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e根据数据模板生成模拟数据\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e模拟 Ajax 请求，生成并返回模拟数据\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e基于 HTML 模板生成模拟数据\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e详细信息，请查看 - \x3ca href=\x22http:\/\/mockjs.com\/0.1\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMock.js 文档\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader34\x22\x3eZone.js\x3c\/h3\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/domenic.github.io\/zones\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eZone\x3c\/a\x3e 是下一个 ECMAScript 规范的建议之一。Angular 团队实现了 JavaScript 版本的 \x3ca href=\x22https:\/\/github.com\/angular\/zone.js\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ezone.js\x3c\/a\x3e ，它是用于拦截和跟踪异步工作的机制。\x3c\/p\x3e\n\x3cp\x3eZone 是一个全局的对象，用来配置有关如何拦截和跟踪异步回调的规则。Zone 有以下能力：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e拦截异步任务调度，如 setTimeout、setInterval、XMLHttpRequest 等\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e提供了将数据附加到 zones 的方法\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e为异常处理函数提供正确的上下文\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e拦截阻塞的方法，如 alert、confirm 方法\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3ezone.js 内部使用 \x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/Monkey_patch\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMonkey Patch\x3c\/a\x3e 方式，拦截 XMLHttpRequest.prototype 对象中的 open、send、abort 等方法。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ zone.js 源码片段\nvar openNative = patchMethod(window.XMLHttpRequest.prototype, \x27open\x27, function () { \n    return function (self, args) {\n        self[XHR_SYNC] = args[2] == false;\n        return openNative.apply(self, args);\n    }; \n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ zone.js 源码片段\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e openNative = patchMethod(\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.XMLHttpRequest.prototype, \x3cspan class=\x22hljs-string\x22\x3e\x27open\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eself, args\x3c\/span\x3e) \x3c\/span\x3e{\n        self[XHR_SYNC] = args[\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e] == \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e openNative.apply(self, args);\n    }; \n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader35\x22\x3eOboe.js\x3c\/h3\x3e\n\x3cp\x3eOboe.js 通过将 HTTP 请求-应答模型封装在一个渐进流式接口中，帮助网页应用快速应答。它将 streaming 和downloading 间的转换与SAX和DOM间JSON的解析整合在一起。它是个非常小的库，不依赖于其他程序库。它可以在 ajax 请求结束前就开始解析 json 变得十分容易，从而提高应用的应答速度。另外，它支持 Node.js 框架，还可以读入除了 http 外的其他流。\x3c\/p\x3e\n\x3cp\x3e有兴趣的读者，推荐看一下官网的可交互的演示示例 - \x3ca href=\x22http:\/\/oboejs.com\/why\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWhy Oboe.js\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e(备注：该库就是文中 - 使用XHR流式传输数据章节的实际应用，不信往下看)\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ oboe-browser.js 源码片段\nfunction handleProgress() {            \n    var textSoFar = xhr.responseText,\n        newText = textSoFar.substr(numberOfCharsAlreadyGivenToCallback);\n    if( newText ) {\n        emitStreamData( newText );\n    } \n    numberOfCharsAlreadyGivenToCallback = len(textSoFar);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ oboe-browser.js 源码片段\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ehandleProgress\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{            \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e textSoFar = xhr.responseText,\n        newText = textSoFar.substr(numberOfCharsAlreadyGivenToCallback);\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e( newText ) {\n        emitStreamData( newText );\n    } \n    numberOfCharsAlreadyGivenToCallback = len(textSoFar);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader36\x22\x3efetch.js\x3c\/h3\x3e\n\x3cp\x3efetch 函数是一个基于 Promise 的机制，用于在浏览器中以编程方式发送 Web 请求。该项目是实现标准 \x3ca href=\x22https:\/\/fetch.spec.whatwg.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFetch\x3c\/a\x3e 规范的一个子集的 polyfill ，足以作为传统 Web 应用程序中 XMLHttpRequest 的代替品。\x3c\/p\x3e\n\x3cp\x3e详细信息，请参考 - \x3ca href=\x22https:\/\/github.com\/github\/fetch\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGithub - fetch\x3c\/a\x3e \x3c\/p\x3e\n\x3cp\x3eFetch API 兼容性，请参考 - \x3ca href=\x22http:\/\/caniuse.com\/#search=Fetch\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCan I use Fetch\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader37\x22\x3eXMLHttpRequest 代码片段\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader38\x22\x3eArrayBuffer 对象转为字符串\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function ab2str(buf) {\n  return String.fromCharCode.apply(null, new Uint16Array(buf));\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eab2str\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ebuf\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e.fromCharCode.apply(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eUint16Array\x3c\/span\x3e(buf));\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码片段来源 - \x3ca href=\x22http:\/\/javascript.ruanyifeng.com\/stdlib\/arraybuffer.html#toc11\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eArrayBuffer与字符串的互相转换\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader39\x22\x3e字符串转 ArrayBuffer对象\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function str2ab(str) {\n  var buf = new ArrayBuffer(str.length * 2); \/\/ 每个字符占用2个字节\n  var bufView = new Uint16Array(buf);\n  for (var i = 0, strLen = str.length; i \x3c strLen; i\x2b\x2b) {\n    bufView[i] = str.charCodeAt(i);\n  }\n  return buf;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3estr2ab\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3estr\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e buf = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eArrayBuffer\x3c\/span\x3e(str.length * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 每个字符占用2个字节\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e bufView = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eUint16Array\x3c\/span\x3e(buf);\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, strLen = str.length; i \x26lt; strLen; i\x2b\x2b) {\n    bufView[i] = str.charCodeAt(i);\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e buf;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码片段来源 - \x3ca href=\x22http:\/\/javascript.ruanyifeng.com\/stdlib\/arraybuffer.html#toc11\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eArrayBuffer与字符串的互相转换\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader40\x22\x3e创建 XHR 对象\x3c\/h3\x3e\n\x3ch4\x3e兼容所有浏览器\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Provide the XMLHttpRequest class for IE 5.x-6.x:\n\/\/ Other browsers (including IE 7.x-8.x) ignore this\n\/\/   when XMLHttpRequest is predefined\nvar xmlHttp;\nif (typeof XMLHttpRequest != \x26quot;undefined\x26quot;) {\n    xmlHttp = new XMLHttpRequest();\n} else if (window.ActiveXObject) {\n    var aVersions = [\x26quot;Msxml2.XMLHttp.5.0\x26quot;, \x26quot;Msxml2.XMLHttp.4.0\x26quot;, \n        \x26quot;Msxml2.XMLHttp.3.0\x26quot;, \x26quot;Msxml2.XMLHttp\x26quot;, \x26quot;Microsoft.XMLHttp\x26quot;];\n    for (var i = 0; i \x3c aVersions.length; i\x2b\x2b) {\n        try {\n            xmlHttp = new ActiveXObject(aVersions[i]);\n            break;\n        } catch (e) {}\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Provide the XMLHttpRequest class for IE 5.x-6.x:\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Other browsers (including IE 7.x-8.x) ignore this\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/   when XMLHttpRequest is predefined\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xmlHttp;\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e XMLHttpRequest != \x3cspan class=\x22hljs-string\x22\x3e\x22undefined\x22\x3c\/span\x3e) {\n    xmlHttp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.ActiveXObject) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e aVersions = [\x3cspan class=\x22hljs-string\x22\x3e\x22Msxml2.XMLHttp.5.0\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22Msxml2.XMLHttp.4.0\x22\x3c\/span\x3e, \n        \x3cspan class=\x22hljs-string\x22\x3e\x22Msxml2.XMLHttp.3.0\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22Msxml2.XMLHttp\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22Microsoft.XMLHttp\x22\x3c\/span\x3e];\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; aVersions.length; i\x2b\x2b) {\n        \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n            xmlHttp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ActiveXObject(aVersions[i]);\n            \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n        } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e) {}\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e精简版\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xmlHttp;\nif (typeof XMLHttpRequest != \x26quot;undefined\x26quot;) {\n    xmlHttp = new XMLHttpRequest();\n} else if (window.ActiveXObject) {\n    try {\n       xmlHttp = new ActiveXObject(\x26quot;Microsoft.XMLHTTP\x26quot;);\n    } catch (e) {} \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xmlHttp;\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e XMLHttpRequest != \x3cspan class=\x22hljs-string\x22\x3e\x22undefined\x22\x3c\/span\x3e) {\n    xmlHttp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.ActiveXObject) {\n    \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n       xmlHttp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ActiveXObject(\x3cspan class=\x22hljs-string\x22\x3e\x22Microsoft.XMLHTTP\x22\x3c\/span\x3e);\n    } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e) {} \n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader41\x22\x3esendAsBinary() polyfill\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (!XMLHttpRequest.prototype.sendAsBinary) {\n  XMLHttpRequest.prototype.sendAsBinary = function (sData) {\n    var nBytes = sData.length, ui8Data = new Uint8Array(nBytes);\n    for (var nIdx = 0; nIdx \x3c nBytes; nIdx\x2b\x2b) {\n      ui8Data[nIdx] = sData.charCodeAt(nIdx) \x26amp; 0xff;\n    }\n    this.send(ui8Data);\n  };\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!XMLHttpRequest.prototype.sendAsBinary) {\n  XMLHttpRequest.prototype.sendAsBinary = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3esData\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e nBytes = sData.length, ui8Data = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eUint8Array\x3c\/span\x3e(nBytes);\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e nIdx = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; nIdx \x26lt; nBytes; nIdx\x2b\x2b) {\n      ui8Data[nIdx] = sData.charCodeAt(nIdx) \x26amp; \x3cspan class=\x22hljs-number\x22\x3e0xff\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.send(ui8Data);\n  };\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader42\x22\x3e获取 XMLHttpRequest 响应体\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function readBody(xhr) {\n    var data;\n    if (!xhr.responseType || xhr.responseType === \x26quot;text\x26quot;) {\n        data = xhr.responseText;\n    } else if (xhr.responseType === \x26quot;document\x26quot;) {\n        data = xhr.responseXML;\n    } else {\n        data = xhr.response;\n    }\n    return data;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ereadBody\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3exhr\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data;\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!xhr.responseType || xhr.responseType === \x3cspan class=\x22hljs-string\x22\x3e\x22text\x22\x3c\/span\x3e) {\n        data = xhr.responseText;\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (xhr.responseType === \x3cspan class=\x22hljs-string\x22\x3e\x22document\x22\x3c\/span\x3e) {\n        data = xhr.responseXML;\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        data = xhr.response;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e data;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e应用示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\nxhr.onreadystatechange = function() {\n    if (xhr.readyState == 4) {\n        console.log(readBody(xhr));\n    }\n}\nxhr.open(\x27GET\x27, \x27https:\/\/www.baidu.com\x27, true);\nxhr.send(null);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (xhr.readyState == \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(readBody(xhr));\n    }\n}\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.baidu.com\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\nxhr.send(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader43\x22\x3e获取 responseURL\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export function getResponseURL(xhr: any): string {\n  if (\x27responseURL\x27 in xhr) {\n    return xhr.responseURL;\n  }\n  if (\/^X-Request-URL:\/m.test(xhr.getAllResponseHeaders())) {\n    return xhr.getResponseHeader(\x27X-Request-URL\x27);\n  }\n  return;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetResponseURL\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3exhr: \x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x3c\/span\x3e): \x3cspan class=\x22hljs-title\x22\x3estring\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27responseURL\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e xhr) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e xhr.responseURL;\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-regexp\x22\x3e\/^X-Request-URL:\/m\x3c\/span\x3e.test(xhr.getAllResponseHeaders())) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e xhr.getResponseHeader(\x3cspan class=\x22hljs-string\x22\x3e\x27X-Request-URL\x27\x3c\/span\x3e);\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码片段来源 - \x3ca href=\x22https:\/\/github.com\/angular\/angular\/blob\/master\/packages\/http\/src\/http_utils.ts#L35\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGithub - @angular\/http - http_utils.ts\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader44\x22\x3e验证请求是否成功\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export const isSuccess = (status: number): boolean =\x3e (status \x3e= 200 \x26amp;\x26amp; status \x3c 300);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e isSuccess = (status: \x3cspan class=\x22hljs-built_in\x22\x3enumber\x3c\/span\x3e): \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eboolean\x3c\/span\x3e =\x26gt;\x3c\/span\x3e (status \x26gt;= \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e \x26amp;\x26amp; status \x26lt; \x3cspan class=\x22hljs-number\x22\x3e300\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码片段来源 - \x3ca href=\x22https:\/\/github.com\/angular\/angular\/blob\/master\/packages\/http\/src\/http_utils.ts#L33\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGithub - @angular\/http - http_utils.ts\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader45\x22\x3e解析查询参数为Map对象\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function paramParser(rawParams: string = \x27\x27): Map\x3cstring, string[]\x3e {\n  const map = new Map\x3cstring, string[]\x3e();\n  if (rawParams.length \x3e 0) {\n    const params: string[] = rawParams.split(\x27\x26amp;\x27);\n    params.forEach((param: string) =\x3e {\n      const eqIdx = param.indexOf(\x27=\x27);\n      const [key, val]: string[] =\n          eqIdx == -1 ? [param, \x27\x27] : [param.slice(0, eqIdx), param.slice(eqIdx \x2b 1)];\n      const list = map.get(key) || [];\n      list.push(val);\n      map.set(key, list);\n    });\n  }\n  return map;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eparamParser\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erawParams: \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e = \x27\x27\x3c\/span\x3e): \x3cspan class=\x22hljs-title\x22\x3eMap\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-title\x22\x3estring\x3c\/span\x3e, \x3cspan class=\x22hljs-title\x22\x3estring\x3c\/span\x3e[]\x26gt; \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e map = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Map\x26lt;\x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e[]\x26gt;();\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (rawParams.length \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e params: \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e[] = rawParams.split(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26amp;\x27\x3c\/span\x3e);\n    params.forEach(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eparam: \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e eqIdx = param.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x27=\x27\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e [key, val]: \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e[] =\n          eqIdx == \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e ? [param, \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e] : [param.slice(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, eqIdx), param.slice(eqIdx \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)];\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e list = map.get(key) || [];\n      list.push(val);\n      map.set(key, list);\n    });\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e map;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码片段来源 - \x3ca href=\x22https:\/\/github.com\/angular\/angular\/blob\/master\/packages\/http\/src\/url_search_params.ts#L9\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGithub - @angular\/http - url_search_params.ts\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3ets 转换为 js 的代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22   function paramParser(rawParams) {\n        if (rawParams === void 0) { rawParams = \x27\x27; }\n        var map = new Map();\n        if (rawParams.length \x3e 0) {\n            var params = rawParams.split(\x27\x26amp;\x27);\n            params.forEach(function (param) {\n                var eqIdx = param.indexOf(\x27=\x27);\n                var _a = eqIdx == -1 ? [param, \x27\x27] : \n                    [param.slice(0, eqIdx), param.slice(eqIdx \x2b 1)], key = _a[0], \n                        val = _a[1];\n                var list = map.get(key) || [];\n                list.push(val);\n                map.set(key, list);\n            });\n        }\n        return map;\n    }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e   \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eparamParser\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erawParams\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (rawParams === \x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) { rawParams = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e; }\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e map = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eMap\x3c\/span\x3e();\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (rawParams.length \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e params = rawParams.split(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26amp;\x27\x3c\/span\x3e);\n            params.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eparam\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e eqIdx = param.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x27=\x27\x3c\/span\x3e);\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _a = eqIdx == \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e ? [param, \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e] : \n                    [param.slice(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, eqIdx), param.slice(eqIdx \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)], key = _a[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e], \n                        val = _a[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e];\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e list = map.get(key) || [];\n                list.push(val);\n                map.set(key, list);\n            });\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e map;\n    }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader46\x22\x3eXHR 下载图片\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\n    xhr.open(\x27GET\x27, \x27https:\/\/avatars2.githubusercontent.com\/u\/4220799?v=3\x27);\n    xhr.responseType = \x27blob\x27;\n\n    xhr.onload = function() {\n        if (this.status == 200) {\n            var img = document.createElement(\x27img\x27);\n            img.src = window.URL.createObjectURL(this.response); \n            img.onload = function() {\n                window.URL.revokeObjectURL(this.src); \n            };\n            document.body.appendChild(img);\n        }\n    };\n    xhr.send();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n    xhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/avatars2.githubusercontent.com\/u\/4220799?v=3\x27\x3c\/span\x3e);\n    xhr.responseType = \x3cspan class=\x22hljs-string\x22\x3e\x27blob\x27\x3c\/span\x3e;\n\n    xhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.status == \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e img = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27img\x27\x3c\/span\x3e);\n            img.src = \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.URL.createObjectURL(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.response); \n            img.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.URL.revokeObjectURL(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.src); \n            };\n            \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(img);\n        }\n    };\n    xhr.send();\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader47\x22\x3eXHR 上传数据\x3c\/h3\x3e\n\x3ch4\x3e发送普通文本\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\nxhr.open(\x27POST\x27,\x27\/upload\x27);\nxhr.onload = function() { ... };\nxhr.send(\x26quot;text string\x26quot;); \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27\/upload\x27\x3c\/span\x3e);\nxhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... };\nxhr.send(\x3cspan class=\x22hljs-string\x22\x3e\x22text string\x22\x3c\/span\x3e); \x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e发送FormData\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var formData = new FormData(); \nformData.append(\x27id\x27, 123456);\nformData.append(\x27topic\x27, \x27performance\x27);\n\nvar xhr = new XMLHttpRequest();\nxhr.open(\x27POST\x27, \x27\/upload\x27);\nxhr.onload = function() { ... };\nxhr.send(formData); \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e formData = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FormData(); \nformData.append(\x3cspan class=\x22hljs-string\x22\x3e\x27id\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e123456\x3c\/span\x3e);\nformData.append(\x3cspan class=\x22hljs-string\x22\x3e\x27topic\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27performance\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/upload\x27\x3c\/span\x3e);\nxhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... };\nxhr.send(formData); \x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e发送 Buffer\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\nxhr.open(\x27POST\x27, \x27\/upload\x27);\nxhr.onload = function() { ... };\nvar uInt8Array = new Uint8Array([1, 2, 3]); \nxhr.send(uInt8Array.buffer);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eXMLHttpRequest\x3c\/span\x3e();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/upload\x27\x3c\/span\x3e);\nxhr.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3c\/span\x3e() { ... };\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e uInt8Array = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eUint8Array\x3c\/span\x3e([\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e]); \nxhr.send(uInt8Array.buffer);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader48\x22\x3eXHR 上传进度条\x3c\/h3\x3e\n\x3cp\x3eprogress 元素\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cprogress id=\x26quot;uploadprogress\x26quot; min=\x26quot;0\x26quot; max=\x26quot;100\x26quot; value=\x26quot;0\x26quot;\x3e0\x3c\/progress\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eprogress\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22uploadprogress\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3emin\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x220\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3emax\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22100\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x220\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e0\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eprogress\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e定义 progress 事件的回调函数\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22xhr.upload.onprogress = function (event) {\n　　if (event.lengthComputable) {\n　　　　　　var complete = (event.loaded \/ event.total * 100 | 0);\n　　　　　　var progress = document.getElementById(\x27uploadprogress\x27);\n　　　　　　progress.value = progress.innerHTML = complete;\n　　}\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3exhr.upload.onprogress = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n　　\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.lengthComputable) {\n　　　　　　\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e complete = (event.loaded \/ event.total * \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e | \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n　　　　　　\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e progress = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27uploadprogress\x27\x3c\/span\x3e);\n　　　　　　progress.value = progress.innerHTML = complete;\n　　}\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e注意，progress事件不是定义在xhr，而是定义在xhr.upload，因为这里需要区分下载和上传，下载也有一个progress事件。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader49\x22\x3e我有话说\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader50\x22\x3e1.什么情况下 XMLHttpRequest status 会为 0？\x3c\/h3\x3e\n\x3cp\x3eXMLHttpRequest 返回 status 时，会执行以下步骤：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e如果状态是 UNSENT 或 OPENED，则返回 0\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e如果错误标志被设置，则返回 0\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e否则返回 HTTP 状态码\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e另外当访问本地文件资源或在 Android 4.1 stock browser 中从应用缓存中获取文件时，XMLHttpRequest 的 status 值也会为0。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e示例一：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xmlhttp;\nxmlhttp = new XMLHttpRequest();\nxmlhttp.open(\x26quot;GET\x26quot;,\x26quot;http:\/\/www.w3schools.com\/XML\/cd_catalog.xml\x26quot;, true);\nxmlhttp.onreadystatechange=function() {\n  if(xmlhttp.readyState == 4) console.log(\x26quot;status \x26quot; \x2b xmlhttp.status);\n};\nxmlhttp.addEventListener(\x27error\x27, function (error) {\n   console.dir(error);\n});\nxmlhttp.send();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xmlhttp;\nxmlhttp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxmlhttp.open(\x3cspan class=\x22hljs-string\x22\x3e\x22GET\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/www.w3schools.com\/XML\/cd_catalog.xml\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\nxmlhttp.onreadystatechange=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(xmlhttp.readyState == \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e) \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22status \x22\x3c\/span\x3e \x2b xmlhttp.status);\n};\nxmlhttp.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eerror\x3c\/span\x3e) \x3c\/span\x3e{\n   \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.dir(error);\n});\nxmlhttp.send();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e以上代码运行后，将会在控制台输出：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22status 0\nProgressEvent # error 对象\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs subunit\x22\x3e\x3ccode\x3estatus 0\n\x3cspan class=\x22hljs-keyword\x22\x3eProgress\x3c\/span\x3eEvent # error 对象\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader51\x22\x3e2.为什么 GET 或 HEAD 请求，不能通过 send() 方法发送请求体？\x3c\/h3\x3e\n\x3cblockquote\x3e\n\x3cp\x3e\x3ccode\x3eclient . send([body = null])\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3eInitiates the request. The optional argument provides the \x3ca href=\x22https:\/\/xhr.spec.whatwg.org\/#request-body\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3erequest body\x3c\/a\x3e. The argument is ignored if \x3ca href=\x22https:\/\/xhr.spec.whatwg.org\/#request-method\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3erequest method\x3c\/a\x3e is \x3ccode\x3eGET\x3c\/code\x3e or \x3ccode\x3eHEAD\x3c\/code\x3e.  —— xhr.spec\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e通过 XMLHttpRequest 规范，我们知道当请求方法是 GET 或 HEAD 时，\x3ccode\x3esend()\x3c\/code\x3e 方法的 body 参数值将会被忽略。那么对于我们常用的 GET 请求，我们要怎么传递参数呢？解决参数传递可以使用以下两种方式：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eURL 传参 - 常用方式，有大小限制大约为 2KB\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e请求头传参 - 一般用于传递 token 等认证信息\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3eURL 传参\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var url = \x26quot;bla.php\x26quot;;\nvar params = \x26quot;somevariable=somevalue\x26amp;anothervariable=anothervalue\x26quot;;\nvar http = new XMLHttpRequest();\n\nhttp.open(\x26quot;GET\x26quot;, url\x2b\x26quot;?\x26quot;\x2bparams, true);\nhttp.onreadystatechange = function()\n{\n    if(http.readyState == 4 \x26amp;\x26amp; http.status == 200) {\n        alert(http.responseText);\n    }\n}\nhttp.send(null); \/\/ 请求方法是GET或HEAD时，设置请求体为空\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e url = \x3cspan class=\x22hljs-string\x22\x3e\x22bla.php\x22\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e params = \x3cspan class=\x22hljs-string\x22\x3e\x22somevariable=somevalue\x26amp;anothervariable=anothervalue\x22\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e http = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n\nhttp.open(\x3cspan class=\x22hljs-string\x22\x3e\x22GET\x22\x3c\/span\x3e, url\x2b\x3cspan class=\x22hljs-string\x22\x3e\x22?\x22\x3c\/span\x3e\x2bparams, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\nhttp.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\n\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(http.readyState == \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e \x26amp;\x26amp; http.status == \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e) {\n        alert(http.responseText);\n    }\n}\nhttp.send(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 请求方法是GET或HEAD时，设置请求体为空\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在日常开发中，我们最常用的方式是传递参数对象，因此我们可以封装一个 \x3ccode\x3eformatParams()\x3c\/code\x3e 来实现参数格式，具体示例如下：\x3c\/p\x3e\n\x3cp\x3eformatParams() 函数：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function formatParams( params ){\n  return \x26quot;?\x26quot; \x2b Object\n        .keys(params)\n        .map(function(key){\n          return key\x2b\x26quot;=\x26quot;\x2bparams[key]\n        })\n        .join(\x26quot;\x26amp;\x26quot;)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eformatParams\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e params \x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22?\x22\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e\n        .keys(params)\n        .map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ekey\x3c\/span\x3e)\x3c\/span\x3e{\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e key\x2b\x3cspan class=\x22hljs-string\x22\x3e\x22=\x22\x3c\/span\x3e\x2bparams[key]\n        })\n        .join(\x3cspan class=\x22hljs-string\x22\x3e\x22\x26amp;\x22\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e应用示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var endpoint = \x26quot;https:\/\/api.example.com\/endpoint\x26quot;;\nvar params = {\n  a: 1, \n  b: 2,\n  c: 3\n};\nvar url = endpoint \x2b formatParams(params); \/\/ 实际应用中需要判断endpoint是否已经包含查询参数\n\/\/ =\x3e \x26quot;https:\/\/api.example.com\/endpoint?a=1\x26amp;b=2\x26amp;c=3\x26quot;;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e endpoint = \x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/api.example.com\/endpoint\x22\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e params = {\n  \x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \n  \x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ec\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\n};\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e url = endpoint \x2b formatParams(params); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 实际应用中需要判断endpoint是否已经包含查询参数\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ =\x26gt; \x22https:\/\/api.example.com\/endpoint?a=1\x26amp;b=2\x26amp;c=3\x22;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e一些常用的 AJAX 库，如 jQuery、zepto 等，内部已经封装了参数序列化的方法 (如：\x3ca href=\x22http:\/\/api.jquery.com\/jquery.param\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejquery.param\x3c\/a\x3e)，我们直接调用顶层的 API 方法即可。\x3c\/p\x3e\n\x3cp\x3e(备注：以上示例来源 - \x3ca href=\x22http:\/\/stackoverflow.com\/questions\/8064691\/how-do-i-pass-along-variables-with-xmlhttprequest\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3estackoverflow - How do I pass along variables with XMLHttpRequest\x3c\/a\x3e)\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e请求头传参 - (身份认证)\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\nxhr.open(\x26quot;POST\x26quot;, \x27\/server\x27, true);\n\nxhr.setRequestHeader(\x26quot;x-access-token\x26quot;, \x26quot;87a476494db6ec53d0a206589611aa3f\x26quot;);\nxhr.onreadystatechange = function() {\n    if(xhr.readyState == 4 \x26amp;\x26amp; xhr.status == 200) {\n       \/\/ handle data \n    }\n};\nxhr.send(\x26quot;foo=bar\x26amp;lorem=ipsum\x26quot;); \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x22POST\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/server\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n\nxhr.setRequestHeader(\x3cspan class=\x22hljs-string\x22\x3e\x22x-access-token\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x2287a476494db6ec53d0a206589611aa3f\x22\x3c\/span\x3e);\nxhr.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(xhr.readyState == \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e \x26amp;\x26amp; xhr.status == \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e) {\n       \x3cspan class=\x22hljs-comment\x22\x3e\/\/ handle data \x3c\/span\x3e\n    }\n};\nxhr.send(\x3cspan class=\x22hljs-string\x22\x3e\x22foo=bar\x26amp;lorem=ipsum\x22\x3c\/span\x3e); \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e详细的身份认证信息，请参考 - \x3ca href=\x22https:\/\/jwt.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJSON Web Tokens\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader52\x22\x3e3.XMLHttpRequest 请求体支持哪些格式？\x3c\/h3\x3e\n\x3cp\x3esend() 方法签名：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22void send();\n\nvoid send(ArrayBuffer data);\n\nvoid send(Blob data);\n\nvoid send(Document data);\n\nvoid send(DOMString? data);\n\nvoid send(FormData data);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3evoid\x3c\/span\x3e send();\n\n\x3cspan class=\x22hljs-built_in\x22\x3evoid\x3c\/span\x3e send(\x3cspan class=\x22hljs-built_in\x22\x3eArrayBuffer\x3c\/span\x3e data);\n\n\x3cspan class=\x22hljs-built_in\x22\x3evoid\x3c\/span\x3e send(Blob data);\n\n\x3cspan class=\x22hljs-built_in\x22\x3evoid\x3c\/span\x3e send(Document data);\n\n\x3cspan class=\x22hljs-built_in\x22\x3evoid\x3c\/span\x3e send(DOMString? data);\n\n\x3cspan class=\x22hljs-built_in\x22\x3evoid\x3c\/span\x3e send(FormData data);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3ePOST请求示例\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e发送 POST 请求通常需要以下步骤：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e使用 open() 方法打开连接时，设定 POST 请求方法和请求 URL地址\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e设置正确的 \x3ccode\x3eContent-Type\x3c\/code\x3e 请求头\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e设置相关的事件监听\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e设置请求体，并使用 send() 方法，发送请求\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var xhr = new XMLHttpRequest();\nxhr.open(\x26quot;POST\x26quot;, \x27\/server\x27, true);\n\n\/\/Send the proper header information along with the request\nxhr.setRequestHeader(\x26quot;Content-Type\x26quot;, \x26quot;application\/x-www-form-urlencoded\x26quot;);\n\nxhr.onreadystatechange = function() {\n    if(xhr.readyState == 4 \x26amp;\x26amp; xhr.status == 200) {\n        \/\/ handle data\n    }\n}\nxhr.send(\x26quot;foo=bar\x26amp;lorem=ipsum\x26quot;); \n\/\/ xhr.send(\x27string\x27); \n\/\/ xhr.send(new Blob()); \n\/\/ xhr.send(new Int8Array()); \n\/\/ xhr.send({ form: \x27data\x27 }); \n\/\/ xhr.send(document);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nxhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x22POST\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/server\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/Send the proper header information along with the request\x3c\/span\x3e\nxhr.setRequestHeader(\x3cspan class=\x22hljs-string\x22\x3e\x22Content-Type\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22application\/x-www-form-urlencoded\x22\x3c\/span\x3e);\n\nxhr.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(xhr.readyState == \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e \x26amp;\x26amp; xhr.status == \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ handle data\x3c\/span\x3e\n    }\n}\nxhr.send(\x3cspan class=\x22hljs-string\x22\x3e\x22foo=bar\x26amp;lorem=ipsum\x22\x3c\/span\x3e); \n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ xhr.send(\x27string\x27); \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ xhr.send(new Blob()); \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ xhr.send(new Int8Array()); \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ xhr.send({ form: \x27data\x27 }); \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ xhr.send(document);\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader53\x22\x3e4.什么是简单请求和预请求 (preflight request) ？\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e简单请求\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e一些不会触发 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Access_control_CORS#Preflighted_requests\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCORS preflight\x3c\/a\x3e 的请求被称为 \x22简单请求\x22，虽然 \x3ca href=\x22https:\/\/fetch.spec.whatwg.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFetch\x3c\/a\x3e  (定义 CORS的) 不使用这个术语。满足下述条件的就是 \x22简单请求\x22：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e只允许下列方法：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Methods\/GET\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGET\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Methods\/HEAD\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eHEAD\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Methods\/POST\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePOST\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e除了用户代理自动设置的头部外（比如 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Connection\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eConnection\x3c\/a\x3e， \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/User-Agent\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eUser-Agent\x3c\/a\x3e ，或者\x3ca href=\x22https:\/\/fetch.spec.whatwg.org\/#forbidden-header-name\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e其他任意的 Fetch 规范定义的 禁止的头部名\x3c\/a\x3e ），唯一允许人工设置的头部是 Fetch 规范定义的 \x3ca href=\x22https:\/\/fetch.spec.whatwg.org\/#cors-safelisted-request-header\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCORS-safelisted request-header\x3c\/a\x3e，如下：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Accept\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAccept\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Accept-Language\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAccept-Language\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Content-Language\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eContent-Language\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Content-Type\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eContent-Type\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e允许的 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Content-Type\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eContent-Type\x3c\/code\x3e\x3c\/a\x3e 值有：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eapplication\/x-www-form-urlencoded\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3emultipart\/form-data\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3etext\/plain\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e预请求\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e不同于上面讨论的简单请求，\x22预请求\x22 要求必须先发送一个 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Methods\/OPTIONS\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eOPTIONS\x3c\/code\x3e\x3c\/a\x3e  方法请求给目的站点，来查明这个跨站请求对于目的站点是不是安全的可接受的。这样做，是因为跨站请求可能会对目的站点的数据产生影响。 当请求具备以下条件，就会被当成预请求处理：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e使用下述方法以外的请求：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Methods\/GET\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGET\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Methods\/HEAD\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eHEAD\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Methods\/POST\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePOST\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e除了用户代理自动设置的头部外（比如 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Connection\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eConnection\x3c\/a\x3e， \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/User-Agent\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eUser-Agent\x3c\/a\x3e ，或者\x3ca href=\x22https:\/\/fetch.spec.whatwg.org\/#forbidden-header-name\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e其他任意的 Fetch 规范定义的 “禁止的头部名”\x3c\/a\x3e ），预请求不包括 Fetch 规范定义的 \x22\x3ca href=\x22https:\/\/fetch.spec.whatwg.org\/#cors-safelisted-request-header\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCORS-safelisted request-header\x3c\/a\x3e\x22：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Accept\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAccept\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Accept-Language\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAccept-Language\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Content-Language\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eContent-Language\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Content-Type\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eContent-Type\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Headers\/Content-Type\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eContent-Type\x3c\/a\x3e 头部的值除了下列之外的:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eapplication\/x-www-form-urlencoded\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3emultipart\/form-data\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3etext\/plain\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e详细的信息，请参考 - \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/HTTP\/Access_control_CORS\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMDN - HTTP 访问控制 (CORS)\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader54\x22\x3e5.XMLHttpRequest 对象垃圾回收机制是什么？\x3c\/h3\x3e\n\x3cp\x3e在以下情况下，XMLHttpRequest 对象不会被垃圾回收：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e如果 XMLHttpRequest 对象的状态是 \x3ccode\x3eOPENED\x3c\/code\x3e 且已设置 \x3ccode\x3esend()\x3c\/code\x3e 的标识符\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eXMLHttpRequest 对象的状态是 HEADERS_RECEIVED (已获取响应头)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eXMLHttpRequest 对象的状态是 LOADING (正在下载响应体)，并且监听了以下一个或多个事件：readystatechange、progress、abort、error、load、timeout、loadend\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e如果 XMLHttpRequest 对象在连接尚存打开时被垃圾回收机制回收了，用户代理必须终止请求。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader55\x22\x3e6.GET 和 POST 请求的区别？\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e对于 GET 请求，浏览器会把 HTTP headers 和 data 一并发送出去，服务器响应 200。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e而对于 POST 请求，浏览器会先发送 HTTP headers，服务器响应 100 continue ，浏览器再发送 data，服务器响应 200。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e详细的信息，请参考 - \x3ca href=\x22https:\/\/zhuanlan.zhihu.com\/p\/22536382\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e99%的人都理解错了HTTP中GET与POST的区别\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader56\x22\x3e7.怎样防止重复发送 AJAX 请求？\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3esetTimeout \x2b clearTimeout - 连续的点击会把上一次点击清除掉，也就是ajax请求会在最后一次点击后发出去\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3edisable 按钮\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e缓存已成功的请求，若请求参数一致，则直接返回，不发送请求\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e详细的信息，请参考 - \x3ca href=\x22https:\/\/www.zhihu.com\/question\/19805411\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e知乎 - 怎样防止重复发送 Ajax 请求\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader57\x22\x3e8、AJAX 站点怎么做 SEO 优化\x3c\/h3\x3e\n\x3cp\x3e众所周知，大部分的搜索引擎爬虫都不会执行 JS，也就是说，如果页面内容由 Ajax 返回的话，搜索引擎是爬取不到部分内容的，也就无从做 SEO (搜索引擎优化)了。国外的 \x3ca href=\x22https:\/\/prerender.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eprerender.io\x3c\/a\x3e 网站提供了一套比较成熟的方案，但是需要付费的。接下来我们来看一下，怎么 \x3ca href=\x22http:\/\/phantomjs.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePhantomJS\x3c\/a\x3e 为我们的站点做 SEO。\x3c\/p\x3e\n\x3cp\x3e详细的信息，请参考 - \x3ca href=\x22https:\/\/www.mxgw.info\/t\/phantomjs-prerender-for-seo.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e用PhantomJS来给AJAX站点做SEO优化\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader58\x22\x3e精品文章\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.html5rocks.com\/zh\/tutorials\/file\/xhr2\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eXMLHttpRequest 2新技巧\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2012\/09\/xmlhttprequest_level_2.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e阮一峰 - XMLHttpRequest Level 2 使用指南\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000004322487\x22\x3esegmentfault - 你真的会使用XMLHttpRequest吗?\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/louiszhai.github.io\/2016\/11\/02\/ajax\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGithub - Ajax 知识体系大梳理\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader59\x22\x3e参考资源\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/xhr.spec.whatwg.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eXMLHttpRequest 标准\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/hpbn.co\/xmlhttprequest\/#preflight\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eHigh Performance Browser Networking - XMLHttpRequest\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/msdn.microsoft.com\/zh-cn\/library\/7sw4ddf8(v=vs.94\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emsdn - ActiveXObject 对象\x3c\/a\x3e.aspx)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/XMLHttpRequest\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emdn - XMLHttpRequest\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.html5rocks.com\/zh\/tutorials\/file\/xhr2\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eXMLHttpRequest 2新技巧\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2012\/09\/xmlhttprequest_level_2.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e阮一峰 - XMLHttpRequest Level 2 使用指南\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000004322487\x22\x3esegmentfault - 你真的会使用XMLHttpRequest吗?\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/louiszhai.github.io\/2016\/11\/02\/ajax\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGithub - Ajax 知识体系大梳理\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/javascript.ruanyifeng.com\/stdlib\/arraybuffer.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScript 标准参考教程 (alpha) - 二进制数组\x3c\/a\x3e​\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>你不知道的 XMLHttpRequest</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008950789">https://segmentfault.com/a/1190000008950789</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/emo34mxsncp/" target="_blank">https://alili.tech/archive/emo34mxsncp/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>