<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Webpack 源码（一）—— Tapable 和 事件流"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Webpack 源码（一）—— Tapable 和 事件流 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/qlyv0tt88ud/",
				"appid": "1613049289050283", 
				"title": "Webpack 源码（一）—— Tapable 和 事件流 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-28T02:30:09"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/7v0gtpe75yk/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/7yxqvcahe65/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fqlyv0tt88ud%2f&text=Webpack%20%e6%ba%90%e7%a0%81%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20Tapable%20%e5%92%8c%20%e4%ba%8b%e4%bb%b6%e6%b5%81"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fqlyv0tt88ud%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fqlyv0tt88ud%2f&text=Webpack%20%e6%ba%90%e7%a0%81%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20Tapable%20%e5%92%8c%20%e4%ba%8b%e4%bb%b6%e6%b5%81"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fqlyv0tt88ud%2f&title=Webpack%20%e6%ba%90%e7%a0%81%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20Tapable%20%e5%92%8c%20%e4%ba%8b%e4%bb%b6%e6%b5%81"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fqlyv0tt88ud%2f&is_video=false&description=Webpack%20%e6%ba%90%e7%a0%81%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20Tapable%20%e5%92%8c%20%e4%ba%8b%e4%bb%b6%e6%b5%81"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Webpack%20%e6%ba%90%e7%a0%81%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20Tapable%20%e5%92%8c%20%e4%ba%8b%e4%bb%b6%e6%b5%81&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fqlyv0tt88ud%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fqlyv0tt88ud%2f&title=Webpack%20%e6%ba%90%e7%a0%81%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20Tapable%20%e5%92%8c%20%e4%ba%8b%e4%bb%b6%e6%b5%81"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqlyv0tt88ud%2f&title=Webpack%20%e6%ba%90%e7%a0%81%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20Tapable%20%e5%92%8c%20%e4%ba%8b%e4%bb%b6%e6%b5%81"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqlyv0tt88ud%2f&title=Webpack%20%e6%ba%90%e7%a0%81%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20Tapable%20%e5%92%8c%20%e4%ba%8b%e4%bb%b6%e6%b5%81"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqlyv0tt88ud%2f&title=Webpack%20%e6%ba%90%e7%a0%81%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%20Tapable%20%e5%92%8c%20%e4%ba%8b%e4%bb%b6%e6%b5%81"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Webpack 源码（一）—— Tapable 和 事件流</h1><div class="meta"><div class="postdate"><time datetime="2019-01-28" itemprop="datePublished">2019-01-28</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e1、Tapable\x3c\/h2\x3e\n\x3cp\x3eTap 的英文单词解释，除了最常用的 \x3cstrong\x3e点击\x3c\/strong\x3e 手势之外，还有一个意思是 \x3cstrong\x3e水龙头\x3c\/strong\x3e —— 在 webpack 中指的是后一种；\x3c\/p\x3e\n\x3cp\x3eWebpack 可以认为是一种基于事件流的编程范例，内部的工作流程都是基于 \x3cstrong\x3e插件\x3c\/strong\x3e 机制串接起来；\x3c\/p\x3e\n\x3cp\x3e而将这些插件粘合起来的就是webpack自己写的基础类 \x3ca href=\x22https:\/\/github.com\/webpack\/tapable\/blob\/master\/lib\/Tapable.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eTapable\x3c\/a\x3e 是，\x3ccode\x3eplugin\x3c\/code\x3e方法就是该类暴露出来的；\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e后面我们将看到核心的对象 Compiler、Compilation 等都是继承于该对象\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e基于该类规范而其的 Webpack 体系保证了插件的有序性，使得整个系统非常有弹性，扩展性很好；然而有一个致命的缺点就是调试、看源码真是很痛苦，各种跳来跳去；（基于事件流的写法，和程序语言中的 \x3cstrong\x3egoto\x3c\/strong\x3e 语句很类似）\x3c\/p\x3e\n\x3cp\x3e把这个仓库下载，使用 Webstorm 进行调试，test 目录是很好的教程入口；\x3c\/p\x3e\n\x3cp\x3eTapable.plugin()：相当于把对象归类到名为 name 的对象下，以array的形式；所有的插件都存在私有变量 \x3cstrong\x3e_plugin\x3c\/strong\x3e 变量中；\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/gw.alicdn.com\/tps\/TB1VgdNKFXXXXaaXFXXXXXXXXXX-321-167.png\x22 src=\x22https:\/\/static.alili.techhttps:\/\/gw.alicdn.com\/tps\/TB1VgdNKFXXXXaaXFXXXXXXXXXX-321-167.png\x22 alt=\x22plugins\x22 title=\x22plugins\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e接下来我们简单节选几个函数分析一下：\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e1.1、apply 方法\x3c\/h3\x3e\n\x3cp\x3e该方法最普通也是最常用的，看一下它的定义：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\nTapable.prototype.apply = function apply() {\n    for(var i = 0; i \x3c arguments.length; i\x2b\x2b) {\n        arguments[i].apply(this);\n    }\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode class=\x22shell\x22\x3e\nTapable.prototype.apply = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eapply\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e.length; i\x2b\x2b) {\n        \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e[i].apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n    }\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e毫无悬念，就是 \x3cstrong\x3e挨个顺序\x3c\/strong\x3e 执行传入到该函数方法中对象的 \x3ccode\x3eapply\x3c\/code\x3e 方法；通常传入该函数的对象也是 \x3cstrong\x3eTapable 插件\x3c\/strong\x3e 对象，因此必然也存在 \x3ccode\x3eapply\x3c\/code\x3e 方法；（Webpack 的插件就是Tapable对象，因此必须要提供  \x3ccode\x3eapply\x3c\/code\x3e  方法 ）\x3c\/p\x3e\n\x3cp\x3e只是更改上下文为当前 \x3ccode\x3ethis\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e因此当前这里最大的作用就是传入当前 \x3cstrong\x3eTapable\x3c\/strong\x3e 的上下文\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e1.2、 applyPluginsAsync(name,...other,callback)\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 模拟两个插件\nvar _plugins = {\n    \x26quot;emit\x26quot;:[\n        function(a,b,cb){\n            setTimeout(()=\x3e{\n              console.log(\x271\x27,a,b);\n              cb();\n            },1000);\n        },\n        function(a,b,cb){\n            setTimeout(()=\x3e{\n                console.log(\x272\x27,a,b);\n                cb();\n            },500)\n        }\n    ]\n}\n\napplyPluginsAsync(\x26quot;emit\x26quot;,\x27aaaa\x27,\x27bbbbb\x27,function(){console.log(\x27end\x27)});\n\n\/\/ 输出结果：\n\n\/\/ 1 aaaa bbbbb\n\/\/ 2 aaaa bbbbb\n\/\/  end\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 模拟两个插件\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _plugins = {\n    \x3cspan class=\x22hljs-string\x22\x3e\x22emit\x22\x3c\/span\x3e:[\n        \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n            setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n              \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e,a,b);\n              cb();\n            },\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n        },\n        \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n            setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n                \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e,a,b);\n                cb();\n            },\x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e)\n        }\n    ]\n}\n\napplyPluginsAsync(\x3cspan class=\x22hljs-string\x22\x3e\x22emit\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27aaaa\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27bbbbb\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27end\x27\x3c\/span\x3e)});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 输出结果：\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1 aaaa bbbbb\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2 aaaa bbbbb\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/  end\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们看到，虽然第一个插件是延后 1000ms 执行，第二个则是延后 500ms，但在真正执行的时候，是严格按照顺序执行的；每个插件需要在最后显式调用\x3ccode\x3ecb()\x3c\/code\x3e通知下一个插件的运行；\x3c\/p\x3e\n\x3cp\x3e这里需要注意每个插件的形参的个数都要一致，且最后一个必须是cb()方法，用于唤起下一个插件的运行；cb的第一个参数是err，如果该参数不为空，就直接调用最后callback，中断后续插件的运行；\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e1.3、 applyPluginsParallel(name,...other,callback)\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e大部分代码和 \x3ccode\x3eapplyPluginsAsync\x3c\/code\x3e 有点儿类似\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e这个 \x3ccode\x3eapplyPluginsParallel\x3c\/code\x3e 主要功能和 最简单的 \x3ccode\x3eapplyPlugins\x3c\/code\x3e 方法比较相似，\x3cstrong\x3e无论如何都会让所有注册的插件运行一遍\x3c\/strong\x3e；\x3c\/p\x3e\n\x3cp\x3e只是相比 \x3ccode\x3eapplyPlugins\x3c\/code\x3e 多了一个额外的功能，它最后 \x3cstrong\x3e提供一个 callback 函数\x3c\/strong\x3e，这个 callback 的函数比较倔强，如果所有的插件x都正常执行，且最后都cb()，则会在最后执行callback里的逻辑；不过，一旦其中某个插件运行出错，就会调用这个callback(err)，之后就算插件有错误也不会再调用该callback函数；\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\nvar _plugins = {\n\x26quot;emit\x26quot;:[\n    function(a,b,cb){\n        setTimeout(()=\x3e{\n          console.log(\x271\x27,a,b);\n          cb(null,\x27e222\x27,\x2733333\x27);\n        },1000);\n    },\n    function(a,b,cb){\n        setTimeout(()=\x3e{\n            console.log(\x272\x27,a,b);\n            cb(null,\x27err\x27);\n        },500)\n    }\n]\n}\n\napplyPluginsParallel(\x26quot;emit\x26quot;,\x27aaaa\x27,\x27bbbbb\x27,function(a,b){console.log(\x27end\x27,a,b)});\n\n\/\/ 输出结果：\n\n\/\/ 2 aaaa bbbbb\n\/\/ 1 aaaa bbbbb\n\/\/  end undefined undefined\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _plugins = {\n\x3cspan class=\x22hljs-string\x22\x3e\x22emit\x22\x3c\/span\x3e:[\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n          \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e,a,b);\n          cb(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27e222\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x2733333\x27\x3c\/span\x3e);\n        },\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n    },\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e,a,b);\n            cb(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27err\x27\x3c\/span\x3e);\n        },\x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e)\n    }\n]\n}\n\napplyPluginsParallel(\x3cspan class=\x22hljs-string\x22\x3e\x22emit\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27aaaa\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27bbbbb\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27end\x27\x3c\/span\x3e,a,b)});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 输出结果：\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2 aaaa bbbbb\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1 aaaa bbbbb\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/  end undefined undefined\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的两个插件都是调用了 cb，且第一个参数是 null（表示没有错误），所以最后能输出 callback 函数中的 console 内容；\x3c\/p\x3e\n\x3cp\x3e如果注释两个插件中任何一个 cb() 调用，你会发现最后的 callback \x3cstrong\x3e没有执行\x3c\/strong\x3e；\x3c\/p\x3e\n\x3cp\x3e如果让 \x3cstrong\x3e第二个\x3c\/strong\x3e cb()的第一个值不是 null，比如 cb(\x27err\x27)，则 callback 之后输出这个错误，之后再也不会调用此 callback：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var _plugins = {\n\x26quot;emit\x26quot;:[\n    function(a,b,cb){\n        setTimeout(()=\x3e{\n          console.log(\x271\x27,a,b);\n          cb(\x27e222\x27,\x2733333\x27);\n        },1000);\n    },\n    function(a,b,cb){\n        setTimeout(()=\x3e{\n            console.log(\x272\x27,a,b);\n            cb(\x27err\x27);\n        },500)\n    }\n]\n}\n\n\/\/ 输出结果：\n\n\/\/ 2 aaaa bbbbb\n\/\/ end err undefined\n\/\/ 1 aaaa bbbbb\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _plugins = {\n\x3cspan class=\x22hljs-string\x22\x3e\x22emit\x22\x3c\/span\x3e:[\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n          \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e,a,b);\n          cb(\x3cspan class=\x22hljs-string\x22\x3e\x27e222\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x2733333\x27\x3c\/span\x3e);\n        },\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n    },\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e,a,b);\n            cb(\x3cspan class=\x22hljs-string\x22\x3e\x27err\x27\x3c\/span\x3e);\n        },\x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e)\n    }\n]\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 输出结果：\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2 aaaa bbbbb\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ end err undefined\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1 aaaa bbbbb\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e1.4、 applyPluginsWaterfall(name, init, callback)\x3c\/h3\x3e\n\x3cp\x3e顾名思义，这个方法相当于是 \x3cstrong\x3e瀑布式\x3c\/strong\x3e 调用，给第一个插件传入初始对象 \x3ccode\x3einit\x3c\/code\x3e，然后经过第一个插件调用之后会获得一个结果对象，该结果对象会传给下一个插件 \x3cstrong\x3e作为初始值\x3c\/strong\x3e，直到最后调用完毕，最后一个插件的直接结果传给 callback 作为初始值；\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e1.5、 applyPluginsParallelBailResult(name,...other,callback)\x3c\/h3\x3e\n\x3cp\x3e这个方法应该是所有方法中最难理解的；\x3c\/p\x3e\n\x3cp\x3e首先它的行为和 \x3ccode\x3eapplyPluginsParallel\x3c\/code\x3e 非常相似，首先会 \x3cstrong\x3e无论如何都会让所有注册的插件运行一遍（根据注册的顺序）\x3c\/strong\x3e；\x3c\/p\x3e\n\x3cp\x3e为了让 callback 执行，其前提条件是每个插件都需要调用 cb()；\x3c\/p\x3e\n\x3cp\x3e但其中的 callback 只会执行一次（当传给cb的值不是undefined\/null 的时候），这一次执行顺序是插件定义顺序有关，\x3cstrong\x3e而跟每个插件中的 cb() 执行时间无关的\x3c\/strong\x3e；\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\nvar _plugins = {\n\x26quot;emit\x26quot;:[\n    function(a,b,cb){\n        setTimeout(()=\x3e{\n          console.log(\x271\x27,a,b);\n          cb();\n        },1000);\n    },\n    function(a,b,cb){\n        setTimeout(()=\x3e{\n            console.log(\x272\x27,a,b);\n            cb();\n        },500)\n    },\n    function(a,b,cb){\n        setTimeout(()=\x3e{\n            console.log(\x273\x27,a,b);\n            cb();\n        },1500)\n    }\n]\n}\n\napplyPluginsParallelBailResult(\x26quot;emit\x26quot;,\x27aaaa\x27,\x27bbbbb\x27,function(a,b){console.log(\x27end\x27,a,b)});\n\n\/\/ 运行结果\n\n\/\/ 2 aaaa bbbbb\n\/\/ 1 aaaa bbbbb\n\/\/ 3 aaaa bbbbb\n\/\/ end undefined undefined\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _plugins = {\n\x3cspan class=\x22hljs-string\x22\x3e\x22emit\x22\x3c\/span\x3e:[\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n          \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e,a,b);\n          cb();\n        },\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n    },\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e,a,b);\n            cb();\n        },\x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e)\n    },\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x273\x27\x3c\/span\x3e,a,b);\n            cb();\n        },\x3cspan class=\x22hljs-number\x22\x3e1500\x3c\/span\x3e)\n    }\n]\n}\n\napplyPluginsParallelBailResult(\x3cspan class=\x22hljs-string\x22\x3e\x22emit\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27aaaa\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27bbbbb\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27end\x27\x3c\/span\x3e,a,b)});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 运行结果\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2 aaaa bbbbb\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1 aaaa bbbbb\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 3 aaaa bbbbb\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ end undefined undefined\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这是最普通的运行情况，我们稍微调整一下（注意三个插件运行的顺序2-1-3），分别给cb传入有效的值：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\nvar _plugins = {\n\x26quot;emit\x26quot;:[\n    function(a,b,cb){\n        setTimeout(()=\x3e{\n          console.log(\x271\x27,a,b);\n          cb(\x271\x27);\n        },1000);\n    },\n    function(a,b,cb){\n        setTimeout(()=\x3e{\n            console.log(\x272\x27,a,b);\n            cb(\x272\x27);\n        },500)\n    },\n    function(a,b,cb){\n        setTimeout(()=\x3e{\n            console.log(\x273\x27,a,b);\n            cb(\x273\x27);\n        },1500)\n    }\n]\n}\napplyPluginsParallelBailResult(\x26quot;emit\x26quot;,\x27aaaa\x27,\x27bbbbb\x27,function(a,b){console.log(\x27end\x27,a,b)});\n\/\/ 运行结果\n\n\/\/ 2 aaaa bbbbb\n\/\/ 1 aaaa bbbbb\n\/\/ end 1 undefined\n\/\/ 3 aaaa bbbbb\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _plugins = {\n\x3cspan class=\x22hljs-string\x22\x3e\x22emit\x22\x3c\/span\x3e:[\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n          \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e,a,b);\n          cb(\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e);\n        },\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n    },\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e,a,b);\n            cb(\x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e);\n        },\x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e)\n    },\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b,cb\x3c\/span\x3e)\x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x273\x27\x3c\/span\x3e,a,b);\n            cb(\x3cspan class=\x22hljs-string\x22\x3e\x273\x27\x3c\/span\x3e);\n        },\x3cspan class=\x22hljs-number\x22\x3e1500\x3c\/span\x3e)\n    }\n]\n}\napplyPluginsParallelBailResult(\x3cspan class=\x22hljs-string\x22\x3e\x22emit\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27aaaa\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27bbbbb\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea,b\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27end\x27\x3c\/span\x3e,a,b)});\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 运行结果\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2 aaaa bbbbb\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1 aaaa bbbbb\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ end 1 undefined\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 3 aaaa bbbbb\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以发现第1个插件 \x3ccode\x3ecb(\x271\x27)\x3c\/code\x3e 执行了，后续的 \x3ccode\x3ecb(\x272\x27)\x3c\/code\x3e 和 \x3ccode\x3ecb(\x273\x27)\x3c\/code\x3e 都给忽略了；\x3c\/p\x3e\n\x3cp\x3e这是因为插件注册顺序是 1-2-3，虽然运行的时候顺序是 2-1-3，但所运行的还是 1 对应的 cb；所以，就算1执行的速度最慢（比如把其setTimeout的值设置成 \x3cstrong\x3e2000\x3c\/strong\x3e），运行的 cb 仍然是1对应的cb;\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e其中涉及的魔法是 \x3cstrong\x3e闭包\x3c\/strong\x3e，传入的\x3ccode\x3ei\x3c\/code\x3e就是和注册顺序绑定了\x3c\/p\x3e\n\x3cp\x3e这样一说明，你会发现 \x3ccode\x3eapplyPluginsParallel\x3c\/code\x3e 的 cb 执行时机是和执行时间有关系的，你可以自己验证一下；\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e1.6、总结\x3c\/h3\x3e\n\x3cp\x3e总结一下，Tapable 就相当于是一个 \x3cstrong\x3e事件管家\x3c\/strong\x3e，它所提供的 \x3ccode\x3eplugin\x3c\/code\x3e 方法类似于 \x3ccode\x3eaddEventListen\x3c\/code\x3e 监听事件，\x3ccode\x3eapply\x3c\/code\x3e 方法类似于事件触发函数 \x3ccode\x3etrigger\x3c\/code\x3e；\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22http:\/\/ww4.sinaimg.cn\/large\/006tNbRwgw1fa8r9bnodhj30sg0lcwhd.jpg\x22 src=\x22https:\/\/static.alili.techhttp:\/\/ww4.sinaimg.cn\/large\/006tNbRwgw1fa8r9bnodhj30sg0lcwhd.jpg\x22 alt=\x22总结一下\x22 title=\x22总结一下\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e2、Webpack 中的事件流\x3c\/h2\x3e\n\x3cp\x3e既然 Webpack 是基于 Tapable 搭建起来的，那么我们看一下 Webpack 构建一个模块的基本事件流是如何的；\x3c\/p\x3e\n\x3cp\x3e我们在 Webpack 库中的 \x3cstrong\x3eTapable.js\x3c\/strong\x3e 中每个方法中新增 \x3ccode\x3econsole\x3c\/code\x3e 语句打出日志，就能找出所有关键的事件名字：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/lh3.googleusercontent.com\/-03Z2Y5cJcMI\/V2zVO1tZgeI\/AAAAAAAACyo\/Z23Qogi0DWkRmSeqjh71-h186RYEx0Y9ACCo\/s640\/2016-06-24_14-30-20.png\x22 src=\x22https:\/\/static.alili.techhttps:\/\/lh3.googleusercontent.com\/-03Z2Y5cJcMI\/V2zVO1tZgeI\/AAAAAAAACyo\/Z23Qogi0DWkRmSeqjh71-h186RYEx0Y9ACCo\/s640\/2016-06-24_14-30-20.png\x22 alt=\x22log\x22 title=\x22log\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e打印结果：（这里只列举了简单的事件流程，打包不同的入口文件会有所差异，但 \x3cstrong\x3e事件出现的先后顺序是固定的\x3c\/strong\x3e ）\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e类型\x3c\/th\x3e\n\x3cth\x3e名字\x3c\/th\x3e\n\x3cth\x3e事件名\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eentry-option\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eafter-plugins\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eafter-resolvers\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eenvironment\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eafter-environment\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[D]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsAsyncSeries\x3c\/td\x3e\n\x3ctd\x3erun\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3enormal-module-factory\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3econtext-module-factory\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ecompile\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ethis-compilation\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ecompilation\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[F]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsParallel\x3c\/td\x3e\n\x3ctd\x3emake\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[E]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsAsyncWaterfall\x3c\/td\x3e\n\x3ctd\x3ebefore-resolve\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3efactory\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3eresolver\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eresolve\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eresolve-step\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[G]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsParallelBailResult\x3c\/td\x3e\n\x3ctd\x3efile\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[G]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsParallelBailResult\x3c\/td\x3e\n\x3ctd\x3edirectory\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eresolve-step\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[G]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsParallelBailResult\x3c\/td\x3e\n\x3ctd\x3eresult\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[E]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsAsyncWaterfall\x3c\/td\x3e\n\x3ctd\x3eafter-resolve\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3ecreate-module\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3emodule\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ebuild-module\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3enormal-module-loader\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eprogram\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3estatement\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eevaluate CallExpression\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3evar data\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eevaluate Identifier\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eevaluate Identifier require\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3ecall require\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eevaluate Literal\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3ecall require:amd:array\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eevaluate Literal\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3ecall require:commonjs:item\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3estatement\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eevaluate MemberExpression\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eevaluate Identifier console.log\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3ecall console.log\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eexpression console.log\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eexpression console\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3esucceed-module\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[E]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsAsyncWaterfall\x3c\/td\x3e\n\x3ctd\x3ebefore-resolve\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3efactory\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ebuild-module\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3esucceed-module\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eseal\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eoptimize\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eoptimize-modules\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eafter-optimize-modules\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eoptimize-chunks\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eafter-optimize-chunks\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[D]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsAsyncSeries\x3c\/td\x3e\n\x3ctd\x3eoptimize-tree\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eafter-optimize-tree\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eshould-record\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3erevive-modules\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eoptimize-module-order\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ebefore-module-ids\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eoptimize-module-ids\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eafter-optimize-module-ids\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3erecord-modules\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3erevive-chunks\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eoptimize-chunk-order\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ebefore-chunk-ids\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eoptimize-chunk-ids\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eafter-optimize-chunk-ids\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3erecord-chunks\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ebefore-hash\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ehash\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ehash\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ehash\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ehash\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ehash-for-chunk\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3echunk-hash\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eafter-hash\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3ebefore-chunk-assets\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3eglobal-hash-paths\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eglobal-hash\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3ebootstrap\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3elocal-vars\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3erequire\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3emodule-obj\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3emodule-require\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3erequire-extensions\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3easset-path\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3estartup\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3emodule-require\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3erender\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3emodule\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3erender\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3epackage\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3emodule\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3erender\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3epackage\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3emodules\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3erender-with-entry\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3easset-path\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3easset-path\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3echunk-asset\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eadditional-chunk-assets\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3erecord\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[D]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsAsyncSeries\x3c\/td\x3e\n\x3ctd\x3eadditional-assets\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[D]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsAsyncSeries\x3c\/td\x3e\n\x3ctd\x3eoptimize-chunk-assets\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eafter-optimize-chunk-assets\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[D]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsAsyncSeries\x3c\/td\x3e\n\x3ctd\x3eoptimize-assets\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3eafter-optimize-assets\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[D]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsAsyncSeries\x3c\/td\x3e\n\x3ctd\x3eafter-compile\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[C]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsBailResult\x3c\/td\x3e\n\x3ctd\x3eshould-emit\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[D]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsAsyncSeries\x3c\/td\x3e\n\x3ctd\x3eemit\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[B]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsWaterfall\x3c\/td\x3e\n\x3ctd\x3easset-path\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[D]\x3c\/td\x3e\n\x3ctd\x3eapplyPluginsAsyncSeries\x3c\/td\x3e\n\x3ctd\x3eafter-emit\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e[A]\x3c\/td\x3e\n\x3ctd\x3eapplyPlugins\x3c\/td\x3e\n\x3ctd\x3edone\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cp\x3e内容较多，依据源码内容的编排，可以将上述进行分层；\x3cstrong\x3e大粒度\x3c\/strong\x3e的事件流如下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22http:\/\/ww1.sinaimg.cn\/large\/006tNbRwgw1fa8sb4gg6oj30ax0mbmy0.jpg\x22 src=\x22https:\/\/static.alili.techhttp:\/\/ww1.sinaimg.cn\/large\/006tNbRwgw1fa8sb4gg6oj30ax0mbmy0.jpg\x22 alt=\x22大力度事件流\x22 title=\x22大力度事件流\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e而其中 \x3cstrong\x3emake\x3c\/strong\x3e、 \x3cstrong\x3eseal\x3c\/strong\x3e 和 \x3cstrong\x3eemit\x3c\/strong\x3e 阶段比较核心（包含了很多小粒度的事件），后续会继续展开讲解；\x3c\/p\x3e\n\x3cp\x3e这里罗列一下关键的事件节点：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eentry-option\x3c\/code\x3e：初始化options\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3erun\x3c\/code\x3e：开始编译\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3emake\x3c\/code\x3e：从entry开始递归的分析依赖，对每个依赖模块进行build\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ebefore-resolve - after-resolve\x3c\/code\x3e： 对其中一个模块位置进行解析\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ebuild-module \x3c\/code\x3e：开始构建 (build) 这个module,这里将使用文件对应的loader加载\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3enormal-module-loader\x3c\/code\x3e：对用loader加载完成的module(是一段js代码)进行编译,用 \x3ca href=\x22https:\/\/github.com\/ternjs\/acorn\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eacorn\x3c\/a\x3e 编译,生成ast抽象语法树。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eprogram\x3c\/code\x3e： 开始对ast进行遍历，当遇到require等一些调用表达式时，触发 \x3ccode\x3ecall require\x3c\/code\x3e 事件的handler执行，收集依赖，并。如：AMDRequireDependenciesBlockParserPlugin等\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eseal\x3c\/code\x3e： 所有依赖build完成，下面将开始对chunk进行优化，比如合并,抽取公共模块,加hash\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eoptimize-chunk-assets\x3c\/code\x3e：压缩代码，插件 \x3cstrong\x3eUglifyJsPlugin\x3c\/strong\x3e 就放在这个阶段\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ebootstrap\x3c\/code\x3e： 生成启动代码\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eemit\x3c\/code\x3e： 把各个chunk输出到结果文件\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e3、参考文章\x3c\/h2\x3e\n\x3cp\x3e本系列的源码阅读，以下几篇文章给了很多启发和思路，其中 \x3ca href=\x22https:\/\/lihuanghe.github.io\/2016\/05\/30\/webpack-source-analyse.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack 源码解析\x3c\/a\x3e 和 \x3ca href=\x22http:\/\/taobaofed.org\/blog\/2016\/09\/09\/webpack-flow\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e细说 webpack 之流程篇\x3c\/a\x3e 尤为突出，推荐阅读；\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/lihuanghe.github.io\/2016\/05\/30\/webpack-source-analyse.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack 源码解析\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/taobaofed.org\/blog\/2016\/09\/09\/webpack-flow\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e细说 webpack 之流程篇\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/itechblog.sinaapp.com\/?p=529\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWebPack学习：WebPack内置Plugin\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/lcxfs1991\/blog\/issues\/1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e如何写一个webpack插件\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/webpack\/docs\/wiki\/plugins\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eplugins官方文档\x3c\/a\x3e：\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Webpack 源码（一）—— Tapable 和 事件流</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008060440">https://segmentfault.com/a/1190000008060440</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/qlyv0tt88ud/" target="_blank">https://alili.tech/archive/qlyv0tt88ud/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>