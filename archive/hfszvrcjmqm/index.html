<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="jQuery 源码系列（一）总体架构"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>jQuery 源码系列（一）总体架构 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/hfszvrcjmqm/",
				"appid": "1613049289050283", 
				"title": "jQuery 源码系列（一）总体架构 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-26T02:30:18"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/9aova4fq5hv/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/het77a8r625/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fhfszvrcjmqm%2f&text=jQuery%20%e6%ba%90%e7%a0%81%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89%e6%80%bb%e4%bd%93%e6%9e%b6%e6%9e%84"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fhfszvrcjmqm%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fhfszvrcjmqm%2f&text=jQuery%20%e6%ba%90%e7%a0%81%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89%e6%80%bb%e4%bd%93%e6%9e%b6%e6%9e%84"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fhfszvrcjmqm%2f&title=jQuery%20%e6%ba%90%e7%a0%81%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89%e6%80%bb%e4%bd%93%e6%9e%b6%e6%9e%84"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fhfszvrcjmqm%2f&is_video=false&description=jQuery%20%e6%ba%90%e7%a0%81%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89%e6%80%bb%e4%bd%93%e6%9e%b6%e6%9e%84"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=jQuery%20%e6%ba%90%e7%a0%81%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89%e6%80%bb%e4%bd%93%e6%9e%b6%e6%9e%84&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fhfszvrcjmqm%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fhfszvrcjmqm%2f&title=jQuery%20%e6%ba%90%e7%a0%81%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89%e6%80%bb%e4%bd%93%e6%9e%b6%e6%9e%84"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fhfszvrcjmqm%2f&title=jQuery%20%e6%ba%90%e7%a0%81%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89%e6%80%bb%e4%bd%93%e6%9e%b6%e6%9e%84"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fhfszvrcjmqm%2f&title=jQuery%20%e6%ba%90%e7%a0%81%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89%e6%80%bb%e4%bd%93%e6%9e%b6%e6%9e%84"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fhfszvrcjmqm%2f&title=jQuery%20%e6%ba%90%e7%a0%81%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89%e6%80%bb%e4%bd%93%e6%9e%b6%e6%9e%84"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">jQuery 源码系列（一）总体架构</h1><div class="meta"><div class="postdate"><time datetime="2019-01-26" itemprop="datePublished">2019-01-26</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e欢迎来\x3ca href=\x22https:\/\/segmentfault.com\/blog\/yuren\x22\x3e我的专栏\x3c\/a\x3e查看系列文章。\x3c\/p\x3e\n\x3cp\x3e决定你走多远的是基础，jQuery 源码分析，向长者膜拜！ \x3c\/p\x3e\n\x3cp\x3e我虽然接触 jQuery 很久了，但也只是局限于表面使用的层次，碰到一些问题，找到 jQuery 的解决办法，然后使用。\x3cstrong\x3e显然\x3c\/strong\x3e，这种做法的弊端就是，无论你怎么学，都只能是个小白。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008365624?w=690\x26amp;h=368\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008365624?w=690\x26amp;h=368\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e当我建立这个项目的时候，就表示，我要改变这一切了，做一些人想做，憧憬去做，但从没踏入第一步的事情，学习 jQuery 源码。\x3c\/p\x3e\n\x3cp\x3e到目前为止，jQuery 的\x3ca href=\x22https:\/\/github.com\/jquery\/jquery\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e贡献者团队\x3c\/a\x3e共 256 名成员，6000 多条 commits，可想而知，jQuery 是一个多么庞大的项目。jQuery \x3ca href=\x22https:\/\/jquery.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e官方\x3c\/a\x3e的版本目前是 v3.1.1，已经衍生出 jQueryUI、jQueryMobile 等多个项目。\x3c\/p\x3e\n\x3cp\x3e虽然我在前端爬摸打滚一年多，自认基础不是很好，在没有外界帮助的情况下，直接阅读项目源码太难了，所以在边参考遍实践的过程中写下来这个项目。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e首先\x3c\/strong\x3e，先推荐一个 jQuery 的\x3ca href=\x22http:\/\/james.padolsey.com\/jquery\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e源码查询\x3c\/a\x3e网站，这个网站给初学者非常大的帮助，不仅能查找不同版本的 jQuery 源码，还能索引函数，功能简直吊炸天。\x3c\/p\x3e\n\x3cp\x3e另外，推荐两个分析 jQuery 的博客：\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/aaronjs\/p\/3279314.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejQuery源码分析系列\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/nuysoft\/archive\/2011\/11\/14\/2248023.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e原创 jQuery1.6.1源码分析系列（停止更新）\x3c\/a\x3e\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e这两个博客给我了很大的帮助，谢谢。\x3c\/p\x3e\n\x3cp\x3e另外还有下面的网址，让我在如何使用 jQuery 上得心应手：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ca href=\x22http:\/\/www.css88.com\/jqapi-1.9\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejQuery API 中文文档\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3ejQuery 总体架构\x3c\/h2\x3e\n\x3cp\x3e首先，jQuery 是一个开发框架，它的火爆程度已经无法用言语来形容，当你随便打开一个网站，一半以上直接使用了 jQuery。或许，早几年，一个前端工程师，只要会写 jQuery，就可以无忧工作。虽说最近 react、vue 很火，但 jQuery 中许多精彩的方法和逻辑值得每一个前端人员学习。\x3c\/p\x3e\n\x3cp\x3e和其众多的框架一样，总要把接口放到外面来调用，内部往往是一个闭包，避免环境变量的污染。\x3c\/p\x3e\n\x3cp\x3e先来看看 jQuery 使用上的几大特点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e$(\x27#id\x27) 函数方式直接生成 jQuery 对象\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e$(\x27#id\x27).css().html().hide() 链式调用\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e关于链式调用，我想有点基础都很容易实现，函数结尾 return this 即可，主要来介绍一下无 new 实现创建对象。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e无 new 函数实现\x3c\/h2\x3e\n\x3cp\x3e下面是一个普通的函数，很显然，会陷入死循环：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var jQuery = function(){\n  return new jQuery();\n}\njQuery.prototype = {\n  ...\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e jQuery = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e jQuery();\n}\njQuery.prototype = {\n  ...\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个死循环来的太突然，jQuery() 会创建一个 new jQuery，new jQuery 又会创建一个 new jQuery...\x3c\/p\x3e\n\x3cp\x3ejQuery 用一个 init 函数来代替直接 new 函数名的方式，还要考虑到 jQuery 中分离作用域：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var jQuery = function(){\n  return new jQuery.prototype.init();\n}\njQuery.prototype = {\n  constructor: jQuery,\n  init: function(){\n    this.jquery = 1.0;\n    return this;\n  },\n  jquery: 2.0,\n  each: function(){\n    console.log(\x27each\x27);\n    return this;\n  }\n}\njQuery().jquery \/\/1.0\njQuery.prototype.jquery \/\/2.0\n\njQuery().each() \/\/ error\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e jQuery = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e jQuery.prototype.init();\n}\njQuery.prototype = {\n  \x3cspan class=\x22hljs-attr\x22\x3econstructor\x3c\/span\x3e: jQuery,\n  \x3cspan class=\x22hljs-attr\x22\x3einit\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.jquery = \x3cspan class=\x22hljs-number\x22\x3e1.0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3ejquery\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eeach\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27each\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n  }\n}\njQuery().jquery \x3cspan class=\x22hljs-comment\x22\x3e\/\/1.0\x3c\/span\x3e\njQuery.prototype.jquery \x3cspan class=\x22hljs-comment\x22\x3e\/\/2.0\x3c\/span\x3e\n\njQuery().each() \x3cspan class=\x22hljs-comment\x22\x3e\/\/ error\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面看似运行正常，但是问题出在 \x3ccode\x3ejQuery().each() \/\/ error\x3c\/code\x3e，访问不到 each 函数。实际上，\x3ccode\x3enew jQuery.prototype.init()\x3c\/code\x3e 返回到是谁的实例？是 init 这个函数的实例，所以 init 函数中的 this 就没了意义。\x3c\/p\x3e\n\x3cp\x3e那么，如果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var jq = jQuery();\njq.__proto__ === jQuery.prototype;\njq.each === jQuery.prototype.each;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e jq = jQuery();\njq.__proto__ === jQuery.prototype;\njq.each === jQuery.prototype.each;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果可以实现上面的 proto 的指向问题，原型函数调用问题就解决了，\x3cstrong\x3e但实际上\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var jq = jQuery();\njq.__proto__ === jQuery.prototype.init.prototype; \/\/true\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e jq = jQuery();\njq.__proto__ === jQuery.prototype.init.prototype; \x3cspan class=\x22hljs-comment\x22\x3e\/\/true\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e实际上，jq 的 proto 是指向 init 函数的原型，\x3cstrong\x3e所以\x3c\/strong\x3e，我们可以把 \x3ccode\x3ejQuery.prototype.init.prototype = jQuery.prototype\x3c\/code\x3e，这个时候，函数调用就顺理成章了，而且使用的都是引用，指向的都是同一个 prototype 对象，也不需要担心循环问题。实际上，jQuery 就是这么干的。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var jQuery = function(){\n  return new jQuery.prototype.init();\n}\njQuery.prototype = {\n  constructor: jQuery,\n  init: function(){\n    this.jquery = 1.0;\n    return this;\n  },\n  jquery: 2.0,\n  each: function(){\n    console.log(\x27each\x27);\n    return this;\n  }\n}\njQuery.prototype.init.prototype = jQuery.prototype;\njQuery().each() \/\/\x27each\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e jQuery = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e jQuery.prototype.init();\n}\njQuery.prototype = {\n  \x3cspan class=\x22hljs-attr\x22\x3econstructor\x3c\/span\x3e: jQuery,\n  \x3cspan class=\x22hljs-attr\x22\x3einit\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.jquery = \x3cspan class=\x22hljs-number\x22\x3e1.0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3ejquery\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eeach\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27each\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n  }\n}\njQuery.prototype.init.prototype = jQuery.prototype;\njQuery().each() \x3cspan class=\x22hljs-comment\x22\x3e\/\/\x27each\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3ejQuery 内部结构图\x3c\/h2\x3e\n\x3cp\x3e在说内部图之前，先说下 \x3ccode\x3ejQuery.fn\x3c\/code\x3e，它实际上是 prototype 的一个引用，指向 jQuery.prototype 的，\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var jQuery = function(){\n  return new jQuery.prototype.init();\n}\njQuery.fn = jQuery.prototype = {\n  ...\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e jQuery = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e jQuery.prototype.init();\n}\njQuery.fn = jQuery.prototype = {\n  ...\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e那么为什么要用 fn 指向 prototype？我本人查阅了一些资料，貌似还是下面的回答比较中肯：简介。你不觉得 fn 比 prototype 好写多了吗。\x3c\/p\x3e\n\x3cp\x3e借用网上的一张图：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008365625?w=690\x26amp;h=554\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008365625?w=690\x26amp;h=554\x22 alt=\x22jquery 内部结构图\x22 title=\x22jquery 内部结构图\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e从这张图中可以看出，window 对象上有两个公共的接口，分别是 $ 和 jQuery：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.jQuery = window.$ = jQuery;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.jQuery = \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.$ = jQuery;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3ejQuery.extend\x3c\/code\x3e 方法是一个对象拷贝的方法，包括深拷贝，后面会详细讲解源码，暂时先放一边。\x3c\/p\x3e\n\x3cp\x3e下面的关系可能会有些乱，但是仔细看了前面的介绍，应该能看懂。fn 就是 prototype，所以 jQuery 的 fn 和 prototype 属性指向 fn 对象，而 init 函数本身就是 jQuery.prototype 中的方法，且 init 函数的 prototype 原型指向 fn。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e链式调用\x3c\/h2\x3e\n\x3cp\x3e链式调用的好处，就是写出来的代码非常简洁，而且代码返回的都是同一个对象，提高代码效率。\x3c\/p\x3e\n\x3cp\x3e前面已经说了，在没有返回值的原型函数后面添加 return this：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var jQuery = function(){\n  return new jQuery.fn.init();\n}\njQuery.fn = jQuery.prototype = {\n  constructor: jQuery,\n  init: function(){\n    this.jquery = 3.0;\n    return this;\n  },\n  each: function(){\n    console.log(\x27each\x27);\n    return this;\n  }\n}\njQuery.fn.init.prototype = jQuery.fn;\njQuery().each().each();\n\/\/ \x27each\x27\n\/\/ \x27each\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e jQuery = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e jQuery.fn.init();\n}\njQuery.fn = jQuery.prototype = {\n  \x3cspan class=\x22hljs-attr\x22\x3econstructor\x3c\/span\x3e: jQuery,\n  \x3cspan class=\x22hljs-attr\x22\x3einit\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.jquery = \x3cspan class=\x22hljs-number\x22\x3e3.0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3eeach\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27each\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n  }\n}\njQuery.fn.init.prototype = jQuery.fn;\njQuery().each().each();\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x27each\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x27each\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3eextend\x3c\/h2\x3e\n\x3cp\x3ejQuery 中一个重要的函数便是 extend，既可以对本身 jQuery 的属性和方法进行扩张，又可以对原型的属性和方法进行扩展。\x3c\/p\x3e\n\x3cp\x3e先来说下 extend 函数的功能，大概有两种，如果参数只有一个 object，即表示将这个对象扩展到 jQuery 的命名空间中，也就是所谓的 jQuery 的扩展。如果函数接收了多个 object，则表示一种属性拷贝，将后面多个对象的属性全拷贝到第一个对象上，这其中，还包括深拷贝，即非引用拷贝，第一个参数如果是 true 则表示深拷贝。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22jQuery.extend(target);\/\/ jQuery 的扩展\njQuery.extend(target, obj1, obj2,..);\/\/浅拷贝 \njQuery.extend(true, target, obj1, obj2,..);\/\/深拷贝 \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ejQuery.extend(target);\x3cspan class=\x22hljs-comment\x22\x3e\/\/ jQuery 的扩展\x3c\/span\x3e\njQuery.extend(target, obj1, obj2,..);\x3cspan class=\x22hljs-comment\x22\x3e\/\/浅拷贝 \x3c\/span\x3e\njQuery.extend(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, target, obj1, obj2,..);\x3cspan class=\x22hljs-comment\x22\x3e\/\/深拷贝 \x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e以下是 jQuery 3 之后的 extend 函数源码，自己做了注释：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22jQuery.extend = jQuery.fn.extend = function () {\n  var options, name, src, copy, copyIsArray, clone, target = arguments[0] || {},\n    i = 1,\n    length = arguments.length,\n    deep = false;\n\n  \/\/ 判断是否为深拷贝\n  if (typeof target === \x26quot;boolean\x26quot;) {\n    deep = target;\n\n    \/\/ 参数后移\n    target = arguments[i] || {};\n    i\x2b\x2b;\n  }\n\n  \/\/ 处理 target 是字符串或奇怪的情况，isFunction(target) 可以判断 target 是否为函数\n  if (typeof target !== \x26quot;object\x26quot; \x26amp;\x26amp; !jQuery.isFunction(target)) {\n    target = {};\n  }\n\n  \/\/ 判断是否 jQuery 的扩展\n  if (i === length) {\n    target = this; \/\/ this 做一个标记，可以指向 jQuery，也可以指向 jQuery.fn\n    i--;\n  }\n\n  for (; i \x3c length; i\x2b\x2b) {\n\n    \/\/ null\/undefined 判断\n    if ((options = arguments[i]) != null) {\n\n      \/\/ 这里已经统一了，无论前面函数的参数怎样，现在的任务就是 target 是目标对象，options 是被拷贝对象\n      for (name in options) {\n        src = target[name];\n        copy = options[name];\n\n        \/\/ 防止死循环，跳过自身情况\n        if (target === copy) {\n          continue;\n        }\n\n        \/\/ 深拷贝，且被拷贝对象是 object 或 array\n        \/\/ 这是深拷贝的重点\n        if (deep \x26amp;\x26amp; copy \x26amp;\x26amp; (jQuery.isPlainObject(copy) || (copyIsArray = Array.isArray(copy)))) {\n          \/\/ 说明被拷贝对象是数组\n          if (copyIsArray) {\n            copyIsArray = false;\n            clone = src \x26amp;\x26amp; Array.isArray(src) ? src : [];\n          \/\/ 被拷贝对象是 object\n          } else {\n            clone = src \x26amp;\x26amp; jQuery.isPlainObject(src) ? src : {};\n          }\n\n          \/\/ 递归拷贝子属性\n          target[name] = jQuery.extend(deep, clone, copy);\n\n          \/\/ 常规变量，直接 =\n        } else if (copy !== undefined) {\n            target[name] = copy;\n        }\n      }\n    }\n  }\n\n  \/\/ Return the modified object\n  return target;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ejQuery.extend = jQuery.fn.extend = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e options, name, src, copy, copyIsArray, clone, target = \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e] || {},\n    i = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n    length = \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e.length,\n    deep = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 判断是否为深拷贝\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e target === \x3cspan class=\x22hljs-string\x22\x3e\x22boolean\x22\x3c\/span\x3e) {\n    deep = target;\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 参数后移\x3c\/span\x3e\n    target = \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e[i] || {};\n    i\x2b\x2b;\n  }\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 处理 target 是字符串或奇怪的情况，isFunction(target) 可以判断 target 是否为函数\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e target !== \x3cspan class=\x22hljs-string\x22\x3e\x22object\x22\x3c\/span\x3e \x26amp;\x26amp; !jQuery.isFunction(target)) {\n    target = {};\n  }\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 判断是否 jQuery 的扩展\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (i === length) {\n    target = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ this 做一个标记，可以指向 jQuery，也可以指向 jQuery.fn\x3c\/span\x3e\n    i--;\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (; i \x26lt; length; i\x2b\x2b) {\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ null\/undefined 判断\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ((options = \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e[i]) != \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e) {\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这里已经统一了，无论前面函数的参数怎样，现在的任务就是 target 是目标对象，options 是被拷贝对象\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (name \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e options) {\n        src = target[name];\n        copy = options[name];\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 防止死循环，跳过自身情况\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (target === copy) {\n          \x3cspan class=\x22hljs-keyword\x22\x3econtinue\x3c\/span\x3e;\n        }\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 深拷贝，且被拷贝对象是 object 或 array\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这是深拷贝的重点\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (deep \x26amp;\x26amp; copy \x26amp;\x26amp; (jQuery.isPlainObject(copy) || (copyIsArray = \x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.isArray(copy)))) {\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 说明被拷贝对象是数组\x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (copyIsArray) {\n            copyIsArray = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n            clone = src \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.isArray(src) ? src : [];\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 被拷贝对象是 object\x3c\/span\x3e\n          } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            clone = src \x26amp;\x26amp; jQuery.isPlainObject(src) ? src : {};\n          }\n\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 递归拷贝子属性\x3c\/span\x3e\n          target[name] = jQuery.extend(deep, clone, copy);\n\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 常规变量，直接 =\x3c\/span\x3e\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (copy !== \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e) {\n            target[name] = copy;\n        }\n      }\n    }\n  }\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Return the modified object\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e target;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eextend 函数符合 jQuery 中的参数处理规范，算是比较标准的一个。jQuery 对于参数的处理很有一套，总是喜欢错位来使得每一个位置上的变量和它们的名字一样，各司其职。比如 target 是目标对象，如果第一个参数是 boolean 型的，就对 deep 赋值 target，并把 target 向后移一位；如果参数对象只有一个，即对 jQuery 的扩展，就令 target 赋值 this，当前指针 i 减一。\x3c\/p\x3e\n\x3cp\x3e这种方法逻辑虽然很复杂，但是带来一个非常大的优势：后面的处理逻辑只需要一个就可以。target 就是我们要拷贝的目标，options 就是要拷贝的对象，逻辑又显得非常的清晰。\x3c\/p\x3e\n\x3cp\x3eextend 函数还需要主要一点，\x3ccode\x3ejQuery.extend = jQuery.fn.extend\x3c\/code\x3e，不仅 jQuery 对象又这个函数，连原型也有，那么如何区分对象是扩展到哪里了呢，又是如何实现的？\x3c\/p\x3e\n\x3cp\x3e其实这一切都要借助与 javascript 中 this 的动态性，\x3ccode\x3etarget = this\x3c\/code\x3e，代码就放在那里，谁去执行，this 就会指向谁，就会在它的属性上扩展。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e由 extend 衍生的函数\x3c\/h2\x3e\n\x3cp\x3e再看 extend 源码，里面有一些函数，只是看名字知道了它是干什么的，我专门挑出来，找到它们的源码。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3ejQuery.isFunction 源码\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22jQuery.isFunction = function (obj) {\n    return jQuery.type(obj) === \x26quot;function\x26quot;;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ejQuery.isFunction = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eobj\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e jQuery.type(obj) === \x3cspan class=\x22hljs-string\x22\x3e\x22function\x22\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这也太简单了些。这里又要引出 jQuery 里一个重要的函数 \x3ccode\x3ejQuery.type\x3c\/code\x3e，这个函数用于类型判断。\x3c\/p\x3e\n\x3cp\x3e首先，为什么传统的 typeof 不用？因为不好用（此处应有一个哭脸）：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Numbers\ntypeof 37 === \x27number\x27;\ntypeof 3.14 === \x27number\x27;\ntypeof(42) === \x27number\x27;\ntypeof Math.LN2 === \x27number\x27;\ntypeof Infinity === \x27number\x27;\ntypeof NaN === \x27number\x27; \/\/ Despite being \x26quot;Not-A-Number\x26quot;\ntypeof Number(1) === \x27number\x27; \/\/ but never use this form!\n\n\/\/ Strings\ntypeof \x26quot;\x26quot; === \x27string\x27;\ntypeof \x26quot;bla\x26quot; === \x27string\x27;\ntypeof (typeof 1) === \x27string\x27; \/\/ typeof always returns a string\ntypeof String(\x26quot;abc\x26quot;) === \x27string\x27; \/\/ but never use this form!\n\n\/\/ Booleans\ntypeof true === \x27boolean\x27;\ntypeof false === \x27boolean\x27;\ntypeof Boolean(true) === \x27boolean\x27; \/\/ but never use this form!\n\n\/\/ Symbols\ntypeof Symbol() === \x27symbol\x27\ntypeof Symbol(\x27foo\x27) === \x27symbol\x27\ntypeof Symbol.iterator === \x27symbol\x27\n\n\/\/ Undefined\ntypeof undefined === \x27undefined\x27;\ntypeof declaredButUndefinedVariable === \x27undefined\x27;\ntypeof undeclaredVariable === \x27undefined\x27; \n\n\/\/ Objects\ntypeof {a:1} === \x27object\x27;\n\n\/\/ use Array.isArray or Object.prototype.toString.call\n\/\/ to differentiate regular objects from arrays\ntypeof [1, 2, 4] === \x27object\x27;\n\ntypeof new Date() === \x27object\x27;\n\n\/\/ The following is confusing. Don\x27t use!\ntypeof new Boolean(true) === \x27object\x27; \ntypeof new Number(1) === \x27object\x27; \ntypeof new String(\x26quot;abc\x26quot;) === \x27object\x27;\n\n\/\/ Functions\ntypeof function(){} === \x27function\x27;\ntypeof class C {} === \x27function\x27;\ntypeof Math.sin === \x27function\x27;\n\n\/\/ This stands since the beginning of JavaScript\ntypeof null === \x27object\x27;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Numbers\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e37\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e3.14\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e42\x3c\/span\x3e) === \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.LN2 === \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3eInfinity\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3eNaN\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Despite being \x22Not-A-Number\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eNumber\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) === \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ but never use this form!\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Strings\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27string\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22bla\x22\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27string\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) === \x3cspan class=\x22hljs-string\x22\x3e\x27string\x27\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ typeof always returns a string\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22abc\x22\x3c\/span\x3e) === \x3cspan class=\x22hljs-string\x22\x3e\x27string\x27\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ but never use this form!\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Booleans\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27boolean\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27boolean\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eBoolean\x3c\/span\x3e(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e) === \x3cspan class=\x22hljs-string\x22\x3e\x27boolean\x27\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ but never use this form!\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Symbols\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eSymbol\x3c\/span\x3e() === \x3cspan class=\x22hljs-string\x22\x3e\x27symbol\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eSymbol\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27foo\x27\x3c\/span\x3e) === \x3cspan class=\x22hljs-string\x22\x3e\x27symbol\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eSymbol\x3c\/span\x3e.iterator === \x3cspan class=\x22hljs-string\x22\x3e\x27symbol\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Undefined\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27undefined\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e declaredButUndefinedVariable === \x3cspan class=\x22hljs-string\x22\x3e\x27undefined\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e undeclaredVariable === \x3cspan class=\x22hljs-string\x22\x3e\x27undefined\x27\x3c\/span\x3e; \n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Objects\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e {\x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e} === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ use Array.isArray or Object.prototype.toString.call\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ to differentiate regular objects from arrays\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e [\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e] === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e() === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ The following is confusing. Don\x27t use!\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eBoolean\x3c\/span\x3e(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e) === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e; \n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eNumber\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e; \n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22abc\x22\x3c\/span\x3e) === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Functions\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{} === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eC\x3c\/span\x3e \x3c\/span\x3e{} === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ This stands since the beginning of JavaScript\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看得出来，对于一些 new 对象，比如 \x3ccode\x3enew Number(1)\x3c\/code\x3e，也会返回 object。具体请参考\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Operators\/typeof\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etypeof MDN\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e网上有两种解决方法（有效性未经考证，请相信 jQuery 的方法），一种是用 \x3ccode\x3econstructor.name\x3c\/code\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Object\/constructor\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eObject.prototype.constructor MDN\x3c\/a\x3e，一种是用 \x3ccode\x3eObject.prototype.toString.call()\x3c\/code\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Object\/toString\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eObject.prototype.toString()\x3c\/a\x3e，最终 jQuery 选择了后者。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var n1 = 1;\nn1.constructor.name;\/\/\x26quot;Number\x26quot;\nvar n2 = new Number(1);\nn2.constructor.name;\/\/\x26quot;Number\x26quot;\n\nvar toString = Object.prototype.toString;\ntoString.call(n1);\/\/\x26quot;[object Number]\x26quot;\ntoString.call(n2);\/\/\x26quot;[object Number]\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e n1 = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\nn1.constructor.name;\x3cspan class=\x22hljs-comment\x22\x3e\/\/\x22Number\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e n2 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eNumber\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\nn2.constructor.name;\x3cspan class=\x22hljs-comment\x22\x3e\/\/\x22Number\x22\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e toString = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.prototype.toString;\ntoString.call(n1);\x3cspan class=\x22hljs-comment\x22\x3e\/\/\x22[object Number]\x22\x3c\/span\x3e\ntoString.call(n2);\x3cspan class=\x22hljs-comment\x22\x3e\/\/\x22[object Number]\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e以上属于科普，原理不多阐述，接下来继续看源码 \x3ccode\x3ejQuery.type\x3c\/code\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 这个对象是用来将 toString 函数返回的字符串转成\nvar class2type = {\n    \x26quot;[object Boolean]\x26quot;: \x26quot;boolean\x26quot;,\n    \x26quot;[object Number]\x26quot;: \x26quot;number\x26quot;,\n    \x26quot;[object String]\x26quot;: \x26quot;string\x26quot;,\n    \x26quot;[object Function]\x26quot;: \x26quot;function\x26quot;,\n    \x26quot;[object Array]\x26quot;: \x26quot;array\x26quot;,\n    \x26quot;[object Date]\x26quot;: \x26quot;date\x26quot;,\n    \x26quot;[object RegExp]\x26quot;: \x26quot;regexp\x26quot;,\n    \x26quot;[object Object]\x26quot;: \x26quot;object\x26quot;,\n    \x26quot;[object Error]\x26quot;: \x26quot;error\x26quot;,\n    \x26quot;[object Symbol]\x26quot;: \x26quot;symbol\x26quot;\n}\nvar toString = Object.prototype.toString;\n\njQuery.type = function (obj) {\n    if (obj == null) {\n        return obj \x2b \x26quot;\x26quot;;\n    }\n    return \n      typeof obj === \x26quot;object\x26quot; || typeof obj === \x26quot;function\x26quot; ? \n        class2type[toString.call(obj)] || \x26quot;object\x26quot; : \n        typeof obj;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这个对象是用来将 toString 函数返回的字符串转成\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e class2type = {\n    \x3cspan class=\x22hljs-string\x22\x3e\x22[object Boolean]\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22boolean\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22[object Number]\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22number\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22[object String]\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22string\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22[object Function]\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22function\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22[object Array]\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22array\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22[object Date]\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22date\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22[object RegExp]\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22regexp\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22[object Object]\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22object\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22[object Error]\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22error\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22[object Symbol]\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22symbol\x22\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e toString = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.prototype.toString;\n\njQuery.type = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eobj\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (obj == \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e obj \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \n      \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e obj === \x3cspan class=\x22hljs-string\x22\x3e\x22object\x22\x3c\/span\x3e || \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e obj === \x3cspan class=\x22hljs-string\x22\x3e\x22function\x22\x3c\/span\x3e ? \n        class2type[toString.call(obj)] || \x3cspan class=\x22hljs-string\x22\x3e\x22object\x22\x3c\/span\x3e : \n        \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e obj;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e因为 jQuery 用的是 toString 方法，所以需要有一个 class2type 的对象用来转换。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3ejQuery.isPlainObject\x3c\/h3\x3e\n\x3cp\x3e这个函数用来判断对象是否是一个纯粹的对象，：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var getProto = Object.getPrototypeOf;\/\/获取父对象\nvar hasOwn = class2type.hasOwnProperty;\nvar fnToString = hasOwn.toString;\nvar ObjectFunctionString = fnToString.call( Object );\n\njQuery.isPlainObject = function (obj) {\n    var proto, Ctor;\n\n    \/\/ 排除 underfined、null 和非 object 情况\n    if (!obj || toString.call(obj) !== \x26quot;[object Object]\x26quot;) {\n        return false;\n    }\n\n    proto = getProto(obj);\n\n    \/\/ Objects with no prototype (e.g., `Object.create( null )`) are plain\n    if (!proto) {\n        return true;\n    }\n\n    \/\/ Objects with prototype are plain iff they were constructed by a global Object function\n    Ctor = hasOwn.call(proto, \x26quot;constructor\x26quot;) \x26amp;\x26amp; proto.constructor;\n    return typeof Ctor === \x26quot;function\x26quot; \x26amp;\x26amp; fnToString.call(Ctor) === ObjectFunctionString;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e getProto = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.getPrototypeOf;\x3cspan class=\x22hljs-comment\x22\x3e\/\/获取父对象\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e hasOwn = class2type.hasOwnProperty;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e fnToString = hasOwn.toString;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ObjectFunctionString = fnToString.call( \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e );\n\njQuery.isPlainObject = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eobj\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e proto, Ctor;\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 排除 underfined、null 和非 object 情况\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!obj || toString.call(obj) !== \x3cspan class=\x22hljs-string\x22\x3e\x22[object Object]\x22\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n    }\n\n    proto = getProto(obj);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Objects with no prototype (e.g., `Object.create( null )`) are plain\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!proto) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n    }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Objects with prototype are plain iff they were constructed by a global Object function\x3c\/span\x3e\n    Ctor = hasOwn.call(proto, \x3cspan class=\x22hljs-string\x22\x3e\x22constructor\x22\x3c\/span\x3e) \x26amp;\x26amp; proto.constructor;\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e Ctor === \x3cspan class=\x22hljs-string\x22\x3e\x22function\x22\x3c\/span\x3e \x26amp;\x26amp; fnToString.call(Ctor) === ObjectFunctionString;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e看一下效果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22jQuery.isPlainObject({});\/\/ true\njQuery.isPlainObject({ a: 1 });\/\/ true\njQuery.isPlainObject(new Object());\/\/ true\n\njQuery.isPlainObject([]);\/\/ false\njQuery.isPlainObject(new String(\x27a\x27));\/\/ false\njQuery.isPlainObject(function(){});\/\/ false\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ejQuery.isPlainObject({});\x3cspan class=\x22hljs-comment\x22\x3e\/\/ true\x3c\/span\x3e\njQuery.isPlainObject({ \x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e });\x3cspan class=\x22hljs-comment\x22\x3e\/\/ true\x3c\/span\x3e\njQuery.isPlainObject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e());\x3cspan class=\x22hljs-comment\x22\x3e\/\/ true\x3c\/span\x3e\n\njQuery.isPlainObject([]);\x3cspan class=\x22hljs-comment\x22\x3e\/\/ false\x3c\/span\x3e\njQuery.isPlainObject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e));\x3cspan class=\x22hljs-comment\x22\x3e\/\/ false\x3c\/span\x3e\njQuery.isPlainObject(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{});\x3cspan class=\x22hljs-comment\x22\x3e\/\/ false\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e除了这几个函数之外，还有个 \x3ccode\x3eArray.isArray()\x3c\/code\x3e，这个真的不用介绍了吧。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e总结还是多说一点的好，现在已经基本理清 jQuery 内部的情况了？no，还差一点，看下面的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(function(window) {\n  \/\/ jQuery 变量，用闭包避免环境污染\n  var jQuery = (function() {\n    var jQuery = function(selector, context) {\n        return new jQuery.fn.init(selector, context, rootjQuery);\n    };\n\n    \/\/ 一些变量声明\n\n    jQuery.fn = jQuery.prototype = {\n        constructor: jQuery,\n        init: function(selector, context, rootjQuery) {\n          \/\/ 下章会重点讨论\n        }\n\n        \/\/ 原型方法\n    };\n\n    jQuery.fn.init.prototype = jQuery.fn;\n\n    jQuery.extend = jQuery.fn.extend = function() {};\/\/已介绍\n\n    jQuery.extend({\n        \/\/ 一堆静态属性和方法\n        \/\/ 用 extend 绑定，而不是直接在 jQuery 上写\n    });\n\n    return jQuery;\n  })();\n\n  \/\/ 工具方法 Utilities\n  \/\/ 回调函数列表 Callbacks Object\n  \/\/ 异步队列 Defferred Object\n  \/\/ 浏览器功能测试 Support\n  \/\/ 数据缓存 Data\n  \/\/ 队列 Queue\n  \/\/ 属性操作 Attributes\n  \/\/ 事件系统 Events\n  \/\/ 选择器 Sizzle\n  \/\/ DOM遍历 Traversing\n  \/\/ 样式操作 CSS（计算样式、内联样式）\n  \/\/ 异步请求 Ajax\n  \/\/ 动画 Effects\n  \/\/ 坐标 Offset、尺寸 Dimensions\n\n  window.jQuery = window.$ = jQuery;\n})(window);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ewindow\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ jQuery 变量，用闭包避免环境污染\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e jQuery = (\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e jQuery = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eselector, context\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e jQuery.fn.init(selector, context, rootjQuery);\n    };\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 一些变量声明\x3c\/span\x3e\n\n    jQuery.fn = jQuery.prototype = {\n        \x3cspan class=\x22hljs-attr\x22\x3econstructor\x3c\/span\x3e: jQuery,\n        \x3cspan class=\x22hljs-attr\x22\x3einit\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eselector, context, rootjQuery\x3c\/span\x3e) \x3c\/span\x3e{\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 下章会重点讨论\x3c\/span\x3e\n        }\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 原型方法\x3c\/span\x3e\n    };\n\n    jQuery.fn.init.prototype = jQuery.fn;\n\n    jQuery.extend = jQuery.fn.extend = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{};\x3cspan class=\x22hljs-comment\x22\x3e\/\/已介绍\x3c\/span\x3e\n\n    jQuery.extend({\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 一堆静态属性和方法\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 用 extend 绑定，而不是直接在 jQuery 上写\x3c\/span\x3e\n    });\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e jQuery;\n  })();\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 工具方法 Utilities\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 回调函数列表 Callbacks Object\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 异步队列 Defferred Object\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 浏览器功能测试 Support\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 数据缓存 Data\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 队列 Queue\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 属性操作 Attributes\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 事件系统 Events\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 选择器 Sizzle\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ DOM遍历 Traversing\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 样式操作 CSS（计算样式、内联样式）\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 异步请求 Ajax\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 动画 Effects\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 坐标 Offset、尺寸 Dimensions\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.jQuery = \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.$ = jQuery;\n})(\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看出 jQuery 很巧妙的整体布局思路，对于属性方法和原型方法等区分，防止变量污染等，都做的非常好。阅读框架源码只是开头，有趣的还在后面。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e参考\x3c\/h2\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/aaronjs\/p\/3278578.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejQuery 2.0.3 源码分析core - 整体架构\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/yiyang\/p\/4959373.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e《jQuery源码解析》读书笔记（第二章：构造jQuery对象）\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/www.365mini.com\/page\/jquery_isplainobject.htm\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejQuery.isPlainObject() 函数详解\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e本文在 github 上的\x3ca href=\x22https:\/\/github.com\/songjinzhong\/JQuerySource\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e源码地址\x3c\/a\x3e，欢迎来 star。\x3c\/p\x3e\n\x3cp\x3e欢迎来\x3ca href=\x22http:\/\/yuren.space\/blog\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e我的博客\x3c\/a\x3e交流。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>jQuery 源码系列（一）总体架构</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008365621">https://segmentfault.com/a/1190000008365621</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/hfszvrcjmqm/" target="_blank">https://alili.tech/archive/hfszvrcjmqm/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>