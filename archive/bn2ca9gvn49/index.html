<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="合理的使用纯函数式编程"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>合理的使用纯函数式编程 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/bn2ca9gvn49/",
				"appid": "1613049289050283", 
				"title": "合理的使用纯函数式编程 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-31T02:31:16"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/v9si6l7jimf/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/05pnuivelo33/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fbn2ca9gvn49%2f&text=%e5%90%88%e7%90%86%e7%9a%84%e4%bd%bf%e7%94%a8%e7%ba%af%e5%87%bd%e6%95%b0%e5%bc%8f%e7%bc%96%e7%a8%8b"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fbn2ca9gvn49%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fbn2ca9gvn49%2f&text=%e5%90%88%e7%90%86%e7%9a%84%e4%bd%bf%e7%94%a8%e7%ba%af%e5%87%bd%e6%95%b0%e5%bc%8f%e7%bc%96%e7%a8%8b"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fbn2ca9gvn49%2f&title=%e5%90%88%e7%90%86%e7%9a%84%e4%bd%bf%e7%94%a8%e7%ba%af%e5%87%bd%e6%95%b0%e5%bc%8f%e7%bc%96%e7%a8%8b"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fbn2ca9gvn49%2f&is_video=false&description=%e5%90%88%e7%90%86%e7%9a%84%e4%bd%bf%e7%94%a8%e7%ba%af%e5%87%bd%e6%95%b0%e5%bc%8f%e7%bc%96%e7%a8%8b"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%90%88%e7%90%86%e7%9a%84%e4%bd%bf%e7%94%a8%e7%ba%af%e5%87%bd%e6%95%b0%e5%bc%8f%e7%bc%96%e7%a8%8b&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fbn2ca9gvn49%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fbn2ca9gvn49%2f&title=%e5%90%88%e7%90%86%e7%9a%84%e4%bd%bf%e7%94%a8%e7%ba%af%e5%87%bd%e6%95%b0%e5%bc%8f%e7%bc%96%e7%a8%8b"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbn2ca9gvn49%2f&title=%e5%90%88%e7%90%86%e7%9a%84%e4%bd%bf%e7%94%a8%e7%ba%af%e5%87%bd%e6%95%b0%e5%bc%8f%e7%bc%96%e7%a8%8b"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbn2ca9gvn49%2f&title=%e5%90%88%e7%90%86%e7%9a%84%e4%bd%bf%e7%94%a8%e7%ba%af%e5%87%bd%e6%95%b0%e5%bc%8f%e7%bc%96%e7%a8%8b"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbn2ca9gvn49%2f&title=%e5%90%88%e7%90%86%e7%9a%84%e4%bd%bf%e7%94%a8%e7%ba%af%e5%87%bd%e6%95%b0%e5%bc%8f%e7%bc%96%e7%a8%8b"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">合理的使用纯函数式编程</h1><div class="meta"><div class="postdate"><time datetime="2019-01-31" itemprop="datePublished">2019-01-31</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e本文是篇译文，原文链接\x3ca href=\x22https:\/\/www.sitepoint.com\/an-introduction-to-reasonably-pure-functional-programming\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAn Introduction to Reasonably Pure Functional Programming\x3c\/a\x3e,不当之处还请指正。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e一个好的程序员应该有能力掌控你写的代码，能够以最简单的方法使你的代码正确并且可读。作为一名优秀的程序员，你会编写尽量短小的函数，使代码更好的被复用；你会编写测试代码，使自己有足够的信心相信代码会按原本的意图正确运行。没有人喜欢解bug，所以一名优秀的程序员也要会避免一些错误，这些要靠经验获得，也可以遵循一些最佳实践，比如Douglas Crockford 最著名的\x3ca href=\x22https:\/\/vimeo.com\/8691412\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScript:The good parts\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e函数式编程能够降低程序的复杂程度：函数看起来就像是一个数学公式。学习函数编程能够帮助你编写简单并且更少bug的代码。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3e纯函数\x3c\/h1\x3e\n\x3cblockquote\x3e\x3cp\x3e纯函数可以理解为一种 相同的输入必定有相同的输出的函数，没有任何可以观察到副作用\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/pure\nfunction add(a \x2b b) {\n  return a \x2b b;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/pure\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea \x2b b\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e a \x2b b;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面是一个纯函数，它不依赖也不改变任何函数以外的变量状态，对于相同的输入总能返回相同的输出。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/impure\nvar minimum = 21;\nvar checkAge = function(age) {\n  return age \x3e= minimum; \/\/ 如果minimum改变，函数结果也会改变\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/impure\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e minimum = \x3cspan class=\x22hljs-number\x22\x3e21\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e checkAge = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eage\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e age \x26gt;= minimum; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果minimum改变，函数结果也会改变\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个函数不是纯函数，因为它依赖外部可变的状态\x3c\/p\x3e\n\x3cp\x3e如果我们将变量移到函数内部，那么它就变成了纯函数，这样我们就能够保证函数每次都能正确的比较年龄。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var checkAge = function(age) {\n  var minimum = 21;\n  return age \x3e= minimum;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e checkAge = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eage\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e minimum = \x3cspan class=\x22hljs-number\x22\x3e21\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e age \x26gt;= minimum;\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e纯函数没有副作用，一些你要记住的是，它不会：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e访问函数以外的系统状态\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e修改以参数形式传递过来的对象\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e发起http请求\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e保留用户输入\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e查询DOM\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e控制增变（controlled mutation）\x3c\/h2\x3e\n\x3cp\x3e你需要留意一些会改变数组和对象的\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Array\/prototype#Mutator_methods\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e增变方法\x3c\/a\x3e，举例来说你要知道splice和slice之间的差异。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/impure, splice 改变了原数组\nvar firstThree = function(arr) {\n  return arr.splice(0,3);\n}\n\n\/\/pure, slice 返回了一个新数组\nvar firstThree = function(arr) {\n  return arr.slice(0,3);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/impure, splice 改变了原数组\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e firstThree = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3earr\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e arr.splice(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/pure, slice 返回了一个新数组\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e firstThree = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3earr\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e arr.slice(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果我们避免使用传入函数的对象的增变方法，我们的程序将更容易理解，我们也有理由期望我们的函数不会改变任何函数之外的东西。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let items = [\x27a\x27, \x27b\x27, \x27c\x27];\nlet newItems = pure(items);\n\/\/对于纯函数items始终应该是[\x27a\x27, \x27b\x27, \x27c\x27]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e items = [\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27b\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27c\x27\x3c\/span\x3e];\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e newItems = pure(items);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/对于纯函数items始终应该是[\x27a\x27, \x27b\x27, \x27c\x27]\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3e纯函数的优点\x3c\/h1\x3e\n\x3cp\x3e相比于不纯的函数，纯函数有如下优点：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e更加容易被测试，因为它们唯一的职责就是根据输入计算输出\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e结果可以被缓存，因为相同的输入总会获得相同的输出\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e自我文档化，因为函数的依赖关系很清晰\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e更容易被调用，因为你不用担心函数会有什么副作用\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e因为纯函数的结果可以被缓存，我们可以\x3ca href=\x22http:\/\/underscorejs.org\/docs\/underscore.html#section-79\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e记住\x3c\/a\x3e他们,这样以来复杂昂贵的操作只需要在被调用时执行一次。例如，缓存一个大的查询索引的结果可以极大的改善程序的性能。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3e不合理的纯函数编程\x3c\/h1\x3e\n\x3cp\x3e使用纯函数能够极大的降低程序的复杂度。但是，如果我们使用过多的函数式编程的抽象概念，我们的函数式编程也会非常难以理解。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import _ from \x27ramda\x27;\nimport $ from \x27jquery\x27;\n\nvar Impure = {\n  getJSON: _.curry(function(callback, url) {\n    $.getJSON(url, callback);\n  }),\n\n  setHtml: _.curry(function(sel, html) {\n    $(sel).html(html);\n  })\n};\n\nvar img = function (url) {\n  return $(\x27\x3cimg \/\x3e\x27, { src: url });\n};\n\nvar url = function (t) {\n  return \x27http:\/\/api.flickr.com\/services\/feeds\/photos_public.gne?tags=\x27 \x2b\n    t \x2b \x27\x26amp;format=json\x26amp;jsoncallback=?\x27;\n};\n\nvar mediaUrl = _.compose(_.prop(\x27m\x27), _.prop(\x27media\x27));\nvar mediaToImg = _.compose(img, mediaUrl);\nvar images = _.compose(_.map(mediaToImg), _.prop(\x27items\x27));\nvar renderImages = _.compose(Impure.setHtml(\x26quot;body\x26quot;), images);\nvar app = _.compose(Impure.getJSON(renderImages), url);\napp(\x26quot;cats\x26quot;);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e _ \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27ramda\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e $ \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27jquery\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e Impure = {\n  \x3cspan class=\x22hljs-attr\x22\x3egetJSON\x3c\/span\x3e: _.curry(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ecallback, url\x3c\/span\x3e) \x3c\/span\x3e{\n    $.getJSON(url, callback);\n  }),\n\n  \x3cspan class=\x22hljs-attr\x22\x3esetHtml\x3c\/span\x3e: _.curry(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3esel, html\x3c\/span\x3e) \x3c\/span\x3e{\n    $(sel).html(html);\n  })\n};\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e img = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;img \/\x26gt;\x27\x3c\/span\x3e, { \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e: url });\n};\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e url = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3et\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/api.flickr.com\/services\/feeds\/photos_public.gne?tags=\x27\x3c\/span\x3e \x2b\n    t \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x26amp;format=json\x26amp;jsoncallback=?\x27\x3c\/span\x3e;\n};\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e mediaUrl = _.compose(_.prop(\x3cspan class=\x22hljs-string\x22\x3e\x27m\x27\x3c\/span\x3e), _.prop(\x3cspan class=\x22hljs-string\x22\x3e\x27media\x27\x3c\/span\x3e));\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e mediaToImg = _.compose(img, mediaUrl);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e images = _.compose(_.map(mediaToImg), _.prop(\x3cspan class=\x22hljs-string\x22\x3e\x27items\x27\x3c\/span\x3e));\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e renderImages = _.compose(Impure.setHtml(\x3cspan class=\x22hljs-string\x22\x3e\x22body\x22\x3c\/span\x3e), images);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = _.compose(Impure.getJSON(renderImages), url);\napp(\x3cspan class=\x22hljs-string\x22\x3e\x22cats\x22\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e花一分钟理解上面的代码。\x3c\/p\x3e\n\x3cp\x3e除非你接触过函数式编程的这些概念（柯里化，组合和prop），否则很难理解上述代码。相比于纯函数式的方法，下面的代码则更加容易理解和修改，它更加清晰的描述程序并且更少的代码。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eapp函数的参数是一个标签字符串\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e从\x3ca href=\x22https:\/\/www.flickr.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFlickr\x3c\/a\x3e获取JSON数据\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e从返回的数据里抽出urls\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e创建\x26lt;img\x26gt;节点数组\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e将他们插入文档\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var app = (tags) =\x3e {\n  let url = `http:\/\/api.flickr.com\/services\/feeds\/photos_public.gne?tags=${tags}\x26amp;format=json\x26amp;jsoncallback=?`;\n  $.getJSON(url, (data) =\x3e {\n    let urls = data.items.map((item) =\x3e item.media.m)\n    let images = urls.map(url) =\x3e $(\x27\x3cimg \/\x3e\x27, {src:url}) );\n    \n    $(document.body).html(images);\n  })\n}\napp(\x26quot;cats\x26quot;);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3etags\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e url = \x3cspan class=\x22hljs-string\x22\x3e`http:\/\/api.flickr.com\/services\/feeds\/photos_public.gne?tags=\x3cspan class=\x22hljs-subst\x22\x3e${tags}\x3c\/span\x3e\x26amp;format=json\x26amp;jsoncallback=?`\x3c\/span\x3e;\n  $.getJSON(url, (data) =\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e urls = data.items.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e item.media.m)\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e images = urls.map(url) =\x26gt; $(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;img \/\x26gt;\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e:url}) );\n    \n    $(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body).html(images);\n  })\n}\napp(\x3cspan class=\x22hljs-string\x22\x3e\x22cats\x22\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e或者可以使用\x3cstrong\x3efetch\x3c\/strong\x3e和\x3cstrong\x3ePromise\x3c\/strong\x3e来更好的进行异步操作。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let flickr = (tags)=\x3e {\n  let url = `http:\/\/api.flickr.com\/services\/feeds\/photos_public.gne?tags=${tags}\x26amp;format=json\x26amp;jsoncallback=?`\n  \n  return fetch(url)\n    .then((resp)=\x3e resp.json())\n    .then((data)=\x3e {\n      let urls = data.items.map((item)=\x3e item.media.m )\n      let images = urls.map((url)=\x3e $(\x27\x3cimg \/\x3e\x27, { src: url }) )\n\n      return images\n  })\n}\nflickr(\x26quot;cats\x26quot;).then((images)=\x3e {\n  $(document.body).html(images)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e flickr = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3etags\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e url = \x3cspan class=\x22hljs-string\x22\x3e`http:\/\/api.flickr.com\/services\/feeds\/photos_public.gne?tags=\x3cspan class=\x22hljs-subst\x22\x3e${tags}\x3c\/span\x3e\x26amp;format=json\x26amp;jsoncallback=?`\x3c\/span\x3e\n  \n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fetch(url)\n    .then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresp\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e resp.json())\n    .then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e urls = data.items.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e item.media.m )\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e images = urls.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e $(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;img \/\x26gt;\x27\x3c\/span\x3e, { \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e: url }) )\n\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e images\n  })\n}\nflickr(\x3cspan class=\x22hljs-string\x22\x3e\x22cats\x22\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eimages\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e {\n  $(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body).html(images)\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eAjax请求和DOM操作都不是纯的，但是我们可以将余下的操作组成纯函数，将返回的JSON数据转换成图片节点数组。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let responseToImages = (resp) =\x3e {\n  let urls = resp.items.map((item) =\x3e item.media.m)\n  let images = urls.map((url) =\x3e $(\x27\x3cimg \/\x3e\x27, {src:url}))\n  \n  return images\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e responseToImages = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresp\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e urls = resp.items.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e item.media.m)\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e images = urls.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e $(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;img \/\x26gt;\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e:url}))\n  \n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e images\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们的函数做了2件事情：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e将返回的数据转换成urls\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e将urls转换成图片节点\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e函数式的方法是将上述2个任务拆开，然后使用\x3cstrong\x3ecompose\x3c\/strong\x3e将一个函数的结果作为参数传给另一个参数。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let urls = (data) =\x3e {\n  return data.items.map((item) =\x3e item.media.m)\n}\nlet images = (urls) =\x3e {\n  return urls.map((url) =\x3e $(\x27\x3cimg \/\x3e\x27, {src: url}))\n}\nlet responseToImages = _.compose(images, urls)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e urls = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e data.items.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e item.media.m)\n}\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e images = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eurls\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e urls.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e $(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;img \/\x26gt;\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e: url}))\n}\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e responseToImages = _.compose(images, urls)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3ecompose 返回一系列函数的组合，每个函数都会将后一个函数的结果作为自己的入参\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e这里compose做的事情，就是将urls的结果传入images函数\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let responseToImages = (data) =\x3e {\n  return images(urls(data))\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e responseToImages = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e images(urls(data))\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过将代码变成纯函数，让我们在以后有机会复用他们，他们更加容易被测试和自文档化。不好的是当我们过度的使用这些函数抽象（像第一个例子那样）， 就会使事情变得复杂，这不是我们想要的。当我们重构代码的时候最重要的是要问一下自己：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e这是否让代码更加容易阅读和理解？\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader4\x22\x3e基本功能函数\x3c\/h1\x3e\n\x3cp\x3e我并不是要诋毁函数式编程。每个程序员都应该齐心协力去学习基础函数，这些函数让你在编程过程中使用一些抽象出的一般模式，写出更加简洁明了的代码，或者像Marijn Haverbeke说的\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e一个程序员能够用常规的基础函数武装自己，更重要的是知道如何使用它们，要比那些苦思冥想的人高效的多。--\x3ca href=\x22http:\/\/eloquentjavascript.net\/1st_edition\/chapter6.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e Eloquent JavaScript, Marijn Haverbeke\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e这里列出了一些JavaScript开发者应该掌握的基础函数\x3cbr\x3e\x3cstrong\x3eArrays\x3c\/strong\x3e\x3cbr\x3e-\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Array\/forEach\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eforEach\x3c\/a\x3e\x3cbr\x3e-\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Array\/map\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emap\x3c\/a\x3e\x3cbr\x3e-\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Array\/filter\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3efilter\x3c\/a\x3e\x3cbr\x3e-\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Array\/Reduce\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereduce\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eFunctions\x3c\/strong\x3e\x3cbr\x3e-\x3ca href=\x22http:\/\/underscorejs.org\/docs\/underscore.html#section-83\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3edebounce\x3c\/a\x3e\x3cbr\x3e-\x3ca href=\x22http:\/\/underscorejs.org\/docs\/underscore.html#section-86\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ecompose\x3c\/a\x3e\x3cbr\x3e-\x3ca href=\x22http:\/\/underscorejs.org\/docs\/underscore.html#section-77\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3epartial\x3c\/a\x3e\x3cbr\x3e-\x3ca href=\x22https:\/\/lodash.com\/docs\/4.16.6#curry\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ecurry\x3c\/a\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3eLess is More\x3c\/h1\x3e\n\x3cp\x3e让我们来通过实践看一下函数式编程能如何改善下面的代码\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let items = [\x27a\x27, \x27b\x27, \x27c\x27];\nlet upperCaseItems = () =\x3e {\n  let arr = [];\n  for (let i=0, ii= items.length; i\x3cii; i\x2b\x2b) {\n    let item = items[i];\n    arr.push(item.toUpperCase());\n  }\n  items = arr;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e items = [\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27b\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27c\x27\x3c\/span\x3e];\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e upperCaseItems = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e arr = [];\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, ii= items.length; i\x26lt;ii; i\x2b\x2b) {\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e item = items[i];\n    arr.push(item.toUpperCase());\n  }\n  items = arr;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e共享状态来简化函数\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e这看起来很明显且微不足道，但是我还是让函数访问和修改了外部的状态，这让函数难以测试且容易出错。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/pure\nlet upperCaseItems = (items) =\x3e {\n  let arr = [];\n  for (let i =0, ii= items.length; i\x3c ii; i\x2b\x2b) {\n    let item = items[i];\n    arr.push(item.toUpperCase());\n  }\n  return arr;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/pure\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e upperCaseItems = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitems\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e arr = [];\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i =\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, ii= items.length; i\x26lt; ii; i\x2b\x2b) {\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e item = items[i];\n    arr.push(item.toUpperCase());\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e arr;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e使用更加可读的语言抽象forEach来迭代\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let upperCaseItems = (items) =\x3e {\n  let arr = [];\n  items.forEach((item) =\x3e {\n    arr.push(item.toUpperCase());\n  })\n  return arr;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e upperCaseItems = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitems\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e arr = [];\n  items.forEach(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    arr.push(item.toUpperCase());\n  })\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e arr;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e使用map进一步简化代码\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let upperCaseItems = (items) =\x3e {\n  return items.map((item) =\x3e item.toUpperCase())\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e upperCaseItems = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitems\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e items.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e item.toUpperCase())\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e进一步简化代码\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let upperCase = (item) =\x3e item.toUpperCase()\nlet upperCaseItems = (item) =\x3e items.map(upperCase)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e upperCase = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e item.toUpperCase()\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e upperCaseItems = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e items.map(upperCase)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e删除代码直到它不能工作\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e我们不需要为这种简单的任务编写函数，语言本身就提供了足够的抽象来完成功能\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let items = [\x27a\x27, \x27b\x27, \x27c\x27]\nlet upperCaseItems = item.map((item) =\x3e item.toUpperCase())\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e items = [\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27b\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27c\x27\x3c\/span\x3e]\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e upperCaseItems = item.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e item.toUpperCase())\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader6\x22\x3e测试\x3c\/h1\x3e\n\x3cp\x3e纯函数的一个关键优点是易于测试，所以在这一节我会为我们之前的Flicker模块编写测试。\x3c\/p\x3e\n\x3cp\x3e我们会使用\x3ca href=\x22https:\/\/mochajs.org\/#getting-started\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMocha\x3c\/a\x3e来运行测试，使用\x3ca href=\x22http:\/\/babeljs.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eBabel\x3c\/a\x3e来编译ES6代码。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22mkdir test-harness\ncd test-harness\nnpm init -y\nnpm install mocha babel-register babel-preset-es2015 --save-dev\necho \x27{ \x26quot;presets\x26quot;: [\x26quot;es2015\x26quot;] }\x27 \x3e .babelrc\nmkdir test\ntouch test\/example.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3emkdir test-harness\ncd test-harness\nnpm init -y\nnpm install mocha babel-register babel-preset-es2015 --save-dev\necho \x3cspan class=\x22hljs-string\x22\x3e\x27{ \x22presets\x22: [\x22es2015\x22] }\x27\x3c\/span\x3e \x26gt; .babelrc\nmkdir test\ntouch test\/example.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eMocha提供了一些好用的函数如\x3cstrong\x3edescribe\x3c\/strong\x3e和\x3cstrong\x3eit\x3c\/strong\x3e来拆分测试和钩子(例如before和after这种用来组装和拆分任务的钩子)。\x3ca href=\x22https:\/\/nodejs.org\/api\/assert.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eassert\x3c\/a\x3e是用来进行相等测试的断言库，\x3cstrong\x3eassert\x3c\/strong\x3e和\x3cstrong\x3eassert.deepEqual\x3c\/strong\x3e是很有用且值得注意的函数。\x3c\/p\x3e\n\x3cp\x3e让我们来编写第一个测试\x3cstrong\x3etest\/example.js\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import assert from \x27assert\x27;\n\ndescribe(\x27Math\x27, () =\x3e {\n  describe(\x27.floor\x27, () =\x3e {\n    it(\x27rounds down to the nearest whole number\x27, () =\x3e {\n      let value = Math.floor(4.24)\n      assert(value === 4)\n    })\n  })\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e assert \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27assert\x27\x3c\/span\x3e;\n\ndescribe(\x3cspan class=\x22hljs-string\x22\x3e\x27Math\x27\x3c\/span\x3e, () =\x26gt; {\n  describe(\x3cspan class=\x22hljs-string\x22\x3e\x27.floor\x27\x3c\/span\x3e, () =\x26gt; {\n    it(\x3cspan class=\x22hljs-string\x22\x3e\x27rounds down to the nearest whole number\x27\x3c\/span\x3e, () =\x26gt; {\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e value = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(\x3cspan class=\x22hljs-number\x22\x3e4.24\x3c\/span\x3e)\n      assert(value === \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e)\n    })\n  })\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e打开package.json文件，将\x22test\x22脚本修改如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22mocha --compilers js:babel-register --recursive\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs brainfuck\x22\x3e\x3ccode class=\x22shell\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3emocha\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecompilers\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3ejs:babel\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eregister\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3erecursive\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后你就可以在命令行运行npm test\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Math\n  .floor\n    ✓ rounds down to the nearest whole number\n1 passing (32ms)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livecodeserver\x22\x3e\x3ccode\x3eMath\n  .floor\n    ✓ rounds down \x3cspan class=\x22hljs-built_in\x22\x3eto\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethe\x3c\/span\x3e nearest \x3cspan class=\x22hljs-keyword\x22\x3ewhole\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3enumber\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e passing (\x3cspan class=\x22hljs-number\x22\x3e32\x3c\/span\x3ems)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3eNote:\x3c\/strong\x3e如果你想让mocha监视改变，并且自动运行测试，可以在上述命令后面加上-w选项。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22mocha --compilers js:babel-register --recursive -w\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs brainfuck\x22\x3e\x3ccode class=\x22shell\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3emocha\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ecompilers\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3ejs:babel\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eregister\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3erecursive\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ew\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e测试我们的Flicker模块\x3c\/h2\x3e\n\x3cp\x3e我们的模块文件是lib\/flickr.js\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import $ from \x27jquery\x27;\nimport { compose } from \x27underscore\x27;\n\nlet urls = (data) =\x3e {\n  return data.items.map((item) =\x3e item.media.m)\n}\n\nlet images = (urls) =\x3e {\n  return urls.map((url) =\x3e $(\x27\x3cimg \/\x3e\x27, {src: url})[0] )\n}\n\nlet responseToImages = compose(images, urls)\n\nlet flickr = (tags) =\x3e {\n  let url = `http:\/\/api.flickr.com\/services\/feeds\/photos_public.gne?tags=${tags}\x26amp;format=json\x26amp;jsoncallback=?`\n  \n  return fetch(url)\n    .then((response) =\x3e reponse.json())\n    .then(responseToImages)\n}\n\nexport default {\n  _responseToImages: responseToImages,\n  flickr: flickr\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e $ \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27jquery\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { compose } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27underscore\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e urls = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e data.items.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e item.media.m)\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e images = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eurls\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e urls.map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e $(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;img \/\x26gt;\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e: url})[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e] )\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e responseToImages = compose(images, urls)\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e flickr = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3etags\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e url = \x3cspan class=\x22hljs-string\x22\x3e`http:\/\/api.flickr.com\/services\/feeds\/photos_public.gne?tags=\x3cspan class=\x22hljs-subst\x22\x3e${tags}\x3c\/span\x3e\x26amp;format=json\x26amp;jsoncallback=?`\x3c\/span\x3e\n  \n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fetch(url)\n    .then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresponse\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e reponse.json())\n    .then(responseToImages)\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attr\x22\x3e_responseToImages\x3c\/span\x3e: responseToImages,\n  \x3cspan class=\x22hljs-attr\x22\x3eflickr\x3c\/span\x3e: flickr\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们的模块暴露了2个方法：一个公有\x3cstrong\x3eflickr\x3c\/strong\x3e和一个私有函数\x3cstrong\x3e_responseToImages\x3c\/strong\x3e,这样就可以独立的测试他们。\x3c\/p\x3e\n\x3cp\x3e我们使用了一组依赖：\x3cstrong\x3ejquery\x3c\/strong\x3e,\x3cstrong\x3eunderscore\x3c\/strong\x3e和polyfill函数\x3cstrong\x3efetch\x3c\/strong\x3e和\x3cstrong\x3ePromise\x3c\/strong\x3e。为了测试他们，我们使用\x3cstrong\x3ejsdom\x3c\/strong\x3e来模拟DOM对象\x3cstrong\x3ewindow\x3c\/strong\x3e和\x3cstrong\x3edocument\x3c\/strong\x3e，使用\x3cstrong\x3esinon\x3c\/strong\x3e包来测试fetch api。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install jquery underscore whatwg-fetch es6-promise jsdom sinon --save-dev\ntouch test\/_setup.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sql\x22\x3e\x3ccode class=\x22shell\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e jquery underscore whatwg-\x3cspan class=\x22hljs-keyword\x22\x3efetch\x3c\/span\x3e es6-promise jsdom sinon \x3cspan class=\x22hljs-comment\x22\x3e--save-dev\x3c\/span\x3e\ntouch \x3cspan class=\x22hljs-keyword\x22\x3etest\x3c\/span\x3e\/_setup.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e打开test\/_setup.js，使用全局对象来配置jsdom\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22global.document = require(\x27jsdom\x27).jsdom(\x27\x3chtml\x3e\x3c\/html\x3e\x27);\nglobal.window = document.defaultView;\nglobal.$ = require(\x27jquery\x27)(window);\nglobal.fetch = require(\x27whatwg-fetch\x27).fetch;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eglobal.document = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27jsdom\x27\x3c\/span\x3e).jsdom(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;html\x26gt;\x26lt;\/html\x26gt;\x27\x3c\/span\x3e);\nglobal.window = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.defaultView;\nglobal.$ = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27jquery\x27\x3c\/span\x3e)(\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e);\nglobal.fetch = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27whatwg-fetch\x27\x3c\/span\x3e).fetch;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们的测试代码在test\/flickr.js，我们将为函数的输出设置断言。我们\x22stub\x22或者覆盖全局的fetch方法，来阻断和模拟HTTP请求，这样我们就可以在不直接访问Flickr api的情况下运行我们的测试。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import assert from \x27assert\x27;\nimport Flickr from \x27..\/lib\/flickr\x27;\nimport sinon from \x27sinon\x27;\nimport { Promise } from \x27es6-promise\x27;\nimport { Response } from \x27whatwg-fetch\x27;\n\nlet sampleResponse = {\n  items: [{\n    media: { m: \x27lolcat.jpg\x27 }\n  }, {\n    media: {m: \x27dancing_pug.gif\x27}\n  }]\n}\n\n\/\/实际项目中我们会将这个test helper移到一个模块里\nlet jsonResponse = (obj) =\x3e {\n  let json = JSON.stringify(obj);\n  var response = new Response(json, {\n    status: 200,\n    headers: {\x27Content-type\x27: \x27application\/json\x27}\n  });\n  return Promise.resolve(response);\n}\n\n\ndescribe(\x27Flickr\x27, () =\x3e {\n  describe(\x27._responseToImages\x27, () =\x3e {\n    it(\x26quot;maps response JSON to a NodeList of \x3cimg\x3e\x26quot;, () =\x3e {\n      let images = Flickr._responseToImages(sampleResponse);\n      \n      assert(images.length === 2);\n      assert(images[0].nodeName === \x27IMG\x27);\n      assert(images[0].src === \x27lolcat.jpg\x27);\n    })\n  })\n  \n  describe(\x27.flickr\x27, () =\x3e {\n    \/\/截断fetch 请求，返回一个Promise对象\n    before(() =\x3e {\n      sinon.stub(global, \x27fetch\x27, (url) =\x3e {\n        return jsonResponse(sampleResponse)\n      })\n    })\n    \n    after(() =\x3e {\n      global.fetch.restore();\n    })\n    \n    it(\x26quot;returns a Promise that resolve with a NodeList of \x3cimg\x3e\x26quot;, (done) =\x3e {\n      Flickr.flickr(\x27cats\x27).then((images) =\x3e {\n        assert(images.length === 2);\n        assert(images[1].nodeName === \x27IMG\x27);\n        assert(images[1].src === \x27dancing_pug.gif\x27);\n        done();\n      })\n    })\n  })  \n  \n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e assert \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27assert\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Flickr \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/lib\/flickr\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e sinon \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27sinon\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27es6-promise\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { Response } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27whatwg-fetch\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e sampleResponse = {\n  \x3cspan class=\x22hljs-attr\x22\x3eitems\x3c\/span\x3e: [{\n    \x3cspan class=\x22hljs-attr\x22\x3emedia\x3c\/span\x3e: { \x3cspan class=\x22hljs-attr\x22\x3em\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27lolcat.jpg\x27\x3c\/span\x3e }\n  }, {\n    \x3cspan class=\x22hljs-attr\x22\x3emedia\x3c\/span\x3e: {\x3cspan class=\x22hljs-attr\x22\x3em\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27dancing_pug.gif\x27\x3c\/span\x3e}\n  }]\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/实际项目中我们会将这个test helper移到一个模块里\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e jsonResponse = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e json = \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(obj);\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e response = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Response(json, {\n    \x3cspan class=\x22hljs-attr\x22\x3estatus\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eheaders\x3c\/span\x3e: {\x3cspan class=\x22hljs-string\x22\x3e\x27Content-type\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27application\/json\x27\x3c\/span\x3e}\n  });\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(response);\n}\n\n\ndescribe(\x3cspan class=\x22hljs-string\x22\x3e\x27Flickr\x27\x3c\/span\x3e, () =\x26gt; {\n  describe(\x3cspan class=\x22hljs-string\x22\x3e\x27._responseToImages\x27\x3c\/span\x3e, () =\x26gt; {\n    it(\x3cspan class=\x22hljs-string\x22\x3e\x22maps response JSON to a NodeList of \x26lt;img\x26gt;\x22\x3c\/span\x3e, () =\x26gt; {\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e images = Flickr._responseToImages(sampleResponse);\n      \n      assert(images.length === \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n      assert(images[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].nodeName === \x3cspan class=\x22hljs-string\x22\x3e\x27IMG\x27\x3c\/span\x3e);\n      assert(images[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].src === \x3cspan class=\x22hljs-string\x22\x3e\x27lolcat.jpg\x27\x3c\/span\x3e);\n    })\n  })\n  \n  describe(\x3cspan class=\x22hljs-string\x22\x3e\x27.flickr\x27\x3c\/span\x3e, () =\x26gt; {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/截断fetch 请求，返回一个Promise对象\x3c\/span\x3e\n    before(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      sinon.stub(global, \x3cspan class=\x22hljs-string\x22\x3e\x27fetch\x27\x3c\/span\x3e, (url) =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e jsonResponse(sampleResponse)\n      })\n    })\n    \n    after(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      global.fetch.restore();\n    })\n    \n    it(\x3cspan class=\x22hljs-string\x22\x3e\x22returns a Promise that resolve with a NodeList of \x26lt;img\x26gt;\x22\x3c\/span\x3e, (done) =\x26gt; {\n      Flickr.flickr(\x3cspan class=\x22hljs-string\x22\x3e\x27cats\x27\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eimages\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        assert(images.length === \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n        assert(images[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e].nodeName === \x3cspan class=\x22hljs-string\x22\x3e\x27IMG\x27\x3c\/span\x3e);\n        assert(images[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e].src === \x3cspan class=\x22hljs-string\x22\x3e\x27dancing_pug.gif\x27\x3c\/span\x3e);\n        done();\n      })\n    })\n  })  \n  \n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行npm test，会得到如下结果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Math\n  .floor\n    ✓ rounds down to the nearest whole number\n\nFlickr\n  ._responseToImages\n    ✓ maps response JSON to a NodeList of \x3cimg\x3e\n  .flickr\n    ✓ returns a Promise that resolves with a NodeList of \x3cimg\x3e\n\n3 passing (67ms)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livecodeserver\x22\x3e\x3ccode\x3eMath\n  .floor\n    ✓ rounds down \x3cspan class=\x22hljs-built_in\x22\x3eto\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethe\x3c\/span\x3e nearest \x3cspan class=\x22hljs-keyword\x22\x3ewhole\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3enumber\x3c\/span\x3e\n\nFlickr\n  .\x3cspan class=\x22hljs-title\x22\x3e_response\x3c\/span\x3eToImages\n    ✓ maps response JSON \x3cspan class=\x22hljs-built_in\x22\x3eto\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ea\x3c\/span\x3e NodeList \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e \x26lt;img\x26gt;\n  .flickr\n    ✓ returns \x3cspan class=\x22hljs-keyword\x22\x3ea\x3c\/span\x3e Promise that resolves \x3cspan class=\x22hljs-keyword\x22\x3ewith\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ea\x3c\/span\x3e NodeList \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e \x26lt;img\x26gt;\n\n\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e passing (\x3cspan class=\x22hljs-number\x22\x3e67\x3c\/span\x3ems)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e到这里，我们已经成功的测试了我们的模块以及组成它的函数，学习到了纯函数以及如何使用函数组合。我们知道了纯函数与不纯函数的区别，知道纯函数更可读，由小函数组成，更容易测试。相比于不太合理的纯函数式编程，我们的代码更加可读、理解和修改，这也是我们重构代码的目的。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader8\x22\x3eLinks\x3c\/h1\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/drboolean.gitbooks.io\/mostly-adequate-guide\/content\/index.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eProfessor Frisby’s Mostly Adequate Guide to Functional Programming – @drboolean\x3c\/a\x3e-这是一本很优秀的介绍函数式编程的书，本文的很多内容和例子出自这本书\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/eloquentjavascript.net\/1st_edition\/chapter6.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eEloquent Javascript – Functional Programming @marijnjh\x3c\/a\x3e-介绍编程的好书，同样有一章介绍函数式编程的内容很棒\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/underscorejs.org\/docs\/underscore.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eUnderscore\x3c\/a\x3e-深入的挖掘像Underscore，\x3ca href=\x22https:\/\/lodash.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3elodash\x3c\/a\x3e,\x3ca href=\x22http:\/\/ramdajs.com\/docs\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRamda\x3c\/a\x3e这样的工具库是成为成熟开发者的重要一步。理解如何使用这些函数将极大降低你代码的长度，让你的程序更加声明式的。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e以上就是本文的全部！非常感谢阅读，我希望这篇文章很好的向你介绍了函数式编程，重构以及测试你的JavaScript。由于目前特别火热的库如\x3ca href=\x22https:\/\/facebook.github.io\/react\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eReact\x3c\/a\x3e,\x3ca href=\x22http:\/\/redux.js.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRedux\x3c\/a\x3e,\x3ca href=\x22http:\/\/elm-lang.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eElm\x3c\/a\x3e,\x3ca href=\x22http:\/\/cycle.js.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCycle\x3c\/a\x3e和\x3ca href=\x22http:\/\/reactivex.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eReactiveX\x3c\/a\x3e都在鼓励和使用这种模式，所以这个时候写这样一篇有趣的范例也算是推波助流吧。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>合理的使用纯函数式编程</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007491981">https://segmentfault.com/a/1190000007491981</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/bn2ca9gvn49/" target="_blank">https://alili.tech/archive/bn2ca9gvn49/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>