<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Tinder渐进式网页应用性能案例学习"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Tinder渐进式网页应用性能案例学习 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/bft7yf7b6vu/",
				"appid": "1613049289050283", 
				"title": "Tinder渐进式网页应用性能案例学习 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-25T02:30:23"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/q6ns1jv1rl8/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/osv1izrn6e/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fbft7yf7b6vu%2f&text=Tinder%e6%b8%90%e8%bf%9b%e5%bc%8f%e7%bd%91%e9%a1%b5%e5%ba%94%e7%94%a8%e6%80%a7%e8%83%bd%e6%a1%88%e4%be%8b%e5%ad%a6%e4%b9%a0"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fbft7yf7b6vu%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fbft7yf7b6vu%2f&text=Tinder%e6%b8%90%e8%bf%9b%e5%bc%8f%e7%bd%91%e9%a1%b5%e5%ba%94%e7%94%a8%e6%80%a7%e8%83%bd%e6%a1%88%e4%be%8b%e5%ad%a6%e4%b9%a0"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fbft7yf7b6vu%2f&title=Tinder%e6%b8%90%e8%bf%9b%e5%bc%8f%e7%bd%91%e9%a1%b5%e5%ba%94%e7%94%a8%e6%80%a7%e8%83%bd%e6%a1%88%e4%be%8b%e5%ad%a6%e4%b9%a0"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fbft7yf7b6vu%2f&is_video=false&description=Tinder%e6%b8%90%e8%bf%9b%e5%bc%8f%e7%bd%91%e9%a1%b5%e5%ba%94%e7%94%a8%e6%80%a7%e8%83%bd%e6%a1%88%e4%be%8b%e5%ad%a6%e4%b9%a0"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Tinder%e6%b8%90%e8%bf%9b%e5%bc%8f%e7%bd%91%e9%a1%b5%e5%ba%94%e7%94%a8%e6%80%a7%e8%83%bd%e6%a1%88%e4%be%8b%e5%ad%a6%e4%b9%a0&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fbft7yf7b6vu%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fbft7yf7b6vu%2f&title=Tinder%e6%b8%90%e8%bf%9b%e5%bc%8f%e7%bd%91%e9%a1%b5%e5%ba%94%e7%94%a8%e6%80%a7%e8%83%bd%e6%a1%88%e4%be%8b%e5%ad%a6%e4%b9%a0"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbft7yf7b6vu%2f&title=Tinder%e6%b8%90%e8%bf%9b%e5%bc%8f%e7%bd%91%e9%a1%b5%e5%ba%94%e7%94%a8%e6%80%a7%e8%83%bd%e6%a1%88%e4%be%8b%e5%ad%a6%e4%b9%a0"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbft7yf7b6vu%2f&title=Tinder%e6%b8%90%e8%bf%9b%e5%bc%8f%e7%bd%91%e9%a1%b5%e5%ba%94%e7%94%a8%e6%80%a7%e8%83%bd%e6%a1%88%e4%be%8b%e5%ad%a6%e4%b9%a0"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbft7yf7b6vu%2f&title=Tinder%e6%b8%90%e8%bf%9b%e5%bc%8f%e7%bd%91%e9%a1%b5%e5%ba%94%e7%94%a8%e6%80%a7%e8%83%bd%e6%a1%88%e4%be%8b%e5%ad%a6%e4%b9%a0"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Tinder渐进式网页应用性能案例学习</h1><div class="meta"><div class="postdate"><time datetime="2019-01-25" itemprop="datePublished">2019-01-25</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3cp\x3eTinder最近对移动端“右滑”了。他们最近出品的响应式的\x3ca href=\x22https:\/\/developers.google.com\/web\/progressive-web-apps\/\x22\x3e渐进式网页应用\x3c\/a\x3e——\x3ca href=\x22https:\/\/tinder.com\x22\x3eTinder Online\x3c\/a\x3e——已经可以在桌面和移动端使用了，应用采用了新技术做\x3ca href=\x22https:\/\/medium.com\/dev-channel\/the-cost-of-javascript-84009f51e99e\x22\x3eJavaScript性能优化\x3c\/a\x3e，并用\x3ca href=\x22https:\/\/developers.google.com\/web\/fundamentals\/primers\/service-workers\/\x22\x3eService Workers\x3c\/a\x3e和\x3ca href=\x22https:\/\/developers.google.com\/web\/fundamentals\/push-notifications\/\x22\x3ePush Notification\x3c\/a\x3e分别做了网络弹性和对话约会。今天我们来简单过一遍他们的性能学习之路。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01a70821d7a1eacd8a.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch3\x3e踏上渐进式网页应用的旅程\x3c\/h3\x3e\n\x3cp\x3eTinder Online的目标是在新市场站稳脚跟，力争达到在其它平台上Tinder V1版本的使用体验。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3ePWA的MVP花了三个月，采用了\x3c\/strong\x3e\x3ca href=\x22https:\/\/reactjs.com\x22\x3e\x3cstrong\x3eReact\x3c\/strong\x3e\x3c\/a\x3e\x3cstrong\x3e构架UI库和\x3c\/strong\x3e\x3ca href=\x22https:\/\/redux.js.org\x22\x3e\x3cstrong\x3eRedux\x3c\/strong\x3e\x3c\/a\x3e\x3cstrong\x3e做状态管理。\x3c\/strong\x3e这些努力的结果就是，渐进式网页应用只使用了10%的流量消耗就达到了Tinder核心的应用体验，这对流量费用昂贵或连接速度慢的地区的人来讲尤为重要：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t012b2b37d979c84e27.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e上图是Tinder Online和原生应用的流量消耗对比。值得注意的是，这并不是横向的比较。PWA只会按需从新路由上加载代码，这些额外的代码加载分散在应用的整个生命周期里面。后续导航消耗流量依旧比下载整个app的要少。\x3c\/p\x3e\n\x3cp\x3e早期征兆显示，对比原生应用，PWA表现出了流畅的滑动体验，更多的消息操作和更长的会话时间。在PWA上：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e用户的滑动操作更多\x3c\/li\x3e\n\x3cli\x3e用户之间发送的消息更多\x3c\/li\x3e\n\x3cli\x3e用户的购买量与原生应用持平\x3c\/li\x3e\n\x3cli\x3e用户对个人资料的编辑更为频繁\x3c\/li\x3e\n\x3cli\x3e用户的会话时间更长\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3\x3e性能\x3c\/h3\x3e\n\x3cp\x3eTinder Online的移动端用户使用最多的设备包括：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eApple iPhone和iPad\x3c\/li\x3e\n\x3cli\x3eSamsung Galaxy S8\x3c\/li\x3e\n\x3cli\x3eSamsung Galaxy S7\x3c\/li\x3e\n\x3cli\x3eMotorola Moto G4\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e通过使用\x3ca href=\x22https:\/\/developers.google.com\/web\/tools\/chrome-user-experience-report\/\x22\x3eChrome用户体验报告\x3c\/a\x3e (CrUX)，我们了解到大部分的用户在浏览Tinder Online的时候使用的是4G网络：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01f3dc813ad3990ef6.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cem\x3e注：Rick Viscomi最近在\x3ca href=\x22https:\/\/calendar.perfplanet.com\/2017\/finding-your-competitive-edge-with-the-chrome-user-experience-report\/\x22\x3ePerfPlanet\x3c\/a\x3e中加入了CrUX，Inian Parameshwaran使用了\x3ca href=\x22https:\/\/calendar.perfplanet.com\/2017\/introducing-ruxt-visualizing-real-user-experience-data-for-1-2-million-websites\/\x22\x3erUXt\x3c\/a\x3e将数据变得更加可视化。\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e在使用\x3ca href=\x22https:\/\/www.webpagetest.org\/result\/171224_ZB_13cef955385ddc4cae8847f451db8403\/\x22\x3eWebPageTest\x3c\/a\x3e和\x3ca href=\x22https:\/\/github.com\/GoogleChrome\/lighthouse\/\x22\x3eLighthouse\x3c\/a\x3e（4G下使用Galaxy S7）测试后，我们看到用户在\x3cstrong\x3e五秒钟之内\x3c\/strong\x3e即可加载完毕并进入可交互状态。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01322e56839095d723.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e当然，在受CPU约束的\x3ca href=\x22https:\/\/www.webpagetest.org\/lighthouse.php?test=171224_NP_f7a489992a86a83b892bf4b4da42819d\x26amp;run=3\x22\x3e中端移动设备\x3c\/a\x3e（比如Moto G4）上，仍然存在很多可优化空间：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01a2b47f851f99e0d7.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3eTinder正在努力优化他们的体验，未来我们也希望能看到他们在网页性能优化上所做的工作。\x3c\/p\x3e\n\x3ch3\x3e性能优化\x3c\/h3\x3e\n\x3cp\x3eTinder使用了很多技术来提升加载速度和减少进入可交互状态之前的时间。他们使用了基于路由的代码分割，并引入了性能预算和资源的长期缓存。\x3c\/p\x3e\n\x3ch3\x3e基于路由的代码分割\x3c\/h3\x3e\n\x3cp\x3eTinder网页端最初包含了庞大的JavaScript代码包，这延长了应用的加载时间。这些包中包含了很多并不需要立即加载的代码，因此这些代码可以通过使用\x3ca href=\x22https:\/\/webpack.js.org\/guides\/code-splitting\/\x22\x3e代码分割\x3c\/a\x3e打碎。\x3cstrong\x3e只加载用户首屏使用的代码，其它的在需要的时候懒加载，这种办法非常有用。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e为了达到这一点，Tinder使用了\x3ca href=\x22https:\/\/reacttraining.com\/react-router\/\x22\x3eReact Router\x3c\/a\x3e和\x3ca href=\x22https:\/\/github.com\/thejameskyle\/react-loadable\x22\x3eReact Loadable\x3c\/a\x3e。他们的应用把路由和渲染信息集中在了一个配置里面，他们发现可以直接在顶层做代码分割。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e简介：\x3c\/strong\x3e\nReact Loadable的的作者是James Kyle，他的初衷是简化以组件为中心的React应用的\x3cstrong\x3e代码分割\x3c\/strong\x3e。\x3cstrong\x3eLoadable\x3c\/strong\x3e是一个高阶组件（一个创建组件的函数），能够在组件层使得\x3cstrong\x3e分割\x3c\/strong\x3e代码包更加简单。\x3c\/p\x3e\n\x3cp\x3e比如我们有两个组件，“A”和“B”。在做代码分割之前，Tinder静态地将所有东西（A、B等等）都引入到主包里面。这种方式很低效，因为我们并不立刻且同时需要A和B两个组件：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t0117f97a162902aff3.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e在做了代码分割之后，组件A和组件B会在需要的时候再加载。Tinder在JS中引入了React Loadable，\x3ca href=\x22https:\/\/webpack.js.org\/guides\/code-splitting\/#dynamic-imports\x22\x3e动态导入\x3c\/a\x3e和\x3ca href=\x22https:\/\/medium.com\/faceyspacey\/how-to-use-webpacks-new-magic-comment-feature-with-react-universal-component-ssr-a38fd3e296a\x22\x3ewebpack的魔法注释\x3c\/a\x3e（针对命名动态代码块）：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01da4af3b5fffd8b99.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e针对“vendor”（库），Tinder使用了\x3ca href=\x22https:\/\/webpack.js.org\/plugins\/commons-chunk-plugin\/\x22\x3e\x3cstrong\x3eCommonsChunkPlugin\x3c\/strong\x3e\x3c\/a\x3e将频繁使用的公共库单独打包，这样可以有效利用长缓存：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01af6e8120c8d95d03.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e接着，Tinder使用\x3ca href=\x22https:\/\/github.com\/thejameskyle\/react-loadable#loadablecomponentpreload\x22\x3eReact Loadable的预加载支持\x3c\/a\x3e来预加载下一页可能会使用到的资源：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01c58de62023ae4dfc.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3eTinder也使用了\x3ca href=\x22https:\/\/developers.google.com\/web\/fundamentals\/primers\/service-workers\/\x22\x3eService Workers\x3c\/a\x3e来预缓存所有路由层的代码包，并把用户最有可能访问的路由在未做分割的情况下加进了主包中。当然他们也使用了最常用的优化手段，例如通过UglifyJS最小化JavaScript文件的体积：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs yaml\x22\x3e\x3cspan class=\x22hljs-string\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ewebpack.optimize.UglifyJsPlugin({\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    parallel:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    compress:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    warnings:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        screw_ie8:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e},\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    sourceMap:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eSHOULD_SOURCEMAP\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e}),\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch4\x3e影响\x3c\/h4\x3e\n\x3cp\x3e在引入了基于路由的代码分割之后，他们的主包的大小从166KB降至了101KB，DCL从5.46秒降至4.69秒：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01ea1e7b6bfadfaffb.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch3\x3e资源的长期缓存\x3c\/h3\x3e\n\x3cp\x3e通过使用webpack的[chunkhash]向文件名中加入独一无二的字段，这保证了静态资源的\x3ca href=\x22https:\/\/webpack.js.org\/guides\/caching\/\x22\x3e长期缓存\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t0181f677a9d045c9f1.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3eTinder在依赖中使用了很多开源的库。vendor的[chunkhash]会随着对这些库作出的改变而改变，这就会使缓存失效。为了解决这个问题，Tinder定义了一个\x3ca href=\x22https:\/\/gist.github.com\/tinder-rhsiao\/89cd682c34d1e1307111b091801e6fe5\x22\x3e外部库白名单\x3c\/a\x3e，并将他们的manifest文件从主代码块中分离出来，以改善缓存。现在两个代码包的大小大约都是160KB。\x3c\/p\x3e\n\x3ch3\x3e预加载后期使用资源\x3c\/h3\x3e\n\x3cp\x3e作为一名新手，\x3ca href=\x22https:\/\/developers.google.com\/web\/fundamentals\/performance\/resource-prioritization\x22\x3e\x26lt;link rel=\x22preload\x22\x26gt;\x3c\/a\x3e是一个声明式的命令，指导浏览器预先加载关键的、后续会用到的资源。在一个单页面应用里面，这些资源可能会是JavaScript包。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01c71a5401eb753861.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3eTinder启用了对对用户体验至关重要的JavaScript\/webpack包的预加载的支持。这将加载时间减少了1秒，初次绘制时间也从1000毫秒降至500毫秒左右。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t018a5d21004b40ef92.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch3\x3e性能预算\x3c\/h3\x3e\n\x3cp\x3eTinder采用了\x3cstrong\x3e性能预算\x3c\/strong\x3e来帮助他们在移动端达到他们的目标。正如Alex Russell在“\x3ca href=\x22https:\/\/infrequently.org\/2017\/10\/can-you-afford-it-real-world-web-performance-budgets\/\x22\x3eCan you afford it?: real-world performance budgets\x3c\/a\x3e”提及的，在使用3G网络的中端移动设备上，你所能利用的资源是非常有限的。\x3c\/p\x3e\n\x3cp\x3e为了保证快速的交互，Tinder制定了一个强制性的体积预算——主包和vendor包155KB，异步加载（懒加载）55KB，其它的块35KB。CSS也有限制，20KB。如果他们想将不同设备上的性能保持一致，这些至关重要。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t0186aaaafde8d61b39.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch3\x3eWebpack打包分析\x3c\/h3\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/webpack-contrib\/webpack-bundle-analyzer\x22\x3eWebpack打包分析器\x3c\/a\x3e可以绘制JavaScript包的依赖关系图，可以使你更容易地发现性能瓶颈，以便继续做优化。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01e35ec62f2ffd3e85.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3eTinder使用了Webpack Bundle Analyzer发现了很多可以继续优化的地方：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3ePolyfills：\x3c\/strong\x3eTinder的目标是现代浏览器，但他们同样兼顾IE11和Android 4.4设备及以上的浏览器，\x3cstrong\x3e为了使polyfills和编译后的代码体积尽可能小，他们使用了\x3c\/strong\x3e\x3ca href=\x22https:\/\/github.com\/babel\/babel-preset-env\x22\x3e\x3cstrong\x3ebabel-preset-env\x3c\/strong\x3e\x3c\/a\x3e\x3cstrong\x3e以及\x3c\/strong\x3e\x3ca href=\x22https:\/\/github.com\/zloirock\/core-js\x22\x3e\x3cstrong\x3ecore-js\x3c\/strong\x3e\x3c\/a\x3e**。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3e削减库的使用：\x3c\/strong\x3eTinder直接使用IndexedDB替代\x3ca href=\x22https:\/\/github.com\/localForage\/localForage\x22\x3elocalForage\x3c\/a\x3e。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3e更好的分割：\x3c\/strong\x3e将首屏\/首次交互不需要的组件从主包中分离出去。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3e代码复用：\x3c\/strong\x3e将使用次数超过三次的模块提取出来，创建为异步加载的公共模块。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eCSS：\x3c\/strong\x3eTinder将\x3ca href=\x22https:\/\/www.smashingmagazine.com\/2015\/08\/understanding-critical-css\/\x22\x3e关键CSS\x3c\/a\x3e从核心包中分离了出来（因为他们使用了服务端渲染，无论如何都将这部分CSS发回到客户端）\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t0109afde917d007f70.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e使用打包分析器同样使Tinder意识到Webpack的\x3ca href=\x22https:\/\/github.com\/lodash\/lodash-webpack-plugin\x22\x3eLodash Module Replacement Plugin\x3c\/a\x3e的重要性。这个插件可以使用更简单的替换包，创建出更小的Lodash构建包：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t010923c95ba7bb8853.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3eWebpack打包分析器可以嵌入到你的Webpack配置中。Tinder的设置看起来就像下面的这样：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs yaml\x22\x3e\x3cspan class=\x22hljs-attr\x22\x3eplugins:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eBundleAnalyzerPlugin({\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        analyzerMode:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27server\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        analyzerPort:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e8888\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        reportFilename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27report.html\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        openAnalyzer:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        generateStatsFile:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        statsFilename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27stats.json\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        statsOptions:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e})\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e]\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e剩下的大部分JavaScript就是主包，如果不对Redux Reducer和Saga Register做架构上的改变的话，很难再去做这部分的分割工作。\x3c\/p\x3e\n\x3ch3\x3eCSS策略\x3c\/h3\x3e\n\x3cp\x3eTinder使用了\x3ca href=\x22https:\/\/acss.io\/\x22\x3eAtomic CSS\x3c\/a\x3e来创建高度可复用的CSS样式。所有的这些原子化的CSS样式会在初次绘制时加入到内联样式中，剩下的CSS则会在样式表中加载（包括动画和基础\/重置样式）。关键的样式有20KB的限制，最近的打包体积已经降低到了11KB以下。\x3c\/p\x3e\n\x3cp\x3eTinder使用\x3ca href=\x22http:\/\/cssstats.com\/stats?url=https%253A%252F%252Ftinder.com\x26amp;ua=Browser%2520Default%0A\x22\x3eCSS stats\x3c\/a\x3e和Google Analystics来分析每个发行版本中改动的地方。在采用Atomic CSS之前，页面的平均加载时间是6.75秒，之后则降低为5.75秒。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t019469fc37704570a6.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3eTinder Online同样使用了PostCSS \x3ca href=\x22https:\/\/twitter.com\/autoprefixer\x22\x3eAutoprefixer plugin\x3c\/a\x3e解析CSS，并按照\x3ca href=\x22http:\/\/caniuse.com\/\x22\x3eCan I Use\x3c\/a\x3e的规则为CSS加上前缀。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs less\x22\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3ewebpack\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.LoaderOptionsPlugin\x3c\/span\x3e({\n    \x3cspan class=\x22hljs-attribute\x22\x3eoptions\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attribute\x22\x3econtext\x3c\/span\x3e: paths.basePath,\n        \x3cspan class=\x22hljs-attribute\x22\x3eoutput\x3c\/span\x3e: { \x3cspan class=\x22hljs-attribute\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/\x27\x3c\/span\x3e },\n        \x3cspan class=\x22hljs-attribute\x22\x3eminimize\x3c\/span\x3e: true,\n        \x3cspan class=\x22hljs-attribute\x22\x3epostcss\x3c\/span\x3e: [\n            autoprefixer({\n            \x3cspan class=\x22hljs-attribute\x22\x3ebrowsers\x3c\/span\x3e: [\n                \x3cspan class=\x22hljs-string\x22\x3e\x27last 2 versions\x27\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-string\x22\x3e\x27not ie \x26lt; 11\x27\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-string\x22\x3e\x27Safari \x26gt;= 8\x27\x3c\/span\x3e\n                ]\n            })\n        ]\n    }\n}),\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3e运行时性能\x3c\/h3\x3e\n\x3ch4\x3e使用requestIdleCallback()延迟非关键工作\x3c\/h4\x3e\n\x3cp\x3e为了提高运行时的性能，Tinder选择了使用\x3ca href=\x22https:\/\/developers.google.com\/web\/updates\/2015\/08\/using-requestidlecallback\x22\x3erequestIdleCallback()\x3c\/a\x3e将非关键动作推迟到空闲时间中。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs lisp\x22\x3erequestIdleCallback(\x3cspan class=\x22hljs-name\x22\x3emyNonEssentialWork\x3c\/span\x3e)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e其中包括诸如instrumentation beacons这样的工作。他们也对HTML复合层做了简化处理，以减少滑动时的绘制次数。\n\x3cstrong\x3e在滑动时对instrumentation beacons使用requestIdleCallback()：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e之前..\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01b8290f3346471572.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e之后\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01c003f7a26d4f2994.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch3\x3e依赖升级\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3eWebpack 3 \x2b 作用域提升\x3c\/strong\x3e\n在旧版本的webpack中打包时，每个模块都会被包含在一个单独的闭包中。这些包含函数会拖慢浏览器中JavaScript的执行速度。\x3ca href=\x22https:\/\/medium.com\/webpack\/webpack-3-official-release-15fd2dd8f07b\x22\x3eWebpack 3\x3c\/a\x3e引入了“作用域提升”——可以将所有的模块打包进一个闭包之中，这样可以使浏览器中JavaScript的执行速度更快。这个功能使用的是Module Concatenation plugin：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3enew webpack\x3cspan class=\x22hljs-selector-class\x22\x3e.optimize\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.ModuleConcatenationPlugin\x3c\/span\x3e()\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3cstrong\x3eWebpack 3的作用域提升将Tinder的vendor包的初次解析时间降低了8%。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eReact 16\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3eReact16相比之前的版本，做了一些改进，\x3ca href=\x22https:\/\/reactjs.org\/blog\/2017\/09\/26\/react-v16.0.html#reduced-file-size\x22\x3e降低了React包的体积大小\x3c\/a\x3e。这去除了现在已经不再使用的代码，带来了更好的打包体验（使用Rollup）。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e通过将React 15升级为React 16，Tinder将gzip压缩后的vendor包的体积减小了7%\x3c\/strong\x3e\nreact \x2b react-dom的体积过去是50KB，现在已经降低为35KB。这要感谢\x3ca href=\x22https:\/\/twitter.com\/dan_abramov\x22\x3eDan Abramov\x3c\/a\x3e，\x3ca href=\x22https:\/\/twitter.com\/trueadm\x22\x3eDominic Gannaway\x3c\/a\x3e和\x3ca href=\x22https:\/\/twitter.com\/natehunzaker\x22\x3eNate Hunzaker\x3c\/a\x3e，他们在这项工作中起到了指导性的作用。\x3c\/p\x3e\n\x3ch3\x3eWorkbox——网络弹性和离线资源缓存\x3c\/h3\x3e\n\x3cp\x3eTinder还使用了\x3ca href=\x22https:\/\/developers.google.com\/web\/tools\/workbox\/get-started\/webpack\x22\x3eWorkbox Webpack plugin\x3c\/a\x3e，来缓存\x3ca href=\x22https:\/\/developers.google.com\/web\/fundamentals\/architecture\/app-shell\x22\x3e应用骨架\x3c\/a\x3e和诸如主包、vendor包、manifest包以及CSS等的核心静态资源。针对频繁的访问，这保证了网络弹性，并且确保用户在回到应用时的加载速度会更快。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01d8e7f34082b4207f.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch3\x3e机遇\x3c\/h3\x3e\n\x3cp\x3e使用\x3ca href=\x22https:\/\/www.npmjs.com\/package\/source-map-explorer\x22\x3esource-map-explorer\x3c\/a\x3e（另一个包分析器）对Tinder包做深入分析之后，我们发现仍然存在很多机会可以减小应用的体积。在登录之前，Facebook Photos、推送消息和验证码就已经获取了。这些如果从关键路径中移除，还可以将主包体积降低20%：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01b581564f4b3c0a08.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e关键路径中的另一个依赖则是Facebook SDK脚本，体积为200KB。丢掉这个（可以在需要的时候懒加载）可以节省1秒的初次加载时间。\x3c\/p\x3e\n\x3ch3\x3e结语\x3c\/h3\x3e\n\x3cp\x3eTinder仍然在迭代他们的渐进式网页应用，但是已经从他们的工作中看到了很多好的结果。赶快去浏览\x3ca href=\x22https:\/\/tinder.com\/\x22\x3eTinder.com\x3c\/a\x3e，跟上他们未来的进度吧！\x3c\/p\x3e\n\x3cp\x3e\x3cem\x3e恭喜Roderick Hsiao、Jordan Banafsheha和Erik Hellenbrand上线Tinder Online，感谢他们为这篇文章的付出。并衷心感谢Cheney Tsai为这篇文章做的审校工作。\x3c\/em\x3e\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Tinder渐进式网页应用性能案例学习</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/a-tinder-progressive-web-app-performance-case-study">https://www.zcfy.cc/article/a-tinder-progressive-web-app-performance-case-study</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/bft7yf7b6vu/" target="_blank">https://alili.tech/archive/bft7yf7b6vu/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>