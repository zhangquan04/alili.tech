<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="ftrace：跟踪你的内核函数！"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>ftrace：跟踪你的内核函数！ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/2dcqdgdjn8y/",
				"appid": "1613049289050283", 
				"title": "ftrace：跟踪你的内核函数！ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-21T02:30:06"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/wkpk6pntmj/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/qeeblf3kzq/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f2dcqdgdjn8y%2f&text=ftrace%ef%bc%9a%e8%b7%9f%e8%b8%aa%e4%bd%a0%e7%9a%84%e5%86%85%e6%a0%b8%e5%87%bd%e6%95%b0%ef%bc%81"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f2dcqdgdjn8y%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f2dcqdgdjn8y%2f&text=ftrace%ef%bc%9a%e8%b7%9f%e8%b8%aa%e4%bd%a0%e7%9a%84%e5%86%85%e6%a0%b8%e5%87%bd%e6%95%b0%ef%bc%81"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f2dcqdgdjn8y%2f&title=ftrace%ef%bc%9a%e8%b7%9f%e8%b8%aa%e4%bd%a0%e7%9a%84%e5%86%85%e6%a0%b8%e5%87%bd%e6%95%b0%ef%bc%81"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f2dcqdgdjn8y%2f&is_video=false&description=ftrace%ef%bc%9a%e8%b7%9f%e8%b8%aa%e4%bd%a0%e7%9a%84%e5%86%85%e6%a0%b8%e5%87%bd%e6%95%b0%ef%bc%81"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=ftrace%ef%bc%9a%e8%b7%9f%e8%b8%aa%e4%bd%a0%e7%9a%84%e5%86%85%e6%a0%b8%e5%87%bd%e6%95%b0%ef%bc%81&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f2dcqdgdjn8y%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f2dcqdgdjn8y%2f&title=ftrace%ef%bc%9a%e8%b7%9f%e8%b8%aa%e4%bd%a0%e7%9a%84%e5%86%85%e6%a0%b8%e5%87%bd%e6%95%b0%ef%bc%81"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2dcqdgdjn8y%2f&title=ftrace%ef%bc%9a%e8%b7%9f%e8%b8%aa%e4%bd%a0%e7%9a%84%e5%86%85%e6%a0%b8%e5%87%bd%e6%95%b0%ef%bc%81"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2dcqdgdjn8y%2f&title=ftrace%ef%bc%9a%e8%b7%9f%e8%b8%aa%e4%bd%a0%e7%9a%84%e5%86%85%e6%a0%b8%e5%87%bd%e6%95%b0%ef%bc%81"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2dcqdgdjn8y%2f&title=ftrace%ef%bc%9a%e8%b7%9f%e8%b8%aa%e4%bd%a0%e7%9a%84%e5%86%85%e6%a0%b8%e5%87%bd%e6%95%b0%ef%bc%81"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">ftrace：跟踪你的内核函数！</h1><div class="meta"><div class="postdate"><time datetime="2019-01-21" itemprop="datePublished">2019-01-21</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3ch1\x3e\x3ca href=\x22#ftrace跟踪你的内核函数\x22\x3e\x3c\/a\x3eftrace：跟踪你的内核函数！\x3c\/h1\x3e\n\x3cp\x3e大家好！今天我们将去讨论一个调试工具：ftrace，之前我的博客上还没有讨论过它。还有什么能比一个新的调试工具更让人激动呢？\x3c\/p\x3e\n\x3cp\x3e这个非常棒的 ftrace 并不是个新的工具！它大约在 Linux 的 2.6 内核版本中就有了，时间大约是在 2008 年。\x3ca href=\x22https:\/\/lwn.net\/Articles\/290277\/\x22\x3e这一篇是我用谷歌能找到的最早的文档\x3c\/a\x3e。因此，如果你是一个调试系统的“老手”，可能早就已经使用它了！\x3c\/p\x3e\n\x3cp\x3e我知道，ftrace 已经存在了大约 2.5 年了（LCTT 译注：距本文初次写作时），但是还没有真正的去学习它。假设我明天要召开一个专题研究会，那么，关于 ftrace 应该讨论些什么？因此，今天是时间去讨论一下它了！\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#什么是-ftrace\x22\x3e\x3c\/a\x3e什么是 ftrace？\x3c\/h3\x3e\n\x3cp\x3eftrace 是一个 Linux 内核特性，它可以让你去跟踪 Linux 内核的函数调用。为什么要这么做呢？好吧，假设你调试一个奇怪的问题，而你已经得到了你的内核版本中这个问题在源代码中的开始的位置，而你想知道这里到底发生了什么？\x3c\/p\x3e\n\x3cp\x3e每次在调试的时候，我并不会经常去读内核源代码，但是，极个别的情况下会去读它！例如，本周在工作中，我有一个程序在内核中卡死了。查看到底是调用了什么函数，能够帮我更好的理解在内核中发生了什么，哪些系统涉及其中！（在我的那个案例中，它是虚拟内存系统）。\x3c\/p\x3e\n\x3cp\x3e我认为 ftrace 是一个十分好用的工具（它肯定没有 \x3ccode\x3estrace\x3c\/code\x3e 那样使用广泛，也比它难以使用），但是它还是值得你去学习。因此，让我们开始吧！\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#使用-ftrace-的第一步\x22\x3e\x3c\/a\x3e使用 ftrace 的第一步\x3c\/h3\x3e\n\x3cp\x3e不像 \x3ccode\x3estrace\x3c\/code\x3e 和 \x3ccode\x3eperf\x3c\/code\x3e，ftrace 并不是真正的 \x3cstrong\x3e程序\x3c\/strong\x3e – 你不能只运行 \x3ccode\x3eftrace my_cool_function\x3c\/code\x3e。那样太容易了！\x3c\/p\x3e\n\x3cp\x3e如果你去读 \x3ca href=\x22https:\/\/lwn.net\/Articles\/365835\/\x22\x3e使用 ftrace 调试内核\x3c\/a\x3e，它会告诉你从 \x3ccode\x3ecd \/sys\/kernel\/debug\/tracing\x3c\/code\x3e 开始，然后做很多文件系统的操作。\x3c\/p\x3e\n\x3cp\x3e对于我来说，这种办法太麻烦——一个使用 ftrace 的简单例子像是这样：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs vim\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ecd\x3c\/span\x3e \/sys\/kernel\/\x3cspan class=\x22hljs-keyword\x22\x3edebug\x3c\/span\x3e\/tracing\n\x3cspan class=\x22hljs-keyword\x22\x3eecho\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x26gt; \x3cspan class=\x22hljs-title\x22\x3ecurrent_tracer\x3c\/span\x3e\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eecho\x3c\/span\x3e do_page_fault \x26gt; set_ftrace_filter\n\x3cspan class=\x22hljs-keyword\x22\x3ecat\x3c\/span\x3e trace\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这个文件系统是跟踪系统的接口（“给这些神奇的文件赋值，然后该发生的事情就会发生”）理论上看起来似乎可用，但是它不是我的首选方式。\x3c\/p\x3e\n\x3cp\x3e幸运的是，ftrace 团队也考虑到这个并不友好的用户界面，因此，它有了一个更易于使用的界面，它就是 \x3ccode\x3etrace-cmd\x3c\/code\x3e！！！\x3ccode\x3etrace-cmd\x3c\/code\x3e 是一个带命令行参数的普通程序。我们后面将使用它！我在 LWN 上找到了一个 \x3ccode\x3etrace-cmd\x3c\/code\x3e 的使用介绍：\x3ca href=\x22https:\/\/lwn.net\/Articles\/410200\/\x22\x3etrace-cmd: Ftrace 的一个前端\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#开始使用-trace-cmd让我们仅跟踪一个函数\x22\x3e\x3c\/a\x3e开始使用 trace-cmd：让我们仅跟踪一个函数\x3c\/h3\x3e\n\x3cp\x3e首先，我需要去使用 \x3ccode\x3esudo apt-get install trace-cmd\x3c\/code\x3e 安装 \x3ccode\x3etrace-cmd\x3c\/code\x3e，这一步很容易。\x3c\/p\x3e\n\x3cp\x3e对于第一个 ftrace 的演示，我决定去了解我的内核如何去处理一个页面故障。当 Linux 分配内存时，它经常偷懒，（“你并不是_真的_计划去使用内存，对吗？”）。这意味着，当一个应用程序尝试去对分配给它的内存进行写入时，就会发生一个页面故障，而这个时候，内核才会真正的为应用程序去分配物理内存。\x3c\/p\x3e\n\x3cp\x3e我们开始使用 \x3ccode\x3etrace-cmd\x3c\/code\x3e 并让它跟踪 \x3ccode\x3edo_page_fault\x3c\/code\x3e 函数！\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs dockerfile\x22\x3e$ sudo trace-\x3cspan class=\x22hljs-keyword\x22\x3ecmd\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e record -p \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e -l do_page_fault\n\x3c\/span\x3e  plugin \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e\nHit Ctrl^C to stop recording\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e我将它运行了几秒钟，然后按下了 \x3ccode\x3eCtrl\x2bC\x3c\/code\x3e。 让我大吃一惊的是，它竟然产生了一个 2.5MB 大小的名为 \x3ccode\x3etrace.dat\x3c\/code\x3e 的跟踪文件。我们来看一下这个文件的内容！\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs delphi\x22\x3e$ sudo trace-cmd report\n          chrome-\x3cspan class=\x22hljs-number\x22\x3e15144\x3c\/span\x3e [\x3cspan class=\x22hljs-number\x22\x3e000\x3c\/span\x3e] \x3cspan class=\x22hljs-number\x22\x3e11446.466121\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e:\x3c\/span\x3e             do_page_fault\n          chrome-\x3cspan class=\x22hljs-number\x22\x3e15144\x3c\/span\x3e [\x3cspan class=\x22hljs-number\x22\x3e000\x3c\/span\x3e] \x3cspan class=\x22hljs-number\x22\x3e11446.467910\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e:\x3c\/span\x3e             do_page_fault\n          chrome-\x3cspan class=\x22hljs-number\x22\x3e15144\x3c\/span\x3e [\x3cspan class=\x22hljs-number\x22\x3e000\x3c\/span\x3e] \x3cspan class=\x22hljs-number\x22\x3e11446.469174\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e:\x3c\/span\x3e             do_page_fault\n          chrome-\x3cspan class=\x22hljs-number\x22\x3e15144\x3c\/span\x3e [\x3cspan class=\x22hljs-number\x22\x3e000\x3c\/span\x3e] \x3cspan class=\x22hljs-number\x22\x3e11446.474225\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e:\x3c\/span\x3e             do_page_fault\n          chrome-\x3cspan class=\x22hljs-number\x22\x3e15144\x3c\/span\x3e [\x3cspan class=\x22hljs-number\x22\x3e000\x3c\/span\x3e] \x3cspan class=\x22hljs-number\x22\x3e11446.474386\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e:\x3c\/span\x3e             do_page_fault\n          chrome-\x3cspan class=\x22hljs-number\x22\x3e15144\x3c\/span\x3e [\x3cspan class=\x22hljs-number\x22\x3e000\x3c\/span\x3e] \x3cspan class=\x22hljs-number\x22\x3e11446.478768\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e:\x3c\/span\x3e             do_page_fault\n CompositorTileW-\x3cspan class=\x22hljs-number\x22\x3e15154\x3c\/span\x3e [\x3cspan class=\x22hljs-number\x22\x3e001\x3c\/span\x3e] \x3cspan class=\x22hljs-number\x22\x3e11446.480172\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e:\x3c\/span\x3e             do_page_fault\n          chrome-\x3cspan class=\x22hljs-number\x22\x3e1830\x3c\/span\x3e  [\x3cspan class=\x22hljs-number\x22\x3e003\x3c\/span\x3e] \x3cspan class=\x22hljs-number\x22\x3e11446.486696\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e:\x3c\/span\x3e             do_page_fault\n CompositorTileW-\x3cspan class=\x22hljs-number\x22\x3e15154\x3c\/span\x3e [\x3cspan class=\x22hljs-number\x22\x3e001\x3c\/span\x3e] \x3cspan class=\x22hljs-number\x22\x3e11446.488983\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e:\x3c\/span\x3e             do_page_fault\n CompositorTileW-\x3cspan class=\x22hljs-number\x22\x3e15154\x3c\/span\x3e [\x3cspan class=\x22hljs-number\x22\x3e001\x3c\/span\x3e] \x3cspan class=\x22hljs-number\x22\x3e11446.489034\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e:\x3c\/span\x3e             do_page_fault\n CompositorTileW-\x3cspan class=\x22hljs-number\x22\x3e15154\x3c\/span\x3e [\x3cspan class=\x22hljs-number\x22\x3e001\x3c\/span\x3e] \x3cspan class=\x22hljs-number\x22\x3e11446.489045\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e:\x3c\/span\x3e             do_page_fault\n\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e看起来很整洁 – 它展示了进程名（chrome）、进程 ID（15144）、CPU ID（000），以及它跟踪的函数。\x3c\/p\x3e\n\x3cp\x3e通过察看整个文件，（\x3ccode\x3esudo trace-cmd report | grep chrome\x3c\/code\x3e）可以看到，我们跟踪了大约 1.5 秒，在这 1.5 秒的时间段内，Chrome 发生了大约 500 个页面故障。真是太酷了！这就是我们做的第一个 ftrace！\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#下一个-ftrace-技巧我们来跟踪一个进程\x22\x3e\x3c\/a\x3e下一个 ftrace 技巧：我们来跟踪一个进程！\x3c\/h3\x3e\n\x3cp\x3e好吧，只看一个函数是有点无聊！假如我想知道一个程序中都发生了什么事情。我使用一个名为 Hugo 的静态站点生成器。看看内核为 Hugo 都做了些什么事情？\x3c\/p\x3e\n\x3cp\x3e在我的电脑上 Hugo 的 PID 现在是 25314，因此，我使用如下的命令去记录所有的内核函数：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs dockerfile\x22\x3esudo trace-\x3cspan class=\x22hljs-keyword\x22\x3ecmd\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e record --\x3cspan class=\x22hljs-built_in\x22\x3ehelp\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e# I read the help!\x3c\/span\x3e\n\x3c\/span\x3esudo trace-\x3cspan class=\x22hljs-keyword\x22\x3ecmd\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e record -p \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e -P 25314 \x3cspan class=\x22hljs-comment\x22\x3e# record for PID 25314\x3c\/span\x3e\n\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3ccode\x3esudo trace-cmd report\x3c\/code\x3e 输出了 18,000 行。如果你对这些感兴趣，你可以看 \x3ca href=\x22https:\/\/gist.githubusercontent.com\/jvns\/e5c2d640f7ec76ed9ed579be1de3312e\/raw\/78b8425436dc4bb5bb4fa76a4f85d5809f7d1ef2\/trace-cmd-report.txt\x22\x3e这里是所有的 18,000 行的输出\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e18,000 行太多了，因此，在这里仅摘录其中几行。\x3c\/p\x3e\n\x3cp\x3e当系统调用 \x3ccode\x3eclock_gettime\x3c\/code\x3e 运行的时候，都发生了什么：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs sqf\x22\x3e compat_SyS_clock_gettime\n    SyS_clock_gettime\n       clockid_to_kclock\n       posix_clock_realtime_get\n          getnstimeofday64\n             \x3cspan class=\x22hljs-variable\x22\x3e__getnstimeofday64\x3c\/span\x3e\n                arch_counter_read\n    \x3cspan class=\x22hljs-variable\x22\x3e__compat_put_timespec\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这是与进程调试相关的一些东西：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs sqf\x22\x3e cpufreq_sched_irq_work\n    wake_up_process\n       try_to_wake_up\n          \x3cspan class=\x22hljs-variable\x22\x3e_raw_spin_lock_irqsave\x3c\/span\x3e\n             do_raw_spin_lock\n          \x3cspan class=\x22hljs-variable\x22\x3e_raw_spin_lock\x3c\/span\x3e\n             do_raw_spin_lock\n          walt_ktime_clock\n             ktime_get\n                arch_counter_read\n          walt_update_task_ravg\n             exiting_task\n\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e虽然你可能还不理解它们是做什么的，但是，能够看到所有的这些函数调用也是件很酷的事情。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#function-graph-跟踪\x22\x3e\x3c\/a\x3e“function graph” 跟踪\x3c\/h3\x3e\n\x3cp\x3e这里有另外一个模式，称为 \x3ccode\x3efunction_graph\x3c\/code\x3e。除了它既可以进入也可以退出一个函数外，其它的功能和函数跟踪器是一样的。\x3ca href=\x22https:\/\/gist.githubusercontent.com\/jvns\/f32e9b06bcd2f1f30998afdd93e4aaa5\/raw\/8154d9828bb895fd6c9b0ee062275055b3775101\/function_graph.txt\x22\x3e这里是那个跟踪器的输出\x3c\/a\x3e\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs dockerfile\x22\x3esudo trace-\x3cspan class=\x22hljs-keyword\x22\x3ecmd\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e record -p function_graph -P 25314\n\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e同样，这里只是一个片断（这次来自 futex 代码）：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs 1c\x22\x3e             \x3cspan class=\x22hljs-string\x22\x3e|      futex_wake() {\x3c\/span\x3e\n             \x3cspan class=\x22hljs-string\x22\x3e|        get_futex_key() {\x3c\/span\x3e\n             \x3cspan class=\x22hljs-string\x22\x3e|          get_user_pages_fast() {\x3c\/span\x3e\n  \x3cspan class=\x22hljs-number\x22\x3e1.458\x3c\/span\x3e us   \x3cspan class=\x22hljs-string\x22\x3e|            __get_user_pages_fast();\x3c\/span\x3e\n  \x3cspan class=\x22hljs-number\x22\x3e4.375\x3c\/span\x3e us   \x3cspan class=\x22hljs-string\x22\x3e|          }\x3c\/span\x3e\n             \x3cspan class=\x22hljs-string\x22\x3e|          __might_sleep() {\x3c\/span\x3e\n  \x3cspan class=\x22hljs-number\x22\x3e0.292\x3c\/span\x3e us   \x3cspan class=\x22hljs-string\x22\x3e|            ___might_sleep();\x3c\/span\x3e\n  \x3cspan class=\x22hljs-number\x22\x3e2.333\x3c\/span\x3e us   \x3cspan class=\x22hljs-string\x22\x3e|          }\x3c\/span\x3e\n  \x3cspan class=\x22hljs-number\x22\x3e0.584\x3c\/span\x3e us   \x3cspan class=\x22hljs-string\x22\x3e|          get_futex_key_refs();\x3c\/span\x3e\n             \x3cspan class=\x22hljs-string\x22\x3e|          unlock_page() {\x3c\/span\x3e\n  \x3cspan class=\x22hljs-number\x22\x3e0.291\x3c\/span\x3e us   \x3cspan class=\x22hljs-string\x22\x3e|            page_waitqueue();\x3c\/span\x3e\n  \x3cspan class=\x22hljs-number\x22\x3e0.583\x3c\/span\x3e us   \x3cspan class=\x22hljs-string\x22\x3e|            __wake_up_bit();\x3c\/span\x3e\n  \x3cspan class=\x22hljs-number\x22\x3e5.250\x3c\/span\x3e us   \x3cspan class=\x22hljs-string\x22\x3e|          }\x3c\/span\x3e\n  \x3cspan class=\x22hljs-number\x22\x3e0.583\x3c\/span\x3e us   \x3cspan class=\x22hljs-string\x22\x3e|          put_page();\x3c\/span\x3e\n\x2b \x3cspan class=\x22hljs-number\x22\x3e24.208\x3c\/span\x3e us  \x3cspan class=\x22hljs-string\x22\x3e|        }\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e我们看到在这个示例中，在 \x3ccode\x3efutex_wake\x3c\/code\x3e 后面调用了 \x3ccode\x3eget_futex_key\x3c\/code\x3e。这是在源代码中真实发生的事情吗？我们可以检查一下！！\x3ca href=\x22https:\/\/github.com\/torvalds\/linux\/blob\/v4.4\/kernel\/futex.c#L1313-L1324\x22\x3e这里是在 Linux 4.4 中 futex_wake 的定义\x3c\/a\x3e (我的内核版本是 4.4）。\x3c\/p\x3e\n\x3cp\x3e为节省时间我直接贴出来，它的内容如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs cpp\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3estatic\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3efutex_wake\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(u32 __user *uaddr, \x3cspan class=\x22hljs-keyword\x22\x3eunsigned\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e flags, \x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e nr_wake, u32 \x3cspan class=\x22hljs-built_in\x22\x3ebitset\x3c\/span\x3e)\x3c\/span\x3e\n\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3estruct\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efutex_hash_bucket\x3c\/span\x3e *\x3cspan class=\x22hljs-title\x22\x3ehb\x3c\/span\x3e;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3estruct\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efutex_q\x3c\/span\x3e *\x3cspan class=\x22hljs-title\x22\x3ethis\x3c\/span\x3e, *\x3cspan class=\x22hljs-title\x22\x3enext\x3c\/span\x3e;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eunion\x3c\/span\x3e futex_key key = FUTEX_KEY_INIT;\n    \x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e ret;\n    WAKE_Q(wake_q);\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-built_in\x22\x3ebitset\x3c\/span\x3e)\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e -EINVAL;\n\n    ret = get_futex_key(uaddr, flags \x26amp; FLAGS_SHARED, \x26amp;key, VERIFY_READ);\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e如你所见，在 \x3ccode\x3efutex_wake\x3c\/code\x3e 中的第一个函数调用真的是 \x3ccode\x3eget_futex_key\x3c\/code\x3e！ 太棒了！相比阅读内核代码，阅读函数跟踪肯定是更容易的找到结果的办法，并且让人高兴的是，还能看到所有的函数用了多长时间。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#如何知道哪些函数可以被跟踪\x22\x3e\x3c\/a\x3e如何知道哪些函数可以被跟踪\x3c\/h3\x3e\n\x3cp\x3e如果你去运行 \x3ccode\x3esudo trace-cmd list -f\x3c\/code\x3e，你将得到一个你可以跟踪的函数的列表。它很简单但是也很重要。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#最后一件事事件\x22\x3e\x3c\/a\x3e最后一件事：事件！\x3c\/h3\x3e\n\x3cp\x3e现在，我们已经知道了怎么去跟踪内核中的函数，真是太酷了！\x3c\/p\x3e\n\x3cp\x3e还有一类我们可以跟踪的东西！有些事件与我们的函数调用并不相符。例如，你可能想知道当一个程序被调度进入或者离开 CPU 时，都发生了什么事件！你可能想通过“盯着”函数调用计算出来，但是，我告诉你，不可行！\x3c\/p\x3e\n\x3cp\x3e由于函数也为你提供了几种事件，因此，你可以看到当重要的事件发生时，都发生了什么事情。你可以使用 \x3ccode\x3esudo cat \/sys\/kernel\/debug\/tracing\/available_events\x3c\/code\x3e 来查看这些事件的一个列表。 \x3c\/p\x3e\n\x3cp\x3e我查看了全部的 sched_switch 事件。我并不完全知道 sched_switch 是什么，但是，我猜测它与调度有关。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs dockerfile\x22\x3esudo cat \/sys\/kernel\/debug\/tracing\/available_events\nsudo trace-\x3cspan class=\x22hljs-keyword\x22\x3ecmd\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e record -e \x3cspan class=\x22hljs-built_in\x22\x3esched\x3c\/span\x3e:sched_switch\n\x3c\/span\x3esudo trace-\x3cspan class=\x22hljs-keyword\x22\x3ecmd\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e report\n\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e输出如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs accesslog\x22\x3e \x3cspan class=\x22hljs-number\x22\x3e16169\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e624862\x3c\/span\x3e:   Chrome_ChildIOT:\x3cspan class=\x22hljs-number\x22\x3e24817\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[112]\x3c\/span\x3e S ==\x26gt; chrome:\x3cspan class=\x22hljs-number\x22\x3e15144\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[120]\x3c\/span\x3e\n \x3cspan class=\x22hljs-number\x22\x3e16169\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e624992\x3c\/span\x3e:   chrome:\x3cspan class=\x22hljs-number\x22\x3e15144\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[120]\x3c\/span\x3e S ==\x26gt; swapper\/\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[120]\x3c\/span\x3e\n \x3cspan class=\x22hljs-number\x22\x3e16169\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e625202\x3c\/span\x3e:   swapper\/\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[120]\x3c\/span\x3e R ==\x26gt; Chrome_ChildIOT:\x3cspan class=\x22hljs-number\x22\x3e24817\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[112]\x3c\/span\x3e\n \x3cspan class=\x22hljs-number\x22\x3e16169\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e625251\x3c\/span\x3e:   Chrome_ChildIOT:\x3cspan class=\x22hljs-number\x22\x3e24817\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[112]\x3c\/span\x3e R ==\x26gt; chrome:\x3cspan class=\x22hljs-number\x22\x3e1561\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[112]\x3c\/span\x3e\n \x3cspan class=\x22hljs-number\x22\x3e16169\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e625437\x3c\/span\x3e:   chrome:\x3cspan class=\x22hljs-number\x22\x3e1561\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[112]\x3c\/span\x3e S ==\x26gt; chrome:\x3cspan class=\x22hljs-number\x22\x3e15144\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[120]\x3c\/span\x3e\n\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在，可以很清楚地看到这些切换，从 PID 24817 -\x26gt; 15144 -\x26gt; kernel -\x26gt; 24817 -\x26gt; 1561 -\x26gt; 15114。(所有的这些事件都发生在同一个 CPU 上）。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#ftrace-是如何工作的\x22\x3e\x3c\/a\x3eftrace 是如何工作的？\x3c\/h3\x3e\n\x3cp\x3eftrace 是一个动态跟踪系统。当我们开始 ftrace 内核函数时，\x3cstrong\x3e函数的代码会被改变\x3c\/strong\x3e。让我们假设去跟踪 \x3ccode\x3edo_page_fault\x3c\/code\x3e 函数。内核将在那个函数的汇编代码中插入一些额外的指令，以便每次该函数被调用时去提示跟踪系统。内核之所以能够添加额外的指令的原因是，Linux 将额外的几个 NOP 指令编译进每个函数中，因此，当需要的时候，这里有添加跟踪代码的地方。\x3c\/p\x3e\n\x3cp\x3e这是一个十分复杂的问题，因为，当不需要使用 ftrace 去跟踪我的内核时，它根本就不影响性能。而当我需要跟踪时，跟踪的函数越多，产生的开销就越大。\x3c\/p\x3e\n\x3cp\x3e（或许有些是不对的，但是，我认为的 ftrace 就是这样工作的）\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#更容易地使用-ftracebrendan-gregg-的工具及-kernelshark\x22\x3e\x3c\/a\x3e更容易地使用 ftrace：brendan gregg 的工具及 kernelshark\x3c\/h3\x3e\n\x3cp\x3e正如我们在文件中所讨论的，你需要去考虑很多的关于单个的内核函数\/事件直接使用 ftrace 都做了些什么。能够做到这一点很酷！但是也需要做大量的工作！\x3c\/p\x3e\n\x3cp\x3eBrendan Gregg （我们的 Linux 调试工具“大神”）有个工具仓库，它使用 ftrace 去提供关于像 I\/O 延迟这样的各种事情的信息。这是它在 GitHub 上全部的 \x3ca href=\x22https:\/\/github.com\/brendangregg\/perf-tools\x22\x3eperf-tools\x3c\/a\x3e 仓库。\x3c\/p\x3e\n\x3cp\x3e这里有一个权衡，那就是这些工具易于使用，但是你被限制仅能用于 Brendan Gregg 认可并做到工具里面的方面。它包括了很多方面！:)\x3c\/p\x3e\n\x3cp\x3e另一个工具是将 ftrace 的输出可视化，做的比较好的是 \x3ca href=\x22https:\/\/lwn.net\/Articles\/425583\/\x22\x3ekernelshark\x3c\/a\x3e。我还没有用过它，但是看起来似乎很有用。你可以使用 \x3ccode\x3esudo apt-get install kernelshark\x3c\/code\x3e 来安装它。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#一个新的超能力\x22\x3e\x3c\/a\x3e一个新的超能力\x3c\/h3\x3e\n\x3cp\x3e我很高兴能够花一些时间去学习 ftrace！对于任何内核工具，不同的内核版本有不同的功效，我希望有一天你能发现它很有用！\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#ftrace-系列文章的一个索引\x22\x3e\x3c\/a\x3eftrace 系列文章的一个索引\x3c\/h3\x3e\n\x3cp\x3e最后，这里是我找到的一些 ftrace 方面的文章。它们大部分在 LWN （Linux 新闻周刊）上，它是 Linux 的一个极好的资源（你可以购买一个 \x3ca href=\x22https:\/\/lwn.net\/subscribe\/Info\x22\x3e订阅\x3c\/a\x3e！）\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/lwn.net\/Articles\/365835\/\x22\x3e使用 Ftrace 调试内核 - part 1\x3c\/a\x3e (Dec 2009, Steven Rostedt)\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/lwn.net\/Articles\/366796\/\x22\x3e使用 Ftrace 调试内核 - part 2\x3c\/a\x3e (Dec 2009, Steven Rostedt)\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/lwn.net\/Articles\/370423\/\x22\x3eLinux 函数跟踪器的秘密\x3c\/a\x3e (Jan 2010, Steven Rostedt)\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/lwn.net\/Articles\/410200\/\x22\x3etrace-cmd：Ftrace 的一个前端\x3c\/a\x3e (Oct 2010, Steven Rostedt)\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/lwn.net\/Articles\/425583\/\x22\x3e使用 KernelShark 去分析实时调试器\x3c\/a\x3e (2011, Steven Rostedt)\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/lwn.net\/Articles\/608497\/\x22\x3eFtrace: 神秘的开关\x3c\/a\x3e (2014, Brendan Gregg)\x3c\/li\x3e\n\x3cli\x3e内核文档：（它十分有用） \x3ca href=\x22https:\/\/raw.githubusercontent.com\/torvalds\/linux\/v4.4\/Documentation\/trace\/ftrace.txt\x22\x3eDocumentation\/ftrace.txt\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e你能跟踪的事件的文档 \x3ca href=\x22https:\/\/raw.githubusercontent.com\/torvalds\/linux\/v4.4\/Documentation\/trace\/events.txt\x22\x3eDocumentation\/events.txt\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3elinux 内核开发上的一些 ftrace 设计文档 （不是有用，而是有趣！) \x3ca href=\x22https:\/\/raw.githubusercontent.com\/torvalds\/linux\/v4.4\/Documentation\/trace\/ftrace-design.txt\x22\x3eDocumentation\/ftrace-design.txt\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3chr\x3e\n\x3cp\x3evia: \x3ca href=\x22https:\/\/jvns.ca\/blog\/2017\/03\/19\/getting-started-with-ftrace\/\x22\x3ehttps:\/\/jvns.ca\/blog\/2017\/03\/19\/getting-started-with-ftrace\/\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e作者：\x3ca href=\x22https:\/\/jvns.ca\x22\x3eJulia Evans\x3c\/a\x3e 译者：\x3ca href=\x22https:\/\/github.com\/qhwdw\x22\x3eqhwdw\x3c\/a\x3e 校对：\x3ca href=\x22https:\/\/github.com\/wxy\x22\x3ewxy\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e本文由 \x3ca href=\x22https:\/\/github.com\/LCTT\/TranslateProject\x22\x3eLCTT\x3c\/a\x3e 原创编译，\x3ca href=\x22https:\/\/linux.cn\/\x22\x3eLinux中国\x3c\/a\x3e 荣誉推出\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>ftrace：跟踪你的内核函数！</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/ftrace-trace-your-kernel-functions">https://www.zcfy.cc/article/ftrace-trace-your-kernel-functions</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/2dcqdgdjn8y/" target="_blank">https://alili.tech/archive/2dcqdgdjn8y/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>